var wwplayer;
(function() {
    if (!wwplayer || !wwplayer.requirejs) {
        if (!wwplayer) {
            wwplayer = {};
        } else {
            require = wwplayer;
        }
        /** vim: et:ts=4:sw=4:sts=4
         * @license RequireJS 2.1.9 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
         * Available via the MIT or new BSD license.
         * see: http://github.com/jrburke/requirejs for details
         */
        //Not using strict: uneven strict support in browsers, #392, and causes
        //problems with requirejs.exec()/transpiler plugins that may not be strict.
        /*jslint regexp: true, nomen: true, sloppy: true */
        /*global window, navigator, document, importScripts, setTimeout, opera */

        var requirejs, require, define;
        (function(global) {
            var req,
                s,
                head,
                baseElement,
                dataMain,
                src,
                interactiveScript,
                currentlyAddingScript,
                mainScript,
                subPath,
                currentConfig,
                version = "2.1.9",
                commentRegExp = /(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,
                cjsRequireRegExp = /[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,
                jsSuffixRegExp = /\.js$/,
                currDirRegExp = /^\.\//,
                op = Object.prototype,
                ostring = op.toString,
                hasOwn = op.hasOwnProperty,
                ap = Array.prototype,
                apsp = ap.splice,
                isBrowser = !!(typeof window !== "undefined" && typeof navigator !== "undefined" && window.document),
                isWebWorker = !isBrowser && typeof importScripts !== "undefined",
                //PS3 indicates loaded and complete, but need to wait for complete
                //specifically. Sequence is 'loading', 'loaded', execution,
                // then 'complete'. The UA check is unfortunate, but not sure how
                //to feature test w/o causing perf issues.
                readyRegExp = isBrowser && navigator.platform === "PLAYSTATION 3" ? /^complete$/ : /^(complete|loaded)$/,
                defContextName = "_",
                //Oh the tragedy, detecting opera. See the usage of isOpera for reason.
                isOpera = typeof opera !== "undefined" && opera.toString() === "[object Opera]",
                contexts = {},
                cfg = {},
                globalDefQueue = [],
                useInteractive = false;

            function isFunction(it) {
                return ostring.call(it) === "[object Function]";
            }

            function isArray(it) {
                return ostring.call(it) === "[object Array]";
            }

            /**
             * Helper function for iterating over an array. If the func returns
             * a true value, it will break out of the loop.
             */
            function each(ary, func) {
                if (ary) {
                    var i;
                    for (i = 0; i < ary.length; i += 1) {
                        if (ary[i] && func(ary[i], i, ary)) {
                            break;
                        }
                    }
                }
            }

            /**
             * Helper function for iterating over an array backwards. If the func
             * returns a true value, it will break out of the loop.
             */
            function eachReverse(ary, func) {
                if (ary) {
                    var i;
                    for (i = ary.length - 1; i > -1; i -= 1) {
                        if (ary[i] && func(ary[i], i, ary)) {
                            break;
                        }
                    }
                }
            }

            function hasProp(obj, prop) {
                return hasOwn.call(obj, prop);
            }

            function getOwn(obj, prop) {
                return hasProp(obj, prop) && obj[prop];
            }

            /**
             * Cycles over properties in an object and calls a function for each
             * property value. If the function returns a truthy value, then the
             * iteration is stopped.
             */
            function eachProp(obj, func) {
                var prop;
                for (prop in obj) {
                    if (hasProp(obj, prop)) {
                        if (func(obj[prop], prop)) {
                            break;
                        }
                    }
                }
            }

            /**
             * Simple function to mix in properties from source into target,
             * but only if target does not already have a property of the same name.
             */
            function mixin(target, source, force, deepStringMixin) {
                if (source) {
                    eachProp(source, function(value, prop) {
                        if (force || !hasProp(target, prop)) {
                            if (deepStringMixin && typeof value !== "string") {
                                if (!target[prop]) {
                                    target[prop] = {};
                                }
                                mixin(target[prop], value, force, deepStringMixin);
                            } else {
                                target[prop] = value;
                            }
                        }
                    });
                }
                return target;
            }

            //Similar to Function.prototype.bind, but the 'this' object is specified
            //first, since it is easier to read/figure out what 'this' will be.
            function bind(obj, fn) {
                return function() {
                    return fn.apply(obj, arguments);
                };
            }

            function scripts() {
                return document.getElementsByTagName("script");
            }

            function defaultOnError(err) {
                throw err;
            }

            //Allow getting a global that expressed in
            //dot notation, like 'a.b.c'.
            function getGlobal(value) {
                if (!value) {
                    return value;
                }
                var g = global;
                each(value.split("."), function(part) {
                    g = g[part];
                });
                return g;
            }

            /**
             * Constructs an error with a pointer to an URL with more information.
             * @param {String} id the error ID that maps to an ID on a web page.
             * @param {String} message human readable error.
             * @param {Error} [err] the original error, if there is one.
             *
             * @returns {Error}
             */
            function makeError(id, msg, err, requireModules) {
                var e = new Error(msg + "\nhttp://requirejs.org/docs/errors.html#" + id);
                e.requireType = id;
                e.requireModules = requireModules;
                if (err) {
                    e.originalError = err;
                }
                return e;
            }

            if (typeof define !== "undefined") {
                //If a define is already in play via another AMD loader,
                //do not overwrite.
                return;
            }

            if (typeof requirejs !== "undefined") {
                if (isFunction(requirejs)) {
                    //Do not overwrite and existing requirejs instance.
                    return;
                }
                cfg = requirejs;
                requirejs = undefined;
            }

            //Allow for a require config object
            if (typeof require !== "undefined" && !isFunction(require)) {
                //assume it is a config object.
                cfg = require;
                require = undefined;
            }

            function newContext(contextName) {
                var inCheckLoaded,
                    Module,
                    context,
                    handlers,
                    checkLoadedTimeoutId,
                    config = {
                        //Defaults. Do not set a default for map
                        //config to speed up normalize(), which
                        //will run faster if there is no default.
                        waitSeconds: 7,
                        baseUrl: "./",
                        paths: {},
                        pkgs: {},
                        shim: {},
                        config: {}
                    },
                    registry = {},
                    //registry of just enabled modules, to speed
                    //cycle breaking code when lots of modules
                    //are registered, but not activated.
                    enabledRegistry = {},
                    undefEvents = {},
                    defQueue = [],
                    defined = {},
                    urlFetched = {},
                    requireCounter = 1,
                    unnormalizedCounter = 1;

                /**
                 * Trims the . and .. from an array of path segments.
                 * It will keep a leading path segment if a .. will become
                 * the first path segment, to help with module name lookups,
                 * which act like paths, but can be remapped. But the end result,
                 * all paths that use this function should look normalized.
                 * NOTE: this method MODIFIES the input array.
                 * @param {Array} ary the array of path segments.
                 */
                function trimDots(ary) {
                    var i, part;
                    for (i = 0; ary[i]; i += 1) {
                        part = ary[i];
                        if (part === ".") {
                            ary.splice(i, 1);
                            i -= 1;
                        } else if (part === "..") {
                            if (i === 1 && (ary[2] === ".." || ary[0] === "..")) {
                                //End of the line. Keep at least one non-dot
                                //path segment at the front so it can be mapped
                                //correctly to disk. Otherwise, there is likely
                                //no path mapping for a path starting with '..'.
                                //This can still fail, but catches the most reasonable
                                //uses of ..
                                break;
                            } else if (i > 0) {
                                ary.splice(i - 1, 2);
                                i -= 2;
                            }
                        }
                    }
                }

                /**
                 * Given a relative module name, like ./something, normalize it to
                 * a real name that can be mapped to a path.
                 * @param {String} name the relative name
                 * @param {String} baseName a real name that the name arg is relative
                 * to.
                 * @param {Boolean} applyMap apply the map config to the value. Should
                 * only be done if this normalization is for a dependency ID.
                 * @returns {String} normalized name
                 */
                function normalize(name, baseName, applyMap) {
                    var pkgName,
                        pkgConfig,
                        mapValue,
                        nameParts,
                        i,
                        j,
                        nameSegment,
                        foundMap,
                        foundI,
                        foundStarMap,
                        starI,
                        baseParts = baseName && baseName.split("/"),
                        normalizedBaseParts = baseParts,
                        map = config.map,
                        starMap = map && map["*"];

                    //Adjust any relative paths.
                    if (name && name.charAt(0) === ".") {
                        //If have a base name, try to normalize against it,
                        //otherwise, assume it is a top-level require that will
                        //be relative to baseUrl in the end.
                        if (baseName) {
                            if (getOwn(config.pkgs, baseName)) {
                                //If the baseName is a package name, then just treat it as one
                                //name to concat the name with.
                                normalizedBaseParts = baseParts = [baseName];
                            } else {
                                //Convert baseName to array, and lop off the last part,
                                //so that . matches that 'directory' and not name of the baseName's
                                //module. For instance, baseName of 'one/two/three', maps to
                                //'one/two/three.js', but we want the directory, 'one/two' for
                                //this normalization.
                                normalizedBaseParts = baseParts.slice(0, baseParts.length - 1);
                            }

                            name = normalizedBaseParts.concat(name.split("/"));
                            trimDots(name);

                            //Some use of packages may use a . path to reference the
                            //'main' module name, so normalize for that.
                            pkgConfig = getOwn(config.pkgs, (pkgName = name[0]));
                            name = name.join("/");
                            if (pkgConfig && name === pkgName + "/" + pkgConfig.main) {
                                name = pkgName;
                            }
                        } else if (name.indexOf("./") === 0) {
                            // No baseName, so this is ID is resolved relative
                            // to baseUrl, pull off the leading dot.
                            name = name.substring(2);
                        }
                    }

                    //Apply map config if available.
                    if (applyMap && map && (baseParts || starMap)) {
                        nameParts = name.split("/");

                        for (i = nameParts.length; i > 0; i -= 1) {
                            nameSegment = nameParts.slice(0, i).join("/");

                            if (baseParts) {
                                //Find the longest baseName segment match in the config.
                                //So, do joins on the biggest to smallest lengths of baseParts.
                                for (j = baseParts.length; j > 0; j -= 1) {
                                    mapValue = getOwn(map, baseParts.slice(0, j).join("/"));

                                    //baseName segment has config, find if it has one for
                                    //this name.
                                    if (mapValue) {
                                        mapValue = getOwn(mapValue, nameSegment);
                                        if (mapValue) {
                                            //Match, update name to the new value.
                                            foundMap = mapValue;
                                            foundI = i;
                                            break;
                                        }
                                    }
                                }
                            }

                            if (foundMap) {
                                break;
                            }

                            //Check for a star map match, but just hold on to it,
                            //if there is a shorter segment match later in a matching
                            //config, then favor over this star map.
                            if (!foundStarMap && starMap && getOwn(starMap, nameSegment)) {
                                foundStarMap = getOwn(starMap, nameSegment);
                                starI = i;
                            }
                        }

                        if (!foundMap && foundStarMap) {
                            foundMap = foundStarMap;
                            foundI = starI;
                        }

                        if (foundMap) {
                            nameParts.splice(0, foundI, foundMap);
                            name = nameParts.join("/");
                        }
                    }

                    return name;
                }

                function removeScript(name) {
                    if (isBrowser) {
                        each(scripts(), function(scriptNode) {
                            if (scriptNode.getAttribute("data-requiremodule") === name && scriptNode.getAttribute("data-requirecontext") === context.contextName) {
                                scriptNode.parentNode.removeChild(scriptNode);
                                return true;
                            }
                        });
                    }
                }

                function hasPathFallback(id) {
                    var pathConfig = getOwn(config.paths, id);
                    if (pathConfig && isArray(pathConfig) && pathConfig.length > 1) {
                        //Pop off the first array value, since it failed, and
                        //retry
                        pathConfig.shift();
                        context.require.undef(id);
                        context.require([id]);
                        return true;
                    }
                }

                //Turns a plugin!resource to [plugin, resource]
                //with the plugin being undefined if the name
                //did not have a plugin prefix.
                function splitPrefix(name) {
                    var prefix,
                        index = name ? name.indexOf("!") : -1;
                    if (index > -1) {
                        prefix = name.substring(0, index);
                        name = name.substring(index + 1, name.length);
                    }
                    return [prefix, name];
                }

                /**
                 * Creates a module mapping that includes plugin prefix, module
                 * name, and path. If parentModuleMap is provided it will
                 * also normalize the name via require.normalize()
                 *
                 * @param {String} name the module name
                 * @param {String} [parentModuleMap] parent module map
                 * for the module name, used to resolve relative names.
                 * @param {Boolean} isNormalized: is the ID already normalized.
                 * This is true if this call is done for a define() module ID.
                 * @param {Boolean} applyMap: apply the map config to the ID.
                 * Should only be true if this map is for a dependency.
                 *
                 * @returns {Object}
                 */
                function makeModuleMap(name, parentModuleMap, isNormalized, applyMap) {
                    var url,
                        pluginModule,
                        suffix,
                        nameParts,
                        prefix = null,
                        parentName = parentModuleMap ? parentModuleMap.name : null,
                        originalName = name,
                        isDefine = true,
                        normalizedName = "";

                    //If no name, then it means it is a require call, generate an
                    //internal name.
                    if (!name) {
                        isDefine = false;
                        name = "_@r" + (requireCounter += 1);
                    }

                    nameParts = splitPrefix(name);
                    prefix = nameParts[0];
                    name = nameParts[1];

                    if (prefix) {
                        prefix = normalize(prefix, parentName, applyMap);
                        pluginModule = getOwn(defined, prefix);
                    }

                    //Account for relative paths if there is a base name.
                    if (name) {
                        if (prefix) {
                            if (pluginModule && pluginModule.normalize) {
                                //Plugin is loaded, use its normalize method.
                                normalizedName = pluginModule.normalize(name, function(name) {
                                    return normalize(name, parentName, applyMap);
                                });
                            } else {
                                normalizedName = normalize(name, parentName, applyMap);
                            }
                        } else {
                            //A regular module.
                            normalizedName = normalize(name, parentName, applyMap);

                            //Normalized name may be a plugin ID due to map config
                            //application in normalize. The map config values must
                            //already be normalized, so do not need to redo that part.
                            nameParts = splitPrefix(normalizedName);
                            prefix = nameParts[0];
                            normalizedName = nameParts[1];
                            isNormalized = true;

                            url = context.nameToUrl(normalizedName);
                        }
                    }

                    //If the id is a plugin id that cannot be determined if it needs
                    //normalization, stamp it with a unique ID so two matching relative
                    //ids that may conflict can be separate.
                    suffix = prefix && !pluginModule && !isNormalized ? "_unnormalized" + (unnormalizedCounter += 1) : "";

                    return {
                        prefix: prefix,
                        name: normalizedName,
                        parentMap: parentModuleMap,
                        unnormalized: !!suffix,
                        url: url,
                        originalName: originalName,
                        isDefine: isDefine,
                        id: (prefix ? prefix + "!" + normalizedName : normalizedName) + suffix
                    };
                }

                function getModule(depMap) {
                    var id = depMap.id,
                        mod = getOwn(registry, id);

                    if (!mod) {
                        mod = registry[id] = new context.Module(depMap);
                    }

                    return mod;
                }

                function on(depMap, name, fn) {
                    var id = depMap.id,
                        mod = getOwn(registry, id);

                    if (hasProp(defined, id) && (!mod || mod.defineEmitComplete)) {
                        if (name === "defined") {
                            fn(defined[id]);
                        }
                    } else {
                        mod = getModule(depMap);
                        if (mod.error && name === "error") {
                            fn(mod.error);
                        } else {
                            mod.on(name, fn);
                        }
                    }
                }

                function onError(err, errback) {
                    var ids = err.requireModules,
                        notified = false;

                    if (errback) {
                        errback(err);
                    } else {
                        each(ids, function(id) {
                            var mod = getOwn(registry, id);
                            if (mod) {
                                //Set error on module, so it skips timeout checks.
                                mod.error = err;
                                if (mod.events.error) {
                                    notified = true;
                                    mod.emit("error", err);
                                }
                            }
                        });

                        if (!notified) {
                            req.onError(err);
                        }
                    }
                }

                /**
                 * Internal method to transfer globalQueue items to this context's
                 * defQueue.
                 */
                function takeGlobalQueue() {
                    //Push all the globalDefQueue items into the context's defQueue
                    if (globalDefQueue.length) {
                        //Array splice in the values since the context code has a
                        //local var ref to defQueue, so cannot just reassign the one
                        //on context.
                        apsp.apply(defQueue, [defQueue.length - 1, 0].concat(globalDefQueue));
                        globalDefQueue = [];
                    }
                }

                handlers = {
                    require: function(mod) {
                        if (mod.require) {
                            return mod.require;
                        } else {
                            return (mod.require = context.makeRequire(mod.map));
                        }
                    },
                    exports: function(mod) {
                        mod.usingExports = true;
                        if (mod.map.isDefine) {
                            if (mod.exports) {
                                return mod.exports;
                            } else {
                                return (mod.exports = defined[mod.map.id] = {});
                            }
                        }
                    },
                    module: function(mod) {
                        if (mod.module) {
                            return mod.module;
                        } else {
                            return (mod.module = {
                                id: mod.map.id,
                                uri: mod.map.url,
                                config: function() {
                                    var c,
                                        pkg = getOwn(config.pkgs, mod.map.id);
                                    // For packages, only support config targeted
                                    // at the main module.
                                    c = pkg ? getOwn(config.config, mod.map.id + "/" + pkg.main) : getOwn(config.config, mod.map.id);
                                    return c || {};
                                },
                                exports: defined[mod.map.id]
                            });
                        }
                    }
                };

                function cleanRegistry(id) {
                    //Clean up machinery used for waiting modules.
                    delete registry[id];
                    delete enabledRegistry[id];
                }

                function breakCycle(mod, traced, processed) {
                    var id = mod.map.id;

                    if (mod.error) {
                        mod.emit("error", mod.error);
                    } else {
                        traced[id] = true;
                        each(mod.depMaps, function(depMap, i) {
                            var depId = depMap.id,
                                dep = getOwn(registry, depId);

                            //Only force things that have not completed
                            //being defined, so still in the registry,
                            //and only if it has not been matched up
                            //in the module already.
                            if (dep && !mod.depMatched[i] && !processed[depId]) {
                                if (getOwn(traced, depId)) {
                                    mod.defineDep(i, defined[depId]);
                                    mod.check(); //pass false?
                                } else {
                                    breakCycle(dep, traced, processed);
                                }
                            }
                        });
                        processed[id] = true;
                    }
                }

                function checkLoaded() {
                    var map,
                        modId,
                        err,
                        usingPathFallback,
                        waitInterval = config.waitSeconds * 1000,
                        //It is possible to disable the wait interval by using waitSeconds of 0.
                        expired = waitInterval && context.startTime + waitInterval < new Date().getTime(),
                        noLoads = [],
                        reqCalls = [],
                        stillLoading = false,
                        needCycleCheck = true;

                    //Do not bother if this call was a result of a cycle break.
                    if (inCheckLoaded) {
                        return;
                    }

                    inCheckLoaded = true;

                    //Figure out the state of all the modules.
                    eachProp(enabledRegistry, function(mod) {
                        map = mod.map;
                        modId = map.id;

                        //Skip things that are not enabled or in error state.
                        if (!mod.enabled) {
                            return;
                        }

                        if (!map.isDefine) {
                            reqCalls.push(mod);
                        }

                        if (!mod.error) {
                            //If the module should be executed, and it has not
                            //been inited and time is up, remember it.
                            if (!mod.inited && expired) {
                                if (hasPathFallback(modId)) {
                                    usingPathFallback = true;
                                    stillLoading = true;
                                } else {
                                    noLoads.push(modId);
                                    removeScript(modId);
                                }
                            } else if (!mod.inited && mod.fetched && map.isDefine) {
                                stillLoading = true;
                                if (!map.prefix) {
                                    //No reason to keep looking for unfinished
                                    //loading. If the only stillLoading is a
                                    //plugin resource though, keep going,
                                    //because it may be that a plugin resource
                                    //is waiting on a non-plugin cycle.
                                    return (needCycleCheck = false);
                                }
                            }
                        }
                    });

                    if (expired && noLoads.length) {
                        //If wait time expired, throw error of unloaded modules.
                        err = makeError("timeout", "Load timeout for modules: " + noLoads, null, noLoads);
                        err.contextName = context.contextName;
                        return onError(err);
                    }

                    //Not expired, check for a cycle.
                    if (needCycleCheck) {
                        each(reqCalls, function(mod) {
                            breakCycle(mod, {}, {});
                        });
                    }

                    //If still waiting on loads, and the waiting load is something
                    //other than a plugin resource, or there are still outstanding
                    //scripts, then just try back later.
                    if ((!expired || usingPathFallback) && stillLoading) {
                        //Something is still waiting to load. Wait for it, but only
                        //if a timeout is not already in effect.
                        if ((isBrowser || isWebWorker) && !checkLoadedTimeoutId) {
                            checkLoadedTimeoutId = setTimeout(function() {
                                checkLoadedTimeoutId = 0;
                                checkLoaded();
                            }, 50);
                        }
                    }

                    inCheckLoaded = false;
                }

                Module = function(map) {
                    this.events = getOwn(undefEvents, map.id) || {};
                    this.map = map;
                    this.shim = getOwn(config.shim, map.id);
                    this.depExports = [];
                    this.depMaps = [];
                    this.depMatched = [];
                    this.pluginMaps = {};
                    this.depCount = 0;

                    /* this.exports this.factory
               this.depMaps = [],
               this.enabled, this.fetched
            */
                };

                Module.prototype = {
                    init: function(depMaps, factory, errback, options) {
                        options = options || {};

                        //Do not do more inits if already done. Can happen if there
                        //are multiple define calls for the same module. That is not
                        //a normal, common case, but it is also not unexpected.
                        if (this.inited) {
                            return;
                        }

                        this.factory = factory;

                        if (errback) {
                            //Register for errors on this module.
                            this.on("error", errback);
                        } else if (this.events.error) {
                            //If no errback already, but there are error listeners
                            //on this module, set up an errback to pass to the deps.
                            errback = bind(this, function(err) {
                                this.emit("error", err);
                            });
                        }

                        //Do a copy of the dependency array, so that
                        //source inputs are not modified. For example
                        //"shim" deps are passed in here directly, and
                        //doing a direct modification of the depMaps array
                        //would affect that config.
                        this.depMaps = depMaps && depMaps.slice(0);

                        this.errback = errback;

                        //Indicate this module has be initialized
                        this.inited = true;

                        this.ignore = options.ignore;

                        //Could have option to init this module in enabled mode,
                        //or could have been previously marked as enabled. However,
                        //the dependencies are not known until init is called. So
                        //if enabled previously, now trigger dependencies as enabled.
                        if (options.enabled || this.enabled) {
                            //Enable this module and dependencies.
                            //Will call this.check()
                            this.enable();
                        } else {
                            this.check();
                        }
                    },

                    defineDep: function(i, depExports) {
                        //Because of cycles, defined callback for a given
                        //export can be called more than once.
                        if (!this.depMatched[i]) {
                            this.depMatched[i] = true;
                            this.depCount -= 1;
                            this.depExports[i] = depExports;
                        }
                    },

                    fetch: function() {
                        if (this.fetched) {
                            return;
                        }
                        this.fetched = true;

                        context.startTime = new Date().getTime();

                        var map = this.map;

                        //If the manager is for a plugin managed resource,
                        //ask the plugin to load it now.
                        if (this.shim) {
                            context.makeRequire(this.map, {
                                enableBuildCallback: true
                            })(
                                this.shim.deps || [],
                                bind(this, function() {
                                    return map.prefix ? this.callPlugin() : this.load();
                                })
                            );
                        } else {
                            //Regular dependency.
                            return map.prefix ? this.callPlugin() : this.load();
                        }
                    },

                    load: function() {
                        var url = this.map.url;

                        // // skip jquery to prevent auth conflict with PDK5 / AMCN
                        if(window.wirewax.pdkPlugin && window.requestor_id === "BBCA" && this.map.name === "jquery") {
                            return
                        }

                        //Regular dependency.
                        if (!urlFetched[url]) {
                            urlFetched[url] = true;
                            context.load(this.map.id, url);
                        }
                    },

                    /**
                     * Checks if the module is ready to define itself, and if so,
                     * define it.
                     */
                    check: function() {

                        if(window.wirewax.pdkPlugin && window.requestor_id === "BBCA" && this.map.name === "jquery") {
                            this.defineEmitted = true;
                            this.emit("defined", this.exports);
                            this.defineEmitComplete = true;
                            return;
                        }


                        if (!this.enabled || this.enabling) {
                            return;
                        }

                        var err,
                            cjsModule,
                            id = this.map.id,
                            depExports = this.depExports,
                            exports = this.exports,
                            factory = this.factory;

                        if (!this.inited) {
                            this.fetch();
                        } else if (this.error) {
                            this.emit("error", this.error);
                        } else if (!this.defining) {
                            //The factory could trigger another require call
                            //that would result in checking this module to
                            //define itself again. If already in the process
                            //of doing that, skip this work.
                            this.defining = true;

                            if (this.depCount < 1 && !this.defined) {
                                if (isFunction(factory)) {
                                    //If there is an error listener, favor passing
                                    //to that instead of throwing an error. However,
                                    //only do it for define()'d  modules. require
                                    //errbacks should not be called for failures in
                                    //their callbacks (#699). However if a global
                                    //onError is set, use that.
                                    if ((this.events.error && this.map.isDefine) || req.onError !== defaultOnError) {
                                        try {
                                            exports = context.execCb(id, factory, depExports, exports);
                                        } catch (e) {
                                            err = e;
                                        }
                                    } else {
                                        exports = context.execCb(id, factory, depExports, exports);
                                    }

                                    if (this.map.isDefine) {
                                        //If setting exports via 'module' is in play,
                                        //favor that over return value and exports. After that,
                                        //favor a non-undefined return value over exports use.
                                        cjsModule = this.module;
                                        if (
                                            cjsModule &&
                                            cjsModule.exports !== undefined &&
                                            //Make sure it is not already the exports value
                                            cjsModule.exports !== this.exports
                                        ) {
                                            exports = cjsModule.exports;
                                        } else if (exports === undefined && this.usingExports) {
                                            //exports already set the defined value.
                                            exports = this.exports;
                                        }
                                    }

                                    if (err) {
                                        err.requireMap = this.map;
                                        err.requireModules = this.map.isDefine ? [this.map.id] : null;
                                        err.requireType = this.map.isDefine ? "define" : "require";
                                        return onError((this.error = err));
                                    }
                                } else {
                                    //Just a literal value
                                    exports = factory;
                                }

                                this.exports = exports;

                                if (this.map.isDefine && !this.ignore) {
                                    defined[id] = exports;

                                    if (req.onResourceLoad) {
                                        req.onResourceLoad(context, this.map, this.depMaps);
                                    }
                                }

                                //Clean up
                                cleanRegistry(id);

                                this.defined = true;
                            }

                            //Finished the define stage. Allow calling check again
                            //to allow define notifications below in the case of a
                            //cycle.
                            this.defining = false;

                            if (this.defined && !this.defineEmitted) {
                                this.defineEmitted = true;
                                this.emit("defined", this.exports);
                                this.defineEmitComplete = true;
                            }
                        }
                    },

                    callPlugin: function() {
                        var map = this.map,
                            id = map.id,
                            //Map already normalized the prefix.
                            pluginMap = makeModuleMap(map.prefix);

                        //Mark this as a dependency for this plugin, so it
                        //can be traced for cycles.
                        this.depMaps.push(pluginMap);

                        on(
                            pluginMap,
                            "defined",
                            bind(this, function(plugin) {
                                var load,
                                    normalizedMap,
                                    normalizedMod,
                                    name = this.map.name,
                                    parentName = this.map.parentMap ? this.map.parentMap.name : null,
                                    localRequire = context.makeRequire(map.parentMap, {
                                        enableBuildCallback: true
                                    });

                                //If current map is not normalized, wait for that
                                //normalized name to load instead of continuing.
                                if (this.map.unnormalized) {
                                    //Normalize the ID if the plugin allows it.
                                    if (plugin.normalize) {
                                        name =
                                            plugin.normalize(name, function(name) {
                                                return normalize(name, parentName, true);
                                            }) || "";
                                    }

                                    //prefix and name should already be normalized, no need
                                    //for applying map config again either.
                                    normalizedMap = makeModuleMap(map.prefix + "!" + name, this.map.parentMap);
                                    on(
                                        normalizedMap,
                                        "defined",
                                        bind(this, function(value) {
                                            this.init(
                                                [],
                                                function() {
                                                    return value;
                                                },
                                                null,
                                                {
                                                    enabled: true,
                                                    ignore: true
                                                }
                                            );
                                        })
                                    );

                                    normalizedMod = getOwn(registry, normalizedMap.id);
                                    if (normalizedMod) {
                                        //Mark this as a dependency for this plugin, so it
                                        //can be traced for cycles.
                                        this.depMaps.push(normalizedMap);

                                        if (this.events.error) {
                                            normalizedMod.on(
                                                "error",
                                                bind(this, function(err) {
                                                    this.emit("error", err);
                                                })
                                            );
                                        }
                                        normalizedMod.enable();
                                    }

                                    return;
                                }

                                load = bind(this, function(value) {
                                    this.init(
                                        [],
                                        function() {
                                            return value;
                                        },
                                        null,
                                        {
                                            enabled: true
                                        }
                                    );
                                });

                                load.error = bind(this, function(err) {
                                    this.inited = true;
                                    this.error = err;
                                    err.requireModules = [id];

                                    //Remove temp unnormalized modules for this module,
                                    //since they will never be resolved otherwise now.
                                    eachProp(registry, function(mod) {
                                        if (mod.map.id.indexOf(id + "_unnormalized") === 0) {
                                            cleanRegistry(mod.map.id);
                                        }
                                    });

                                    onError(err);
                                });

                                //Allow plugins to load other code without having to know the
                                //context or how to 'complete' the load.
                                load.fromText = bind(this, function(text, textAlt) {
                                    /*jslint evil: true */
                                    var moduleName = map.name,
                                        moduleMap = makeModuleMap(moduleName),
                                        hasInteractive = useInteractive;

                                    //As of 2.1.0, support just passing the text, to reinforce
                                    //fromText only being called once per resource. Still
                                    //support old style of passing moduleName but discard
                                    //that moduleName in favor of the internal ref.
                                    if (textAlt) {
                                        text = textAlt;
                                    }

                                    //Turn off interactive script matching for IE for any define
                                    //calls in the text, then turn it back on at the end.
                                    if (hasInteractive) {
                                        useInteractive = false;
                                    }

                                    //Prime the system by creating a module instance for
                                    //it.
                                    getModule(moduleMap);

                                    //Transfer any config to this other module.
                                    if (hasProp(config.config, id)) {
                                        config.config[moduleName] = config.config[id];
                                    }

                                    try {
                                        req.exec(text);
                                    } catch (e) {
                                        return onError(makeError("fromtexteval", "fromText eval for " + id + " failed: " + e, e, [id]));
                                    }

                                    if (hasInteractive) {
                                        useInteractive = true;
                                    }

                                    //Mark this as a dependency for the plugin
                                    //resource
                                    this.depMaps.push(moduleMap);

                                    //Support anonymous modules.
                                    context.completeLoad(moduleName);

                                    //Bind the value of that module to the value for this
                                    //resource ID.
                                    localRequire([moduleName], load);
                                });

                                //Use parentName here since the plugin's name is not reliable,
                                //could be some weird string with no path that actually wants to
                                //reference the parentName's path.
                                plugin.load(map.name, localRequire, load, config);
                            })
                        );

                        context.enable(pluginMap, this);
                        this.pluginMaps[pluginMap.id] = pluginMap;
                    },

                    enable: function() {
                        enabledRegistry[this.map.id] = this;
                        this.enabled = true;

                        //Set flag mentioning that the module is enabling,
                        //so that immediate calls to the defined callbacks
                        //for dependencies do not trigger inadvertent load
                        //with the depCount still being zero.
                        this.enabling = true;

                        //Enable each dependency
                        each(
                            this.depMaps,
                            bind(this, function(depMap, i) {
                                var id, mod, handler;

                                if (typeof depMap === "string") {
                                    //Dependency needs to be converted to a depMap
                                    //and wired up to this module.
                                    depMap = makeModuleMap(depMap, this.map.isDefine ? this.map : this.map.parentMap, false, !this.skipMap);
                                    this.depMaps[i] = depMap;

                                    handler = getOwn(handlers, depMap.id);

                                    if (handler) {
                                        this.depExports[i] = handler(this);
                                        return;
                                    }

                                    this.depCount += 1;

                                    on(
                                        depMap,
                                        "defined",
                                        bind(this, function(depExports) {
                                            this.defineDep(i, depExports);
                                            this.check();
                                        })
                                    );

                                    if (this.errback) {
                                        on(depMap, "error", bind(this, this.errback));
                                    }
                                }

                                id = depMap.id;
                                mod = registry[id];

                                //Skip special modules like 'require', 'exports', 'module'
                                //Also, don't call enable if it is already enabled,
                                //important in circular dependency cases.
                                if (!hasProp(handlers, id) && mod && !mod.enabled) {
                                    context.enable(depMap, this);
                                }
                            })
                        );

                        //Enable each plugin that is used in
                        //a dependency
                        eachProp(
                            this.pluginMaps,
                            bind(this, function(pluginMap) {
                                var mod = getOwn(registry, pluginMap.id);
                                if (mod && !mod.enabled) {
                                    context.enable(pluginMap, this);
                                }
                            })
                        );

                        this.enabling = false;

                        this.check();
                    },

                    on: function(name, cb) {
                        var cbs = this.events[name];
                        if (!cbs) {
                            cbs = this.events[name] = [];
                        }
                        cbs.push(cb);
                    },

                    emit: function(name, evt) {
                        each(this.events[name], function(cb) {
                            cb(evt);
                        });
                        if (name === "error") {
                            //Now that the error handler was triggered, remove
                            //the listeners, since this broken Module instance
                            //can stay around for a while in the registry.
                            delete this.events[name];
                        }
                    }
                };

                function callGetModule(args) {
                    //Skip modules already defined.
                    if (!hasProp(defined, args[0])) {
                        getModule(makeModuleMap(args[0], null, true)).init(args[1], args[2]);
                    }
                }

                function removeListener(node, func, name, ieName) {
                    //Favor detachEvent because of IE9
                    //issue, see attachEvent/addEventListener comment elsewhere
                    //in this file.
                    if (node.detachEvent && !isOpera) {
                        //Probably IE. If not it will throw an error, which will be
                        //useful to know.
                        if (ieName) {
                            node.detachEvent(ieName, func);
                        }
                    } else {
                        node.removeEventListener(name, func, false);
                    }
                }

                /**
                 * Given an event from a script node, get the requirejs info from it,
                 * and then removes the event listeners on the node.
                 * @param {Event} evt
                 * @returns {Object}
                 */
                function getScriptData(evt) {
                    //Using currentTarget instead of target for Firefox 2.0's sake. Not
                    //all old browsers will be supported, but this one was easy enough
                    //to support and still makes sense.
                    var node = evt.currentTarget || evt.srcElement;

                    //Remove the listeners once here.
                    removeListener(node, context.onScriptLoad, "load", "onreadystatechange");
                    removeListener(node, context.onScriptError, "error");

                    return {
                        node: node,
                        id: node && node.getAttribute("data-requiremodule")
                    };
                }

                function intakeDefines() {
                    var args;

                    //Any defined modules in the global queue, intake them now.
                    takeGlobalQueue();

                    //Make sure any remaining defQueue items get properly processed.
                    while (defQueue.length) {
                        args = defQueue.shift();
                        if (args[0] === null) {
                            return onError(makeError("mismatch", "Mismatched anonymous define() module: " + args[args.length - 1]));
                        } else {
                            //args are id, deps, factory. Should be normalized by the
                            //define() function.
                            callGetModule(args);
                        }
                    }
                }

                context = {
                    config: config,
                    contextName: contextName,
                    registry: registry,
                    defined: defined,
                    urlFetched: urlFetched,
                    defQueue: defQueue,
                    Module: Module,
                    makeModuleMap: makeModuleMap,
                    nextTick: req.nextTick,
                    onError: onError,

                    /**
                     * Set a configuration for the context.
                     * @param {Object} cfg config object to integrate.
                     */
                    configure: function(cfg) {
                        //Make sure the baseUrl ends in a slash.
                        if (cfg.baseUrl) {
                            if (cfg.baseUrl.charAt(cfg.baseUrl.length - 1) !== "/") {
                                cfg.baseUrl += "/";
                            }
                        }

                        //Save off the paths and packages since they require special processing,
                        //they are additive.
                        var pkgs = config.pkgs,
                            shim = config.shim,
                            objs = {
                                paths: true,
                                config: true,
                                map: true
                            };

                        eachProp(cfg, function(value, prop) {
                            if (objs[prop]) {
                                if (prop === "map") {
                                    if (!config.map) {
                                        config.map = {};
                                    }
                                    mixin(config[prop], value, true, true);
                                } else {
                                    mixin(config[prop], value, true);
                                }
                            } else {
                                config[prop] = value;
                            }
                        });

                        //Merge shim
                        if (cfg.shim) {
                            eachProp(cfg.shim, function(value, id) {
                                //Normalize the structure
                                if (isArray(value)) {
                                    value = {
                                        deps: value
                                    };
                                }
                                if ((value.exports || value.init) && !value.exportsFn) {
                                    value.exportsFn = context.makeShimExports(value);
                                }
                                shim[id] = value;
                            });
                            config.shim = shim;
                        }

                        //Adjust packages if necessary.
                        if (cfg.packages) {
                            each(cfg.packages, function(pkgObj) {
                                var location;

                                pkgObj = typeof pkgObj === "string" ? { name: pkgObj } : pkgObj;
                                location = pkgObj.location;

                                //Create a brand new object on pkgs, since currentPackages can
                                //be passed in again, and config.pkgs is the internal transformed
                                //state for all package configs.
                                pkgs[pkgObj.name] = {
                                    name: pkgObj.name,
                                    location: location || pkgObj.name,
                                    //Remove leading dot in main, so main paths are normalized,
                                    //and remove any trailing .js, since different package
                                    //envs have different conventions: some use a module name,
                                    //some use a file name.
                                    main: (pkgObj.main || "main").replace(currDirRegExp, "").replace(jsSuffixRegExp, "")
                                };
                            });

                            //Done with modifications, assing packages back to context config
                            config.pkgs = pkgs;
                        }

                        //If there are any "waiting to execute" modules in the registry,
                        //update the maps for them, since their info, like URLs to load,
                        //may have changed.
                        eachProp(registry, function(mod, id) {
                            //If module already has init called, since it is too
                            //late to modify them, and ignore unnormalized ones
                            //since they are transient.
                            if (!mod.inited && !mod.map.unnormalized) {
                                mod.map = makeModuleMap(id);
                            }
                        });

                        //If a deps array or a config callback is specified, then call
                        //require with those args. This is useful when require is defined as a
                        //config object before require.js is loaded.
                        if (cfg.deps || cfg.callback) {
                            context.require(cfg.deps || [], cfg.callback);
                        }
                    },

                    makeShimExports: function(value) {
                        function fn() {
                            var ret;
                            if (value.init) {
                                ret = value.init.apply(global, arguments);
                            }
                            return ret || (value.exports && getGlobal(value.exports));
                        }
                        return fn;
                    },

                    makeRequire: function(relMap, options) {
                        options = options || {};

                        function localRequire(deps, callback, errback) {
                            var id, map, requireMod;

                            if (options.enableBuildCallback && callback && isFunction(callback)) {
                                callback.__requireJsBuild = true;
                            }

                            if (typeof deps === "string") {
                                if (isFunction(callback)) {
                                    //Invalid call
                                    return onError(makeError("requireargs", "Invalid require call"), errback);
                                }

                                //If require|exports|module are requested, get the
                                //value for them from the special handlers. Caveat:
                                //this only works while module is being defined.
                                if (relMap && hasProp(handlers, deps)) {
                                    return handlers[deps](registry[relMap.id]);
                                }

                                //Synchronous access to one module. If require.get is
                                //available (as in the Node adapter), prefer that.
                                if (req.get) {
                                    return req.get(context, deps, relMap, localRequire);
                                }

                                //Normalize module name, if it contains . or ..
                                map = makeModuleMap(deps, relMap, false, true);
                                id = map.id;

                                if (!hasProp(defined, id)) {
                                    return onError(
                                        makeError("notloaded", 'Module name "' + id + '" has not been loaded yet for context: ' + contextName + (relMap ? "" : ". Use require([])"))
                                    );
                                }
                                return defined[id];
                            }

                            //Grab defines waiting in the global queue.
                            intakeDefines();

                            //Mark all the dependencies as needing to be loaded.
                            context.nextTick(function() {
                                //Some defines could have been added since the
                                //require call, collect them.
                                intakeDefines();

                                requireMod = getModule(makeModuleMap(null, relMap));

                                //Store if map config should be applied to this require
                                //call for dependencies.
                                requireMod.skipMap = options.skipMap;

                                requireMod.init(deps, callback, errback, {
                                    enabled: true
                                });

                                checkLoaded();
                            });

                            return localRequire;
                        }

                        mixin(localRequire, {
                            isBrowser: isBrowser,

                            /**
                             * Converts a module name + .extension into an URL path.
                             * *Requires* the use of a module name. It does not support using
                             * plain URLs like nameToUrl.
                             */
                            toUrl: function(moduleNamePlusExt) {
                                var ext,
                                    index = moduleNamePlusExt.lastIndexOf("."),
                                    segment = moduleNamePlusExt.split("/")[0],
                                    isRelative = segment === "." || segment === "..";

                                //Have a file extension alias, and it is not the
                                //dots from a relative path.
                                if (index !== -1 && (!isRelative || index > 1)) {
                                    ext = moduleNamePlusExt.substring(index, moduleNamePlusExt.length);
                                    moduleNamePlusExt = moduleNamePlusExt.substring(0, index);
                                }

                                return context.nameToUrl(normalize(moduleNamePlusExt, relMap && relMap.id, true), ext, true);
                            },

                            defined: function(id) {
                                return hasProp(defined, makeModuleMap(id, relMap, false, true).id);
                            },

                            specified: function(id) {
                                id = makeModuleMap(id, relMap, false, true).id;
                                return hasProp(defined, id) || hasProp(registry, id);
                            }
                        });

                        //Only allow undef on top level require calls
                        if (!relMap) {
                            localRequire.undef = function(id) {
                                //Bind any waiting define() calls to this context,
                                //fix for #408
                                takeGlobalQueue();

                                var map = makeModuleMap(id, relMap, true),
                                    mod = getOwn(registry, id);

                                removeScript(id);

                                delete defined[id];
                                delete urlFetched[map.url];
                                delete undefEvents[id];

                                if (mod) {
                                    //Hold on to listeners in case the
                                    //module will be attempted to be reloaded
                                    //using a different config.
                                    if (mod.events.defined) {
                                        undefEvents[id] = mod.events;
                                    }

                                    cleanRegistry(id);
                                }
                            };
                        }

                        return localRequire;
                    },

                    /**
                     * Called to enable a module if it is still in the registry
                     * awaiting enablement. A second arg, parent, the parent module,
                     * is passed in for context, when this method is overriden by
                     * the optimizer. Not shown here to keep code compact.
                     */
                    enable: function(depMap) {
                        var mod = getOwn(registry, depMap.id);
                        if (mod) {
                            getModule(depMap).enable();
                        }
                    },

                    /**
                     * Internal method used by environment adapters to complete a load event.
                     * A load event could be a script load or just a load pass from a synchronous
                     * load call.
                     * @param {String} moduleName the name of the module to potentially complete.
                     */
                    completeLoad: function(moduleName) {
                        var found,
                            args,
                            mod,
                            shim = getOwn(config.shim, moduleName) || {},
                            shExports = shim.exports;

                        takeGlobalQueue();

                        while (defQueue.length) {
                            args = defQueue.shift();
                            if (args[0] === null) {
                                args[0] = moduleName;
                                //If already found an anonymous module and bound it
                                //to this name, then this is some other anon module
                                //waiting for its completeLoad to fire.
                                if (found) {
                                    break;
                                }
                                found = true;
                            } else if (args[0] === moduleName) {
                                //Found matching define call for this script!
                                found = true;
                            }

                            callGetModule(args);
                        }

                        //Do this after the cycle of callGetModule in case the result
                        //of those calls/init calls changes the registry.
                        mod = getOwn(registry, moduleName);

                        if (!found && !hasProp(defined, moduleName) && mod && !mod.inited) {
                            if (config.enforceDefine && (!shExports || !getGlobal(shExports))) {
                                if (hasPathFallback(moduleName)) {
                                    return;
                                } else {
                                    return onError(makeError("nodefine", "No define call for " + moduleName, null, [moduleName]));
                                }
                            } else {
                                //A script that does not call define(), so just simulate
                                //the call for it.
                                callGetModule([moduleName, shim.deps || [], shim.exportsFn]);
                            }
                        }

                        checkLoaded();
                    },

                    /**
                     * Converts a module name to a file path. Supports cases where
                     * moduleName may actually be just an URL.
                     * Note that it **does not** call normalize on the moduleName,
                     * it is assumed to have already been normalized. This is an
                     * internal API, not a public one. Use toUrl for the public API.
                     */
                    nameToUrl: function(moduleName, ext, skipExt) {
                        var paths, pkgs, pkg, pkgPath, syms, i, parentModule, url, parentPath;

                        //If a colon is in the URL, it indicates a protocol is used and it is just
                        //an URL to a file, or if it starts with a slash, contains a query arg (i.e. ?)
                        //or ends with .js, then assume the user meant to use an url and not a module id.
                        //The slash is important for protocol-less URLs as well as full paths.
                        if (req.jsExtRegExp.test(moduleName)) {
                            //Just a plain path, not module name lookup, so just return it.
                            //Add extension if it is included. This is a bit wonky, only non-.js things pass
                            //an extension, this method probably needs to be reworked.
                            url = moduleName + (ext || "");
                        } else {
                            //A module that needs to be converted to a path.
                            paths = config.paths;
                            pkgs = config.pkgs;

                            syms = moduleName.split("/");
                            //For each module name segment, see if there is a path
                            //registered for it. Start with most specific name
                            //and work up from it.
                            for (i = syms.length; i > 0; i -= 1) {
                                parentModule = syms.slice(0, i).join("/");
                                pkg = getOwn(pkgs, parentModule);
                                parentPath = getOwn(paths, parentModule);
                                if (parentPath) {
                                    //If an array, it means there are a few choices,
                                    //Choose the one that is desired
                                    if (isArray(parentPath)) {
                                        parentPath = parentPath[0];
                                    }
                                    syms.splice(0, i, parentPath);
                                    break;
                                } else if (pkg) {
                                    //If module name is just the package name, then looking
                                    //for the main module.
                                    if (moduleName === pkg.name) {
                                        pkgPath = pkg.location + "/" + pkg.main;
                                    } else {
                                        pkgPath = pkg.location;
                                    }
                                    syms.splice(0, i, pkgPath);
                                    break;
                                }
                            }

                            //Join the path parts together, then figure out if baseUrl is needed.
                            url = syms.join("/");
                            url += ext || (/^data\:|\?/.test(url) || skipExt ? "" : ".js");
                            url = (url.charAt(0) === "/" || url.match(/^[\w\+\.\-]+:/) ? "" : config.baseUrl) + url;
                        }

                        return config.urlArgs ? url + ((url.indexOf("?") === -1 ? "?" : "&") + config.urlArgs) : url;
                    },

                    //Delegates to req.load. Broken out as a separate function to
                    //allow overriding in the optimizer.
                    load: function(id, url) {
                        req.load(context, id, url);
                    },

                    /**
                     * Executes a module callback function. Broken out as a separate function
                     * solely to allow the build system to sequence the files in the built
                     * layer in the right sequence.
                     *
                     * @private
                     */
                    execCb: function(name, callback, args, exports) {
                        return callback.apply(exports, args);
                    },

                    /**
                     * callback for script loads, used to check status of loading.
                     *
                     * @param {Event} evt the event from the browser for the script
                     * that was loaded.
                     */
                    onScriptLoad: function(evt) {
                        //Using currentTarget instead of target for Firefox 2.0's sake. Not
                        //all old browsers will be supported, but this one was easy enough
                        //to support and still makes sense.
                        if (evt.type === "load" || readyRegExp.test((evt.currentTarget || evt.srcElement).readyState)) {
                            //Reset interactive script so a script node is not held onto for
                            //to long.
                            interactiveScript = null;

                            //Pull out the name of the module and the context.
                            var data = getScriptData(evt);
                            context.completeLoad(data.id);
                        }
                    },

                    /**
                     * Callback for script errors.
                     */
                    onScriptError: function(evt) {
                        var data = getScriptData(evt);
                        if (!hasPathFallback(data.id)) {
                            return onError(makeError("scripterror", "Script error for: " + data.id, evt, [data.id]));
                        }
                    }
                };

                context.require = context.makeRequire();
                return context;
            }

            /**
             * Main entry point.
             *
             * If the only argument to require is a string, then the module that
             * is represented by that string is fetched for the appropriate context.
             *
             * If the first argument is an array, then it will be treated as an array
             * of dependency string names to fetch. An optional function callback can
             * be specified to execute when all of those dependencies are available.
             *
             * Make a local req variable to help Caja compliance (it assumes things
             * on a require that are not standardized), and to give a short
             * name for minification/local scope use.
             */
            req = requirejs = function(deps, callback, errback, optional) {
                //Find the right context, use default
                var context,
                    config,
                    contextName = defContextName;

                // Determine if have config object in the call.
                if (!isArray(deps) && typeof deps !== "string") {
                    // deps is a config object
                    config = deps;
                    if (isArray(callback)) {
                        // Adjust args if there are dependencies
                        deps = callback;
                        callback = errback;
                        errback = optional;
                    } else {
                        deps = [];
                    }
                }

                if (config && config.context) {
                    contextName = config.context;
                }

                context = getOwn(contexts, contextName);
                if (!context) {
                    context = contexts[contextName] = req.s.newContext(contextName);
                }

                if (config) {
                    context.configure(config);
                }

                return context.require(deps, callback, errback);
            };

            /**
             * Support wwplayer.require.config() to make it easier to cooperate with other
             * AMD loaders on globally agreed names.
             */
            req.config = function(config) {
                currentConfig = config;
                return req(config);
            };

            /**
             * Execute something after the current tick
             * of the event loop. Override for other envs
             * that have a better solution than setTimeout.
             * @param  {Function} fn function to execute later.
             */
            req.nextTick =
                typeof setTimeout !== "undefined"
                    ? function(fn) {
                          setTimeout(fn, 4);
                      }
                    : function(fn) {
                          fn();
                      };

            /**
             * Export require as a global, but only if it does not already exist.
             */
            if (!require) {
                require = req;
            }

            req.version = version;

            //Used to filter out dependencies that are already paths.
            req.jsExtRegExp = /^\/|:|\?|\.js$/;
            req.isBrowser = isBrowser;
            s = req.s = {
                contexts: contexts,
                newContext: newContext
            };

            //Create default context.
            req({});

            //Exports some context-sensitive methods on global require.
            each(["toUrl", "undef", "defined", "specified"], function(prop) {
                //Reference from contexts instead of early binding to default context,
                //so that during builds, the latest instance of the default context
                //with its config gets used.
                req[prop] = function() {
                    var ctx = contexts[defContextName];
                    return ctx.require[prop].apply(ctx, arguments);
                };
            });

            if (isBrowser) {
                head = s.head = document.getElementsByTagName("head")[0];
                //If BASE tag is in play, using appendChild is a problem for IE6.
                //When that browser dies, this can be removed. Details in this jQuery bug:
                //http://dev.jquery.com/ticket/2709
                baseElement = document.getElementsByTagName("base")[0];
                if (baseElement) {
                    head = s.head = baseElement.parentNode;
                }
            }

            /**
             * Any errors that require explicitly generates will be passed to this
             * function. Intercept/override it if you want custom error handling.
             * @param {Error} err the error object.
             */
            req.onError = defaultOnError;

            /**
             * Creates the node for the load command. Only used in browser envs.
             */
            req.createNode = function(config, moduleName, url) {
                var node = config.xhtml ? document.createElementNS("http://www.w3.org/1999/xhtml", "html:script") : document.createElement("script");
                node.type = config.scriptType || "text/javascript";
                node.charset = "utf-8";
                node.async = true;
                return node;
            };

            /**
             * Does the request to load a module for the browser case.
             * Make this a separate function to allow other environments
             * to override it.
             *
             * @param {Object} context the require context to find state.
             * @param {String} moduleName the name of the module.
             * @param {Object} url the URL to the module.
             */
            req.load = function(context, moduleName, url) {
                var config = (context && context.config) || {},
                    node;
                if (isBrowser) {
                    //In the browser so use a script tag
                    node = req.createNode(config, moduleName, url);

                    node.setAttribute("data-requirecontext", context.contextName);
                    node.setAttribute("data-requiremodule", moduleName);

                    //Set up load listener. Test attachEvent first because IE9 has
                    //a subtle issue in its addEventListener and script onload firings
                    //that do not match the behavior of all other browsers with
                    //addEventListener support, which fire the onload event for a
                    //script right after the script execution. See:
                    //https://connect.microsoft.com/IE/feedback/details/648057/script-onload-event-is-not-fired-immediately-after-script-execution
                    //UNFORTUNATELY Opera implements attachEvent but does not follow the script
                    //script execution mode.
                    if (
                        node.attachEvent &&
                        //Check if node.attachEvent is artificially added by custom script or
                        //natively supported by browser
                        //read https://github.com/jrburke/requirejs/issues/187
                        //if we can NOT find [native code] then it must NOT natively supported.
                        //in IE8, node.attachEvent does not have toString()
                        //Note the test for "[native code" with no closing brace, see:
                        //https://github.com/jrburke/requirejs/issues/273
                        !(node.attachEvent.toString && node.attachEvent.toString().indexOf("[native code") < 0) &&
                        !isOpera
                    ) {
                        //Probably IE. IE (at least 6-8) do not fire
                        //script onload right after executing the script, so
                        //we cannot tie the anonymous define call to a name.
                        //However, IE reports the script as being in 'interactive'
                        //readyState at the time of the define call.
                        useInteractive = true;

                        node.attachEvent("onreadystatechange", context.onScriptLoad);
                        //It would be great to add an error handler here to catch
                        //404s in IE9+. However, onreadystatechange will fire before
                        //the error handler, so that does not help. If addEventListener
                        //is used, then IE will fire error before load, but we cannot
                        //use that pathway given the connect.microsoft.com issue
                        //mentioned above about not doing the 'script execute,
                        //then fire the script load event listener before execute
                        //next script' that other browsers do.
                        //Best hope: IE10 fixes the issues,
                        //and then destroys all installs of IE 6-9.
                        //node.attachEvent('onerror', context.onScriptError);
                    } else {
                        node.addEventListener("load", context.onScriptLoad, false);
                        node.addEventListener("error", context.onScriptError, false);
                    }
                    node.src = url;

                    //For some cache cases in IE 6-8, the script executes before the end
                    //of the appendChild execution, so to tie an anonymous define
                    //call to the module name (which is stored on the node), hold on
                    //to a reference to this node, but clear after the DOM insertion.
                    currentlyAddingScript = node;
                    if (baseElement) {
                        head.insertBefore(node, baseElement);
                    } else {
                        head.appendChild(node);
                    }
                    currentlyAddingScript = null;

                    return node;
                } else if (isWebWorker) {
                    try {
                        //In a web worker, use importScripts. This is not a very
                        //efficient use of importScripts, importScripts will block until
                        //its script is downloaded and evaluated. However, if web workers
                        //are in play, the expectation that a build has been done so that
                        //only one script needs to be loaded anyway. This may need to be
                        //reevaluated if other use cases become common.
                        importScripts(url);

                        //Account for anonymous modules
                        context.completeLoad(moduleName);
                    } catch (e) {
                        context.onError(makeError("importscripts", "importScripts failed for " + moduleName + " at " + url, e, [moduleName]));
                    }
                }
            };

            function getInteractiveScript() {
                if (interactiveScript && interactiveScript.readyState === "interactive") {
                    return interactiveScript;
                }

                eachReverse(scripts(), function(script) {
                    if (script.readyState === "interactive") {
                        return (interactiveScript = script);
                    }
                });
                return interactiveScript;
            }

            //Look for a data-main script attribute, which could also adjust the baseUrl.
            if (isBrowser && !cfg.skipDataMain) {
                //Figure out baseUrl. Get it from the script tag with require.js in it.
                eachReverse(scripts(), function(script) {
                    //Set the 'head' where we can append children by
                    //using the script's parent.
                    if (!head) {
                        head = script.parentNode;
                    }

                    //Look for a data-main attribute to set main script for the page
                    //to load. If it is there, the path to data main becomes the
                    //baseUrl, if it is not already set.
                    dataMain = script.getAttribute("data-main");
                    if (dataMain) {
                        //Preserve dataMain in case it is a path (i.e. contains '?')
                        mainScript = dataMain;

                        //Set final baseUrl if there is not already an explicit one.
                        if (!cfg.baseUrl) {
                            //Pull off the directory of data-main for use as the
                            //baseUrl.
                            src = mainScript.split("/");
                            mainScript = src.pop();
                            subPath = src.length ? src.join("/") + "/" : "./";

                            cfg.baseUrl = subPath;
                        }

                        //Strip off any trailing .js since mainScript is now
                        //like a module name.
                        mainScript = mainScript.replace(jsSuffixRegExp, "");

                        //If mainScript is still a path, fall back to dataMain
                        if (req.jsExtRegExp.test(mainScript)) {
                            mainScript = dataMain;
                        }

                        //Put the data-main script in the files to load.
                        cfg.deps = cfg.deps ? cfg.deps.concat(mainScript) : [mainScript];

                        return true;
                    }
                });
            }

            /**
             * The function that handles definitions of modules. Differs from
             * require() in that a string for the module should be the first argument,
             * and the function to execute after dependencies are loaded should
             * return a value to define the module corresponding to the first argument's
             * name.
             */
            define = function(name, deps, callback) {
                var node, context;

                //Allow for anonymous modules
                if (typeof name !== "string") {
                    //Adjust args appropriately
                    callback = deps;
                    deps = name;
                    name = null;
                }

                //This module may not have dependencies
                if (!isArray(deps)) {
                    callback = deps;
                    deps = null;
                }

                //If no name, and callback is a function, then figure out if it a
                //CommonJS thing with dependencies.
                if (!deps && isFunction(callback)) {
                    deps = [];
                    //Remove comments from the callback string,
                    //look for require calls, and pull them into the dependencies,
                    //but only if there are function args.
                    if (callback.length) {
                        callback
                            .toString()
                            .replace(commentRegExp, "")
                            .replace(cjsRequireRegExp, function(match, dep) {
                                deps.push(dep);
                            });

                        //May be a CommonJS thing even without require calls, but still
                        //could use exports, and module. Avoid doing exports and module
                        //work though if it just needs require.
                        //REQUIRES the function to expect the CommonJS variables in the
                        //order listed below.
                        deps = (callback.length === 1 ? ["require"] : ["require", "exports", "module"]).concat(deps);
                    }
                }

                //If in IE 6-8 and hit an anonymous define() call, do the interactive
                //work.
                if (useInteractive) {
                    node = currentlyAddingScript || getInteractiveScript();
                    if (node) {
                        if (!name) {
                            name = node.getAttribute("data-requiremodule");
                        }
                        context = contexts[node.getAttribute("data-requirecontext")];
                    }
                }

                //Always save off evaluating the def call until the script onload handler.
                //This allows multiple modules to be in a file without prematurely
                //tracing dependencies, and allows for anonymous module support,
                //where the module name is not known until the script onload event
                //occurs. If no context, use the global queue, and get it processed
                //in the onscript load callback.
                (context ? context.defQueue : globalDefQueue).push([name, deps, callback]);
            };

            define.amd = {
                jQuery: true
            };

            /**
             * Executes the text. Normally just uses eval, but can be modified
             * to use a better, environment-specific call. Only used for transpiling
             * loader plugins, not for plain JS modules.
             * @param {String} text the text to execute/evaluate.
             */
            req.exec = function(text) {
                /*jslint evil: true */
                return eval(text);
            };

            /**
             * Get the current config settings so that we can test them
             */
            req.getConfig = function() {
                return currentConfig;
            };

            //Set up with config info.
            req(cfg);
        })(this);

        wwplayer.requirejs = requirejs;
        wwplayer.require = require;
        wwplayer.define = define;
    }
})();
wwplayer.define("vendor/require", function() {});

/*
Copyright (c) 2010,2011,2012,2013 Morgan Roderick http://roderick.dk
License: MIT - http://mrgnrdrck.mit-license.org

https://github.com/mroderick/PubSubJS
*/
/*jslint white:true, plusplus:true, stupid:true*/
/*global
	setTimeout,
	module,
	exports,
	define,
	require,
	window
*/
(function(root, factory) {
    "use strict";

    // CommonJS
    if (typeof exports === "object" && module) {
        module.exports = factory();

        // AMD
    } else if (typeof wwplayer.define === "function" && wwplayer.define.amd) {
        wwplayer.define("pubsub", factory);
        // Browser
    } else {
        root.PubSub = factory();
    }
})((typeof window === "object" && window) || this, function() {
    "use strict";

    var PubSub = {},
        messages = {},
        lastUid = -1;

    /**
     *	Returns a function that throws the passed exception, for use as argument for setTimeout
     *	@param { Object } ex An Error object
     */
    function throwException(ex) {
        return function reThrowException() {
            throw ex;
        };
    }

    function callSubscriberWithDelayedExceptions(subscriber, message, data) {
        try {
            subscriber(message, data);
        } catch (ex) {
            setTimeout(throwException(ex), 0);
        }
    }

    function callSubscriberWithImmediateExceptions(subscriber, message, data) {
        subscriber(message, data);
    }

    function deliverMessage(originalMessage, matchedMessage, data, immediateExceptions) {
        var subscribers = messages[matchedMessage],
            callSubscriber = immediateExceptions ? callSubscriberWithImmediateExceptions : callSubscriberWithDelayedExceptions,
            i,
            j;

        if (!messages.hasOwnProperty(matchedMessage)) {
            return;
        }

        // do not cache the length of the subscribers array, as it might change if there are unsubscribtions
        // by subscribers during delivery of a topic
        // see https://github.com/mroderick/PubSubJS/issues/26
        for (i = 0; i < subscribers.length; i++) {
            callSubscriber(subscribers[i].func, originalMessage, data);
        }
    }

    function createDeliveryFunction(message, data, immediateExceptions) {
        return function deliverNamespaced() {
            var topic = String(message),
                position = topic.lastIndexOf(".");

            // deliver the message as it is now
            deliverMessage(message, message, data, immediateExceptions);

            // trim the hierarchy and deliver message to each level
            while (position !== -1) {
                topic = topic.substr(0, position);
                position = topic.lastIndexOf(".");
                deliverMessage(message, topic, data);
            }
        };
    }

    function messageHasSubscribers(message) {
        var topic = String(message),
            found = messages.hasOwnProperty(topic),
            position = topic.lastIndexOf(".");

        while (!found && position !== -1) {
            topic = topic.substr(0, position);
            position = topic.lastIndexOf(".");
            found = messages.hasOwnProperty(topic);
        }

        return found && messages[topic].length > 0;
    }

    function publish(message, data, sync, immediateExceptions) {
        var deliver = createDeliveryFunction(message, data, immediateExceptions),
            hasSubscribers = messageHasSubscribers(message);

        if (!hasSubscribers) {
            return false;
        }

        if (sync === true) {
            deliver();
        } else {
            setTimeout(deliver, 0);
        }
        return true;
    }

    /**
     *	PubSub.publish( message[, data] ) -> Boolean
     *	- message (String): The message to publish
     *	- data: The data to pass to subscribers
     *	Publishes the the message, passing the data to it's subscribers
     **/
    PubSub.publish = function(message, data) {
        return publish(message, data, false, PubSub.immediateExceptions);
    };

    /**
     *	PubSub.publishSync( message[, data] ) -> Boolean
     *	- message (String): The message to publish
     *	- data: The data to pass to subscribers
     *	Publishes the the message synchronously, passing the data to it's subscribers
     **/
    PubSub.publishSync = function(message, data) {
        return publish(message, data, true, PubSub.immediateExceptions);
    };

    /**
     *	PubSub.subscribe( message, func ) -> String
     *	- message (String): The message to subscribe to
     *	- func (Function): The function to call when a new message is published
     *	Subscribes the passed function to the passed message. Every returned token is unique and should be stored if
     *	you need to unsubscribe
     **/
    PubSub.subscribe = function(message, func) {
        if (typeof func !== "function") {
            return false;
        }

        // message is not registered yet
        if (!messages.hasOwnProperty(message)) {
            messages[message] = [];
        }

        // forcing token as String, to allow for future expansions without breaking usage
        // and allow for easy use as key names for the 'messages' object
        var token = String(++lastUid);
        messages[message].push({ token: token, func: func });

        // return token for unsubscribing
        return token;
    };

    /**
     *	PubSub.unsubscribe( tokenOrFunction ) -> String | Boolean
     *  - tokenOrFunction (String|Function): The token of the function to unsubscribe or func passed in on subscribe
     *  Unsubscribes a specific subscriber from a specific message using the unique token
     *  or if using Function as argument, it will remove all subscriptions with that function
     **/
    PubSub.unsubscribe = function(tokenOrFunction) {
        var isToken = typeof tokenOrFunction === "string",
            key = isToken ? "token" : "func",
            succesfulReturnValue = isToken ? tokenOrFunction : true,
            result = false,
            m,
            i;

        for (m in messages) {
            if (messages.hasOwnProperty(m)) {
                for (i = messages[m].length - 1; i >= 0; i--) {
                    if (messages[m][i][key] === tokenOrFunction) {
                        setTimeout(function() {
                            messages[m].splice(i, 1);
                        }, 0);
                        result = succesfulReturnValue;

                        // tokens are unique, so we can just return here
                        if (isToken) {
                            return result;
                        }
                    }
                }
            }
        }

        return result;
    };

    PubSub.unsubscribeAll = function() {
        messages = {};
        lastUid = -1;
    };

    return PubSub;
});

if( !jQuery || jQuery.fn.jquery !== "1.12.4") {

/*! jQuery v1.12.4 | (c) jQuery Foundation | jquery.org/license */
!(function(a, b) {
    "object" == typeof module && "object" == typeof module.exports
        ? (module.exports = a.document
              ? b(a, !0)
              : function(a) {
                    if (!a.document) throw new Error("jQuery requires a window with a document");
                    return b(a);
                })
        : b(a);
})("undefined" != typeof window ? window : this, function(a, b) {
    var c = [],
        d = a.document,
        e = c.slice,
        f = c.concat,
        g = c.push,
        h = c.indexOf,
        i = {},
        j = i.toString,
        k = i.hasOwnProperty,
        l = {},
        m = "1.12.4",
        n = function(a, b) {
            return new n.fn.init(a, b);
        },
        o = /^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,
        p = /^-ms-/,
        q = /-([\da-z])/gi,
        r = function(a, b) {
            return b.toUpperCase();
        };
    (n.fn = n.prototype = {
        jquery: m,
        constructor: n,
        selector: "",
        length: 0,
        toArray: function() {
            return e.call(this);
        },
        get: function(a) {
            return null != a ? (0 > a ? this[a + this.length] : this[a]) : e.call(this);
        },
        pushStack: function(a) {
            var b = n.merge(this.constructor(), a);
            return (b.prevObject = this), (b.context = this.context), b;
        },
        each: function(a) {
            return n.each(this, a);
        },
        map: function(a) {
            return this.pushStack(
                n.map(this, function(b, c) {
                    return a.call(b, c, b);
                })
            );
        },
        slice: function() {
            return this.pushStack(e.apply(this, arguments));
        },
        first: function() {
            return this.eq(0);
        },
        last: function() {
            return this.eq(-1);
        },
        eq: function(a) {
            var b = this.length,
                c = +a + (0 > a ? b : 0);
            return this.pushStack(c >= 0 && b > c ? [this[c]] : []);
        },
        end: function() {
            return this.prevObject || this.constructor();
        },
        push: g,
        sort: c.sort,
        splice: c.splice
    }),
        (n.extend = n.fn.extend = function() {
            var a,
                b,
                c,
                d,
                e,
                f,
                g = arguments[0] || {},
                h = 1,
                i = arguments.length,
                j = !1;
            for ("boolean" == typeof g && ((j = g), (g = arguments[h] || {}), h++), "object" == typeof g || n.isFunction(g) || (g = {}), h === i && ((g = this), h--); i > h; h++)
                if (null != (e = arguments[h]))
                    for (d in e)
                        (a = g[d]),
                            (c = e[d]),
                            g !== c &&
                                (j && c && (n.isPlainObject(c) || (b = n.isArray(c)))
                                    ? (b ? ((b = !1), (f = a && n.isArray(a) ? a : [])) : (f = a && n.isPlainObject(a) ? a : {}), (g[d] = n.extend(j, f, c)))
                                    : void 0 !== c && (g[d] = c));
            return g;
        }),
        n.extend({
            expando: "jQuery" + (m + Math.random()).replace(/\D/g, ""),
            isReady: !0,
            error: function(a) {
                throw new Error(a);
            },
            noop: function() {},
            isFunction: function(a) {
                return "function" === n.type(a);
            },
            isArray:
                Array.isArray ||
                function(a) {
                    return "array" === n.type(a);
                },
            isWindow: function(a) {
                return null != a && a == a.window;
            },
            isNumeric: function(a) {
                var b = a && a.toString();
                return !n.isArray(a) && b - parseFloat(b) + 1 >= 0;
            },
            isEmptyObject: function(a) {
                var b;
                for (b in a) return !1;
                return !0;
            },
            isPlainObject: function(a) {
                var b;
                if (!a || "object" !== n.type(a) || a.nodeType || n.isWindow(a)) return !1;
                try {
                    if (a.constructor && !k.call(a, "constructor") && !k.call(a.constructor.prototype, "isPrototypeOf")) return !1;
                } catch (c) {
                    return !1;
                }
                if (!l.ownFirst) for (b in a) return k.call(a, b);
                for (b in a);
                return void 0 === b || k.call(a, b);
            },
            type: function(a) {
                return null == a ? a + "" : "object" == typeof a || "function" == typeof a ? i[j.call(a)] || "object" : typeof a;
            },
            globalEval: function(b) {
                b &&
                    n.trim(b) &&
                    (
                        a.execScript ||
                        function(b) {
                            a.eval.call(a, b);
                        }
                    )(b);
            },
            camelCase: function(a) {
                return a.replace(p, "ms-").replace(q, r);
            },
            nodeName: function(a, b) {
                return a.nodeName && a.nodeName.toLowerCase() === b.toLowerCase();
            },
            each: function(a, b) {
                var c,
                    d = 0;
                if (s(a)) {
                    for (c = a.length; c > d; d++) if (b.call(a[d], d, a[d]) === !1) break;
                } else for (d in a) if (b.call(a[d], d, a[d]) === !1) break;
                return a;
            },
            trim: function(a) {
                return null == a ? "" : (a + "").replace(o, "");
            },
            makeArray: function(a, b) {
                var c = b || [];
                return null != a && (s(Object(a)) ? n.merge(c, "string" == typeof a ? [a] : a) : g.call(c, a)), c;
            },
            inArray: function(a, b, c) {
                var d;
                if (b) {
                    if (h) return h.call(b, a, c);
                    for (d = b.length, c = c ? (0 > c ? Math.max(0, d + c) : c) : 0; d > c; c++) if (c in b && b[c] === a) return c;
                }
                return -1;
            },
            merge: function(a, b) {
                var c = +b.length,
                    d = 0,
                    e = a.length;
                while (c > d) a[e++] = b[d++];
                if (c !== c) while (void 0 !== b[d]) a[e++] = b[d++];
                return (a.length = e), a;
            },
            grep: function(a, b, c) {
                for (var d, e = [], f = 0, g = a.length, h = !c; g > f; f++) (d = !b(a[f], f)), d !== h && e.push(a[f]);
                return e;
            },
            map: function(a, b, c) {
                var d,
                    e,
                    g = 0,
                    h = [];
                if (s(a)) for (d = a.length; d > g; g++) (e = b(a[g], g, c)), null != e && h.push(e);
                else for (g in a) (e = b(a[g], g, c)), null != e && h.push(e);
                return f.apply([], h);
            },
            guid: 1,
            proxy: function(a, b) {
                var c, d, f;
                return (
                    "string" == typeof b && ((f = a[b]), (b = a), (a = f)),
                    n.isFunction(a)
                        ? ((c = e.call(arguments, 2)),
                          (d = function() {
                              return a.apply(b || this, c.concat(e.call(arguments)));
                          }),
                          (d.guid = a.guid = a.guid || n.guid++),
                          d)
                        : void 0
                );
            },
            now: function() {
                return +new Date();
            },
            support: l
        }),
        "function" == typeof Symbol && (n.fn[Symbol.iterator] = c[Symbol.iterator]),
        n.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "), function(a, b) {
            i["[object " + b + "]"] = b.toLowerCase();
        });
    function s(a) {
        var b = !!a && "length" in a && a.length,
            c = n.type(a);
        return "function" === c || n.isWindow(a) ? !1 : "array" === c || 0 === b || ("number" == typeof b && b > 0 && b - 1 in a);
    }
    var t = (function(a) {
        var b,
            c,
            d,
            e,
            f,
            g,
            h,
            i,
            j,
            k,
            l,
            m,
            n,
            o,
            p,
            q,
            r,
            s,
            t,
            u = "sizzle" + 1 * new Date(),
            v = a.document,
            w = 0,
            x = 0,
            y = ga(),
            z = ga(),
            A = ga(),
            B = function(a, b) {
                return a === b && (l = !0), 0;
            },
            C = 1 << 31,
            D = {}.hasOwnProperty,
            E = [],
            F = E.pop,
            G = E.push,
            H = E.push,
            I = E.slice,
            J = function(a, b) {
                for (var c = 0, d = a.length; d > c; c++) if (a[c] === b) return c;
                return -1;
            },
            K = "checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",
            L = "[\\x20\\t\\r\\n\\f]",
            M = "(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",
            N = "\\[" + L + "*(" + M + ")(?:" + L + "*([*^$|!~]?=)" + L + "*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|(" + M + "))|)" + L + "*\\]",
            O = ":(" + M + ")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|" + N + ")*)|.*)\\)|)",
            P = new RegExp(L + "+", "g"),
            Q = new RegExp("^" + L + "+|((?:^|[^\\\\])(?:\\\\.)*)" + L + "+$", "g"),
            R = new RegExp("^" + L + "*," + L + "*"),
            S = new RegExp("^" + L + "*([>+~]|" + L + ")" + L + "*"),
            T = new RegExp("=" + L + "*([^\\]'\"]*?)" + L + "*\\]", "g"),
            U = new RegExp(O),
            V = new RegExp("^" + M + "$"),
            W = {
                ID: new RegExp("^#(" + M + ")"),
                CLASS: new RegExp("^\\.(" + M + ")"),
                TAG: new RegExp("^(" + M + "|[*])"),
                ATTR: new RegExp("^" + N),
                PSEUDO: new RegExp("^" + O),
                CHILD: new RegExp(
                    "^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\(" + L + "*(even|odd|(([+-]|)(\\d*)n|)" + L + "*(?:([+-]|)" + L + "*(\\d+)|))" + L + "*\\)|)",
                    "i"
                ),
                bool: new RegExp("^(?:" + K + ")$", "i"),
                needsContext: new RegExp("^" + L + "*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\(" + L + "*((?:-\\d)?\\d*)" + L + "*\\)|)(?=[^-]|$)", "i")
            },
            X = /^(?:input|select|textarea|button)$/i,
            Y = /^h\d$/i,
            Z = /^[^{]+\{\s*\[native \w/,
            $ = /^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,
            _ = /[+~]/,
            aa = /'|\\/g,
            ba = new RegExp("\\\\([\\da-f]{1,6}" + L + "?|(" + L + ")|.)", "ig"),
            ca = function(a, b, c) {
                var d = "0x" + b - 65536;
                return d !== d || c ? b : 0 > d ? String.fromCharCode(d + 65536) : String.fromCharCode((d >> 10) | 55296, (1023 & d) | 56320);
            },
            da = function() {
                m();
            };
        try {
            H.apply((E = I.call(v.childNodes)), v.childNodes), E[v.childNodes.length].nodeType;
        } catch (ea) {
            H = {
                apply: E.length
                    ? function(a, b) {
                          G.apply(a, I.call(b));
                      }
                    : function(a, b) {
                          var c = a.length,
                              d = 0;
                          while ((a[c++] = b[d++]));
                          a.length = c - 1;
                      }
            };
        }
        function fa(a, b, d, e) {
            var f,
                h,
                j,
                k,
                l,
                o,
                r,
                s,
                w = b && b.ownerDocument,
                x = b ? b.nodeType : 9;
            if (((d = d || []), "string" != typeof a || !a || (1 !== x && 9 !== x && 11 !== x))) return d;
            if (!e && ((b ? b.ownerDocument || b : v) !== n && m(b), (b = b || n), p)) {
                if (11 !== x && (o = $.exec(a)))
                    if ((f = o[1])) {
                        if (9 === x) {
                            if (!(j = b.getElementById(f))) return d;
                            if (j.id === f) return d.push(j), d;
                        } else if (w && (j = w.getElementById(f)) && t(b, j) && j.id === f) return d.push(j), d;
                    } else {
                        if (o[2]) return H.apply(d, b.getElementsByTagName(a)), d;
                        if ((f = o[3]) && c.getElementsByClassName && b.getElementsByClassName) return H.apply(d, b.getElementsByClassName(f)), d;
                    }
                if (c.qsa && !A[a + " "] && (!q || !q.test(a))) {
                    if (1 !== x) (w = b), (s = a);
                    else if ("object" !== b.nodeName.toLowerCase()) {
                        (k = b.getAttribute("id")) ? (k = k.replace(aa, "\\$&")) : b.setAttribute("id", (k = u)),
                            (r = g(a)),
                            (h = r.length),
                            (l = V.test(k) ? "#" + k : "[id='" + k + "']");
                        while (h--) r[h] = l + " " + qa(r[h]);
                        (s = r.join(",")), (w = (_.test(a) && oa(b.parentNode)) || b);
                    }
                    if (s)
                        try {
                            return H.apply(d, w.querySelectorAll(s)), d;
                        } catch (y) {
                        } finally {
                            k === u && b.removeAttribute("id");
                        }
                }
            }
            return i(a.replace(Q, "$1"), b, d, e);
        }
        function ga() {
            var a = [];
            function b(c, e) {
                return a.push(c + " ") > d.cacheLength && delete b[a.shift()], (b[c + " "] = e);
            }
            return b;
        }
        function ha(a) {
            return (a[u] = !0), a;
        }
        function ia(a) {
            var b = n.createElement("div");
            try {
                return !!a(b);
            } catch (c) {
                return !1;
            } finally {
                b.parentNode && b.parentNode.removeChild(b), (b = null);
            }
        }
        function ja(a, b) {
            var c = a.split("|"),
                e = c.length;
            while (e--) d.attrHandle[c[e]] = b;
        }
        function ka(a, b) {
            var c = b && a,
                d = c && 1 === a.nodeType && 1 === b.nodeType && (~b.sourceIndex || C) - (~a.sourceIndex || C);
            if (d) return d;
            if (c) while ((c = c.nextSibling)) if (c === b) return -1;
            return a ? 1 : -1;
        }
        function la(a) {
            return function(b) {
                var c = b.nodeName.toLowerCase();
                return "input" === c && b.type === a;
            };
        }
        function ma(a) {
            return function(b) {
                var c = b.nodeName.toLowerCase();
                return ("input" === c || "button" === c) && b.type === a;
            };
        }
        function na(a) {
            return ha(function(b) {
                return (
                    (b = +b),
                    ha(function(c, d) {
                        var e,
                            f = a([], c.length, b),
                            g = f.length;
                        while (g--) c[(e = f[g])] && (c[e] = !(d[e] = c[e]));
                    })
                );
            });
        }
        function oa(a) {
            return a && "undefined" != typeof a.getElementsByTagName && a;
        }
        (c = fa.support = {}),
            (f = fa.isXML = function(a) {
                var b = a && (a.ownerDocument || a).documentElement;
                return b ? "HTML" !== b.nodeName : !1;
            }),
            (m = fa.setDocument = function(a) {
                var b,
                    e,
                    g = a ? a.ownerDocument || a : v;
                return g !== n && 9 === g.nodeType && g.documentElement
                    ? ((n = g),
                      (o = n.documentElement),
                      (p = !f(n)),
                      (e = n.defaultView) && e.top !== e && (e.addEventListener ? e.addEventListener("unload", da, !1) : e.attachEvent && e.attachEvent("onunload", da)),
                      (c.attributes = ia(function(a) {
                          return (a.className = "i"), !a.getAttribute("className");
                      })),
                      (c.getElementsByTagName = ia(function(a) {
                          return a.appendChild(n.createComment("")), !a.getElementsByTagName("*").length;
                      })),
                      (c.getElementsByClassName = Z.test(n.getElementsByClassName)),
                      (c.getById = ia(function(a) {
                          return (o.appendChild(a).id = u), !n.getElementsByName || !n.getElementsByName(u).length;
                      })),
                      c.getById
                          ? ((d.find.ID = function(a, b) {
                                if ("undefined" != typeof b.getElementById && p) {
                                    var c = b.getElementById(a);
                                    return c ? [c] : [];
                                }
                            }),
                            (d.filter.ID = function(a) {
                                var b = a.replace(ba, ca);
                                return function(a) {
                                    return a.getAttribute("id") === b;
                                };
                            }))
                          : (delete d.find.ID,
                            (d.filter.ID = function(a) {
                                var b = a.replace(ba, ca);
                                return function(a) {
                                    var c = "undefined" != typeof a.getAttributeNode && a.getAttributeNode("id");
                                    return c && c.value === b;
                                };
                            })),
                      (d.find.TAG = c.getElementsByTagName
                          ? function(a, b) {
                                return "undefined" != typeof b.getElementsByTagName ? b.getElementsByTagName(a) : c.qsa ? b.querySelectorAll(a) : void 0;
                            }
                          : function(a, b) {
                                var c,
                                    d = [],
                                    e = 0,
                                    f = b.getElementsByTagName(a);
                                if ("*" === a) {
                                    while ((c = f[e++])) 1 === c.nodeType && d.push(c);
                                    return d;
                                }
                                return f;
                            }),
                      (d.find.CLASS =
                          c.getElementsByClassName &&
                          function(a, b) {
                              return "undefined" != typeof b.getElementsByClassName && p ? b.getElementsByClassName(a) : void 0;
                          }),
                      (r = []),
                      (q = []),
                      (c.qsa = Z.test(n.querySelectorAll)) &&
                          (ia(function(a) {
                              (o.appendChild(a).innerHTML = "<a id='" + u + "'></a><select id='" + u + "-\r\\' msallowcapture=''><option selected=''></option></select>"),
                                  a.querySelectorAll("[msallowcapture^='']").length && q.push("[*^$]=" + L + "*(?:''|\"\")"),
                                  a.querySelectorAll("[selected]").length || q.push("\\[" + L + "*(?:value|" + K + ")"),
                                  a.querySelectorAll("[id~=" + u + "-]").length || q.push("~="),
                                  a.querySelectorAll(":checked").length || q.push(":checked"),
                                  a.querySelectorAll("a#" + u + "+*").length || q.push(".#.+[+~]");
                          }),
                          ia(function(a) {
                              var b = n.createElement("input");
                              b.setAttribute("type", "hidden"),
                                  a.appendChild(b).setAttribute("name", "D"),
                                  a.querySelectorAll("[name=d]").length && q.push("name" + L + "*[*^$|!~]?="),
                                  a.querySelectorAll(":enabled").length || q.push(":enabled", ":disabled"),
                                  a.querySelectorAll("*,:x"),
                                  q.push(",.*:");
                          })),
                      (c.matchesSelector = Z.test((s = o.matches || o.webkitMatchesSelector || o.mozMatchesSelector || o.oMatchesSelector || o.msMatchesSelector))) &&
                          ia(function(a) {
                              (c.disconnectedMatch = s.call(a, "div")), s.call(a, "[s!='']:x"), r.push("!=", O);
                          }),
                      (q = q.length && new RegExp(q.join("|"))),
                      (r = r.length && new RegExp(r.join("|"))),
                      (b = Z.test(o.compareDocumentPosition)),
                      (t =
                          b || Z.test(o.contains)
                              ? function(a, b) {
                                    var c = 9 === a.nodeType ? a.documentElement : a,
                                        d = b && b.parentNode;
                                    return a === d || !(!d || 1 !== d.nodeType || !(c.contains ? c.contains(d) : a.compareDocumentPosition && 16 & a.compareDocumentPosition(d)));
                                }
                              : function(a, b) {
                                    if (b) while ((b = b.parentNode)) if (b === a) return !0;
                                    return !1;
                                }),
                      (B = b
                          ? function(a, b) {
                                if (a === b) return (l = !0), 0;
                                var d = !a.compareDocumentPosition - !b.compareDocumentPosition;
                                return d
                                    ? d
                                    : ((d = (a.ownerDocument || a) === (b.ownerDocument || b) ? a.compareDocumentPosition(b) : 1),
                                      1 & d || (!c.sortDetached && b.compareDocumentPosition(a) === d)
                                          ? a === n || (a.ownerDocument === v && t(v, a))
                                              ? -1
                                              : b === n || (b.ownerDocument === v && t(v, b))
                                              ? 1
                                              : k
                                              ? J(k, a) - J(k, b)
                                              : 0
                                          : 4 & d
                                          ? -1
                                          : 1);
                            }
                          : function(a, b) {
                                if (a === b) return (l = !0), 0;
                                var c,
                                    d = 0,
                                    e = a.parentNode,
                                    f = b.parentNode,
                                    g = [a],
                                    h = [b];
                                if (!e || !f) return a === n ? -1 : b === n ? 1 : e ? -1 : f ? 1 : k ? J(k, a) - J(k, b) : 0;
                                if (e === f) return ka(a, b);
                                c = a;
                                while ((c = c.parentNode)) g.unshift(c);
                                c = b;
                                while ((c = c.parentNode)) h.unshift(c);
                                while (g[d] === h[d]) d++;
                                return d ? ka(g[d], h[d]) : g[d] === v ? -1 : h[d] === v ? 1 : 0;
                            }),
                      n)
                    : n;
            }),
            (fa.matches = function(a, b) {
                return fa(a, null, null, b);
            }),
            (fa.matchesSelector = function(a, b) {
                if (((a.ownerDocument || a) !== n && m(a), (b = b.replace(T, "='$1']")), c.matchesSelector && p && !A[b + " "] && (!r || !r.test(b)) && (!q || !q.test(b))))
                    try {
                        var d = s.call(a, b);
                        if (d || c.disconnectedMatch || (a.document && 11 !== a.document.nodeType)) return d;
                    } catch (e) {}
                return fa(b, n, null, [a]).length > 0;
            }),
            (fa.contains = function(a, b) {
                return (a.ownerDocument || a) !== n && m(a), t(a, b);
            }),
            (fa.attr = function(a, b) {
                (a.ownerDocument || a) !== n && m(a);
                var e = d.attrHandle[b.toLowerCase()],
                    f = e && D.call(d.attrHandle, b.toLowerCase()) ? e(a, b, !p) : void 0;
                return void 0 !== f ? f : c.attributes || !p ? a.getAttribute(b) : (f = a.getAttributeNode(b)) && f.specified ? f.value : null;
            }),
            (fa.error = function(a) {
                throw new Error("Syntax error, unrecognized expression: " + a);
            }),
            (fa.uniqueSort = function(a) {
                var b,
                    d = [],
                    e = 0,
                    f = 0;
                if (((l = !c.detectDuplicates), (k = !c.sortStable && a.slice(0)), a.sort(B), l)) {
                    while ((b = a[f++])) b === a[f] && (e = d.push(f));
                    while (e--) a.splice(d[e], 1);
                }
                return (k = null), a;
            }),
            (e = fa.getText = function(a) {
                var b,
                    c = "",
                    d = 0,
                    f = a.nodeType;
                if (f) {
                    if (1 === f || 9 === f || 11 === f) {
                        if ("string" == typeof a.textContent) return a.textContent;
                        for (a = a.firstChild; a; a = a.nextSibling) c += e(a);
                    } else if (3 === f || 4 === f) return a.nodeValue;
                } else while ((b = a[d++])) c += e(b);
                return c;
            }),
            (d = fa.selectors = {
                cacheLength: 50,
                createPseudo: ha,
                match: W,
                attrHandle: {},
                find: {},
                relative: { ">": { dir: "parentNode", first: !0 }, " ": { dir: "parentNode" }, "+": { dir: "previousSibling", first: !0 }, "~": { dir: "previousSibling" } },
                preFilter: {
                    ATTR: function(a) {
                        return (a[1] = a[1].replace(ba, ca)), (a[3] = (a[3] || a[4] || a[5] || "").replace(ba, ca)), "~=" === a[2] && (a[3] = " " + a[3] + " "), a.slice(0, 4);
                    },
                    CHILD: function(a) {
                        return (
                            (a[1] = a[1].toLowerCase()),
                            "nth" === a[1].slice(0, 3)
                                ? (a[3] || fa.error(a[0]),
                                  (a[4] = +(a[4] ? a[5] + (a[6] || 1) : 2 * ("even" === a[3] || "odd" === a[3]))),
                                  (a[5] = +(a[7] + a[8] || "odd" === a[3])))
                                : a[3] && fa.error(a[0]),
                            a
                        );
                    },
                    PSEUDO: function(a) {
                        var b,
                            c = !a[6] && a[2];
                        return W.CHILD.test(a[0])
                            ? null
                            : (a[3]
                                  ? (a[2] = a[4] || a[5] || "")
                                  : c && U.test(c) && (b = g(c, !0)) && (b = c.indexOf(")", c.length - b) - c.length) && ((a[0] = a[0].slice(0, b)), (a[2] = c.slice(0, b))),
                              a.slice(0, 3));
                    }
                },
                filter: {
                    TAG: function(a) {
                        var b = a.replace(ba, ca).toLowerCase();
                        return "*" === a
                            ? function() {
                                  return !0;
                              }
                            : function(a) {
                                  return a.nodeName && a.nodeName.toLowerCase() === b;
                              };
                    },
                    CLASS: function(a) {
                        var b = y[a + " "];
                        return (
                            b ||
                            ((b = new RegExp("(^|" + L + ")" + a + "(" + L + "|$)")) &&
                                y(a, function(a) {
                                    return b.test(("string" == typeof a.className && a.className) || ("undefined" != typeof a.getAttribute && a.getAttribute("class")) || "");
                                }))
                        );
                    },
                    ATTR: function(a, b, c) {
                        return function(d) {
                            var e = fa.attr(d, a);
                            return null == e
                                ? "!=" === b
                                : b
                                ? ((e += ""),
                                  "=" === b
                                      ? e === c
                                      : "!=" === b
                                      ? e !== c
                                      : "^=" === b
                                      ? c && 0 === e.indexOf(c)
                                      : "*=" === b
                                      ? c && e.indexOf(c) > -1
                                      : "$=" === b
                                      ? c && e.slice(-c.length) === c
                                      : "~=" === b
                                      ? (" " + e.replace(P, " ") + " ").indexOf(c) > -1
                                      : "|=" === b
                                      ? e === c || e.slice(0, c.length + 1) === c + "-"
                                      : !1)
                                : !0;
                        };
                    },
                    CHILD: function(a, b, c, d, e) {
                        var f = "nth" !== a.slice(0, 3),
                            g = "last" !== a.slice(-4),
                            h = "of-type" === b;
                        return 1 === d && 0 === e
                            ? function(a) {
                                  return !!a.parentNode;
                              }
                            : function(b, c, i) {
                                  var j,
                                      k,
                                      l,
                                      m,
                                      n,
                                      o,
                                      p = f !== g ? "nextSibling" : "previousSibling",
                                      q = b.parentNode,
                                      r = h && b.nodeName.toLowerCase(),
                                      s = !i && !h,
                                      t = !1;
                                  if (q) {
                                      if (f) {
                                          while (p) {
                                              m = b;
                                              while ((m = m[p])) if (h ? m.nodeName.toLowerCase() === r : 1 === m.nodeType) return !1;
                                              o = p = "only" === a && !o && "nextSibling";
                                          }
                                          return !0;
                                      }
                                      if (((o = [g ? q.firstChild : q.lastChild]), g && s)) {
                                          (m = q),
                                              (l = m[u] || (m[u] = {})),
                                              (k = l[m.uniqueID] || (l[m.uniqueID] = {})),
                                              (j = k[a] || []),
                                              (n = j[0] === w && j[1]),
                                              (t = n && j[2]),
                                              (m = n && q.childNodes[n]);
                                          while ((m = (++n && m && m[p]) || (t = n = 0) || o.pop()))
                                              if (1 === m.nodeType && ++t && m === b) {
                                                  k[a] = [w, n, t];
                                                  break;
                                              }
                                      } else if (
                                          (s &&
                                              ((m = b),
                                              (l = m[u] || (m[u] = {})),
                                              (k = l[m.uniqueID] || (l[m.uniqueID] = {})),
                                              (j = k[a] || []),
                                              (n = j[0] === w && j[1]),
                                              (t = n)),
                                          t === !1)
                                      )
                                          while ((m = (++n && m && m[p]) || (t = n = 0) || o.pop()))
                                              if (
                                                  (h ? m.nodeName.toLowerCase() === r : 1 === m.nodeType) &&
                                                  ++t &&
                                                  (s && ((l = m[u] || (m[u] = {})), (k = l[m.uniqueID] || (l[m.uniqueID] = {})), (k[a] = [w, t])), m === b)
                                              )
                                                  break;
                                      return (t -= e), t === d || (t % d === 0 && t / d >= 0);
                                  }
                              };
                    },
                    PSEUDO: function(a, b) {
                        var c,
                            e = d.pseudos[a] || d.setFilters[a.toLowerCase()] || fa.error("unsupported pseudo: " + a);
                        return e[u]
                            ? e(b)
                            : e.length > 1
                            ? ((c = [a, a, "", b]),
                              d.setFilters.hasOwnProperty(a.toLowerCase())
                                  ? ha(function(a, c) {
                                        var d,
                                            f = e(a, b),
                                            g = f.length;
                                        while (g--) (d = J(a, f[g])), (a[d] = !(c[d] = f[g]));
                                    })
                                  : function(a) {
                                        return e(a, 0, c);
                                    })
                            : e;
                    }
                },
                pseudos: {
                    not: ha(function(a) {
                        var b = [],
                            c = [],
                            d = h(a.replace(Q, "$1"));
                        return d[u]
                            ? ha(function(a, b, c, e) {
                                  var f,
                                      g = d(a, null, e, []),
                                      h = a.length;
                                  while (h--) (f = g[h]) && (a[h] = !(b[h] = f));
                              })
                            : function(a, e, f) {
                                  return (b[0] = a), d(b, null, f, c), (b[0] = null), !c.pop();
                              };
                    }),
                    has: ha(function(a) {
                        return function(b) {
                            return fa(a, b).length > 0;
                        };
                    }),
                    contains: ha(function(a) {
                        return (
                            (a = a.replace(ba, ca)),
                            function(b) {
                                return (b.textContent || b.innerText || e(b)).indexOf(a) > -1;
                            }
                        );
                    }),
                    lang: ha(function(a) {
                        return (
                            V.test(a || "") || fa.error("unsupported lang: " + a),
                            (a = a.replace(ba, ca).toLowerCase()),
                            function(b) {
                                var c;
                                do if ((c = p ? b.lang : b.getAttribute("xml:lang") || b.getAttribute("lang"))) return (c = c.toLowerCase()), c === a || 0 === c.indexOf(a + "-");
                                while ((b = b.parentNode) && 1 === b.nodeType);
                                return !1;
                            }
                        );
                    }),
                    target: function(b) {
                        var c = a.location && a.location.hash;
                        return c && c.slice(1) === b.id;
                    },
                    root: function(a) {
                        return a === o;
                    },
                    focus: function(a) {
                        return a === n.activeElement && (!n.hasFocus || n.hasFocus()) && !!(a.type || a.href || ~a.tabIndex);
                    },
                    enabled: function(a) {
                        return a.disabled === !1;
                    },
                    disabled: function(a) {
                        return a.disabled === !0;
                    },
                    checked: function(a) {
                        var b = a.nodeName.toLowerCase();
                        return ("input" === b && !!a.checked) || ("option" === b && !!a.selected);
                    },
                    selected: function(a) {
                        return a.parentNode && a.parentNode.selectedIndex, a.selected === !0;
                    },
                    empty: function(a) {
                        for (a = a.firstChild; a; a = a.nextSibling) if (a.nodeType < 6) return !1;
                        return !0;
                    },
                    parent: function(a) {
                        return !d.pseudos.empty(a);
                    },
                    header: function(a) {
                        return Y.test(a.nodeName);
                    },
                    input: function(a) {
                        return X.test(a.nodeName);
                    },
                    button: function(a) {
                        var b = a.nodeName.toLowerCase();
                        return ("input" === b && "button" === a.type) || "button" === b;
                    },
                    text: function(a) {
                        var b;
                        return "input" === a.nodeName.toLowerCase() && "text" === a.type && (null == (b = a.getAttribute("type")) || "text" === b.toLowerCase());
                    },
                    first: na(function() {
                        return [0];
                    }),
                    last: na(function(a, b) {
                        return [b - 1];
                    }),
                    eq: na(function(a, b, c) {
                        return [0 > c ? c + b : c];
                    }),
                    even: na(function(a, b) {
                        for (var c = 0; b > c; c += 2) a.push(c);
                        return a;
                    }),
                    odd: na(function(a, b) {
                        for (var c = 1; b > c; c += 2) a.push(c);
                        return a;
                    }),
                    lt: na(function(a, b, c) {
                        for (var d = 0 > c ? c + b : c; --d >= 0; ) a.push(d);
                        return a;
                    }),
                    gt: na(function(a, b, c) {
                        for (var d = 0 > c ? c + b : c; ++d < b; ) a.push(d);
                        return a;
                    })
                }
            }),
            (d.pseudos.nth = d.pseudos.eq);
        for (b in { radio: !0, checkbox: !0, file: !0, password: !0, image: !0 }) d.pseudos[b] = la(b);
        for (b in { submit: !0, reset: !0 }) d.pseudos[b] = ma(b);
        function pa() {}
        (pa.prototype = d.filters = d.pseudos),
            (d.setFilters = new pa()),
            (g = fa.tokenize = function(a, b) {
                var c,
                    e,
                    f,
                    g,
                    h,
                    i,
                    j,
                    k = z[a + " "];
                if (k) return b ? 0 : k.slice(0);
                (h = a), (i = []), (j = d.preFilter);
                while (h) {
                    (c && !(e = R.exec(h))) || (e && (h = h.slice(e[0].length) || h), i.push((f = []))),
                        (c = !1),
                        (e = S.exec(h)) && ((c = e.shift()), f.push({ value: c, type: e[0].replace(Q, " ") }), (h = h.slice(c.length)));
                    for (g in d.filter) !(e = W[g].exec(h)) || (j[g] && !(e = j[g](e))) || ((c = e.shift()), f.push({ value: c, type: g, matches: e }), (h = h.slice(c.length)));
                    if (!c) break;
                }
                return b ? h.length : h ? fa.error(a) : z(a, i).slice(0);
            });
        function qa(a) {
            for (var b = 0, c = a.length, d = ""; c > b; b++) d += a[b].value;
            return d;
        }
        function ra(a, b, c) {
            var d = b.dir,
                e = c && "parentNode" === d,
                f = x++;
            return b.first
                ? function(b, c, f) {
                      while ((b = b[d])) if (1 === b.nodeType || e) return a(b, c, f);
                  }
                : function(b, c, g) {
                      var h,
                          i,
                          j,
                          k = [w, f];
                      if (g) {
                          while ((b = b[d])) if ((1 === b.nodeType || e) && a(b, c, g)) return !0;
                      } else
                          while ((b = b[d]))
                              if (1 === b.nodeType || e) {
                                  if (((j = b[u] || (b[u] = {})), (i = j[b.uniqueID] || (j[b.uniqueID] = {})), (h = i[d]) && h[0] === w && h[1] === f)) return (k[2] = h[2]);
                                  if (((i[d] = k), (k[2] = a(b, c, g)))) return !0;
                              }
                  };
        }
        function sa(a) {
            return a.length > 1
                ? function(b, c, d) {
                      var e = a.length;
                      while (e--) if (!a[e](b, c, d)) return !1;
                      return !0;
                  }
                : a[0];
        }
        function ta(a, b, c) {
            for (var d = 0, e = b.length; e > d; d++) fa(a, b[d], c);
            return c;
        }
        function ua(a, b, c, d, e) {
            for (var f, g = [], h = 0, i = a.length, j = null != b; i > h; h++) (f = a[h]) && ((c && !c(f, d, e)) || (g.push(f), j && b.push(h)));
            return g;
        }
        function va(a, b, c, d, e, f) {
            return (
                d && !d[u] && (d = va(d)),
                e && !e[u] && (e = va(e, f)),
                ha(function(f, g, h, i) {
                    var j,
                        k,
                        l,
                        m = [],
                        n = [],
                        o = g.length,
                        p = f || ta(b || "*", h.nodeType ? [h] : h, []),
                        q = !a || (!f && b) ? p : ua(p, m, a, h, i),
                        r = c ? (e || (f ? a : o || d) ? [] : g) : q;
                    if ((c && c(q, r, h, i), d)) {
                        (j = ua(r, n)), d(j, [], h, i), (k = j.length);
                        while (k--) (l = j[k]) && (r[n[k]] = !(q[n[k]] = l));
                    }
                    if (f) {
                        if (e || a) {
                            if (e) {
                                (j = []), (k = r.length);
                                while (k--) (l = r[k]) && j.push((q[k] = l));
                                e(null, (r = []), j, i);
                            }
                            k = r.length;
                            while (k--) (l = r[k]) && (j = e ? J(f, l) : m[k]) > -1 && (f[j] = !(g[j] = l));
                        }
                    } else (r = ua(r === g ? r.splice(o, r.length) : r)), e ? e(null, g, r, i) : H.apply(g, r);
                })
            );
        }
        function wa(a) {
            for (
                var b,
                    c,
                    e,
                    f = a.length,
                    g = d.relative[a[0].type],
                    h = g || d.relative[" "],
                    i = g ? 1 : 0,
                    k = ra(
                        function(a) {
                            return a === b;
                        },
                        h,
                        !0
                    ),
                    l = ra(
                        function(a) {
                            return J(b, a) > -1;
                        },
                        h,
                        !0
                    ),
                    m = [
                        function(a, c, d) {
                            var e = (!g && (d || c !== j)) || ((b = c).nodeType ? k(a, c, d) : l(a, c, d));
                            return (b = null), e;
                        }
                    ];
                f > i;
                i++
            )
                if ((c = d.relative[a[i].type])) m = [ra(sa(m), c)];
                else {
                    if (((c = d.filter[a[i].type].apply(null, a[i].matches)), c[u])) {
                        for (e = ++i; f > e; e++) if (d.relative[a[e].type]) break;
                        return va(
                            i > 1 && sa(m),
                            i > 1 && qa(a.slice(0, i - 1).concat({ value: " " === a[i - 2].type ? "*" : "" })).replace(Q, "$1"),
                            c,
                            e > i && wa(a.slice(i, e)),
                            f > e && wa((a = a.slice(e))),
                            f > e && qa(a)
                        );
                    }
                    m.push(c);
                }
            return sa(m);
        }
        function xa(a, b) {
            var c = b.length > 0,
                e = a.length > 0,
                f = function(f, g, h, i, k) {
                    var l,
                        o,
                        q,
                        r = 0,
                        s = "0",
                        t = f && [],
                        u = [],
                        v = j,
                        x = f || (e && d.find.TAG("*", k)),
                        y = (w += null == v ? 1 : Math.random() || 0.1),
                        z = x.length;
                    for (k && (j = g === n || g || k); s !== z && null != (l = x[s]); s++) {
                        if (e && l) {
                            (o = 0), g || l.ownerDocument === n || (m(l), (h = !p));
                            while ((q = a[o++]))
                                if (q(l, g || n, h)) {
                                    i.push(l);
                                    break;
                                }
                            k && (w = y);
                        }
                        c && ((l = !q && l) && r--, f && t.push(l));
                    }
                    if (((r += s), c && s !== r)) {
                        o = 0;
                        while ((q = b[o++])) q(t, u, g, h);
                        if (f) {
                            if (r > 0) while (s--) t[s] || u[s] || (u[s] = F.call(i));
                            u = ua(u);
                        }
                        H.apply(i, u), k && !f && u.length > 0 && r + b.length > 1 && fa.uniqueSort(i);
                    }
                    return k && ((w = y), (j = v)), t;
                };
            return c ? ha(f) : f;
        }
        return (
            (h = fa.compile = function(a, b) {
                var c,
                    d = [],
                    e = [],
                    f = A[a + " "];
                if (!f) {
                    b || (b = g(a)), (c = b.length);
                    while (c--) (f = wa(b[c])), f[u] ? d.push(f) : e.push(f);
                    (f = A(a, xa(e, d))), (f.selector = a);
                }
                return f;
            }),
            (i = fa.select = function(a, b, e, f) {
                var i,
                    j,
                    k,
                    l,
                    m,
                    n = "function" == typeof a && a,
                    o = !f && g((a = n.selector || a));
                if (((e = e || []), 1 === o.length)) {
                    if (((j = o[0] = o[0].slice(0)), j.length > 2 && "ID" === (k = j[0]).type && c.getById && 9 === b.nodeType && p && d.relative[j[1].type])) {
                        if (((b = (d.find.ID(k.matches[0].replace(ba, ca), b) || [])[0]), !b)) return e;
                        n && (b = b.parentNode), (a = a.slice(j.shift().value.length));
                    }
                    i = W.needsContext.test(a) ? 0 : j.length;
                    while (i--) {
                        if (((k = j[i]), d.relative[(l = k.type)])) break;
                        if ((m = d.find[l]) && (f = m(k.matches[0].replace(ba, ca), (_.test(j[0].type) && oa(b.parentNode)) || b))) {
                            if ((j.splice(i, 1), (a = f.length && qa(j)), !a)) return H.apply(e, f), e;
                            break;
                        }
                    }
                }
                return (n || h(a, o))(f, b, !p, e, !b || (_.test(a) && oa(b.parentNode)) || b), e;
            }),
            (c.sortStable =
                u
                    .split("")
                    .sort(B)
                    .join("") === u),
            (c.detectDuplicates = !!l),
            m(),
            (c.sortDetached = ia(function(a) {
                return 1 & a.compareDocumentPosition(n.createElement("div"));
            })),
            ia(function(a) {
                return (a.innerHTML = "<a href='#'></a>"), "#" === a.firstChild.getAttribute("href");
            }) ||
                ja("type|href|height|width", function(a, b, c) {
                    return c ? void 0 : a.getAttribute(b, "type" === b.toLowerCase() ? 1 : 2);
                }),
            (c.attributes &&
                ia(function(a) {
                    return (a.innerHTML = "<input/>"), a.firstChild.setAttribute("value", ""), "" === a.firstChild.getAttribute("value");
                })) ||
                ja("value", function(a, b, c) {
                    return c || "input" !== a.nodeName.toLowerCase() ? void 0 : a.defaultValue;
                }),
            ia(function(a) {
                return null == a.getAttribute("disabled");
            }) ||
                ja(K, function(a, b, c) {
                    var d;
                    return c ? void 0 : a[b] === !0 ? b.toLowerCase() : (d = a.getAttributeNode(b)) && d.specified ? d.value : null;
                }),
            fa
        );
    })(a);
    (n.find = t),
        (n.expr = t.selectors),
        (n.expr[":"] = n.expr.pseudos),
        (n.uniqueSort = n.unique = t.uniqueSort),
        (n.text = t.getText),
        (n.isXMLDoc = t.isXML),
        (n.contains = t.contains);
    var u = function(a, b, c) {
            var d = [],
                e = void 0 !== c;
            while ((a = a[b]) && 9 !== a.nodeType)
                if (1 === a.nodeType) {
                    if (e && n(a).is(c)) break;
                    d.push(a);
                }
            return d;
        },
        v = function(a, b) {
            for (var c = []; a; a = a.nextSibling) 1 === a.nodeType && a !== b && c.push(a);
            return c;
        },
        w = n.expr.match.needsContext,
        x = /^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,
        y = /^.[^:#\[\.,]*$/;
    function z(a, b, c) {
        if (n.isFunction(b))
            return n.grep(a, function(a, d) {
                return !!b.call(a, d, a) !== c;
            });
        if (b.nodeType)
            return n.grep(a, function(a) {
                return (a === b) !== c;
            });
        if ("string" == typeof b) {
            if (y.test(b)) return n.filter(b, a, c);
            b = n.filter(b, a);
        }
        return n.grep(a, function(a) {
            return n.inArray(a, b) > -1 !== c;
        });
    }
    (n.filter = function(a, b, c) {
        var d = b[0];
        return (
            c && (a = ":not(" + a + ")"),
            1 === b.length && 1 === d.nodeType
                ? n.find.matchesSelector(d, a)
                    ? [d]
                    : []
                : n.find.matches(
                      a,
                      n.grep(b, function(a) {
                          return 1 === a.nodeType;
                      })
                  )
        );
    }),
        n.fn.extend({
            find: function(a) {
                var b,
                    c = [],
                    d = this,
                    e = d.length;
                if ("string" != typeof a)
                    return this.pushStack(
                        n(a).filter(function() {
                            for (b = 0; e > b; b++) if (n.contains(d[b], this)) return !0;
                        })
                    );
                for (b = 0; e > b; b++) n.find(a, d[b], c);
                return (c = this.pushStack(e > 1 ? n.unique(c) : c)), (c.selector = this.selector ? this.selector + " " + a : a), c;
            },
            filter: function(a) {
                return this.pushStack(z(this, a || [], !1));
            },
            not: function(a) {
                return this.pushStack(z(this, a || [], !0));
            },
            is: function(a) {
                return !!z(this, "string" == typeof a && w.test(a) ? n(a) : a || [], !1).length;
            }
        });
    var A,
        B = /^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,
        C = (n.fn.init = function(a, b, c) {
            var e, f;
            if (!a) return this;
            if (((c = c || A), "string" == typeof a)) {
                if (((e = "<" === a.charAt(0) && ">" === a.charAt(a.length - 1) && a.length >= 3 ? [null, a, null] : B.exec(a)), !e || (!e[1] && b)))
                    return !b || b.jquery ? (b || c).find(a) : this.constructor(b).find(a);
                if (e[1]) {
                    if (((b = b instanceof n ? b[0] : b), n.merge(this, n.parseHTML(e[1], b && b.nodeType ? b.ownerDocument || b : d, !0)), x.test(e[1]) && n.isPlainObject(b)))
                        for (e in b) n.isFunction(this[e]) ? this[e](b[e]) : this.attr(e, b[e]);
                    return this;
                }
                if (((f = d.getElementById(e[2])), f && f.parentNode)) {
                    if (f.id !== e[2]) return A.find(a);
                    (this.length = 1), (this[0] = f);
                }
                return (this.context = d), (this.selector = a), this;
            }
            return a.nodeType
                ? ((this.context = this[0] = a), (this.length = 1), this)
                : n.isFunction(a)
                ? "undefined" != typeof c.ready
                    ? c.ready(a)
                    : a(n)
                : (void 0 !== a.selector && ((this.selector = a.selector), (this.context = a.context)), n.makeArray(a, this));
        });
    (C.prototype = n.fn), (A = n(d));
    var D = /^(?:parents|prev(?:Until|All))/,
        E = { children: !0, contents: !0, next: !0, prev: !0 };
    n.fn.extend({
        has: function(a) {
            var b,
                c = n(a, this),
                d = c.length;
            return this.filter(function() {
                for (b = 0; d > b; b++) if (n.contains(this, c[b])) return !0;
            });
        },
        closest: function(a, b) {
            for (var c, d = 0, e = this.length, f = [], g = w.test(a) || "string" != typeof a ? n(a, b || this.context) : 0; e > d; d++)
                for (c = this[d]; c && c !== b; c = c.parentNode)
                    if (c.nodeType < 11 && (g ? g.index(c) > -1 : 1 === c.nodeType && n.find.matchesSelector(c, a))) {
                        f.push(c);
                        break;
                    }
            return this.pushStack(f.length > 1 ? n.uniqueSort(f) : f);
        },
        index: function(a) {
            return a
                ? "string" == typeof a
                    ? n.inArray(this[0], n(a))
                    : n.inArray(a.jquery ? a[0] : a, this)
                : this[0] && this[0].parentNode
                ? this.first().prevAll().length
                : -1;
        },
        add: function(a, b) {
            return this.pushStack(n.uniqueSort(n.merge(this.get(), n(a, b))));
        },
        addBack: function(a) {
            return this.add(null == a ? this.prevObject : this.prevObject.filter(a));
        }
    });
    function F(a, b) {
        do a = a[b];
        while (a && 1 !== a.nodeType);
        return a;
    }
    n.each(
        {
            parent: function(a) {
                var b = a.parentNode;
                return b && 11 !== b.nodeType ? b : null;
            },
            parents: function(a) {
                return u(a, "parentNode");
            },
            parentsUntil: function(a, b, c) {
                return u(a, "parentNode", c);
            },
            next: function(a) {
                return F(a, "nextSibling");
            },
            prev: function(a) {
                return F(a, "previousSibling");
            },
            nextAll: function(a) {
                return u(a, "nextSibling");
            },
            prevAll: function(a) {
                return u(a, "previousSibling");
            },
            nextUntil: function(a, b, c) {
                return u(a, "nextSibling", c);
            },
            prevUntil: function(a, b, c) {
                return u(a, "previousSibling", c);
            },
            siblings: function(a) {
                return v((a.parentNode || {}).firstChild, a);
            },
            children: function(a) {
                return v(a.firstChild);
            },
            contents: function(a) {
                return n.nodeName(a, "iframe") ? a.contentDocument || a.contentWindow.document : n.merge([], a.childNodes);
            }
        },
        function(a, b) {
            n.fn[a] = function(c, d) {
                var e = n.map(this, b, c);
                return (
                    "Until" !== a.slice(-5) && (d = c),
                    d && "string" == typeof d && (e = n.filter(d, e)),
                    this.length > 1 && (E[a] || (e = n.uniqueSort(e)), D.test(a) && (e = e.reverse())),
                    this.pushStack(e)
                );
            };
        }
    );
    var G = /\S+/g;
    function H(a) {
        var b = {};
        return (
            n.each(a.match(G) || [], function(a, c) {
                b[c] = !0;
            }),
            b
        );
    }
    (n.Callbacks = function(a) {
        a = "string" == typeof a ? H(a) : n.extend({}, a);
        var b,
            c,
            d,
            e,
            f = [],
            g = [],
            h = -1,
            i = function() {
                for (e = a.once, d = b = !0; g.length; h = -1) {
                    c = g.shift();
                    while (++h < f.length) f[h].apply(c[0], c[1]) === !1 && a.stopOnFalse && ((h = f.length), (c = !1));
                }
                a.memory || (c = !1), (b = !1), e && (f = c ? [] : "");
            },
            j = {
                add: function() {
                    return (
                        f &&
                            (c && !b && ((h = f.length - 1), g.push(c)),
                            (function d(b) {
                                n.each(b, function(b, c) {
                                    n.isFunction(c) ? (a.unique && j.has(c)) || f.push(c) : c && c.length && "string" !== n.type(c) && d(c);
                                });
                            })(arguments),
                            c && !b && i()),
                        this
                    );
                },
                remove: function() {
                    return (
                        n.each(arguments, function(a, b) {
                            var c;
                            while ((c = n.inArray(b, f, c)) > -1) f.splice(c, 1), h >= c && h--;
                        }),
                        this
                    );
                },
                has: function(a) {
                    return a ? n.inArray(a, f) > -1 : f.length > 0;
                },
                empty: function() {
                    return f && (f = []), this;
                },
                disable: function() {
                    return (e = g = []), (f = c = ""), this;
                },
                disabled: function() {
                    return !f;
                },
                lock: function() {
                    return (e = !0), c || j.disable(), this;
                },
                locked: function() {
                    return !!e;
                },
                fireWith: function(a, c) {
                    return e || ((c = c || []), (c = [a, c.slice ? c.slice() : c]), g.push(c), b || i()), this;
                },
                fire: function() {
                    return j.fireWith(this, arguments), this;
                },
                fired: function() {
                    return !!d;
                }
            };
        return j;
    }),
        n.extend({
            Deferred: function(a) {
                var b = [
                        ["resolve", "done", n.Callbacks("once memory"), "resolved"],
                        ["reject", "fail", n.Callbacks("once memory"), "rejected"],
                        ["notify", "progress", n.Callbacks("memory")]
                    ],
                    c = "pending",
                    d = {
                        state: function() {
                            return c;
                        },
                        always: function() {
                            return e.done(arguments).fail(arguments), this;
                        },
                        then: function() {
                            var a = arguments;
                            return n
                                .Deferred(function(c) {
                                    n.each(b, function(b, f) {
                                        var g = n.isFunction(a[b]) && a[b];
                                        e[f[1]](function() {
                                            var a = g && g.apply(this, arguments);
                                            a && n.isFunction(a.promise)
                                                ? a
                                                      .promise()
                                                      .progress(c.notify)
                                                      .done(c.resolve)
                                                      .fail(c.reject)
                                                : c[f[0] + "With"](this === d ? c.promise() : this, g ? [a] : arguments);
                                        });
                                    }),
                                        (a = null);
                                })
                                .promise();
                        },
                        promise: function(a) {
                            return null != a ? n.extend(a, d) : d;
                        }
                    },
                    e = {};
                return (
                    (d.pipe = d.then),
                    n.each(b, function(a, f) {
                        var g = f[2],
                            h = f[3];
                        (d[f[1]] = g.add),
                            h &&
                                g.add(
                                    function() {
                                        c = h;
                                    },
                                    b[1 ^ a][2].disable,
                                    b[2][2].lock
                                ),
                            (e[f[0]] = function() {
                                return e[f[0] + "With"](this === e ? d : this, arguments), this;
                            }),
                            (e[f[0] + "With"] = g.fireWith);
                    }),
                    d.promise(e),
                    a && a.call(e, e),
                    e
                );
            },
            when: function(a) {
                var b = 0,
                    c = e.call(arguments),
                    d = c.length,
                    f = 1 !== d || (a && n.isFunction(a.promise)) ? d : 0,
                    g = 1 === f ? a : n.Deferred(),
                    h = function(a, b, c) {
                        return function(d) {
                            (b[a] = this), (c[a] = arguments.length > 1 ? e.call(arguments) : d), c === i ? g.notifyWith(b, c) : --f || g.resolveWith(b, c);
                        };
                    },
                    i,
                    j,
                    k;
                if (d > 1)
                    for (i = new Array(d), j = new Array(d), k = new Array(d); d > b; b++)
                        c[b] && n.isFunction(c[b].promise)
                            ? c[b]
                                  .promise()
                                  .progress(h(b, j, i))
                                  .done(h(b, k, c))
                                  .fail(g.reject)
                            : --f;
                return f || g.resolveWith(k, c), g.promise();
            }
        });
    var I;
    (n.fn.ready = function(a) {
        return n.ready.promise().done(a), this;
    }),
        n.extend({
            isReady: !1,
            readyWait: 1,
            holdReady: function(a) {
                a ? n.readyWait++ : n.ready(!0);
            },
            ready: function(a) {
                (a === !0 ? --n.readyWait : n.isReady) ||
                    ((n.isReady = !0), (a !== !0 && --n.readyWait > 0) || (I.resolveWith(d, [n]), n.fn.triggerHandler && (n(d).triggerHandler("ready"), n(d).off("ready"))));
            }
        });
    function J() {
        d.addEventListener
            ? (d.removeEventListener("DOMContentLoaded", K), a.removeEventListener("load", K))
            : (d.detachEvent("onreadystatechange", K), a.detachEvent("onload", K));
    }
    function K() {
        (d.addEventListener || "load" === a.event.type || "complete" === d.readyState) && (J(), n.ready());
    }
    (n.ready.promise = function(b) {
        if (!I)
            if (((I = n.Deferred()), "complete" === d.readyState || ("loading" !== d.readyState && !d.documentElement.doScroll))) a.setTimeout(n.ready);
            else if (d.addEventListener) d.addEventListener("DOMContentLoaded", K), a.addEventListener("load", K);
            else {
                d.attachEvent("onreadystatechange", K), a.attachEvent("onload", K);
                var c = !1;
                try {
                    c = null == a.frameElement && d.documentElement;
                } catch (e) {}
                c &&
                    c.doScroll &&
                    !(function f() {
                        if (!n.isReady) {
                            try {
                                c.doScroll("left");
                            } catch (b) {
                                return a.setTimeout(f, 50);
                            }
                            J(), n.ready();
                        }
                    })();
            }
        return I.promise(b);
    }),
        n.ready.promise();
    var L;
    for (L in n(l)) break;
    (l.ownFirst = "0" === L),
        (l.inlineBlockNeedsLayout = !1),
        n(function() {
            var a, b, c, e;
            (c = d.getElementsByTagName("body")[0]),
                c &&
                    c.style &&
                    ((b = d.createElement("div")),
                    (e = d.createElement("div")),
                    (e.style.cssText = "position:absolute;border:0;width:0;height:0;top:0;left:-9999px"),
                    c.appendChild(e).appendChild(b),
                    "undefined" != typeof b.style.zoom &&
                        ((b.style.cssText = "display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1"),
                        (l.inlineBlockNeedsLayout = a = 3 === b.offsetWidth),
                        a && (c.style.zoom = 1)),
                    c.removeChild(e));
        }),
        (function() {
            var a = d.createElement("div");
            l.deleteExpando = !0;
            try {
                delete a.test;
            } catch (b) {
                l.deleteExpando = !1;
            }
            a = null;
        })();
    var M = function(a) {
            var b = n.noData[(a.nodeName + " ").toLowerCase()],
                c = +a.nodeType || 1;
            return 1 !== c && 9 !== c ? !1 : !b || (b !== !0 && a.getAttribute("classid") === b);
        },
        N = /^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,
        O = /([A-Z])/g;
    function P(a, b, c) {
        if (void 0 === c && 1 === a.nodeType) {
            var d = "data-" + b.replace(O, "-$1").toLowerCase();
            if (((c = a.getAttribute(d)), "string" == typeof c)) {
                try {
                    c = "true" === c ? !0 : "false" === c ? !1 : "null" === c ? null : +c + "" === c ? +c : N.test(c) ? n.parseJSON(c) : c;
                } catch (e) {}
                n.data(a, b, c);
            } else c = void 0;
        }
        return c;
    }
    function Q(a) {
        var b;
        for (b in a) if (("data" !== b || !n.isEmptyObject(a[b])) && "toJSON" !== b) return !1;
        return !0;
    }
    function R(a, b, d, e) {
        if (M(a)) {
            var f,
                g,
                h = n.expando,
                i = a.nodeType,
                j = i ? n.cache : a,
                k = i ? a[h] : a[h] && h;
            if ((k && j[k] && (e || j[k].data)) || void 0 !== d || "string" != typeof b)
                return (
                    k || (k = i ? (a[h] = c.pop() || n.guid++) : h),
                    j[k] || (j[k] = i ? {} : { toJSON: n.noop }),
                    ("object" != typeof b && "function" != typeof b) || (e ? (j[k] = n.extend(j[k], b)) : (j[k].data = n.extend(j[k].data, b))),
                    (g = j[k]),
                    e || (g.data || (g.data = {}), (g = g.data)),
                    void 0 !== d && (g[n.camelCase(b)] = d),
                    "string" == typeof b ? ((f = g[b]), null == f && (f = g[n.camelCase(b)])) : (f = g),
                    f
                );
        }
    }
    function S(a, b, c) {
        if (M(a)) {
            var d,
                e,
                f = a.nodeType,
                g = f ? n.cache : a,
                h = f ? a[n.expando] : n.expando;
            if (g[h]) {
                if (b && (d = c ? g[h] : g[h].data)) {
                    n.isArray(b) ? (b = b.concat(n.map(b, n.camelCase))) : b in d ? (b = [b]) : ((b = n.camelCase(b)), (b = b in d ? [b] : b.split(" "))), (e = b.length);
                    while (e--) delete d[b[e]];
                    if (c ? !Q(d) : !n.isEmptyObject(d)) return;
                }
                (c || (delete g[h].data, Q(g[h]))) && (f ? n.cleanData([a], !0) : l.deleteExpando || g != g.window ? delete g[h] : (g[h] = void 0));
            }
        }
    }
    n.extend({
        cache: {},
        noData: { "applet ": !0, "embed ": !0, "object ": "clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" },
        hasData: function(a) {
            return (a = a.nodeType ? n.cache[a[n.expando]] : a[n.expando]), !!a && !Q(a);
        },
        data: function(a, b, c) {
            return R(a, b, c);
        },
        removeData: function(a, b) {
            return S(a, b);
        },
        _data: function(a, b, c) {
            return R(a, b, c, !0);
        },
        _removeData: function(a, b) {
            return S(a, b, !0);
        }
    }),
        n.fn.extend({
            data: function(a, b) {
                var c,
                    d,
                    e,
                    f = this[0],
                    g = f && f.attributes;
                if (void 0 === a) {
                    if (this.length && ((e = n.data(f)), 1 === f.nodeType && !n._data(f, "parsedAttrs"))) {
                        c = g.length;
                        while (c--) g[c] && ((d = g[c].name), 0 === d.indexOf("data-") && ((d = n.camelCase(d.slice(5))), P(f, d, e[d])));
                        n._data(f, "parsedAttrs", !0);
                    }
                    return e;
                }
                return "object" == typeof a
                    ? this.each(function() {
                          n.data(this, a);
                      })
                    : arguments.length > 1
                    ? this.each(function() {
                          n.data(this, a, b);
                      })
                    : f
                    ? P(f, a, n.data(f, a))
                    : void 0;
            },
            removeData: function(a) {
                return this.each(function() {
                    n.removeData(this, a);
                });
            }
        }),
        n.extend({
            queue: function(a, b, c) {
                var d;
                return a ? ((b = (b || "fx") + "queue"), (d = n._data(a, b)), c && (!d || n.isArray(c) ? (d = n._data(a, b, n.makeArray(c))) : d.push(c)), d || []) : void 0;
            },
            dequeue: function(a, b) {
                b = b || "fx";
                var c = n.queue(a, b),
                    d = c.length,
                    e = c.shift(),
                    f = n._queueHooks(a, b),
                    g = function() {
                        n.dequeue(a, b);
                    };
                "inprogress" === e && ((e = c.shift()), d--), e && ("fx" === b && c.unshift("inprogress"), delete f.stop, e.call(a, g, f)), !d && f && f.empty.fire();
            },
            _queueHooks: function(a, b) {
                var c = b + "queueHooks";
                return (
                    n._data(a, c) ||
                    n._data(a, c, {
                        empty: n.Callbacks("once memory").add(function() {
                            n._removeData(a, b + "queue"), n._removeData(a, c);
                        })
                    })
                );
            }
        }),
        n.fn.extend({
            queue: function(a, b) {
                var c = 2;
                return (
                    "string" != typeof a && ((b = a), (a = "fx"), c--),
                    arguments.length < c
                        ? n.queue(this[0], a)
                        : void 0 === b
                        ? this
                        : this.each(function() {
                              var c = n.queue(this, a, b);
                              n._queueHooks(this, a), "fx" === a && "inprogress" !== c[0] && n.dequeue(this, a);
                          })
                );
            },
            dequeue: function(a) {
                return this.each(function() {
                    n.dequeue(this, a);
                });
            },
            clearQueue: function(a) {
                return this.queue(a || "fx", []);
            },
            promise: function(a, b) {
                var c,
                    d = 1,
                    e = n.Deferred(),
                    f = this,
                    g = this.length,
                    h = function() {
                        --d || e.resolveWith(f, [f]);
                    };
                "string" != typeof a && ((b = a), (a = void 0)), (a = a || "fx");
                while (g--) (c = n._data(f[g], a + "queueHooks")), c && c.empty && (d++, c.empty.add(h));
                return h(), e.promise(b);
            }
        }),
        (function() {
            var a;
            l.shrinkWrapBlocks = function() {
                if (null != a) return a;
                a = !1;
                var b, c, e;
                return (
                    (c = d.getElementsByTagName("body")[0]),
                    c && c.style
                        ? ((b = d.createElement("div")),
                          (e = d.createElement("div")),
                          (e.style.cssText = "position:absolute;border:0;width:0;height:0;top:0;left:-9999px"),
                          c.appendChild(e).appendChild(b),
                          "undefined" != typeof b.style.zoom &&
                              ((b.style.cssText =
                                  "-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:1px;width:1px;zoom:1"),
                              (b.appendChild(d.createElement("div")).style.width = "5px"),
                              (a = 3 !== b.offsetWidth)),
                          c.removeChild(e),
                          a)
                        : void 0
                );
            };
        })();
    var T = /[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,
        U = new RegExp("^(?:([+-])=|)(" + T + ")([a-z%]*)$", "i"),
        V = ["Top", "Right", "Bottom", "Left"],
        W = function(a, b) {
            return (a = b || a), "none" === n.css(a, "display") || !n.contains(a.ownerDocument, a);
        };
    function X(a, b, c, d) {
        var e,
            f = 1,
            g = 20,
            h = d
                ? function() {
                      return d.cur();
                  }
                : function() {
                      return n.css(a, b, "");
                  },
            i = h(),
            j = (c && c[3]) || (n.cssNumber[b] ? "" : "px"),
            k = (n.cssNumber[b] || ("px" !== j && +i)) && U.exec(n.css(a, b));
        if (k && k[3] !== j) {
            (j = j || k[3]), (c = c || []), (k = +i || 1);
            do (f = f || ".5"), (k /= f), n.style(a, b, k + j);
            while (f !== (f = h() / i) && 1 !== f && --g);
        }
        return c && ((k = +k || +i || 0), (e = c[1] ? k + (c[1] + 1) * c[2] : +c[2]), d && ((d.unit = j), (d.start = k), (d.end = e))), e;
    }
    var Y = function(a, b, c, d, e, f, g) {
            var h = 0,
                i = a.length,
                j = null == c;
            if ("object" === n.type(c)) {
                e = !0;
                for (h in c) Y(a, b, h, c[h], !0, f, g);
            } else if (
                void 0 !== d &&
                ((e = !0),
                n.isFunction(d) || (g = !0),
                j &&
                    (g
                        ? (b.call(a, d), (b = null))
                        : ((j = b),
                          (b = function(a, b, c) {
                              return j.call(n(a), c);
                          }))),
                b)
            )
                for (; i > h; h++) b(a[h], c, g ? d : d.call(a[h], h, b(a[h], c)));
            return e ? a : j ? b.call(a) : i ? b(a[0], c) : f;
        },
        Z = /^(?:checkbox|radio)$/i,
        $ = /<([\w:-]+)/,
        _ = /^$|\/(?:java|ecma)script/i,
        aa = /^\s+/,
        ba =
            "abbr|article|aside|audio|bdi|canvas|data|datalist|details|dialog|figcaption|figure|footer|header|hgroup|main|mark|meter|nav|output|picture|progress|section|summary|template|time|video";
    function ca(a) {
        var b = ba.split("|"),
            c = a.createDocumentFragment();
        if (c.createElement) while (b.length) c.createElement(b.pop());
        return c;
    }
    !(function() {
        var a = d.createElement("div"),
            b = d.createDocumentFragment(),
            c = d.createElement("input");
        (a.innerHTML = "  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>"),
            (l.leadingWhitespace = 3 === a.firstChild.nodeType),
            (l.tbody = !a.getElementsByTagName("tbody").length),
            (l.htmlSerialize = !!a.getElementsByTagName("link").length),
            (l.html5Clone = "<:nav></:nav>" !== d.createElement("nav").cloneNode(!0).outerHTML),
            (c.type = "checkbox"),
            (c.checked = !0),
            b.appendChild(c),
            (l.appendChecked = c.checked),
            (a.innerHTML = "<textarea>x</textarea>"),
            (l.noCloneChecked = !!a.cloneNode(!0).lastChild.defaultValue),
            b.appendChild(a),
            (c = d.createElement("input")),
            c.setAttribute("type", "radio"),
            c.setAttribute("checked", "checked"),
            c.setAttribute("name", "t"),
            a.appendChild(c),
            (l.checkClone = a.cloneNode(!0).cloneNode(!0).lastChild.checked),
            (l.noCloneEvent = !!a.addEventListener),
            (a[n.expando] = 1),
            (l.attributes = !a.getAttribute(n.expando));
    })();
    var da = {
        option: [1, "<select multiple='multiple'>", "</select>"],
        legend: [1, "<fieldset>", "</fieldset>"],
        area: [1, "<map>", "</map>"],
        param: [1, "<object>", "</object>"],
        thead: [1, "<table>", "</table>"],
        tr: [2, "<table><tbody>", "</tbody></table>"],
        col: [2, "<table><tbody></tbody><colgroup>", "</colgroup></table>"],
        td: [3, "<table><tbody><tr>", "</tr></tbody></table>"],
        _default: l.htmlSerialize ? [0, "", ""] : [1, "X<div>", "</div>"]
    };
    (da.optgroup = da.option), (da.tbody = da.tfoot = da.colgroup = da.caption = da.thead), (da.th = da.td);
    function ea(a, b) {
        var c,
            d,
            e = 0,
            f = "undefined" != typeof a.getElementsByTagName ? a.getElementsByTagName(b || "*") : "undefined" != typeof a.querySelectorAll ? a.querySelectorAll(b || "*") : void 0;
        if (!f) for (f = [], c = a.childNodes || a; null != (d = c[e]); e++) !b || n.nodeName(d, b) ? f.push(d) : n.merge(f, ea(d, b));
        return void 0 === b || (b && n.nodeName(a, b)) ? n.merge([a], f) : f;
    }
    function fa(a, b) {
        for (var c, d = 0; null != (c = a[d]); d++) n._data(c, "globalEval", !b || n._data(b[d], "globalEval"));
    }
    var ga = /<|&#?\w+;/,
        ha = /<tbody/i;
    function ia(a) {
        Z.test(a.type) && (a.defaultChecked = a.checked);
    }
    function ja(a, b, c, d, e) {
        for (var f, g, h, i, j, k, m, o = a.length, p = ca(b), q = [], r = 0; o > r; r++)
            if (((g = a[r]), g || 0 === g))
                if ("object" === n.type(g)) n.merge(q, g.nodeType ? [g] : g);
                else if (ga.test(g)) {
                    (i = i || p.appendChild(b.createElement("div"))),
                        (j = ($.exec(g) || ["", ""])[1].toLowerCase()),
                        (m = da[j] || da._default),
                        (i.innerHTML = m[1] + n.htmlPrefilter(g) + m[2]),
                        (f = m[0]);
                    while (f--) i = i.lastChild;
                    if ((!l.leadingWhitespace && aa.test(g) && q.push(b.createTextNode(aa.exec(g)[0])), !l.tbody)) {
                        (g = "table" !== j || ha.test(g) ? ("<table>" !== m[1] || ha.test(g) ? 0 : i) : i.firstChild), (f = g && g.childNodes.length);
                        while (f--) n.nodeName((k = g.childNodes[f]), "tbody") && !k.childNodes.length && g.removeChild(k);
                    }
                    n.merge(q, i.childNodes), (i.textContent = "");
                    while (i.firstChild) i.removeChild(i.firstChild);
                    i = p.lastChild;
                } else q.push(b.createTextNode(g));
        i && p.removeChild(i), l.appendChecked || n.grep(ea(q, "input"), ia), (r = 0);
        while ((g = q[r++]))
            if (d && n.inArray(g, d) > -1) e && e.push(g);
            else if (((h = n.contains(g.ownerDocument, g)), (i = ea(p.appendChild(g), "script")), h && fa(i), c)) {
                f = 0;
                while ((g = i[f++])) _.test(g.type || "") && c.push(g);
            }
        return (i = null), p;
    }
    !(function() {
        var b,
            c,
            e = d.createElement("div");
        for (b in { submit: !0, change: !0, focusin: !0 }) (c = "on" + b), (l[b] = c in a) || (e.setAttribute(c, "t"), (l[b] = e.attributes[c].expando === !1));
        e = null;
    })();
    var ka = /^(?:input|select|textarea)$/i,
        la = /^key/,
        ma = /^(?:mouse|pointer|contextmenu|drag|drop)|click/,
        na = /^(?:focusinfocus|focusoutblur)$/,
        oa = /^([^.]*)(?:\.(.+)|)/;
    function pa() {
        return !0;
    }
    function qa() {
        return !1;
    }
    function ra() {
        try {
            return d.activeElement;
        } catch (a) {}
    }
    function sa(a, b, c, d, e, f) {
        var g, h;
        if ("object" == typeof b) {
            "string" != typeof c && ((d = d || c), (c = void 0));
            for (h in b) sa(a, h, c, d, b[h], f);
            return a;
        }
        if ((null == d && null == e ? ((e = c), (d = c = void 0)) : null == e && ("string" == typeof c ? ((e = d), (d = void 0)) : ((e = d), (d = c), (c = void 0))), e === !1))
            e = qa;
        else if (!e) return a;
        return (
            1 === f &&
                ((g = e),
                (e = function(a) {
                    return n().off(a), g.apply(this, arguments);
                }),
                (e.guid = g.guid || (g.guid = n.guid++))),
            a.each(function() {
                n.event.add(this, b, e, d, c);
            })
        );
    }
    (n.event = {
        global: {},
        add: function(a, b, c, d, e) {
            var f,
                g,
                h,
                i,
                j,
                k,
                l,
                m,
                o,
                p,
                q,
                r = n._data(a);
            if (r) {
                c.handler && ((i = c), (c = i.handler), (e = i.selector)),
                    c.guid || (c.guid = n.guid++),
                    (g = r.events) || (g = r.events = {}),
                    (k = r.handle) ||
                        ((k = r.handle = function(a) {
                            return "undefined" == typeof n || (a && n.event.triggered === a.type) ? void 0 : n.event.dispatch.apply(k.elem, arguments);
                        }),
                        (k.elem = a)),
                    (b = (b || "").match(G) || [""]),
                    (h = b.length);
                while (h--)
                    (f = oa.exec(b[h]) || []),
                        (o = q = f[1]),
                        (p = (f[2] || "").split(".").sort()),
                        o &&
                            ((j = n.event.special[o] || {}),
                            (o = (e ? j.delegateType : j.bindType) || o),
                            (j = n.event.special[o] || {}),
                            (l = n.extend(
                                {
                                    type: o,
                                    origType: q,
                                    data: d,
                                    handler: c,
                                    guid: c.guid,
                                    selector: e,
                                    needsContext: e && n.expr.match.needsContext.test(e),
                                    namespace: p.join(".")
                                },
                                i
                            )),
                            (m = g[o]) ||
                                ((m = g[o] = []),
                                (m.delegateCount = 0),
                                (j.setup && j.setup.call(a, d, p, k) !== !1) || (a.addEventListener ? a.addEventListener(o, k, !1) : a.attachEvent && a.attachEvent("on" + o, k))),
                            j.add && (j.add.call(a, l), l.handler.guid || (l.handler.guid = c.guid)),
                            e ? m.splice(m.delegateCount++, 0, l) : m.push(l),
                            (n.event.global[o] = !0));
                a = null;
            }
        },
        remove: function(a, b, c, d, e) {
            var f,
                g,
                h,
                i,
                j,
                k,
                l,
                m,
                o,
                p,
                q,
                r = n.hasData(a) && n._data(a);
            if (r && (k = r.events)) {
                (b = (b || "").match(G) || [""]), (j = b.length);
                while (j--)
                    if (((h = oa.exec(b[j]) || []), (o = q = h[1]), (p = (h[2] || "").split(".").sort()), o)) {
                        (l = n.event.special[o] || {}),
                            (o = (d ? l.delegateType : l.bindType) || o),
                            (m = k[o] || []),
                            (h = h[2] && new RegExp("(^|\\.)" + p.join("\\.(?:.*\\.|)") + "(\\.|$)")),
                            (i = f = m.length);
                        while (f--)
                            (g = m[f]),
                                (!e && q !== g.origType) ||
                                    (c && c.guid !== g.guid) ||
                                    (h && !h.test(g.namespace)) ||
                                    (d && d !== g.selector && ("**" !== d || !g.selector)) ||
                                    (m.splice(f, 1), g.selector && m.delegateCount--, l.remove && l.remove.call(a, g));
                        i && !m.length && ((l.teardown && l.teardown.call(a, p, r.handle) !== !1) || n.removeEvent(a, o, r.handle), delete k[o]);
                    } else for (o in k) n.event.remove(a, o + b[j], c, d, !0);
                n.isEmptyObject(k) && (delete r.handle, n._removeData(a, "events"));
            }
        },
        trigger: function(b, c, e, f) {
            var g,
                h,
                i,
                j,
                l,
                m,
                o,
                p = [e || d],
                q = k.call(b, "type") ? b.type : b,
                r = k.call(b, "namespace") ? b.namespace.split(".") : [];
            if (
                ((i = m = e = e || d),
                3 !== e.nodeType &&
                    8 !== e.nodeType &&
                    !na.test(q + n.event.triggered) &&
                    (q.indexOf(".") > -1 && ((r = q.split(".")), (q = r.shift()), r.sort()),
                    (h = q.indexOf(":") < 0 && "on" + q),
                    (b = b[n.expando] ? b : new n.Event(q, "object" == typeof b && b)),
                    (b.isTrigger = f ? 2 : 3),
                    (b.namespace = r.join(".")),
                    (b.rnamespace = b.namespace ? new RegExp("(^|\\.)" + r.join("\\.(?:.*\\.|)") + "(\\.|$)") : null),
                    (b.result = void 0),
                    b.target || (b.target = e),
                    (c = null == c ? [b] : n.makeArray(c, [b])),
                    (l = n.event.special[q] || {}),
                    f || !l.trigger || l.trigger.apply(e, c) !== !1))
            ) {
                if (!f && !l.noBubble && !n.isWindow(e)) {
                    for (j = l.delegateType || q, na.test(j + q) || (i = i.parentNode); i; i = i.parentNode) p.push(i), (m = i);
                    m === (e.ownerDocument || d) && p.push(m.defaultView || m.parentWindow || a);
                }
                o = 0;
                while ((i = p[o++]) && !b.isPropagationStopped())
                    (b.type = o > 1 ? j : l.bindType || q),
                        (g = (n._data(i, "events") || {})[b.type] && n._data(i, "handle")),
                        g && g.apply(i, c),
                        (g = h && i[h]),
                        g && g.apply && M(i) && ((b.result = g.apply(i, c)), b.result === !1 && b.preventDefault());
                if (((b.type = q), !f && !b.isDefaultPrevented() && (!l._default || l._default.apply(p.pop(), c) === !1) && M(e) && h && e[q] && !n.isWindow(e))) {
                    (m = e[h]), m && (e[h] = null), (n.event.triggered = q);
                    try {
                        e[q]();
                    } catch (s) {}
                    (n.event.triggered = void 0), m && (e[h] = m);
                }
                return b.result;
            }
        },
        dispatch: function(a) {
            a = n.event.fix(a);
            var b,
                c,
                d,
                f,
                g,
                h = [],
                i = e.call(arguments),
                j = (n._data(this, "events") || {})[a.type] || [],
                k = n.event.special[a.type] || {};
            if (((i[0] = a), (a.delegateTarget = this), !k.preDispatch || k.preDispatch.call(this, a) !== !1)) {
                (h = n.event.handlers.call(this, a, j)), (b = 0);
                while ((f = h[b++]) && !a.isPropagationStopped()) {
                    (a.currentTarget = f.elem), (c = 0);
                    while ((g = f.handlers[c++]) && !a.isImmediatePropagationStopped())
                        (a.rnamespace && !a.rnamespace.test(g.namespace)) ||
                            ((a.handleObj = g),
                            (a.data = g.data),
                            (d = ((n.event.special[g.origType] || {}).handle || g.handler).apply(f.elem, i)),
                            void 0 !== d && (a.result = d) === !1 && (a.preventDefault(), a.stopPropagation()));
                }
                return k.postDispatch && k.postDispatch.call(this, a), a.result;
            }
        },
        handlers: function(a, b) {
            var c,
                d,
                e,
                f,
                g = [],
                h = b.delegateCount,
                i = a.target;
            if (h && i.nodeType && ("click" !== a.type || isNaN(a.button) || a.button < 1))
                for (; i != this; i = i.parentNode || this)
                    if (1 === i.nodeType && (i.disabled !== !0 || "click" !== a.type)) {
                        for (d = [], c = 0; h > c; c++)
                            (f = b[c]),
                                (e = f.selector + " "),
                                void 0 === d[e] && (d[e] = f.needsContext ? n(e, this).index(i) > -1 : n.find(e, this, null, [i]).length),
                                d[e] && d.push(f);
                        d.length && g.push({ elem: i, handlers: d });
                    }
            return h < b.length && g.push({ elem: this, handlers: b.slice(h) }), g;
        },
        fix: function(a) {
            if (a[n.expando]) return a;
            var b,
                c,
                e,
                f = a.type,
                g = a,
                h = this.fixHooks[f];
            h || (this.fixHooks[f] = h = ma.test(f) ? this.mouseHooks : la.test(f) ? this.keyHooks : {}),
                (e = h.props ? this.props.concat(h.props) : this.props),
                (a = new n.Event(g)),
                (b = e.length);
            while (b--) (c = e[b]), (a[c] = g[c]);
            return (
                a.target || (a.target = g.srcElement || d), 3 === a.target.nodeType && (a.target = a.target.parentNode), (a.metaKey = !!a.metaKey), h.filter ? h.filter(a, g) : a
            );
        },
        props: "altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),
        fixHooks: {},
        keyHooks: {
            props: "char charCode key keyCode".split(" "),
            filter: function(a, b) {
                return null == a.which && (a.which = null != b.charCode ? b.charCode : b.keyCode), a;
            }
        },
        mouseHooks: {
            props: "button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),
            filter: function(a, b) {
                var c,
                    e,
                    f,
                    g = b.button,
                    h = b.fromElement;
                return (
                    null == a.pageX &&
                        null != b.clientX &&
                        ((e = a.target.ownerDocument || d),
                        (f = e.documentElement),
                        (c = e.body),
                        (a.pageX = b.clientX + ((f && f.scrollLeft) || (c && c.scrollLeft) || 0) - ((f && f.clientLeft) || (c && c.clientLeft) || 0)),
                        (a.pageY = b.clientY + ((f && f.scrollTop) || (c && c.scrollTop) || 0) - ((f && f.clientTop) || (c && c.clientTop) || 0))),
                    !a.relatedTarget && h && (a.relatedTarget = h === a.target ? b.toElement : h),
                    a.which || void 0 === g || (a.which = 1 & g ? 1 : 2 & g ? 3 : 4 & g ? 2 : 0),
                    a
                );
            }
        },
        special: {
            load: { noBubble: !0 },
            focus: {
                trigger: function() {
                    if (this !== ra() && this.focus)
                        try {
                            return this.focus(), !1;
                        } catch (a) {}
                },
                delegateType: "focusin"
            },
            blur: {
                trigger: function() {
                    return this === ra() && this.blur ? (this.blur(), !1) : void 0;
                },
                delegateType: "focusout"
            },
            click: {
                trigger: function() {
                    return n.nodeName(this, "input") && "checkbox" === this.type && this.click ? (this.click(), !1) : void 0;
                },
                _default: function(a) {
                    return n.nodeName(a.target, "a");
                }
            },
            beforeunload: {
                postDispatch: function(a) {
                    void 0 !== a.result && a.originalEvent && (a.originalEvent.returnValue = a.result);
                }
            }
        },
        simulate: function(a, b, c) {
            var d = n.extend(new n.Event(), c, { type: a, isSimulated: !0 });
            n.event.trigger(d, null, b), d.isDefaultPrevented() && c.preventDefault();
        }
    }),
        (n.removeEvent = d.removeEventListener
            ? function(a, b, c) {
                  a.removeEventListener && a.removeEventListener(b, c);
              }
            : function(a, b, c) {
                  var d = "on" + b;
                  a.detachEvent && ("undefined" == typeof a[d] && (a[d] = null), a.detachEvent(d, c));
              }),
        (n.Event = function(a, b) {
            return this instanceof n.Event
                ? (a && a.type
                      ? ((this.originalEvent = a),
                        (this.type = a.type),
                        (this.isDefaultPrevented = a.defaultPrevented || (void 0 === a.defaultPrevented && a.returnValue === !1) ? pa : qa))
                      : (this.type = a),
                  b && n.extend(this, b),
                  (this.timeStamp = (a && a.timeStamp) || n.now()),
                  void (this[n.expando] = !0))
                : new n.Event(a, b);
        }),
        (n.Event.prototype = {
            constructor: n.Event,
            isDefaultPrevented: qa,
            isPropagationStopped: qa,
            isImmediatePropagationStopped: qa,
            preventDefault: function() {
                var a = this.originalEvent;
                (this.isDefaultPrevented = pa), a && (a.preventDefault ? a.preventDefault() : (a.returnValue = !1));
            },
            stopPropagation: function() {
                var a = this.originalEvent;
                (this.isPropagationStopped = pa), a && !this.isSimulated && (a.stopPropagation && a.stopPropagation(), (a.cancelBubble = !0));
            },
            stopImmediatePropagation: function() {
                var a = this.originalEvent;
                (this.isImmediatePropagationStopped = pa), a && a.stopImmediatePropagation && a.stopImmediatePropagation(), this.stopPropagation();
            }
        }),
        n.each({ mouseenter: "mouseover", mouseleave: "mouseout", pointerenter: "pointerover", pointerleave: "pointerout" }, function(a, b) {
            n.event.special[a] = {
                delegateType: b,
                bindType: b,
                handle: function(a) {
                    var c,
                        d = this,
                        e = a.relatedTarget,
                        f = a.handleObj;
                    return (e && (e === d || n.contains(d, e))) || ((a.type = f.origType), (c = f.handler.apply(this, arguments)), (a.type = b)), c;
                }
            };
        }),
        l.submit ||
            (n.event.special.submit = {
                setup: function() {
                    return n.nodeName(this, "form")
                        ? !1
                        : void n.event.add(this, "click._submit keypress._submit", function(a) {
                              var b = a.target,
                                  c = n.nodeName(b, "input") || n.nodeName(b, "button") ? n.prop(b, "form") : void 0;
                              c &&
                                  !n._data(c, "submit") &&
                                  (n.event.add(c, "submit._submit", function(a) {
                                      a._submitBubble = !0;
                                  }),
                                  n._data(c, "submit", !0));
                          });
                },
                postDispatch: function(a) {
                    a._submitBubble && (delete a._submitBubble, this.parentNode && !a.isTrigger && n.event.simulate("submit", this.parentNode, a));
                },
                teardown: function() {
                    return n.nodeName(this, "form") ? !1 : void n.event.remove(this, "._submit");
                }
            }),
        l.change ||
            (n.event.special.change = {
                setup: function() {
                    return ka.test(this.nodeName)
                        ? (("checkbox" !== this.type && "radio" !== this.type) ||
                              (n.event.add(this, "propertychange._change", function(a) {
                                  "checked" === a.originalEvent.propertyName && (this._justChanged = !0);
                              }),
                              n.event.add(this, "click._change", function(a) {
                                  this._justChanged && !a.isTrigger && (this._justChanged = !1), n.event.simulate("change", this, a);
                              })),
                          !1)
                        : void n.event.add(this, "beforeactivate._change", function(a) {
                              var b = a.target;
                              ka.test(b.nodeName) &&
                                  !n._data(b, "change") &&
                                  (n.event.add(b, "change._change", function(a) {
                                      !this.parentNode || a.isSimulated || a.isTrigger || n.event.simulate("change", this.parentNode, a);
                                  }),
                                  n._data(b, "change", !0));
                          });
                },
                handle: function(a) {
                    var b = a.target;
                    return this !== b || a.isSimulated || a.isTrigger || ("radio" !== b.type && "checkbox" !== b.type) ? a.handleObj.handler.apply(this, arguments) : void 0;
                },
                teardown: function() {
                    return n.event.remove(this, "._change"), !ka.test(this.nodeName);
                }
            }),
        l.focusin ||
            n.each({ focus: "focusin", blur: "focusout" }, function(a, b) {
                var c = function(a) {
                    n.event.simulate(b, a.target, n.event.fix(a));
                };
                n.event.special[b] = {
                    setup: function() {
                        var d = this.ownerDocument || this,
                            e = n._data(d, b);
                        e || d.addEventListener(a, c, !0), n._data(d, b, (e || 0) + 1);
                    },
                    teardown: function() {
                        var d = this.ownerDocument || this,
                            e = n._data(d, b) - 1;
                        e ? n._data(d, b, e) : (d.removeEventListener(a, c, !0), n._removeData(d, b));
                    }
                };
            }),
        n.fn.extend({
            on: function(a, b, c, d) {
                return sa(this, a, b, c, d);
            },
            one: function(a, b, c, d) {
                return sa(this, a, b, c, d, 1);
            },
            off: function(a, b, c) {
                var d, e;
                if (a && a.preventDefault && a.handleObj)
                    return (d = a.handleObj), n(a.delegateTarget).off(d.namespace ? d.origType + "." + d.namespace : d.origType, d.selector, d.handler), this;
                if ("object" == typeof a) {
                    for (e in a) this.off(e, b, a[e]);
                    return this;
                }
                return (
                    (b !== !1 && "function" != typeof b) || ((c = b), (b = void 0)),
                    c === !1 && (c = qa),
                    this.each(function() {
                        n.event.remove(this, a, c, b);
                    })
                );
            },
            trigger: function(a, b) {
                return this.each(function() {
                    n.event.trigger(a, b, this);
                });
            },
            triggerHandler: function(a, b) {
                var c = this[0];
                return c ? n.event.trigger(a, b, c, !0) : void 0;
            }
        });
    var ta = / jQuery\d+="(?:null|\d+)"/g,
        ua = new RegExp("<(?:" + ba + ")[\\s/>]", "i"),
        va = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,
        wa = /<script|<style|<link/i,
        xa = /checked\s*(?:[^=]|=\s*.checked.)/i,
        ya = /^true\/(.*)/,
        za = /^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,
        Aa = ca(d),
        Ba = Aa.appendChild(d.createElement("div"));
    function Ca(a, b) {
        return n.nodeName(a, "table") && n.nodeName(11 !== b.nodeType ? b : b.firstChild, "tr")
            ? a.getElementsByTagName("tbody")[0] || a.appendChild(a.ownerDocument.createElement("tbody"))
            : a;
    }
    function Da(a) {
        return (a.type = (null !== n.find.attr(a, "type")) + "/" + a.type), a;
    }
    function Ea(a) {
        var b = ya.exec(a.type);
        return b ? (a.type = b[1]) : a.removeAttribute("type"), a;
    }
    function Fa(a, b) {
        if (1 === b.nodeType && n.hasData(a)) {
            var c,
                d,
                e,
                f = n._data(a),
                g = n._data(b, f),
                h = f.events;
            if (h) {
                delete g.handle, (g.events = {});
                for (c in h) for (d = 0, e = h[c].length; e > d; d++) n.event.add(b, c, h[c][d]);
            }
            g.data && (g.data = n.extend({}, g.data));
        }
    }
    function Ga(a, b) {
        var c, d, e;
        if (1 === b.nodeType) {
            if (((c = b.nodeName.toLowerCase()), !l.noCloneEvent && b[n.expando])) {
                e = n._data(b);
                for (d in e.events) n.removeEvent(b, d, e.handle);
                b.removeAttribute(n.expando);
            }
            "script" === c && b.text !== a.text
                ? ((Da(b).text = a.text), Ea(b))
                : "object" === c
                ? (b.parentNode && (b.outerHTML = a.outerHTML), l.html5Clone && a.innerHTML && !n.trim(b.innerHTML) && (b.innerHTML = a.innerHTML))
                : "input" === c && Z.test(a.type)
                ? ((b.defaultChecked = b.checked = a.checked), b.value !== a.value && (b.value = a.value))
                : "option" === c
                ? (b.defaultSelected = b.selected = a.defaultSelected)
                : ("input" !== c && "textarea" !== c) || (b.defaultValue = a.defaultValue);
        }
    }
    function Ha(a, b, c, d) {
        b = f.apply([], b);
        var e,
            g,
            h,
            i,
            j,
            k,
            m = 0,
            o = a.length,
            p = o - 1,
            q = b[0],
            r = n.isFunction(q);
        if (r || (o > 1 && "string" == typeof q && !l.checkClone && xa.test(q)))
            return a.each(function(e) {
                var f = a.eq(e);
                r && (b[0] = q.call(this, e, f.html())), Ha(f, b, c, d);
            });
        if (o && ((k = ja(b, a[0].ownerDocument, !1, a, d)), (e = k.firstChild), 1 === k.childNodes.length && (k = e), e || d)) {
            for (i = n.map(ea(k, "script"), Da), h = i.length; o > m; m++) (g = k), m !== p && ((g = n.clone(g, !0, !0)), h && n.merge(i, ea(g, "script"))), c.call(a[m], g, m);
            if (h)
                for (j = i[i.length - 1].ownerDocument, n.map(i, Ea), m = 0; h > m; m++)
                    (g = i[m]),
                        _.test(g.type || "") &&
                            !n._data(g, "globalEval") &&
                            n.contains(j, g) &&
                            (g.src ? n._evalUrl && n._evalUrl(g.src) : n.globalEval((g.text || g.textContent || g.innerHTML || "").replace(za, "")));
            k = e = null;
        }
        return a;
    }
    function Ia(a, b, c) {
        for (var d, e = b ? n.filter(b, a) : a, f = 0; null != (d = e[f]); f++)
            c || 1 !== d.nodeType || n.cleanData(ea(d)), d.parentNode && (c && n.contains(d.ownerDocument, d) && fa(ea(d, "script")), d.parentNode.removeChild(d));
        return a;
    }
    n.extend({
        htmlPrefilter: function(a) {
            return a.replace(va, "<$1></$2>");
        },
        clone: function(a, b, c) {
            var d,
                e,
                f,
                g,
                h,
                i = n.contains(a.ownerDocument, a);
            if (
                (l.html5Clone || n.isXMLDoc(a) || !ua.test("<" + a.nodeName + ">") ? (f = a.cloneNode(!0)) : ((Ba.innerHTML = a.outerHTML), Ba.removeChild((f = Ba.firstChild))),
                !((l.noCloneEvent && l.noCloneChecked) || (1 !== a.nodeType && 11 !== a.nodeType) || n.isXMLDoc(a)))
            )
                for (d = ea(f), h = ea(a), g = 0; null != (e = h[g]); ++g) d[g] && Ga(e, d[g]);
            if (b)
                if (c) for (h = h || ea(a), d = d || ea(f), g = 0; null != (e = h[g]); g++) Fa(e, d[g]);
                else Fa(a, f);
            return (d = ea(f, "script")), d.length > 0 && fa(d, !i && ea(a, "script")), (d = h = e = null), f;
        },
        cleanData: function(a, b) {
            for (var d, e, f, g, h = 0, i = n.expando, j = n.cache, k = l.attributes, m = n.event.special; null != (d = a[h]); h++)
                if ((b || M(d)) && ((f = d[i]), (g = f && j[f]))) {
                    if (g.events) for (e in g.events) m[e] ? n.event.remove(d, e) : n.removeEvent(d, e, g.handle);
                    j[f] && (delete j[f], k || "undefined" == typeof d.removeAttribute ? (d[i] = void 0) : d.removeAttribute(i), c.push(f));
                }
        }
    }),
        n.fn.extend({
            domManip: Ha,
            detach: function(a) {
                return Ia(this, a, !0);
            },
            remove: function(a) {
                return Ia(this, a);
            },
            text: function(a) {
                return Y(
                    this,
                    function(a) {
                        return void 0 === a ? n.text(this) : this.empty().append(((this[0] && this[0].ownerDocument) || d).createTextNode(a));
                    },
                    null,
                    a,
                    arguments.length
                );
            },
            append: function() {
                return Ha(this, arguments, function(a) {
                    if (1 === this.nodeType || 11 === this.nodeType || 9 === this.nodeType) {
                        var b = Ca(this, a);
                        b.appendChild(a);
                    }
                });
            },
            prepend: function() {
                return Ha(this, arguments, function(a) {
                    if (1 === this.nodeType || 11 === this.nodeType || 9 === this.nodeType) {
                        var b = Ca(this, a);
                        b.insertBefore(a, b.firstChild);
                    }
                });
            },
            before: function() {
                return Ha(this, arguments, function(a) {
                    this.parentNode && this.parentNode.insertBefore(a, this);
                });
            },
            after: function() {
                return Ha(this, arguments, function(a) {
                    this.parentNode && this.parentNode.insertBefore(a, this.nextSibling);
                });
            },
            empty: function() {
                for (var a, b = 0; null != (a = this[b]); b++) {
                    1 === a.nodeType && n.cleanData(ea(a, !1));
                    while (a.firstChild) a.removeChild(a.firstChild);
                    a.options && n.nodeName(a, "select") && (a.options.length = 0);
                }
                return this;
            },
            clone: function(a, b) {
                return (
                    (a = null == a ? !1 : a),
                    (b = null == b ? a : b),
                    this.map(function() {
                        return n.clone(this, a, b);
                    })
                );
            },
            html: function(a) {
                return Y(
                    this,
                    function(a) {
                        var b = this[0] || {},
                            c = 0,
                            d = this.length;
                        if (void 0 === a) return 1 === b.nodeType ? b.innerHTML.replace(ta, "") : void 0;
                        if (
                            "string" == typeof a &&
                            !wa.test(a) &&
                            (l.htmlSerialize || !ua.test(a)) &&
                            (l.leadingWhitespace || !aa.test(a)) &&
                            !da[($.exec(a) || ["", ""])[1].toLowerCase()]
                        ) {
                            a = n.htmlPrefilter(a);
                            try {
                                for (; d > c; c++) (b = this[c] || {}), 1 === b.nodeType && (n.cleanData(ea(b, !1)), (b.innerHTML = a));
                                b = 0;
                            } catch (e) {}
                        }
                        b && this.empty().append(a);
                    },
                    null,
                    a,
                    arguments.length
                );
            },
            replaceWith: function() {
                var a = [];
                return Ha(
                    this,
                    arguments,
                    function(b) {
                        var c = this.parentNode;
                        n.inArray(this, a) < 0 && (n.cleanData(ea(this)), c && c.replaceChild(b, this));
                    },
                    a
                );
            }
        }),
        n.each({ appendTo: "append", prependTo: "prepend", insertBefore: "before", insertAfter: "after", replaceAll: "replaceWith" }, function(a, b) {
            n.fn[a] = function(a) {
                for (var c, d = 0, e = [], f = n(a), h = f.length - 1; h >= d; d++) (c = d === h ? this : this.clone(!0)), n(f[d])[b](c), g.apply(e, c.get());
                return this.pushStack(e);
            };
        });
    var Ja,
        Ka = { HTML: "block", BODY: "block" };
    function La(a, b) {
        var c = n(b.createElement(a)).appendTo(b.body),
            d = n.css(c[0], "display");
        return c.detach(), d;
    }
    function Ma(a) {
        var b = d,
            c = Ka[a];
        return (
            c ||
                ((c = La(a, b)),
                ("none" !== c && c) ||
                    ((Ja = (Ja || n("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement)),
                    (b = (Ja[0].contentWindow || Ja[0].contentDocument).document),
                    b.write(),
                    b.close(),
                    (c = La(a, b)),
                    Ja.detach()),
                (Ka[a] = c)),
            c
        );
    }
    var Na = /^margin/,
        Oa = new RegExp("^(" + T + ")(?!px)[a-z%]+$", "i"),
        Pa = function(a, b, c, d) {
            var e,
                f,
                g = {};
            for (f in b) (g[f] = a.style[f]), (a.style[f] = b[f]);
            e = c.apply(a, d || []);
            for (f in b) a.style[f] = g[f];
            return e;
        },
        Qa = d.documentElement;
    !(function() {
        var b,
            c,
            e,
            f,
            g,
            h,
            i = d.createElement("div"),
            j = d.createElement("div");
        if (j.style) {
            (j.style.cssText = "float:left;opacity:.5"),
                (l.opacity = "0.5" === j.style.opacity),
                (l.cssFloat = !!j.style.cssFloat),
                (j.style.backgroundClip = "content-box"),
                (j.cloneNode(!0).style.backgroundClip = ""),
                (l.clearCloneStyle = "content-box" === j.style.backgroundClip),
                (i = d.createElement("div")),
                (i.style.cssText = "border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute"),
                (j.innerHTML = ""),
                i.appendChild(j),
                (l.boxSizing = "" === j.style.boxSizing || "" === j.style.MozBoxSizing || "" === j.style.WebkitBoxSizing),
                n.extend(l, {
                    reliableHiddenOffsets: function() {
                        return null == b && k(), f;
                    },
                    boxSizingReliable: function() {
                        return null == b && k(), e;
                    },
                    pixelMarginRight: function() {
                        return null == b && k(), c;
                    },
                    pixelPosition: function() {
                        return null == b && k(), b;
                    },
                    reliableMarginRight: function() {
                        return null == b && k(), g;
                    },
                    reliableMarginLeft: function() {
                        return null == b && k(), h;
                    }
                });
            function k() {
                var k,
                    l,
                    m = d.documentElement;
                m.appendChild(i),
                    (j.style.cssText = "-webkit-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%"),
                    (b = e = h = !1),
                    (c = g = !0),
                    a.getComputedStyle &&
                        ((l = a.getComputedStyle(j)),
                        (b = "1%" !== (l || {}).top),
                        (h = "2px" === (l || {}).marginLeft),
                        (e = "4px" === (l || { width: "4px" }).width),
                        (j.style.marginRight = "50%"),
                        (c = "4px" === (l || { marginRight: "4px" }).marginRight),
                        (k = j.appendChild(d.createElement("div"))),
                        (k.style.cssText = j.style.cssText =
                            "-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0"),
                        (k.style.marginRight = k.style.width = "0"),
                        (j.style.width = "1px"),
                        (g = !parseFloat((a.getComputedStyle(k) || {}).marginRight)),
                        j.removeChild(k)),
                    (j.style.display = "none"),
                    (f = 0 === j.getClientRects().length),
                    f &&
                        ((j.style.display = ""),
                        (j.innerHTML = "<table><tr><td></td><td>t</td></tr></table>"),
                        (j.childNodes[0].style.borderCollapse = "separate"),
                        (k = j.getElementsByTagName("td")),
                        (k[0].style.cssText = "margin:0;border:0;padding:0;display:none"),
                        (f = 0 === k[0].offsetHeight),
                        f && ((k[0].style.display = ""), (k[1].style.display = "none"), (f = 0 === k[0].offsetHeight))),
                    m.removeChild(i);
            }
        }
    })();
    var Ra,
        Sa,
        Ta = /^(top|right|bottom|left)$/;
    a.getComputedStyle
        ? ((Ra = function(b) {
              var c = b.ownerDocument.defaultView;
              return (c && c.opener) || (c = a), c.getComputedStyle(b);
          }),
          (Sa = function(a, b, c) {
              var d,
                  e,
                  f,
                  g,
                  h = a.style;
              return (
                  (c = c || Ra(a)),
                  (g = c ? c.getPropertyValue(b) || c[b] : void 0),
                  ("" !== g && void 0 !== g) || n.contains(a.ownerDocument, a) || (g = n.style(a, b)),
                  c &&
                      !l.pixelMarginRight() &&
                      Oa.test(g) &&
                      Na.test(b) &&
                      ((d = h.width),
                      (e = h.minWidth),
                      (f = h.maxWidth),
                      (h.minWidth = h.maxWidth = h.width = g),
                      (g = c.width),
                      (h.width = d),
                      (h.minWidth = e),
                      (h.maxWidth = f)),
                  void 0 === g ? g : g + ""
              );
          }))
        : Qa.currentStyle &&
          ((Ra = function(a) {
              return a.currentStyle;
          }),
          (Sa = function(a, b, c) {
              var d,
                  e,
                  f,
                  g,
                  h = a.style;
              return (
                  (c = c || Ra(a)),
                  (g = c ? c[b] : void 0),
                  null == g && h && h[b] && (g = h[b]),
                  Oa.test(g) &&
                      !Ta.test(b) &&
                      ((d = h.left),
                      (e = a.runtimeStyle),
                      (f = e && e.left),
                      f && (e.left = a.currentStyle.left),
                      (h.left = "fontSize" === b ? "1em" : g),
                      (g = h.pixelLeft + "px"),
                      (h.left = d),
                      f && (e.left = f)),
                  void 0 === g ? g : g + "" || "auto"
              );
          }));
    function Ua(a, b) {
        return {
            get: function() {
                return a() ? void delete this.get : (this.get = b).apply(this, arguments);
            }
        };
    }
    var Va = /alpha\([^)]*\)/i,
        Wa = /opacity\s*=\s*([^)]*)/i,
        Xa = /^(none|table(?!-c[ea]).+)/,
        Ya = new RegExp("^(" + T + ")(.*)$", "i"),
        Za = { position: "absolute", visibility: "hidden", display: "block" },
        $a = { letterSpacing: "0", fontWeight: "400" },
        _a = ["Webkit", "O", "Moz", "ms"],
        ab = d.createElement("div").style;
    function bb(a) {
        if (a in ab) return a;
        var b = a.charAt(0).toUpperCase() + a.slice(1),
            c = _a.length;
        while (c--) if (((a = _a[c] + b), a in ab)) return a;
    }
    function cb(a, b) {
        for (var c, d, e, f = [], g = 0, h = a.length; h > g; g++)
            (d = a[g]),
                d.style &&
                    ((f[g] = n._data(d, "olddisplay")),
                    (c = d.style.display),
                    b
                        ? (f[g] || "none" !== c || (d.style.display = ""), "" === d.style.display && W(d) && (f[g] = n._data(d, "olddisplay", Ma(d.nodeName))))
                        : ((e = W(d)), ((c && "none" !== c) || !e) && n._data(d, "olddisplay", e ? c : n.css(d, "display"))));
        for (g = 0; h > g; g++) (d = a[g]), d.style && ((b && "none" !== d.style.display && "" !== d.style.display) || (d.style.display = b ? f[g] || "" : "none"));
        return a;
    }
    function db(a, b, c) {
        var d = Ya.exec(b);
        return d ? Math.max(0, d[1] - (c || 0)) + (d[2] || "px") : b;
    }
    function eb(a, b, c, d, e) {
        for (var f = c === (d ? "border" : "content") ? 4 : "width" === b ? 1 : 0, g = 0; 4 > f; f += 2)
            "margin" === c && (g += n.css(a, c + V[f], !0, e)),
                d
                    ? ("content" === c && (g -= n.css(a, "padding" + V[f], !0, e)), "margin" !== c && (g -= n.css(a, "border" + V[f] + "Width", !0, e)))
                    : ((g += n.css(a, "padding" + V[f], !0, e)), "padding" !== c && (g += n.css(a, "border" + V[f] + "Width", !0, e)));
        return g;
    }
    function fb(a, b, c) {
        var d = !0,
            e = "width" === b ? a.offsetWidth : a.offsetHeight,
            f = Ra(a),
            g = l.boxSizing && "border-box" === n.css(a, "boxSizing", !1, f);
        if (0 >= e || null == e) {
            if (((e = Sa(a, b, f)), (0 > e || null == e) && (e = a.style[b]), Oa.test(e))) return e;
            (d = g && (l.boxSizingReliable() || e === a.style[b])), (e = parseFloat(e) || 0);
        }
        return e + eb(a, b, c || (g ? "border" : "content"), d, f) + "px";
    }
    n.extend({
        cssHooks: {
            opacity: {
                get: function(a, b) {
                    if (b) {
                        var c = Sa(a, "opacity");
                        return "" === c ? "1" : c;
                    }
                }
            }
        },
        cssNumber: {
            animationIterationCount: !0,
            columnCount: !0,
            fillOpacity: !0,
            flexGrow: !0,
            flexShrink: !0,
            fontWeight: !0,
            lineHeight: !0,
            opacity: !0,
            order: !0,
            orphans: !0,
            widows: !0,
            zIndex: !0,
            zoom: !0
        },
        cssProps: { float: l.cssFloat ? "cssFloat" : "styleFloat" },
        style: function(a, b, c, d) {
            if (a && 3 !== a.nodeType && 8 !== a.nodeType && a.style) {
                var e,
                    f,
                    g,
                    h = n.camelCase(b),
                    i = a.style;
                if (((b = n.cssProps[h] || (n.cssProps[h] = bb(h) || h)), (g = n.cssHooks[b] || n.cssHooks[h]), void 0 === c))
                    return g && "get" in g && void 0 !== (e = g.get(a, !1, d)) ? e : i[b];
                if (
                    ((f = typeof c),
                    "string" === f && (e = U.exec(c)) && e[1] && ((c = X(a, b, e)), (f = "number")),
                    null != c &&
                        c === c &&
                        ("number" === f && (c += (e && e[3]) || (n.cssNumber[h] ? "" : "px")),
                        l.clearCloneStyle || "" !== c || 0 !== b.indexOf("background") || (i[b] = "inherit"),
                        !(g && "set" in g && void 0 === (c = g.set(a, c, d)))))
                )
                    try {
                        i[b] = c;
                    } catch (j) {}
            }
        },
        css: function(a, b, c, d) {
            var e,
                f,
                g,
                h = n.camelCase(b);
            return (
                (b = n.cssProps[h] || (n.cssProps[h] = bb(h) || h)),
                (g = n.cssHooks[b] || n.cssHooks[h]),
                g && "get" in g && (f = g.get(a, !0, c)),
                void 0 === f && (f = Sa(a, b, d)),
                "normal" === f && b in $a && (f = $a[b]),
                "" === c || c ? ((e = parseFloat(f)), c === !0 || isFinite(e) ? e || 0 : f) : f
            );
        }
    }),
        n.each(["height", "width"], function(a, b) {
            n.cssHooks[b] = {
                get: function(a, c, d) {
                    return c
                        ? Xa.test(n.css(a, "display")) && 0 === a.offsetWidth
                            ? Pa(a, Za, function() {
                                  return fb(a, b, d);
                              })
                            : fb(a, b, d)
                        : void 0;
                },
                set: function(a, c, d) {
                    var e = d && Ra(a);
                    return db(a, c, d ? eb(a, b, d, l.boxSizing && "border-box" === n.css(a, "boxSizing", !1, e), e) : 0);
                }
            };
        }),
        l.opacity ||
            (n.cssHooks.opacity = {
                get: function(a, b) {
                    return Wa.test((b && a.currentStyle ? a.currentStyle.filter : a.style.filter) || "") ? 0.01 * parseFloat(RegExp.$1) + "" : b ? "1" : "";
                },
                set: function(a, b) {
                    var c = a.style,
                        d = a.currentStyle,
                        e = n.isNumeric(b) ? "alpha(opacity=" + 100 * b + ")" : "",
                        f = (d && d.filter) || c.filter || "";
                    (c.zoom = 1),
                        ((b >= 1 || "" === b) && "" === n.trim(f.replace(Va, "")) && c.removeAttribute && (c.removeAttribute("filter"), "" === b || (d && !d.filter))) ||
                            (c.filter = Va.test(f) ? f.replace(Va, e) : f + " " + e);
                }
            }),
        (n.cssHooks.marginRight = Ua(l.reliableMarginRight, function(a, b) {
            return b ? Pa(a, { display: "inline-block" }, Sa, [a, "marginRight"]) : void 0;
        })),
        (n.cssHooks.marginLeft = Ua(l.reliableMarginLeft, function(a, b) {
            return b
                ? (parseFloat(Sa(a, "marginLeft")) ||
                      (n.contains(a.ownerDocument, a)
                          ? a.getBoundingClientRect().left -
                            Pa(
                                a,
                                {
                                    marginLeft: 0
                                },
                                function() {
                                    return a.getBoundingClientRect().left;
                                }
                            )
                          : 0)) + "px"
                : void 0;
        })),
        n.each({ margin: "", padding: "", border: "Width" }, function(a, b) {
            (n.cssHooks[a + b] = {
                expand: function(c) {
                    for (var d = 0, e = {}, f = "string" == typeof c ? c.split(" ") : [c]; 4 > d; d++) e[a + V[d] + b] = f[d] || f[d - 2] || f[0];
                    return e;
                }
            }),
                Na.test(a) || (n.cssHooks[a + b].set = db);
        }),
        n.fn.extend({
            css: function(a, b) {
                return Y(
                    this,
                    function(a, b, c) {
                        var d,
                            e,
                            f = {},
                            g = 0;
                        if (n.isArray(b)) {
                            for (d = Ra(a), e = b.length; e > g; g++) f[b[g]] = n.css(a, b[g], !1, d);
                            return f;
                        }
                        return void 0 !== c ? n.style(a, b, c) : n.css(a, b);
                    },
                    a,
                    b,
                    arguments.length > 1
                );
            },
            show: function() {
                return cb(this, !0);
            },
            hide: function() {
                return cb(this);
            },
            toggle: function(a) {
                return "boolean" == typeof a
                    ? a
                        ? this.show()
                        : this.hide()
                    : this.each(function() {
                          W(this) ? n(this).show() : n(this).hide();
                      });
            }
        });
    function gb(a, b, c, d, e) {
        return new gb.prototype.init(a, b, c, d, e);
    }
    (n.Tween = gb),
        (gb.prototype = {
            constructor: gb,
            init: function(a, b, c, d, e, f) {
                (this.elem = a),
                    (this.prop = c),
                    (this.easing = e || n.easing._default),
                    (this.options = b),
                    (this.start = this.now = this.cur()),
                    (this.end = d),
                    (this.unit = f || (n.cssNumber[c] ? "" : "px"));
            },
            cur: function() {
                var a = gb.propHooks[this.prop];
                return a && a.get ? a.get(this) : gb.propHooks._default.get(this);
            },
            run: function(a) {
                var b,
                    c = gb.propHooks[this.prop];
                return (
                    this.options.duration ? (this.pos = b = n.easing[this.easing](a, this.options.duration * a, 0, 1, this.options.duration)) : (this.pos = b = a),
                    (this.now = (this.end - this.start) * b + this.start),
                    this.options.step && this.options.step.call(this.elem, this.now, this),
                    c && c.set ? c.set(this) : gb.propHooks._default.set(this),
                    this
                );
            }
        }),
        (gb.prototype.init.prototype = gb.prototype),
        (gb.propHooks = {
            _default: {
                get: function(a) {
                    var b;
                    return 1 !== a.elem.nodeType || (null != a.elem[a.prop] && null == a.elem.style[a.prop])
                        ? a.elem[a.prop]
                        : ((b = n.css(a.elem, a.prop, "")), b && "auto" !== b ? b : 0);
                },
                set: function(a) {
                    n.fx.step[a.prop]
                        ? n.fx.step[a.prop](a)
                        : 1 !== a.elem.nodeType || (null == a.elem.style[n.cssProps[a.prop]] && !n.cssHooks[a.prop])
                        ? (a.elem[a.prop] = a.now)
                        : n.style(a.elem, a.prop, a.now + a.unit);
                }
            }
        }),
        (gb.propHooks.scrollTop = gb.propHooks.scrollLeft = {
            set: function(a) {
                a.elem.nodeType && a.elem.parentNode && (a.elem[a.prop] = a.now);
            }
        }),
        (n.easing = {
            linear: function(a) {
                return a;
            },
            swing: function(a) {
                return 0.5 - Math.cos(a * Math.PI) / 2;
            },
            _default: "swing"
        }),
        (n.fx = gb.prototype.init),
        (n.fx.step = {});
    var hb,
        ib,
        jb = /^(?:toggle|show|hide)$/,
        kb = /queueHooks$/;
    function lb() {
        return (
            a.setTimeout(function() {
                hb = void 0;
            }),
            (hb = n.now())
        );
    }
    function mb(a, b) {
        var c,
            d = { height: a },
            e = 0;
        for (b = b ? 1 : 0; 4 > e; e += 2 - b) (c = V[e]), (d["margin" + c] = d["padding" + c] = a);
        return b && (d.opacity = d.width = a), d;
    }
    function nb(a, b, c) {
        for (var d, e = (qb.tweeners[b] || []).concat(qb.tweeners["*"]), f = 0, g = e.length; g > f; f++) if ((d = e[f].call(c, b, a))) return d;
    }
    function ob(a, b, c) {
        var d,
            e,
            f,
            g,
            h,
            i,
            j,
            k,
            m = this,
            o = {},
            p = a.style,
            q = a.nodeType && W(a),
            r = n._data(a, "fxshow");
        c.queue ||
            ((h = n._queueHooks(a, "fx")),
            null == h.unqueued &&
                ((h.unqueued = 0),
                (i = h.empty.fire),
                (h.empty.fire = function() {
                    h.unqueued || i();
                })),
            h.unqueued++,
            m.always(function() {
                m.always(function() {
                    h.unqueued--, n.queue(a, "fx").length || h.empty.fire();
                });
            })),
            1 === a.nodeType &&
                ("height" in b || "width" in b) &&
                ((c.overflow = [p.overflow, p.overflowX, p.overflowY]),
                (j = n.css(a, "display")),
                (k = "none" === j ? n._data(a, "olddisplay") || Ma(a.nodeName) : j),
                "inline" === k && "none" === n.css(a, "float") && (l.inlineBlockNeedsLayout && "inline" !== Ma(a.nodeName) ? (p.zoom = 1) : (p.display = "inline-block"))),
            c.overflow &&
                ((p.overflow = "hidden"),
                l.shrinkWrapBlocks() ||
                    m.always(function() {
                        (p.overflow = c.overflow[0]), (p.overflowX = c.overflow[1]), (p.overflowY = c.overflow[2]);
                    }));
        for (d in b)
            if (((e = b[d]), jb.exec(e))) {
                if ((delete b[d], (f = f || "toggle" === e), e === (q ? "hide" : "show"))) {
                    if ("show" !== e || !r || void 0 === r[d]) continue;
                    q = !0;
                }
                o[d] = (r && r[d]) || n.style(a, d);
            } else j = void 0;
        if (n.isEmptyObject(o)) "inline" === ("none" === j ? Ma(a.nodeName) : j) && (p.display = j);
        else {
            r ? "hidden" in r && (q = r.hidden) : (r = n._data(a, "fxshow", {})),
                f && (r.hidden = !q),
                q
                    ? n(a).show()
                    : m.done(function() {
                          n(a).hide();
                      }),
                m.done(function() {
                    var b;
                    n._removeData(a, "fxshow");
                    for (b in o) n.style(a, b, o[b]);
                });
            for (d in o) (g = nb(q ? r[d] : 0, d, m)), d in r || ((r[d] = g.start), q && ((g.end = g.start), (g.start = "width" === d || "height" === d ? 1 : 0)));
        }
    }
    function pb(a, b) {
        var c, d, e, f, g;
        for (c in a)
            if (
                ((d = n.camelCase(c)),
                (e = b[d]),
                (f = a[c]),
                n.isArray(f) && ((e = f[1]), (f = a[c] = f[0])),
                c !== d && ((a[d] = f), delete a[c]),
                (g = n.cssHooks[d]),
                g && "expand" in g)
            ) {
                (f = g.expand(f)), delete a[d];
                for (c in f) c in a || ((a[c] = f[c]), (b[c] = e));
            } else b[d] = e;
    }
    function qb(a, b, c) {
        var d,
            e,
            f = 0,
            g = qb.prefilters.length,
            h = n.Deferred().always(function() {
                delete i.elem;
            }),
            i = function() {
                if (e) return !1;
                for (var b = hb || lb(), c = Math.max(0, j.startTime + j.duration - b), d = c / j.duration || 0, f = 1 - d, g = 0, i = j.tweens.length; i > g; g++)
                    j.tweens[g].run(f);
                return h.notifyWith(a, [j, f, c]), 1 > f && i ? c : (h.resolveWith(a, [j]), !1);
            },
            j = h.promise({
                elem: a,
                props: n.extend({}, b),
                opts: n.extend(!0, { specialEasing: {}, easing: n.easing._default }, c),
                originalProperties: b,
                originalOptions: c,
                startTime: hb || lb(),
                duration: c.duration,
                tweens: [],
                createTween: function(b, c) {
                    var d = n.Tween(a, j.opts, b, c, j.opts.specialEasing[b] || j.opts.easing);
                    return j.tweens.push(d), d;
                },
                stop: function(b) {
                    var c = 0,
                        d = b ? j.tweens.length : 0;
                    if (e) return this;
                    for (e = !0; d > c; c++) j.tweens[c].run(1);
                    return b ? (h.notifyWith(a, [j, 1, 0]), h.resolveWith(a, [j, b])) : h.rejectWith(a, [j, b]), this;
                }
            }),
            k = j.props;
        for (pb(k, j.opts.specialEasing); g > f; f++)
            if ((d = qb.prefilters[f].call(j, a, k, j.opts))) return n.isFunction(d.stop) && (n._queueHooks(j.elem, j.opts.queue).stop = n.proxy(d.stop, d)), d;
        return (
            n.map(k, nb, j),
            n.isFunction(j.opts.start) && j.opts.start.call(a, j),
            n.fx.timer(n.extend(i, { elem: a, anim: j, queue: j.opts.queue })),
            j
                .progress(j.opts.progress)
                .done(j.opts.done, j.opts.complete)
                .fail(j.opts.fail)
                .always(j.opts.always)
        );
    }
    (n.Animation = n.extend(qb, {
        tweeners: {
            "*": [
                function(a, b) {
                    var c = this.createTween(a, b);
                    return X(c.elem, a, U.exec(b), c), c;
                }
            ]
        },
        tweener: function(a, b) {
            n.isFunction(a) ? ((b = a), (a = ["*"])) : (a = a.match(G));
            for (var c, d = 0, e = a.length; e > d; d++) (c = a[d]), (qb.tweeners[c] = qb.tweeners[c] || []), qb.tweeners[c].unshift(b);
        },
        prefilters: [ob],
        prefilter: function(a, b) {
            b ? qb.prefilters.unshift(a) : qb.prefilters.push(a);
        }
    })),
        (n.speed = function(a, b, c) {
            var d =
                a && "object" == typeof a ? n.extend({}, a) : { complete: c || (!c && b) || (n.isFunction(a) && a), duration: a, easing: (c && b) || (b && !n.isFunction(b) && b) };
            return (
                (d.duration = n.fx.off ? 0 : "number" == typeof d.duration ? d.duration : d.duration in n.fx.speeds ? n.fx.speeds[d.duration] : n.fx.speeds._default),
                (null != d.queue && d.queue !== !0) || (d.queue = "fx"),
                (d.old = d.complete),
                (d.complete = function() {
                    n.isFunction(d.old) && d.old.call(this), d.queue && n.dequeue(this, d.queue);
                }),
                d
            );
        }),
        n.fn.extend({
            fadeTo: function(a, b, c, d) {
                return this.filter(W)
                    .css("opacity", 0)
                    .show()
                    .end()
                    .animate({ opacity: b }, a, c, d);
            },
            animate: function(a, b, c, d) {
                var e = n.isEmptyObject(a),
                    f = n.speed(b, c, d),
                    g = function() {
                        var b = qb(this, n.extend({}, a), f);
                        (e || n._data(this, "finish")) && b.stop(!0);
                    };
                return (g.finish = g), e || f.queue === !1 ? this.each(g) : this.queue(f.queue, g);
            },
            stop: function(a, b, c) {
                var d = function(a) {
                    var b = a.stop;
                    delete a.stop, b(c);
                };
                return (
                    "string" != typeof a && ((c = b), (b = a), (a = void 0)),
                    b && a !== !1 && this.queue(a || "fx", []),
                    this.each(function() {
                        var b = !0,
                            e = null != a && a + "queueHooks",
                            f = n.timers,
                            g = n._data(this);
                        if (e) g[e] && g[e].stop && d(g[e]);
                        else for (e in g) g[e] && g[e].stop && kb.test(e) && d(g[e]);
                        for (e = f.length; e--; ) f[e].elem !== this || (null != a && f[e].queue !== a) || (f[e].anim.stop(c), (b = !1), f.splice(e, 1));
                        (!b && c) || n.dequeue(this, a);
                    })
                );
            },
            finish: function(a) {
                return (
                    a !== !1 && (a = a || "fx"),
                    this.each(function() {
                        var b,
                            c = n._data(this),
                            d = c[a + "queue"],
                            e = c[a + "queueHooks"],
                            f = n.timers,
                            g = d ? d.length : 0;
                        for (c.finish = !0, n.queue(this, a, []), e && e.stop && e.stop.call(this, !0), b = f.length; b--; )
                            f[b].elem === this && f[b].queue === a && (f[b].anim.stop(!0), f.splice(b, 1));
                        for (b = 0; g > b; b++) d[b] && d[b].finish && d[b].finish.call(this);
                        delete c.finish;
                    })
                );
            }
        }),
        n.each(["toggle", "show", "hide"], function(a, b) {
            var c = n.fn[b];
            n.fn[b] = function(a, d, e) {
                return null == a || "boolean" == typeof a ? c.apply(this, arguments) : this.animate(mb(b, !0), a, d, e);
            };
        }),
        n.each(
            { slideDown: mb("show"), slideUp: mb("hide"), slideToggle: mb("toggle"), fadeIn: { opacity: "show" }, fadeOut: { opacity: "hide" }, fadeToggle: { opacity: "toggle" } },
            function(a, b) {
                n.fn[a] = function(a, c, d) {
                    return this.animate(b, a, c, d);
                };
            }
        ),
        (n.timers = []),
        (n.fx.tick = function() {
            var a,
                b = n.timers,
                c = 0;
            for (hb = n.now(); c < b.length; c++) (a = b[c]), a() || b[c] !== a || b.splice(c--, 1);
            b.length || n.fx.stop(), (hb = void 0);
        }),
        (n.fx.timer = function(a) {
            n.timers.push(a), a() ? n.fx.start() : n.timers.pop();
        }),
        (n.fx.interval = 13),
        (n.fx.start = function() {
            ib || (ib = a.setInterval(n.fx.tick, n.fx.interval));
        }),
        (n.fx.stop = function() {
            a.clearInterval(ib), (ib = null);
        }),
        (n.fx.speeds = { slow: 600, fast: 200, _default: 400 }),
        (n.fn.delay = function(b, c) {
            return (
                (b = n.fx ? n.fx.speeds[b] || b : b),
                (c = c || "fx"),
                this.queue(c, function(c, d) {
                    var e = a.setTimeout(c, b);
                    d.stop = function() {
                        a.clearTimeout(e);
                    };
                })
            );
        }),
        (function() {
            var a,
                b = d.createElement("input"),
                c = d.createElement("div"),
                e = d.createElement("select"),
                f = e.appendChild(d.createElement("option"));
            (c = d.createElement("div")),
                c.setAttribute("className", "t"),
                (c.innerHTML = "  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>"),
                (a = c.getElementsByTagName("a")[0]),
                b.setAttribute("type", "checkbox"),
                c.appendChild(b),
                (a = c.getElementsByTagName("a")[0]),
                (a.style.cssText = "top:1px"),
                (l.getSetAttribute = "t" !== c.className),
                (l.style = /top/.test(a.getAttribute("style"))),
                (l.hrefNormalized = "/a" === a.getAttribute("href")),
                (l.checkOn = !!b.value),
                (l.optSelected = f.selected),
                (l.enctype = !!d.createElement("form").enctype),
                (e.disabled = !0),
                (l.optDisabled = !f.disabled),
                (b = d.createElement("input")),
                b.setAttribute("value", ""),
                (l.input = "" === b.getAttribute("value")),
                (b.value = "t"),
                b.setAttribute("type", "radio"),
                (l.radioValue = "t" === b.value);
        })();
    var rb = /\r/g,
        sb = /[\x20\t\r\n\f]+/g;
    n.fn.extend({
        val: function(a) {
            var b,
                c,
                d,
                e = this[0];
            {
                if (arguments.length)
                    return (
                        (d = n.isFunction(a)),
                        this.each(function(c) {
                            var e;
                            1 === this.nodeType &&
                                ((e = d ? a.call(this, c, n(this).val()) : a),
                                null == e
                                    ? (e = "")
                                    : "number" == typeof e
                                    ? (e += "")
                                    : n.isArray(e) &&
                                      (e = n.map(e, function(a) {
                                          return null == a ? "" : a + "";
                                      })),
                                (b = n.valHooks[this.type] || n.valHooks[this.nodeName.toLowerCase()]),
                                (b && "set" in b && void 0 !== b.set(this, e, "value")) || (this.value = e));
                        })
                    );
                if (e)
                    return (
                        (b = n.valHooks[e.type] || n.valHooks[e.nodeName.toLowerCase()]),
                        b && "get" in b && void 0 !== (c = b.get(e, "value")) ? c : ((c = e.value), "string" == typeof c ? c.replace(rb, "") : null == c ? "" : c)
                    );
            }
        }
    }),
        n.extend({
            valHooks: {
                option: {
                    get: function(a) {
                        var b = n.find.attr(a, "value");
                        return null != b ? b : n.trim(n.text(a)).replace(sb, " ");
                    }
                },
                select: {
                    get: function(a) {
                        for (
                            var b,
                                c,
                                d = a.options,
                                e = a.selectedIndex,
                                f = "select-one" === a.type || 0 > e,
                                g = f ? null : [],
                                h = f ? e + 1 : d.length,
                                i = 0 > e ? h : f ? e : 0;
                            h > i;
                            i++
                        )
                            if (
                                ((c = d[i]),
                                (c.selected || i === e) &&
                                    (l.optDisabled ? !c.disabled : null === c.getAttribute("disabled")) &&
                                    (!c.parentNode.disabled || !n.nodeName(c.parentNode, "optgroup")))
                            ) {
                                if (((b = n(c).val()), f)) return b;
                                g.push(b);
                            }
                        return g;
                    },
                    set: function(a, b) {
                        var c,
                            d,
                            e = a.options,
                            f = n.makeArray(b),
                            g = e.length;
                        while (g--)
                            if (((d = e[g]), n.inArray(n.valHooks.option.get(d), f) > -1))
                                try {
                                    d.selected = c = !0;
                                } catch (h) {
                                    d.scrollHeight;
                                }
                            else d.selected = !1;
                        return c || (a.selectedIndex = -1), e;
                    }
                }
            }
        }),
        n.each(["radio", "checkbox"], function() {
            (n.valHooks[this] = {
                set: function(a, b) {
                    return n.isArray(b) ? (a.checked = n.inArray(n(a).val(), b) > -1) : void 0;
                }
            }),
                l.checkOn ||
                    (n.valHooks[this].get = function(a) {
                        return null === a.getAttribute("value") ? "on" : a.value;
                    });
        });
    var tb,
        ub,
        vb = n.expr.attrHandle,
        wb = /^(?:checked|selected)$/i,
        xb = l.getSetAttribute,
        yb = l.input;
    n.fn.extend({
        attr: function(a, b) {
            return Y(this, n.attr, a, b, arguments.length > 1);
        },
        removeAttr: function(a) {
            return this.each(function() {
                n.removeAttr(this, a);
            });
        }
    }),
        n.extend({
            attr: function(a, b, c) {
                var d,
                    e,
                    f = a.nodeType;
                if (3 !== f && 8 !== f && 2 !== f)
                    return "undefined" == typeof a.getAttribute
                        ? n.prop(a, b, c)
                        : ((1 === f && n.isXMLDoc(a)) || ((b = b.toLowerCase()), (e = n.attrHooks[b] || (n.expr.match.bool.test(b) ? ub : tb))),
                          void 0 !== c
                              ? null === c
                                  ? void n.removeAttr(a, b)
                                  : e && "set" in e && void 0 !== (d = e.set(a, c, b))
                                  ? d
                                  : (a.setAttribute(b, c + ""), c)
                              : e && "get" in e && null !== (d = e.get(a, b))
                              ? d
                              : ((d = n.find.attr(a, b)), null == d ? void 0 : d));
            },
            attrHooks: {
                type: {
                    set: function(a, b) {
                        if (!l.radioValue && "radio" === b && n.nodeName(a, "input")) {
                            var c = a.value;
                            return a.setAttribute("type", b), c && (a.value = c), b;
                        }
                    }
                }
            },
            removeAttr: function(a, b) {
                var c,
                    d,
                    e = 0,
                    f = b && b.match(G);
                if (f && 1 === a.nodeType)
                    while ((c = f[e++]))
                        (d = n.propFix[c] || c),
                            n.expr.match.bool.test(c) ? ((yb && xb) || !wb.test(c) ? (a[d] = !1) : (a[n.camelCase("default-" + c)] = a[d] = !1)) : n.attr(a, c, ""),
                            a.removeAttribute(xb ? c : d);
            }
        }),
        (ub = {
            set: function(a, b, c) {
                return b === !1 ? n.removeAttr(a, c) : (yb && xb) || !wb.test(c) ? a.setAttribute((!xb && n.propFix[c]) || c, c) : (a[n.camelCase("default-" + c)] = a[c] = !0), c;
            }
        }),
        n.each(n.expr.match.bool.source.match(/\w+/g), function(a, b) {
            var c = vb[b] || n.find.attr;
            (yb && xb) || !wb.test(b)
                ? (vb[b] = function(a, b, d) {
                      var e, f;
                      return d || ((f = vb[b]), (vb[b] = e), (e = null != c(a, b, d) ? b.toLowerCase() : null), (vb[b] = f)), e;
                  })
                : (vb[b] = function(a, b, c) {
                      return c ? void 0 : a[n.camelCase("default-" + b)] ? b.toLowerCase() : null;
                  });
        }),
        (yb && xb) ||
            (n.attrHooks.value = {
                set: function(a, b, c) {
                    return n.nodeName(a, "input") ? void (a.defaultValue = b) : tb && tb.set(a, b, c);
                }
            }),
        xb ||
            ((tb = {
                set: function(a, b, c) {
                    var d = a.getAttributeNode(c);
                    return d || a.setAttributeNode((d = a.ownerDocument.createAttribute(c))), (d.value = b += ""), "value" === c || b === a.getAttribute(c) ? b : void 0;
                }
            }),
            (vb.id = vb.name = vb.coords = function(a, b, c) {
                var d;
                return c ? void 0 : (d = a.getAttributeNode(b)) && "" !== d.value ? d.value : null;
            }),
            (n.valHooks.button = {
                get: function(a, b) {
                    var c = a.getAttributeNode(b);
                    return c && c.specified ? c.value : void 0;
                },
                set: tb.set
            }),
            (n.attrHooks.contenteditable = {
                set: function(a, b, c) {
                    tb.set(a, "" === b ? !1 : b, c);
                }
            }),
            n.each(["width", "height"], function(a, b) {
                n.attrHooks[b] = {
                    set: function(a, c) {
                        return "" === c ? (a.setAttribute(b, "auto"), c) : void 0;
                    }
                };
            })),
        l.style ||
            (n.attrHooks.style = {
                get: function(a) {
                    return a.style.cssText || void 0;
                },
                set: function(a, b) {
                    return (a.style.cssText = b + "");
                }
            });
    var zb = /^(?:input|select|textarea|button|object)$/i,
        Ab = /^(?:a|area)$/i;
    n.fn.extend({
        prop: function(a, b) {
            return Y(this, n.prop, a, b, arguments.length > 1);
        },
        removeProp: function(a) {
            return (
                (a = n.propFix[a] || a),
                this.each(function() {
                    try {
                        (this[a] = void 0), delete this[a];
                    } catch (b) {}
                })
            );
        }
    }),
        n.extend({
            prop: function(a, b, c) {
                var d,
                    e,
                    f = a.nodeType;
                if (3 !== f && 8 !== f && 2 !== f)
                    return (
                        (1 === f && n.isXMLDoc(a)) || ((b = n.propFix[b] || b), (e = n.propHooks[b])),
                        void 0 !== c ? (e && "set" in e && void 0 !== (d = e.set(a, c, b)) ? d : (a[b] = c)) : e && "get" in e && null !== (d = e.get(a, b)) ? d : a[b]
                    );
            },
            propHooks: {
                tabIndex: {
                    get: function(a) {
                        var b = n.find.attr(a, "tabindex");
                        return b ? parseInt(b, 10) : zb.test(a.nodeName) || (Ab.test(a.nodeName) && a.href) ? 0 : -1;
                    }
                }
            },
            propFix: { for: "htmlFor", class: "className" }
        }),
        l.hrefNormalized ||
            n.each(["href", "src"], function(a, b) {
                n.propHooks[b] = {
                    get: function(a) {
                        return a.getAttribute(b, 4);
                    }
                };
            }),
        l.optSelected ||
            (n.propHooks.selected = {
                get: function(a) {
                    var b = a.parentNode;
                    return b && (b.selectedIndex, b.parentNode && b.parentNode.selectedIndex), null;
                },
                set: function(a) {
                    var b = a.parentNode;
                    b && (b.selectedIndex, b.parentNode && b.parentNode.selectedIndex);
                }
            }),
        n.each(["tabIndex", "readOnly", "maxLength", "cellSpacing", "cellPadding", "rowSpan", "colSpan", "useMap", "frameBorder", "contentEditable"], function() {
            n.propFix[this.toLowerCase()] = this;
        }),
        l.enctype || (n.propFix.enctype = "encoding");
    var Bb = /[\t\r\n\f]/g;
    function Cb(a) {
        return n.attr(a, "class") || "";
    }
    n.fn.extend({
        addClass: function(a) {
            var b,
                c,
                d,
                e,
                f,
                g,
                h,
                i = 0;
            if (n.isFunction(a))
                return this.each(function(b) {
                    n(this).addClass(a.call(this, b, Cb(this)));
                });
            if ("string" == typeof a && a) {
                b = a.match(G) || [];
                while ((c = this[i++]))
                    if (((e = Cb(c)), (d = 1 === c.nodeType && (" " + e + " ").replace(Bb, " ")))) {
                        g = 0;
                        while ((f = b[g++])) d.indexOf(" " + f + " ") < 0 && (d += f + " ");
                        (h = n.trim(d)), e !== h && n.attr(c, "class", h);
                    }
            }
            return this;
        },
        removeClass: function(a) {
            var b,
                c,
                d,
                e,
                f,
                g,
                h,
                i = 0;
            if (n.isFunction(a))
                return this.each(function(b) {
                    n(this).removeClass(a.call(this, b, Cb(this)));
                });
            if (!arguments.length) return this.attr("class", "");
            if ("string" == typeof a && a) {
                b = a.match(G) || [];
                while ((c = this[i++]))
                    if (((e = Cb(c)), (d = 1 === c.nodeType && (" " + e + " ").replace(Bb, " ")))) {
                        g = 0;
                        while ((f = b[g++])) while (d.indexOf(" " + f + " ") > -1) d = d.replace(" " + f + " ", " ");
                        (h = n.trim(d)), e !== h && n.attr(c, "class", h);
                    }
            }
            return this;
        },
        toggleClass: function(a, b) {
            var c = typeof a;
            return "boolean" == typeof b && "string" === c
                ? b
                    ? this.addClass(a)
                    : this.removeClass(a)
                : n.isFunction(a)
                ? this.each(function(c) {
                      n(this).toggleClass(a.call(this, c, Cb(this), b), b);
                  })
                : this.each(function() {
                      var b, d, e, f;
                      if ("string" === c) {
                          (d = 0), (e = n(this)), (f = a.match(G) || []);
                          while ((b = f[d++])) e.hasClass(b) ? e.removeClass(b) : e.addClass(b);
                      } else (void 0 !== a && "boolean" !== c) || ((b = Cb(this)), b && n._data(this, "__className__", b), n.attr(this, "class", b || a === !1 ? "" : n._data(this, "__className__") || ""));
                  });
        },
        hasClass: function(a) {
            var b,
                c,
                d = 0;
            b = " " + a + " ";
            while ((c = this[d++])) if (1 === c.nodeType && (" " + Cb(c) + " ").replace(Bb, " ").indexOf(b) > -1) return !0;
            return !1;
        }
    }),
        n.each(
            "blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(
                " "
            ),
            function(a, b) {
                n.fn[b] = function(a, c) {
                    return arguments.length > 0 ? this.on(b, null, a, c) : this.trigger(b);
                };
            }
        ),
        n.fn.extend({
            hover: function(a, b) {
                return this.mouseenter(a).mouseleave(b || a);
            }
        });
    var Db = a.location,
        Eb = n.now(),
        Fb = /\?/,
        Gb = /(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;
    (n.parseJSON = function(b) {
        if (a.JSON && a.JSON.parse) return a.JSON.parse(b + "");
        var c,
            d = null,
            e = n.trim(b + "");
        return e &&
            !n.trim(
                e.replace(Gb, function(a, b, e, f) {
                    return c && b && (d = 0), 0 === d ? a : ((c = e || b), (d += !f - !e), "");
                })
            )
            ? Function("return " + e)()
            : n.error("Invalid JSON: " + b);
    }),
        (n.parseXML = function(b) {
            var c, d;
            if (!b || "string" != typeof b) return null;
            try {
                a.DOMParser
                    ? ((d = new a.DOMParser()), (c = d.parseFromString(b, "text/xml")))
                    : ((c = new a.ActiveXObject("Microsoft.XMLDOM")), (c.async = "false"), c.loadXML(b));
            } catch (e) {
                c = void 0;
            }
            return (c && c.documentElement && !c.getElementsByTagName("parsererror").length) || n.error("Invalid XML: " + b), c;
        });
    var Hb = /#.*$/,
        Ib = /([?&])_=[^&]*/,
        Jb = /^(.*?):[ \t]*([^\r\n]*)\r?$/gm,
        Kb = /^(?:about|app|app-storage|.+-extension|file|res|widget):$/,
        Lb = /^(?:GET|HEAD)$/,
        Mb = /^\/\//,
        Nb = /^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,
        Ob = {},
        Pb = {},
        Qb = "*/".concat("*"),
        Rb = Db.href,
        Sb = Nb.exec(Rb.toLowerCase()) || [];
    function Tb(a) {
        return function(b, c) {
            "string" != typeof b && ((c = b), (b = "*"));
            var d,
                e = 0,
                f = b.toLowerCase().match(G) || [];
            if (n.isFunction(c)) while ((d = f[e++])) "+" === d.charAt(0) ? ((d = d.slice(1) || "*"), (a[d] = a[d] || []).unshift(c)) : (a[d] = a[d] || []).push(c);
        };
    }
    function Ub(a, b, c, d) {
        var e = {},
            f = a === Pb;
        function g(h) {
            var i;
            return (
                (e[h] = !0),
                n.each(a[h] || [], function(a, h) {
                    var j = h(b, c, d);
                    return "string" != typeof j || f || e[j] ? (f ? !(i = j) : void 0) : (b.dataTypes.unshift(j), g(j), !1);
                }),
                i
            );
        }
        return g(b.dataTypes[0]) || (!e["*"] && g("*"));
    }
    function Vb(a, b) {
        var c,
            d,
            e = n.ajaxSettings.flatOptions || {};
        for (d in b) void 0 !== b[d] && ((e[d] ? a : c || (c = {}))[d] = b[d]);
        return c && n.extend(!0, a, c), a;
    }
    function Wb(a, b, c) {
        var d,
            e,
            f,
            g,
            h = a.contents,
            i = a.dataTypes;
        while ("*" === i[0]) i.shift(), void 0 === e && (e = a.mimeType || b.getResponseHeader("Content-Type"));
        if (e)
            for (g in h)
                if (h[g] && h[g].test(e)) {
                    i.unshift(g);
                    break;
                }
        if (i[0] in c) f = i[0];
        else {
            for (g in c) {
                if (!i[0] || a.converters[g + " " + i[0]]) {
                    f = g;
                    break;
                }
                d || (d = g);
            }
            f = f || d;
        }
        return f ? (f !== i[0] && i.unshift(f), c[f]) : void 0;
    }
    function Xb(a, b, c, d) {
        var e,
            f,
            g,
            h,
            i,
            j = {},
            k = a.dataTypes.slice();
        if (k[1]) for (g in a.converters) j[g.toLowerCase()] = a.converters[g];
        f = k.shift();
        while (f)
            if ((a.responseFields[f] && (c[a.responseFields[f]] = b), !i && d && a.dataFilter && (b = a.dataFilter(b, a.dataType)), (i = f), (f = k.shift())))
                if ("*" === f) f = i;
                else if ("*" !== i && i !== f) {
                    if (((g = j[i + " " + f] || j["* " + f]), !g))
                        for (e in j)
                            if (((h = e.split(" ")), h[1] === f && (g = j[i + " " + h[0]] || j["* " + h[0]]))) {
                                g === !0 ? (g = j[e]) : j[e] !== !0 && ((f = h[0]), k.unshift(h[1]));
                                break;
                            }
                    if (g !== !0)
                        if (g && a["throws"]) b = g(b);
                        else
                            try {
                                b = g(b);
                            } catch (l) {
                                return { state: "parsererror", error: g ? l : "No conversion from " + i + " to " + f };
                            }
                }
        return { state: "success", data: b };
    }
    n.extend({
        active: 0,
        lastModified: {},
        etag: {},
        ajaxSettings: {
            url: Rb,
            type: "GET",
            isLocal: Kb.test(Sb[1]),
            global: !0,
            processData: !0,
            async: !0,
            contentType: "application/x-www-form-urlencoded; charset=UTF-8",
            accepts: { "*": Qb, text: "text/plain", html: "text/html", xml: "application/xml, text/xml", json: "application/json, text/javascript" },
            contents: { xml: /\bxml\b/, html: /\bhtml/, json: /\bjson\b/ },
            responseFields: { xml: "responseXML", text: "responseText", json: "responseJSON" },
            converters: { "* text": String, "text html": !0, "text json": n.parseJSON, "text xml": n.parseXML },
            flatOptions: { url: !0, context: !0 }
        },
        ajaxSetup: function(a, b) {
            return b ? Vb(Vb(a, n.ajaxSettings), b) : Vb(n.ajaxSettings, a);
        },
        ajaxPrefilter: Tb(Ob),
        ajaxTransport: Tb(Pb),
        ajax: function(b, c) {
            "object" == typeof b && ((c = b), (b = void 0)), (c = c || {});
            var d,
                e,
                f,
                g,
                h,
                i,
                j,
                k,
                l = n.ajaxSetup({}, c),
                m = l.context || l,
                o = l.context && (m.nodeType || m.jquery) ? n(m) : n.event,
                p = n.Deferred(),
                q = n.Callbacks("once memory"),
                r = l.statusCode || {},
                s = {},
                t = {},
                u = 0,
                v = "canceled",
                w = {
                    readyState: 0,
                    getResponseHeader: function(a) {
                        var b;
                        if (2 === u) {
                            if (!k) {
                                k = {};
                                while ((b = Jb.exec(g))) k[b[1].toLowerCase()] = b[2];
                            }
                            b = k[a.toLowerCase()];
                        }
                        return null == b ? null : b;
                    },
                    getAllResponseHeaders: function() {
                        return 2 === u ? g : null;
                    },
                    setRequestHeader: function(a, b) {
                        var c = a.toLowerCase();
                        return u || ((a = t[c] = t[c] || a), (s[a] = b)), this;
                    },
                    overrideMimeType: function(a) {
                        return u || (l.mimeType = a), this;
                    },
                    statusCode: function(a) {
                        var b;
                        if (a)
                            if (2 > u) for (b in a) r[b] = [r[b], a[b]];
                            else w.always(a[w.status]);
                        return this;
                    },
                    abort: function(a) {
                        var b = a || v;
                        return j && j.abort(b), y(0, b), this;
                    }
                };
            if (
                ((p.promise(w).complete = q.add),
                (w.success = w.done),
                (w.error = w.fail),
                (l.url = ((b || l.url || Rb) + "").replace(Hb, "").replace(Mb, Sb[1] + "//")),
                (l.type = c.method || c.type || l.method || l.type),
                (l.dataTypes = n
                    .trim(l.dataType || "*")
                    .toLowerCase()
                    .match(G) || [""]),
                null == l.crossDomain &&
                    ((d = Nb.exec(l.url.toLowerCase())),
                    (l.crossDomain = !(!d || (d[1] === Sb[1] && d[2] === Sb[2] && (d[3] || ("http:" === d[1] ? "80" : "443")) === (Sb[3] || ("http:" === Sb[1] ? "80" : "443")))))),
                l.data && l.processData && "string" != typeof l.data && (l.data = n.param(l.data, l.traditional)),
                Ub(Ob, l, c, w),
                2 === u)
            )
                return w;
            (i = n.event && l.global),
                i && 0 === n.active++ && n.event.trigger("ajaxStart"),
                (l.type = l.type.toUpperCase()),
                (l.hasContent = !Lb.test(l.type)),
                (f = l.url),
                l.hasContent ||
                    (l.data && ((f = l.url += (Fb.test(f) ? "&" : "?") + l.data), delete l.data),
                    l.cache === !1 && (l.url = Ib.test(f) ? f.replace(Ib, "$1_=" + Eb++) : f + (Fb.test(f) ? "&" : "?") + "_=" + Eb++)),
                l.ifModified && (n.lastModified[f] && w.setRequestHeader("If-Modified-Since", n.lastModified[f]), n.etag[f] && w.setRequestHeader("If-None-Match", n.etag[f])),
                ((l.data && l.hasContent && l.contentType !== !1) || c.contentType) && w.setRequestHeader("Content-Type", l.contentType),
                w.setRequestHeader(
                    "Accept",
                    l.dataTypes[0] && l.accepts[l.dataTypes[0]] ? l.accepts[l.dataTypes[0]] + ("*" !== l.dataTypes[0] ? ", " + Qb + "; q=0.01" : "") : l.accepts["*"]
                );
            for (e in l.headers) w.setRequestHeader(e, l.headers[e]);
            if (l.beforeSend && (l.beforeSend.call(m, w, l) === !1 || 2 === u)) return w.abort();
            v = "abort";
            for (e in { success: 1, error: 1, complete: 1 }) w[e](l[e]);
            if ((j = Ub(Pb, l, c, w))) {
                if (((w.readyState = 1), i && o.trigger("ajaxSend", [w, l]), 2 === u)) return w;
                l.async &&
                    l.timeout > 0 &&
                    (h = a.setTimeout(function() {
                        w.abort("timeout");
                    }, l.timeout));
                try {
                    (u = 1), j.send(s, y);
                } catch (x) {
                    if (!(2 > u)) throw x;
                    y(-1, x);
                }
            } else y(-1, "No Transport");
            function y(b, c, d, e) {
                var k,
                    s,
                    t,
                    v,
                    x,
                    y = c;
                2 !== u &&
                    ((u = 2),
                    h && a.clearTimeout(h),
                    (j = void 0),
                    (g = e || ""),
                    (w.readyState = b > 0 ? 4 : 0),
                    (k = (b >= 200 && 300 > b) || 304 === b),
                    d && (v = Wb(l, w, d)),
                    (v = Xb(l, v, w, k)),
                    k
                        ? (l.ifModified && ((x = w.getResponseHeader("Last-Modified")), x && (n.lastModified[f] = x), (x = w.getResponseHeader("etag")), x && (n.etag[f] = x)),
                          204 === b || "HEAD" === l.type ? (y = "nocontent") : 304 === b ? (y = "notmodified") : ((y = v.state), (s = v.data), (t = v.error), (k = !t)))
                        : ((t = y), (!b && y) || ((y = "error"), 0 > b && (b = 0))),
                    (w.status = b),
                    (w.statusText = (c || y) + ""),
                    k ? p.resolveWith(m, [s, y, w]) : p.rejectWith(m, [w, y, t]),
                    w.statusCode(r),
                    (r = void 0),
                    i && o.trigger(k ? "ajaxSuccess" : "ajaxError", [w, l, k ? s : t]),
                    q.fireWith(m, [w, y]),
                    i && (o.trigger("ajaxComplete", [w, l]), --n.active || n.event.trigger("ajaxStop")));
            }
            return w;
        },
        getJSON: function(a, b, c) {
            return n.get(a, b, c, "json");
        },
        getScript: function(a, b) {
            return n.get(a, void 0, b, "script");
        }
    }),
        n.each(["get", "post"], function(a, b) {
            n[b] = function(a, c, d, e) {
                return n.isFunction(c) && ((e = e || d), (d = c), (c = void 0)), n.ajax(n.extend({ url: a, type: b, dataType: e, data: c, success: d }, n.isPlainObject(a) && a));
            };
        }),
        (n._evalUrl = function(a) {
            return n.ajax({ url: a, type: "GET", dataType: "script", cache: !0, async: !1, global: !1, throws: !0 });
        }),
        n.fn.extend({
            wrapAll: function(a) {
                if (n.isFunction(a))
                    return this.each(function(b) {
                        n(this).wrapAll(a.call(this, b));
                    });
                if (this[0]) {
                    var b = n(a, this[0].ownerDocument)
                        .eq(0)
                        .clone(!0);
                    this[0].parentNode && b.insertBefore(this[0]),
                        b
                            .map(function() {
                                var a = this;
                                while (a.firstChild && 1 === a.firstChild.nodeType) a = a.firstChild;
                                return a;
                            })
                            .append(this);
                }
                return this;
            },
            wrapInner: function(a) {
                return n.isFunction(a)
                    ? this.each(function(b) {
                          n(this).wrapInner(a.call(this, b));
                      })
                    : this.each(function() {
                          var b = n(this),
                              c = b.contents();
                          c.length ? c.wrapAll(a) : b.append(a);
                      });
            },
            wrap: function(a) {
                var b = n.isFunction(a);
                return this.each(function(c) {
                    n(this).wrapAll(b ? a.call(this, c) : a);
                });
            },
            unwrap: function() {
                return this.parent()
                    .each(function() {
                        n.nodeName(this, "body") || n(this).replaceWith(this.childNodes);
                    })
                    .end();
            }
        });
    function Yb(a) {
        return (a.style && a.style.display) || n.css(a, "display");
    }
    function Zb(a) {
        if (!n.contains(a.ownerDocument || d, a)) return !0;
        while (a && 1 === a.nodeType) {
            if ("none" === Yb(a) || "hidden" === a.type) return !0;
            a = a.parentNode;
        }
        return !1;
    }
    (n.expr.filters.hidden = function(a) {
        return l.reliableHiddenOffsets() ? a.offsetWidth <= 0 && a.offsetHeight <= 0 && !a.getClientRects().length : Zb(a);
    }),
        (n.expr.filters.visible = function(a) {
            return !n.expr.filters.hidden(a);
        });
    var $b = /%20/g,
        _b = /\[\]$/,
        ac = /\r?\n/g,
        bc = /^(?:submit|button|image|reset|file)$/i,
        cc = /^(?:input|select|textarea|keygen)/i;
    function dc(a, b, c, d) {
        var e;
        if (n.isArray(b))
            n.each(b, function(b, e) {
                c || _b.test(a) ? d(a, e) : dc(a + "[" + ("object" == typeof e && null != e ? b : "") + "]", e, c, d);
            });
        else if (c || "object" !== n.type(b)) d(a, b);
        else for (e in b) dc(a + "[" + e + "]", b[e], c, d);
    }
    (n.param = function(a, b) {
        var c,
            d = [],
            e = function(a, b) {
                (b = n.isFunction(b) ? b() : null == b ? "" : b), (d[d.length] = encodeURIComponent(a) + "=" + encodeURIComponent(b));
            };
        if ((void 0 === b && (b = n.ajaxSettings && n.ajaxSettings.traditional), n.isArray(a) || (a.jquery && !n.isPlainObject(a))))
            n.each(a, function() {
                e(this.name, this.value);
            });
        else for (c in a) dc(c, a[c], b, e);
        return d.join("&").replace($b, "+");
    }),
        n.fn.extend({
            serialize: function() {
                return n.param(this.serializeArray());
            },
            serializeArray: function() {
                return this.map(function() {
                    var a = n.prop(this, "elements");
                    return a ? n.makeArray(a) : this;
                })
                    .filter(function() {
                        var a = this.type;
                        return this.name && !n(this).is(":disabled") && cc.test(this.nodeName) && !bc.test(a) && (this.checked || !Z.test(a));
                    })
                    .map(function(a, b) {
                        var c = n(this).val();
                        return null == c
                            ? null
                            : n.isArray(c)
                            ? n.map(c, function(a) {
                                  return { name: b.name, value: a.replace(ac, "\r\n") };
                              })
                            : { name: b.name, value: c.replace(ac, "\r\n") };
                    })
                    .get();
            }
        }),
        (n.ajaxSettings.xhr =
            void 0 !== a.ActiveXObject
                ? function() {
                      return this.isLocal ? ic() : d.documentMode > 8 ? hc() : (/^(get|post|head|put|delete|options)$/i.test(this.type) && hc()) || ic();
                  }
                : hc);
    var ec = 0,
        fc = {},
        gc = n.ajaxSettings.xhr();
    a.attachEvent &&
        a.attachEvent("onunload", function() {
            for (var a in fc) fc[a](void 0, !0);
        }),
        (l.cors = !!gc && "withCredentials" in gc),
        (gc = l.ajax = !!gc),
        gc &&
            n.ajaxTransport(function(b) {
                if (!b.crossDomain || l.cors) {
                    var c;
                    return {
                        send: function(d, e) {
                            var f,
                                g = b.xhr(),
                                h = ++ec;
                            if ((g.open(b.type, b.url, b.async, b.username, b.password), b.xhrFields)) for (f in b.xhrFields) g[f] = b.xhrFields[f];
                            b.mimeType && g.overrideMimeType && g.overrideMimeType(b.mimeType),
                                b.crossDomain || d["X-Requested-With"] || (d["X-Requested-With"] = "XMLHttpRequest");
                            for (f in d) void 0 !== d[f] && g.setRequestHeader(f, d[f] + "");
                            g.send((b.hasContent && b.data) || null),
                                (c = function(a, d) {
                                    var f, i, j;
                                    if (c && (d || 4 === g.readyState))
                                        if ((delete fc[h], (c = void 0), (g.onreadystatechange = n.noop), d)) 4 !== g.readyState && g.abort();
                                        else {
                                            (j = {}), (f = g.status), "string" == typeof g.responseText && (j.text = g.responseText);
                                            try {
                                                i = g.statusText;
                                            } catch (k) {
                                                i = "";
                                            }
                                            f || !b.isLocal || b.crossDomain ? 1223 === f && (f = 204) : (f = j.text ? 200 : 404);
                                        }
                                    j && e(f, i, j, g.getAllResponseHeaders());
                                }),
                                b.async ? (4 === g.readyState ? a.setTimeout(c) : (g.onreadystatechange = fc[h] = c)) : c();
                        },
                        abort: function() {
                            c && c(void 0, !0);
                        }
                    };
                }
            });
    function hc() {
        try {
            return new a.XMLHttpRequest();
        } catch (b) {}
    }
    function ic() {
        try {
            return new a.ActiveXObject("Microsoft.XMLHTTP");
        } catch (b) {}
    }
    n.ajaxSetup({
        accepts: { script: "text/javascript, application/javascript, application/ecmascript, application/x-ecmascript" },
        contents: { script: /\b(?:java|ecma)script\b/ },
        converters: {
            "text script": function(a) {
                return n.globalEval(a), a;
            }
        }
    }),
        n.ajaxPrefilter("script", function(a) {
            void 0 === a.cache && (a.cache = !1), a.crossDomain && ((a.type = "GET"), (a.global = !1));
        }),
        n.ajaxTransport("script", function(a) {
            if (a.crossDomain) {
                var b,
                    c = d.head || n("head")[0] || d.documentElement;
                return {
                    send: function(e, f) {
                        (b = d.createElement("script")),
                            (b.async = !0),
                            a.scriptCharset && (b.charset = a.scriptCharset),
                            (b.src = a.url),
                            (b.onload = b.onreadystatechange = function(a, c) {
                                (c || !b.readyState || /loaded|complete/.test(b.readyState)) &&
                                    ((b.onload = b.onreadystatechange = null), b.parentNode && b.parentNode.removeChild(b), (b = null), c || f(200, "success"));
                            }),
                            c.insertBefore(b, c.firstChild);
                    },
                    abort: function() {
                        b && b.onload(void 0, !0);
                    }
                };
            }
        });
    var jc = [],
        kc = /(=)\?(?=&|$)|\?\?/;
    n.ajaxSetup({
        jsonp: "callback",
        jsonpCallback: function() {
            var a = jc.pop() || n.expando + "_" + Eb++;
            return (this[a] = !0), a;
        }
    }),
        n.ajaxPrefilter("json jsonp", function(b, c, d) {
            var e,
                f,
                g,
                h =
                    b.jsonp !== !1 &&
                    (kc.test(b.url) ? "url" : "string" == typeof b.data && 0 === (b.contentType || "").indexOf("application/x-www-form-urlencoded") && kc.test(b.data) && "data");
            return h || "jsonp" === b.dataTypes[0]
                ? ((e = b.jsonpCallback = n.isFunction(b.jsonpCallback) ? b.jsonpCallback() : b.jsonpCallback),
                  h ? (b[h] = b[h].replace(kc, "$1" + e)) : b.jsonp !== !1 && (b.url += (Fb.test(b.url) ? "&" : "?") + b.jsonp + "=" + e),
                  (b.converters["script json"] = function() {
                      return g || n.error(e + " was not called"), g[0];
                  }),
                  (b.dataTypes[0] = "json"),
                  (f = a[e]),
                  (a[e] = function() {
                      g = arguments;
                  }),
                  d.always(function() {
                      void 0 === f ? n(a).removeProp(e) : (a[e] = f), b[e] && ((b.jsonpCallback = c.jsonpCallback), jc.push(e)), g && n.isFunction(f) && f(g[0]), (g = f = void 0);
                  }),
                  "script")
                : void 0;
        }),
        (n.parseHTML = function(a, b, c) {
            if (!a || "string" != typeof a) return null;
            "boolean" == typeof b && ((c = b), (b = !1)), (b = b || d);
            var e = x.exec(a),
                f = !c && [];
            return e ? [b.createElement(e[1])] : ((e = ja([a], b, f)), f && f.length && n(f).remove(), n.merge([], e.childNodes));
        });
    var lc = n.fn.load;
    (n.fn.load = function(a, b, c) {
        if ("string" != typeof a && lc) return lc.apply(this, arguments);
        var d,
            e,
            f,
            g = this,
            h = a.indexOf(" ");
        return (
            h > -1 && ((d = n.trim(a.slice(h, a.length))), (a = a.slice(0, h))),
            n.isFunction(b) ? ((c = b), (b = void 0)) : b && "object" == typeof b && (e = "POST"),
            g.length > 0 &&
                n
                    .ajax({ url: a, type: e || "GET", dataType: "html", data: b })
                    .done(function(a) {
                        (f = arguments),
                            g.html(
                                d
                                    ? n("<div>")
                                          .append(n.parseHTML(a))
                                          .find(d)
                                    : a
                            );
                    })
                    .always(
                        c &&
                            function(a, b) {
                                g.each(function() {
                                    c.apply(this, f || [a.responseText, b, a]);
                                });
                            }
                    ),
            this
        );
    }),
        n.each(["ajaxStart", "ajaxStop", "ajaxComplete", "ajaxError", "ajaxSuccess", "ajaxSend"], function(a, b) {
            n.fn[b] = function(a) {
                return this.on(b, a);
            };
        }),
        (n.expr.filters.animated = function(a) {
            return n.grep(n.timers, function(b) {
                return a === b.elem;
            }).length;
        });
    function mc(a) {
        return n.isWindow(a) ? a : 9 === a.nodeType ? a.defaultView || a.parentWindow : !1;
    }
    (n.offset = {
        setOffset: function(a, b, c) {
            var d,
                e,
                f,
                g,
                h,
                i,
                j,
                k = n.css(a, "position"),
                l = n(a),
                m = {};
            "static" === k && (a.style.position = "relative"),
                (h = l.offset()),
                (f = n.css(a, "top")),
                (i = n.css(a, "left")),
                (j = ("absolute" === k || "fixed" === k) && n.inArray("auto", [f, i]) > -1),
                j ? ((d = l.position()), (g = d.top), (e = d.left)) : ((g = parseFloat(f) || 0), (e = parseFloat(i) || 0)),
                n.isFunction(b) && (b = b.call(a, c, n.extend({}, h))),
                null != b.top && (m.top = b.top - h.top + g),
                null != b.left && (m.left = b.left - h.left + e),
                "using" in b ? b.using.call(a, m) : l.css(m);
        }
    }),
        n.fn.extend({
            offset: function(a) {
                if (arguments.length)
                    return void 0 === a
                        ? this
                        : this.each(function(b) {
                              n.offset.setOffset(this, a, b);
                          });
                var b,
                    c,
                    d = { top: 0, left: 0 },
                    e = this[0],
                    f = e && e.ownerDocument;
                if (f)
                    return (
                        (b = f.documentElement),
                        n.contains(b, e)
                            ? ("undefined" != typeof e.getBoundingClientRect && (d = e.getBoundingClientRect()),
                              (c = mc(f)),
                              { top: d.top + (c.pageYOffset || b.scrollTop) - (b.clientTop || 0), left: d.left + (c.pageXOffset || b.scrollLeft) - (b.clientLeft || 0) })
                            : d
                    );
            },
            position: function() {
                if (this[0]) {
                    var a,
                        b,
                        c = { top: 0, left: 0 },
                        d = this[0];
                    return (
                        "fixed" === n.css(d, "position")
                            ? (b = d.getBoundingClientRect())
                            : ((a = this.offsetParent()),
                              (b = this.offset()),
                              n.nodeName(a[0], "html") || (c = a.offset()),
                              (c.top += n.css(a[0], "borderTopWidth", !0)),
                              (c.left += n.css(a[0], "borderLeftWidth", !0))),
                        { top: b.top - c.top - n.css(d, "marginTop", !0), left: b.left - c.left - n.css(d, "marginLeft", !0) }
                    );
                }
            },
            offsetParent: function() {
                return this.map(function() {
                    var a = this.offsetParent;
                    while (a && !n.nodeName(a, "html") && "static" === n.css(a, "position")) a = a.offsetParent;
                    return a || Qa;
                });
            }
        }),
        n.each({ scrollLeft: "pageXOffset", scrollTop: "pageYOffset" }, function(a, b) {
            var c = /Y/.test(b);
            n.fn[a] = function(d) {
                return Y(
                    this,
                    function(a, d, e) {
                        var f = mc(a);
                        return void 0 === e
                            ? f
                                ? b in f
                                    ? f[b]
                                    : f.document.documentElement[d]
                                : a[d]
                            : void (f ? f.scrollTo(c ? n(f).scrollLeft() : e, c ? e : n(f).scrollTop()) : (a[d] = e));
                    },
                    a,
                    d,
                    arguments.length,
                    null
                );
            };
        }),
        n.each(["top", "left"], function(a, b) {
            n.cssHooks[b] = Ua(l.pixelPosition, function(a, c) {
                return c ? ((c = Sa(a, b)), Oa.test(c) ? n(a).position()[b] + "px" : c) : void 0;
            });
        }),
        n.each({ Height: "height", Width: "width" }, function(a, b) {
            n.each(
                {
                    padding: "inner" + a,
                    content: b,
                    "": "outer" + a
                },
                function(c, d) {
                    n.fn[d] = function(d, e) {
                        var f = arguments.length && (c || "boolean" != typeof d),
                            g = c || (d === !0 || e === !0 ? "margin" : "border");
                        return Y(
                            this,
                            function(b, c, d) {
                                var e;
                                return n.isWindow(b)
                                    ? b.document.documentElement["client" + a]
                                    : 9 === b.nodeType
                                    ? ((e = b.documentElement), Math.max(b.body["scroll" + a], e["scroll" + a], b.body["offset" + a], e["offset" + a], e["client" + a]))
                                    : void 0 === d
                                    ? n.css(b, c, g)
                                    : n.style(b, c, d, g);
                            },
                            b,
                            f ? d : void 0,
                            f,
                            null
                        );
                    };
                }
            );
        }),
        n.fn.extend({
            bind: function(a, b, c) {
                return this.on(a, null, b, c);
            },
            unbind: function(a, b) {
                return this.off(a, null, b);
            },
            delegate: function(a, b, c, d) {
                return this.on(b, a, c, d);
            },
            undelegate: function(a, b, c) {
                return 1 === arguments.length ? this.off(a, "**") : this.off(b, a || "**", c);
            }
        }),
        (n.fn.size = function() {
            return this.length;
        }),
        (n.fn.andSelf = n.fn.addBack),
        "function" === typeof wwplayer.define &&
            wwplayer.define.amd &&
            wwplayer.define("jquery", [], function() {
                return n;
            });
    var nc = a.jQuery,
        oc = a.$;
    return (
        (n.noConflict = function(b) {
            return a.$ === n && (a.$ = oc), b && a.jQuery === n && (a.jQuery = nc), n;
        }),
        b || (a.jQuery = a.$ = n),
        n
    );
});
/*! jQuery v1.12.4 | (c) jQuery Foundation | jquery.org/license */
!(function(a, b) {
    "object" == typeof module && "object" == typeof module.exports
        ? (module.exports = a.document
              ? b(a, !0)
              : function(a) {
                    if (!a.document) throw new Error("jQuery requires a window with a document");
                    return b(a);
                })
        : b(a);
})("undefined" != typeof window ? window : this, function(a, b) {
    var c = [],
        d = a.document,
        e = c.slice,
        f = c.concat,
        g = c.push,
        h = c.indexOf,
        i = {},
        j = i.toString,
        k = i.hasOwnProperty,
        l = {},
        m = "1.12.4",
        n = function(a, b) {
            return new n.fn.init(a, b);
        },
        o = /^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,
        p = /^-ms-/,
        q = /-([\da-z])/gi,
        r = function(a, b) {
            return b.toUpperCase();
        };
    (n.fn = n.prototype = {
        jquery: m,
        constructor: n,
        selector: "",
        length: 0,
        toArray: function() {
            return e.call(this);
        },
        get: function(a) {
            return null != a ? (0 > a ? this[a + this.length] : this[a]) : e.call(this);
        },
        pushStack: function(a) {
            var b = n.merge(this.constructor(), a);
            return (b.prevObject = this), (b.context = this.context), b;
        },
        each: function(a) {
            return n.each(this, a);
        },
        map: function(a) {
            return this.pushStack(
                n.map(this, function(b, c) {
                    return a.call(b, c, b);
                })
            );
        },
        slice: function() {
            return this.pushStack(e.apply(this, arguments));
        },
        first: function() {
            return this.eq(0);
        },
        last: function() {
            return this.eq(-1);
        },
        eq: function(a) {
            var b = this.length,
                c = +a + (0 > a ? b : 0);
            return this.pushStack(c >= 0 && b > c ? [this[c]] : []);
        },
        end: function() {
            return this.prevObject || this.constructor();
        },
        push: g,
        sort: c.sort,
        splice: c.splice
    }),
        (n.extend = n.fn.extend = function() {
            var a,
                b,
                c,
                d,
                e,
                f,
                g = arguments[0] || {},
                h = 1,
                i = arguments.length,
                j = !1;
            for ("boolean" == typeof g && ((j = g), (g = arguments[h] || {}), h++), "object" == typeof g || n.isFunction(g) || (g = {}), h === i && ((g = this), h--); i > h; h++)
                if (null != (e = arguments[h]))
                    for (d in e)
                        (a = g[d]),
                            (c = e[d]),
                            g !== c &&
                                (j && c && (n.isPlainObject(c) || (b = n.isArray(c)))
                                    ? (b ? ((b = !1), (f = a && n.isArray(a) ? a : [])) : (f = a && n.isPlainObject(a) ? a : {}), (g[d] = n.extend(j, f, c)))
                                    : void 0 !== c && (g[d] = c));
            return g;
        }),
        n.extend({
            expando: "jQuery" + (m + Math.random()).replace(/\D/g, ""),
            isReady: !0,
            error: function(a) {
                throw new Error(a);
            },
            noop: function() {},
            isFunction: function(a) {
                return "function" === n.type(a);
            },
            isArray:
                Array.isArray ||
                function(a) {
                    return "array" === n.type(a);
                },
            isWindow: function(a) {
                return null != a && a == a.window;
            },
            isNumeric: function(a) {
                var b = a && a.toString();
                return !n.isArray(a) && b - parseFloat(b) + 1 >= 0;
            },
            isEmptyObject: function(a) {
                var b;
                for (b in a) return !1;
                return !0;
            },
            isPlainObject: function(a) {
                var b;
                if (!a || "object" !== n.type(a) || a.nodeType || n.isWindow(a)) return !1;
                try {
                    if (a.constructor && !k.call(a, "constructor") && !k.call(a.constructor.prototype, "isPrototypeOf")) return !1;
                } catch (c) {
                    return !1;
                }
                if (!l.ownFirst) for (b in a) return k.call(a, b);
                for (b in a);
                return void 0 === b || k.call(a, b);
            },
            type: function(a) {
                return null == a ? a + "" : "object" == typeof a || "function" == typeof a ? i[j.call(a)] || "object" : typeof a;
            },
            globalEval: function(b) {
                b &&
                    n.trim(b) &&
                    (
                        a.execScript ||
                        function(b) {
                            a.eval.call(a, b);
                        }
                    )(b);
            },
            camelCase: function(a) {
                return a.replace(p, "ms-").replace(q, r);
            },
            nodeName: function(a, b) {
                return a.nodeName && a.nodeName.toLowerCase() === b.toLowerCase();
            },
            each: function(a, b) {
                var c,
                    d = 0;
                if (s(a)) {
                    for (c = a.length; c > d; d++) if (b.call(a[d], d, a[d]) === !1) break;
                } else for (d in a) if (b.call(a[d], d, a[d]) === !1) break;
                return a;
            },
            trim: function(a) {
                return null == a ? "" : (a + "").replace(o, "");
            },
            makeArray: function(a, b) {
                var c = b || [];
                return null != a && (s(Object(a)) ? n.merge(c, "string" == typeof a ? [a] : a) : g.call(c, a)), c;
            },
            inArray: function(a, b, c) {
                var d;
                if (b) {
                    if (h) return h.call(b, a, c);
                    for (d = b.length, c = c ? (0 > c ? Math.max(0, d + c) : c) : 0; d > c; c++) if (c in b && b[c] === a) return c;
                }
                return -1;
            },
            merge: function(a, b) {
                var c = +b.length,
                    d = 0,
                    e = a.length;
                while (c > d) a[e++] = b[d++];
                if (c !== c) while (void 0 !== b[d]) a[e++] = b[d++];
                return (a.length = e), a;
            },
            grep: function(a, b, c) {
                for (var d, e = [], f = 0, g = a.length, h = !c; g > f; f++) (d = !b(a[f], f)), d !== h && e.push(a[f]);
                return e;
            },
            map: function(a, b, c) {
                var d,
                    e,
                    g = 0,
                    h = [];
                if (s(a)) for (d = a.length; d > g; g++) (e = b(a[g], g, c)), null != e && h.push(e);
                else for (g in a) (e = b(a[g], g, c)), null != e && h.push(e);
                return f.apply([], h);
            },
            guid: 1,
            proxy: function(a, b) {
                var c, d, f;
                return (
                    "string" == typeof b && ((f = a[b]), (b = a), (a = f)),
                    n.isFunction(a)
                        ? ((c = e.call(arguments, 2)),
                          (d = function() {
                              return a.apply(b || this, c.concat(e.call(arguments)));
                          }),
                          (d.guid = a.guid = a.guid || n.guid++),
                          d)
                        : void 0
                );
            },
            now: function() {
                return +new Date();
            },
            support: l
        }),
        "function" == typeof Symbol && (n.fn[Symbol.iterator] = c[Symbol.iterator]),
        n.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "), function(a, b) {
            i["[object " + b + "]"] = b.toLowerCase();
        });
    function s(a) {
        var b = !!a && "length" in a && a.length,
            c = n.type(a);
        return "function" === c || n.isWindow(a) ? !1 : "array" === c || 0 === b || ("number" == typeof b && b > 0 && b - 1 in a);
    }
    var t = (function(a) {
        var b,
            c,
            d,
            e,
            f,
            g,
            h,
            i,
            j,
            k,
            l,
            m,
            n,
            o,
            p,
            q,
            r,
            s,
            t,
            u = "sizzle" + 1 * new Date(),
            v = a.document,
            w = 0,
            x = 0,
            y = ga(),
            z = ga(),
            A = ga(),
            B = function(a, b) {
                return a === b && (l = !0), 0;
            },
            C = 1 << 31,
            D = {}.hasOwnProperty,
            E = [],
            F = E.pop,
            G = E.push,
            H = E.push,
            I = E.slice,
            J = function(a, b) {
                for (var c = 0, d = a.length; d > c; c++) if (a[c] === b) return c;
                return -1;
            },
            K = "checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",
            L = "[\\x20\\t\\r\\n\\f]",
            M = "(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",
            N = "\\[" + L + "*(" + M + ")(?:" + L + "*([*^$|!~]?=)" + L + "*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|(" + M + "))|)" + L + "*\\]",
            O = ":(" + M + ")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|" + N + ")*)|.*)\\)|)",
            P = new RegExp(L + "+", "g"),
            Q = new RegExp("^" + L + "+|((?:^|[^\\\\])(?:\\\\.)*)" + L + "+$", "g"),
            R = new RegExp("^" + L + "*," + L + "*"),
            S = new RegExp("^" + L + "*([>+~]|" + L + ")" + L + "*"),
            T = new RegExp("=" + L + "*([^\\]'\"]*?)" + L + "*\\]", "g"),
            U = new RegExp(O),
            V = new RegExp("^" + M + "$"),
            W = {
                ID: new RegExp("^#(" + M + ")"),
                CLASS: new RegExp("^\\.(" + M + ")"),
                TAG: new RegExp("^(" + M + "|[*])"),
                ATTR: new RegExp("^" + N),
                PSEUDO: new RegExp("^" + O),
                CHILD: new RegExp(
                    "^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\(" + L + "*(even|odd|(([+-]|)(\\d*)n|)" + L + "*(?:([+-]|)" + L + "*(\\d+)|))" + L + "*\\)|)",
                    "i"
                ),
                bool: new RegExp("^(?:" + K + ")$", "i"),
                needsContext: new RegExp("^" + L + "*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\(" + L + "*((?:-\\d)?\\d*)" + L + "*\\)|)(?=[^-]|$)", "i")
            },
            X = /^(?:input|select|textarea|button)$/i,
            Y = /^h\d$/i,
            Z = /^[^{]+\{\s*\[native \w/,
            $ = /^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,
            _ = /[+~]/,
            aa = /'|\\/g,
            ba = new RegExp("\\\\([\\da-f]{1,6}" + L + "?|(" + L + ")|.)", "ig"),
            ca = function(a, b, c) {
                var d = "0x" + b - 65536;
                return d !== d || c ? b : 0 > d ? String.fromCharCode(d + 65536) : String.fromCharCode((d >> 10) | 55296, (1023 & d) | 56320);
            },
            da = function() {
                m();
            };
        try {
            H.apply((E = I.call(v.childNodes)), v.childNodes), E[v.childNodes.length].nodeType;
        } catch (ea) {
            H = {
                apply: E.length
                    ? function(a, b) {
                          G.apply(a, I.call(b));
                      }
                    : function(a, b) {
                          var c = a.length,
                              d = 0;
                          while ((a[c++] = b[d++]));
                          a.length = c - 1;
                      }
            };
        }
        function fa(a, b, d, e) {
            var f,
                h,
                j,
                k,
                l,
                o,
                r,
                s,
                w = b && b.ownerDocument,
                x = b ? b.nodeType : 9;
            if (((d = d || []), "string" != typeof a || !a || (1 !== x && 9 !== x && 11 !== x))) return d;
            if (!e && ((b ? b.ownerDocument || b : v) !== n && m(b), (b = b || n), p)) {
                if (11 !== x && (o = $.exec(a)))
                    if ((f = o[1])) {
                        if (9 === x) {
                            if (!(j = b.getElementById(f))) return d;
                            if (j.id === f) return d.push(j), d;
                        } else if (w && (j = w.getElementById(f)) && t(b, j) && j.id === f) return d.push(j), d;
                    } else {
                        if (o[2]) return H.apply(d, b.getElementsByTagName(a)), d;
                        if ((f = o[3]) && c.getElementsByClassName && b.getElementsByClassName) return H.apply(d, b.getElementsByClassName(f)), d;
                    }
                if (c.qsa && !A[a + " "] && (!q || !q.test(a))) {
                    if (1 !== x) (w = b), (s = a);
                    else if ("object" !== b.nodeName.toLowerCase()) {
                        (k = b.getAttribute("id")) ? (k = k.replace(aa, "\\$&")) : b.setAttribute("id", (k = u)),
                            (r = g(a)),
                            (h = r.length),
                            (l = V.test(k) ? "#" + k : "[id='" + k + "']");
                        while (h--) r[h] = l + " " + qa(r[h]);
                        (s = r.join(",")), (w = (_.test(a) && oa(b.parentNode)) || b);
                    }
                    if (s)
                        try {
                            return H.apply(d, w.querySelectorAll(s)), d;
                        } catch (y) {
                        } finally {
                            k === u && b.removeAttribute("id");
                        }
                }
            }
            return i(a.replace(Q, "$1"), b, d, e);
        }
        function ga() {
            var a = [];
            function b(c, e) {
                return a.push(c + " ") > d.cacheLength && delete b[a.shift()], (b[c + " "] = e);
            }
            return b;
        }
        function ha(a) {
            return (a[u] = !0), a;
        }
        function ia(a) {
            var b = n.createElement("div");
            try {
                return !!a(b);
            } catch (c) {
                return !1;
            } finally {
                b.parentNode && b.parentNode.removeChild(b), (b = null);
            }
        }
        function ja(a, b) {
            var c = a.split("|"),
                e = c.length;
            while (e--) d.attrHandle[c[e]] = b;
        }
        function ka(a, b) {
            var c = b && a,
                d = c && 1 === a.nodeType && 1 === b.nodeType && (~b.sourceIndex || C) - (~a.sourceIndex || C);
            if (d) return d;
            if (c) while ((c = c.nextSibling)) if (c === b) return -1;
            return a ? 1 : -1;
        }
        function la(a) {
            return function(b) {
                var c = b.nodeName.toLowerCase();
                return "input" === c && b.type === a;
            };
        }
        function ma(a) {
            return function(b) {
                var c = b.nodeName.toLowerCase();
                return ("input" === c || "button" === c) && b.type === a;
            };
        }
        function na(a) {
            return ha(function(b) {
                return (
                    (b = +b),
                    ha(function(c, d) {
                        var e,
                            f = a([], c.length, b),
                            g = f.length;
                        while (g--) c[(e = f[g])] && (c[e] = !(d[e] = c[e]));
                    })
                );
            });
        }
        function oa(a) {
            return a && "undefined" != typeof a.getElementsByTagName && a;
        }
        (c = fa.support = {}),
            (f = fa.isXML = function(a) {
                var b = a && (a.ownerDocument || a).documentElement;
                return b ? "HTML" !== b.nodeName : !1;
            }),
            (m = fa.setDocument = function(a) {
                var b,
                    e,
                    g = a ? a.ownerDocument || a : v;
                return g !== n && 9 === g.nodeType && g.documentElement
                    ? ((n = g),
                      (o = n.documentElement),
                      (p = !f(n)),
                      (e = n.defaultView) && e.top !== e && (e.addEventListener ? e.addEventListener("unload", da, !1) : e.attachEvent && e.attachEvent("onunload", da)),
                      (c.attributes = ia(function(a) {
                          return (a.className = "i"), !a.getAttribute("className");
                      })),
                      (c.getElementsByTagName = ia(function(a) {
                          return a.appendChild(n.createComment("")), !a.getElementsByTagName("*").length;
                      })),
                      (c.getElementsByClassName = Z.test(n.getElementsByClassName)),
                      (c.getById = ia(function(a) {
                          return (o.appendChild(a).id = u), !n.getElementsByName || !n.getElementsByName(u).length;
                      })),
                      c.getById
                          ? ((d.find.ID = function(a, b) {
                                if ("undefined" != typeof b.getElementById && p) {
                                    var c = b.getElementById(a);
                                    return c ? [c] : [];
                                }
                            }),
                            (d.filter.ID = function(a) {
                                var b = a.replace(ba, ca);
                                return function(a) {
                                    return a.getAttribute("id") === b;
                                };
                            }))
                          : (delete d.find.ID,
                            (d.filter.ID = function(a) {
                                var b = a.replace(ba, ca);
                                return function(a) {
                                    var c = "undefined" != typeof a.getAttributeNode && a.getAttributeNode("id");
                                    return c && c.value === b;
                                };
                            })),
                      (d.find.TAG = c.getElementsByTagName
                          ? function(a, b) {
                                return "undefined" != typeof b.getElementsByTagName ? b.getElementsByTagName(a) : c.qsa ? b.querySelectorAll(a) : void 0;
                            }
                          : function(a, b) {
                                var c,
                                    d = [],
                                    e = 0,
                                    f = b.getElementsByTagName(a);
                                if ("*" === a) {
                                    while ((c = f[e++])) 1 === c.nodeType && d.push(c);
                                    return d;
                                }
                                return f;
                            }),
                      (d.find.CLASS =
                          c.getElementsByClassName &&
                          function(a, b) {
                              return "undefined" != typeof b.getElementsByClassName && p ? b.getElementsByClassName(a) : void 0;
                          }),
                      (r = []),
                      (q = []),
                      (c.qsa = Z.test(n.querySelectorAll)) &&
                          (ia(function(a) {
                              (o.appendChild(a).innerHTML = "<a id='" + u + "'></a><select id='" + u + "-\r\\' msallowcapture=''><option selected=''></option></select>"),
                                  a.querySelectorAll("[msallowcapture^='']").length && q.push("[*^$]=" + L + "*(?:''|\"\")"),
                                  a.querySelectorAll("[selected]").length || q.push("\\[" + L + "*(?:value|" + K + ")"),
                                  a.querySelectorAll("[id~=" + u + "-]").length || q.push("~="),
                                  a.querySelectorAll(":checked").length || q.push(":checked"),
                                  a.querySelectorAll("a#" + u + "+*").length || q.push(".#.+[+~]");
                          }),
                          ia(function(a) {
                              var b = n.createElement("input");
                              b.setAttribute("type", "hidden"),
                                  a.appendChild(b).setAttribute("name", "D"),
                                  a.querySelectorAll("[name=d]").length && q.push("name" + L + "*[*^$|!~]?="),
                                  a.querySelectorAll(":enabled").length || q.push(":enabled", ":disabled"),
                                  a.querySelectorAll("*,:x"),
                                  q.push(",.*:");
                          })),
                      (c.matchesSelector = Z.test((s = o.matches || o.webkitMatchesSelector || o.mozMatchesSelector || o.oMatchesSelector || o.msMatchesSelector))) &&
                          ia(function(a) {
                              (c.disconnectedMatch = s.call(a, "div")), s.call(a, "[s!='']:x"), r.push("!=", O);
                          }),
                      (q = q.length && new RegExp(q.join("|"))),
                      (r = r.length && new RegExp(r.join("|"))),
                      (b = Z.test(o.compareDocumentPosition)),
                      (t =
                          b || Z.test(o.contains)
                              ? function(a, b) {
                                    var c = 9 === a.nodeType ? a.documentElement : a,
                                        d = b && b.parentNode;
                                    return a === d || !(!d || 1 !== d.nodeType || !(c.contains ? c.contains(d) : a.compareDocumentPosition && 16 & a.compareDocumentPosition(d)));
                                }
                              : function(a, b) {
                                    if (b) while ((b = b.parentNode)) if (b === a) return !0;
                                    return !1;
                                }),
                      (B = b
                          ? function(a, b) {
                                if (a === b) return (l = !0), 0;
                                var d = !a.compareDocumentPosition - !b.compareDocumentPosition;
                                return d
                                    ? d
                                    : ((d = (a.ownerDocument || a) === (b.ownerDocument || b) ? a.compareDocumentPosition(b) : 1),
                                      1 & d || (!c.sortDetached && b.compareDocumentPosition(a) === d)
                                          ? a === n || (a.ownerDocument === v && t(v, a))
                                              ? -1
                                              : b === n || (b.ownerDocument === v && t(v, b))
                                              ? 1
                                              : k
                                              ? J(k, a) - J(k, b)
                                              : 0
                                          : 4 & d
                                          ? -1
                                          : 1);
                            }
                          : function(a, b) {
                                if (a === b) return (l = !0), 0;
                                var c,
                                    d = 0,
                                    e = a.parentNode,
                                    f = b.parentNode,
                                    g = [a],
                                    h = [b];
                                if (!e || !f) return a === n ? -1 : b === n ? 1 : e ? -1 : f ? 1 : k ? J(k, a) - J(k, b) : 0;
                                if (e === f) return ka(a, b);
                                c = a;
                                while ((c = c.parentNode)) g.unshift(c);
                                c = b;
                                while ((c = c.parentNode)) h.unshift(c);
                                while (g[d] === h[d]) d++;
                                return d ? ka(g[d], h[d]) : g[d] === v ? -1 : h[d] === v ? 1 : 0;
                            }),
                      n)
                    : n;
            }),
            (fa.matches = function(a, b) {
                return fa(a, null, null, b);
            }),
            (fa.matchesSelector = function(a, b) {
                if (((a.ownerDocument || a) !== n && m(a), (b = b.replace(T, "='$1']")), c.matchesSelector && p && !A[b + " "] && (!r || !r.test(b)) && (!q || !q.test(b))))
                    try {
                        var d = s.call(a, b);
                        if (d || c.disconnectedMatch || (a.document && 11 !== a.document.nodeType)) return d;
                    } catch (e) {}
                return fa(b, n, null, [a]).length > 0;
            }),
            (fa.contains = function(a, b) {
                return (a.ownerDocument || a) !== n && m(a), t(a, b);
            }),
            (fa.attr = function(a, b) {
                (a.ownerDocument || a) !== n && m(a);
                var e = d.attrHandle[b.toLowerCase()],
                    f = e && D.call(d.attrHandle, b.toLowerCase()) ? e(a, b, !p) : void 0;
                return void 0 !== f ? f : c.attributes || !p ? a.getAttribute(b) : (f = a.getAttributeNode(b)) && f.specified ? f.value : null;
            }),
            (fa.error = function(a) {
                throw new Error("Syntax error, unrecognized expression: " + a);
            }),
            (fa.uniqueSort = function(a) {
                var b,
                    d = [],
                    e = 0,
                    f = 0;
                if (((l = !c.detectDuplicates), (k = !c.sortStable && a.slice(0)), a.sort(B), l)) {
                    while ((b = a[f++])) b === a[f] && (e = d.push(f));
                    while (e--) a.splice(d[e], 1);
                }
                return (k = null), a;
            }),
            (e = fa.getText = function(a) {
                var b,
                    c = "",
                    d = 0,
                    f = a.nodeType;
                if (f) {
                    if (1 === f || 9 === f || 11 === f) {
                        if ("string" == typeof a.textContent) return a.textContent;
                        for (a = a.firstChild; a; a = a.nextSibling) c += e(a);
                    } else if (3 === f || 4 === f) return a.nodeValue;
                } else while ((b = a[d++])) c += e(b);
                return c;
            }),
            (d = fa.selectors = {
                cacheLength: 50,
                createPseudo: ha,
                match: W,
                attrHandle: {},
                find: {},
                relative: { ">": { dir: "parentNode", first: !0 }, " ": { dir: "parentNode" }, "+": { dir: "previousSibling", first: !0 }, "~": { dir: "previousSibling" } },
                preFilter: {
                    ATTR: function(a) {
                        return (a[1] = a[1].replace(ba, ca)), (a[3] = (a[3] || a[4] || a[5] || "").replace(ba, ca)), "~=" === a[2] && (a[3] = " " + a[3] + " "), a.slice(0, 4);
                    },
                    CHILD: function(a) {
                        return (
                            (a[1] = a[1].toLowerCase()),
                            "nth" === a[1].slice(0, 3)
                                ? (a[3] || fa.error(a[0]),
                                  (a[4] = +(a[4] ? a[5] + (a[6] || 1) : 2 * ("even" === a[3] || "odd" === a[3]))),
                                  (a[5] = +(a[7] + a[8] || "odd" === a[3])))
                                : a[3] && fa.error(a[0]),
                            a
                        );
                    },
                    PSEUDO: function(a) {
                        var b,
                            c = !a[6] && a[2];
                        return W.CHILD.test(a[0])
                            ? null
                            : (a[3]
                                  ? (a[2] = a[4] || a[5] || "")
                                  : c && U.test(c) && (b = g(c, !0)) && (b = c.indexOf(")", c.length - b) - c.length) && ((a[0] = a[0].slice(0, b)), (a[2] = c.slice(0, b))),
                              a.slice(0, 3));
                    }
                },
                filter: {
                    TAG: function(a) {
                        var b = a.replace(ba, ca).toLowerCase();
                        return "*" === a
                            ? function() {
                                  return !0;
                              }
                            : function(a) {
                                  return a.nodeName && a.nodeName.toLowerCase() === b;
                              };
                    },
                    CLASS: function(a) {
                        var b = y[a + " "];
                        return (
                            b ||
                            ((b = new RegExp("(^|" + L + ")" + a + "(" + L + "|$)")) &&
                                y(a, function(a) {
                                    return b.test(("string" == typeof a.className && a.className) || ("undefined" != typeof a.getAttribute && a.getAttribute("class")) || "");
                                }))
                        );
                    },
                    ATTR: function(a, b, c) {
                        return function(d) {
                            var e = fa.attr(d, a);
                            return null == e
                                ? "!=" === b
                                : b
                                ? ((e += ""),
                                  "=" === b
                                      ? e === c
                                      : "!=" === b
                                      ? e !== c
                                      : "^=" === b
                                      ? c && 0 === e.indexOf(c)
                                      : "*=" === b
                                      ? c && e.indexOf(c) > -1
                                      : "$=" === b
                                      ? c && e.slice(-c.length) === c
                                      : "~=" === b
                                      ? (" " + e.replace(P, " ") + " ").indexOf(c) > -1
                                      : "|=" === b
                                      ? e === c || e.slice(0, c.length + 1) === c + "-"
                                      : !1)
                                : !0;
                        };
                    },
                    CHILD: function(a, b, c, d, e) {
                        var f = "nth" !== a.slice(0, 3),
                            g = "last" !== a.slice(-4),
                            h = "of-type" === b;
                        return 1 === d && 0 === e
                            ? function(a) {
                                  return !!a.parentNode;
                              }
                            : function(b, c, i) {
                                  var j,
                                      k,
                                      l,
                                      m,
                                      n,
                                      o,
                                      p = f !== g ? "nextSibling" : "previousSibling",
                                      q = b.parentNode,
                                      r = h && b.nodeName.toLowerCase(),
                                      s = !i && !h,
                                      t = !1;
                                  if (q) {
                                      if (f) {
                                          while (p) {
                                              m = b;
                                              while ((m = m[p])) if (h ? m.nodeName.toLowerCase() === r : 1 === m.nodeType) return !1;
                                              o = p = "only" === a && !o && "nextSibling";
                                          }
                                          return !0;
                                      }
                                      if (((o = [g ? q.firstChild : q.lastChild]), g && s)) {
                                          (m = q),
                                              (l = m[u] || (m[u] = {})),
                                              (k = l[m.uniqueID] || (l[m.uniqueID] = {})),
                                              (j = k[a] || []),
                                              (n = j[0] === w && j[1]),
                                              (t = n && j[2]),
                                              (m = n && q.childNodes[n]);
                                          while ((m = (++n && m && m[p]) || (t = n = 0) || o.pop()))
                                              if (1 === m.nodeType && ++t && m === b) {
                                                  k[a] = [w, n, t];
                                                  break;
                                              }
                                      } else if (
                                          (s &&
                                              ((m = b),
                                              (l = m[u] || (m[u] = {})),
                                              (k = l[m.uniqueID] || (l[m.uniqueID] = {})),
                                              (j = k[a] || []),
                                              (n = j[0] === w && j[1]),
                                              (t = n)),
                                          t === !1)
                                      )
                                          while ((m = (++n && m && m[p]) || (t = n = 0) || o.pop()))
                                              if (
                                                  (h ? m.nodeName.toLowerCase() === r : 1 === m.nodeType) &&
                                                  ++t &&
                                                  (s && ((l = m[u] || (m[u] = {})), (k = l[m.uniqueID] || (l[m.uniqueID] = {})), (k[a] = [w, t])), m === b)
                                              )
                                                  break;
                                      return (t -= e), t === d || (t % d === 0 && t / d >= 0);
                                  }
                              };
                    },
                    PSEUDO: function(a, b) {
                        var c,
                            e = d.pseudos[a] || d.setFilters[a.toLowerCase()] || fa.error("unsupported pseudo: " + a);
                        return e[u]
                            ? e(b)
                            : e.length > 1
                            ? ((c = [a, a, "", b]),
                              d.setFilters.hasOwnProperty(a.toLowerCase())
                                  ? ha(function(a, c) {
                                        var d,
                                            f = e(a, b),
                                            g = f.length;
                                        while (g--) (d = J(a, f[g])), (a[d] = !(c[d] = f[g]));
                                    })
                                  : function(a) {
                                        return e(a, 0, c);
                                    })
                            : e;
                    }
                },
                pseudos: {
                    not: ha(function(a) {
                        var b = [],
                            c = [],
                            d = h(a.replace(Q, "$1"));
                        return d[u]
                            ? ha(function(a, b, c, e) {
                                  var f,
                                      g = d(a, null, e, []),
                                      h = a.length;
                                  while (h--) (f = g[h]) && (a[h] = !(b[h] = f));
                              })
                            : function(a, e, f) {
                                  return (b[0] = a), d(b, null, f, c), (b[0] = null), !c.pop();
                              };
                    }),
                    has: ha(function(a) {
                        return function(b) {
                            return fa(a, b).length > 0;
                        };
                    }),
                    contains: ha(function(a) {
                        return (
                            (a = a.replace(ba, ca)),
                            function(b) {
                                return (b.textContent || b.innerText || e(b)).indexOf(a) > -1;
                            }
                        );
                    }),
                    lang: ha(function(a) {
                        return (
                            V.test(a || "") || fa.error("unsupported lang: " + a),
                            (a = a.replace(ba, ca).toLowerCase()),
                            function(b) {
                                var c;
                                do if ((c = p ? b.lang : b.getAttribute("xml:lang") || b.getAttribute("lang"))) return (c = c.toLowerCase()), c === a || 0 === c.indexOf(a + "-");
                                while ((b = b.parentNode) && 1 === b.nodeType);
                                return !1;
                            }
                        );
                    }),
                    target: function(b) {
                        var c = a.location && a.location.hash;
                        return c && c.slice(1) === b.id;
                    },
                    root: function(a) {
                        return a === o;
                    },
                    focus: function(a) {
                        return a === n.activeElement && (!n.hasFocus || n.hasFocus()) && !!(a.type || a.href || ~a.tabIndex);
                    },
                    enabled: function(a) {
                        return a.disabled === !1;
                    },
                    disabled: function(a) {
                        return a.disabled === !0;
                    },
                    checked: function(a) {
                        var b = a.nodeName.toLowerCase();
                        return ("input" === b && !!a.checked) || ("option" === b && !!a.selected);
                    },
                    selected: function(a) {
                        return a.parentNode && a.parentNode.selectedIndex, a.selected === !0;
                    },
                    empty: function(a) {
                        for (a = a.firstChild; a; a = a.nextSibling) if (a.nodeType < 6) return !1;
                        return !0;
                    },
                    parent: function(a) {
                        return !d.pseudos.empty(a);
                    },
                    header: function(a) {
                        return Y.test(a.nodeName);
                    },
                    input: function(a) {
                        return X.test(a.nodeName);
                    },
                    button: function(a) {
                        var b = a.nodeName.toLowerCase();
                        return ("input" === b && "button" === a.type) || "button" === b;
                    },
                    text: function(a) {
                        var b;
                        return "input" === a.nodeName.toLowerCase() && "text" === a.type && (null == (b = a.getAttribute("type")) || "text" === b.toLowerCase());
                    },
                    first: na(function() {
                        return [0];
                    }),
                    last: na(function(a, b) {
                        return [b - 1];
                    }),
                    eq: na(function(a, b, c) {
                        return [0 > c ? c + b : c];
                    }),
                    even: na(function(a, b) {
                        for (var c = 0; b > c; c += 2) a.push(c);
                        return a;
                    }),
                    odd: na(function(a, b) {
                        for (var c = 1; b > c; c += 2) a.push(c);
                        return a;
                    }),
                    lt: na(function(a, b, c) {
                        for (var d = 0 > c ? c + b : c; --d >= 0; ) a.push(d);
                        return a;
                    }),
                    gt: na(function(a, b, c) {
                        for (var d = 0 > c ? c + b : c; ++d < b; ) a.push(d);
                        return a;
                    })
                }
            }),
            (d.pseudos.nth = d.pseudos.eq);
        for (b in { radio: !0, checkbox: !0, file: !0, password: !0, image: !0 }) d.pseudos[b] = la(b);
        for (b in { submit: !0, reset: !0 }) d.pseudos[b] = ma(b);
        function pa() {}
        (pa.prototype = d.filters = d.pseudos),
            (d.setFilters = new pa()),
            (g = fa.tokenize = function(a, b) {
                var c,
                    e,
                    f,
                    g,
                    h,
                    i,
                    j,
                    k = z[a + " "];
                if (k) return b ? 0 : k.slice(0);
                (h = a), (i = []), (j = d.preFilter);
                while (h) {
                    (c && !(e = R.exec(h))) || (e && (h = h.slice(e[0].length) || h), i.push((f = []))),
                        (c = !1),
                        (e = S.exec(h)) && ((c = e.shift()), f.push({ value: c, type: e[0].replace(Q, " ") }), (h = h.slice(c.length)));
                    for (g in d.filter) !(e = W[g].exec(h)) || (j[g] && !(e = j[g](e))) || ((c = e.shift()), f.push({ value: c, type: g, matches: e }), (h = h.slice(c.length)));
                    if (!c) break;
                }
                return b ? h.length : h ? fa.error(a) : z(a, i).slice(0);
            });
        function qa(a) {
            for (var b = 0, c = a.length, d = ""; c > b; b++) d += a[b].value;
            return d;
        }
        function ra(a, b, c) {
            var d = b.dir,
                e = c && "parentNode" === d,
                f = x++;
            return b.first
                ? function(b, c, f) {
                      while ((b = b[d])) if (1 === b.nodeType || e) return a(b, c, f);
                  }
                : function(b, c, g) {
                      var h,
                          i,
                          j,
                          k = [w, f];
                      if (g) {
                          while ((b = b[d])) if ((1 === b.nodeType || e) && a(b, c, g)) return !0;
                      } else
                          while ((b = b[d]))
                              if (1 === b.nodeType || e) {
                                  if (((j = b[u] || (b[u] = {})), (i = j[b.uniqueID] || (j[b.uniqueID] = {})), (h = i[d]) && h[0] === w && h[1] === f)) return (k[2] = h[2]);
                                  if (((i[d] = k), (k[2] = a(b, c, g)))) return !0;
                              }
                  };
        }
        function sa(a) {
            return a.length > 1
                ? function(b, c, d) {
                      var e = a.length;
                      while (e--) if (!a[e](b, c, d)) return !1;
                      return !0;
                  }
                : a[0];
        }
        function ta(a, b, c) {
            for (var d = 0, e = b.length; e > d; d++) fa(a, b[d], c);
            return c;
        }
        function ua(a, b, c, d, e) {
            for (var f, g = [], h = 0, i = a.length, j = null != b; i > h; h++) (f = a[h]) && ((c && !c(f, d, e)) || (g.push(f), j && b.push(h)));
            return g;
        }
        function va(a, b, c, d, e, f) {
            return (
                d && !d[u] && (d = va(d)),
                e && !e[u] && (e = va(e, f)),
                ha(function(f, g, h, i) {
                    var j,
                        k,
                        l,
                        m = [],
                        n = [],
                        o = g.length,
                        p = f || ta(b || "*", h.nodeType ? [h] : h, []),
                        q = !a || (!f && b) ? p : ua(p, m, a, h, i),
                        r = c ? (e || (f ? a : o || d) ? [] : g) : q;
                    if ((c && c(q, r, h, i), d)) {
                        (j = ua(r, n)), d(j, [], h, i), (k = j.length);
                        while (k--) (l = j[k]) && (r[n[k]] = !(q[n[k]] = l));
                    }
                    if (f) {
                        if (e || a) {
                            if (e) {
                                (j = []), (k = r.length);
                                while (k--) (l = r[k]) && j.push((q[k] = l));
                                e(null, (r = []), j, i);
                            }
                            k = r.length;
                            while (k--) (l = r[k]) && (j = e ? J(f, l) : m[k]) > -1 && (f[j] = !(g[j] = l));
                        }
                    } else (r = ua(r === g ? r.splice(o, r.length) : r)), e ? e(null, g, r, i) : H.apply(g, r);
                })
            );
        }
        function wa(a) {
            for (
                var b,
                    c,
                    e,
                    f = a.length,
                    g = d.relative[a[0].type],
                    h = g || d.relative[" "],
                    i = g ? 1 : 0,
                    k = ra(
                        function(a) {
                            return a === b;
                        },
                        h,
                        !0
                    ),
                    l = ra(
                        function(a) {
                            return J(b, a) > -1;
                        },
                        h,
                        !0
                    ),
                    m = [
                        function(a, c, d) {
                            var e = (!g && (d || c !== j)) || ((b = c).nodeType ? k(a, c, d) : l(a, c, d));
                            return (b = null), e;
                        }
                    ];
                f > i;
                i++
            )
                if ((c = d.relative[a[i].type])) m = [ra(sa(m), c)];
                else {
                    if (((c = d.filter[a[i].type].apply(null, a[i].matches)), c[u])) {
                        for (e = ++i; f > e; e++) if (d.relative[a[e].type]) break;
                        return va(
                            i > 1 && sa(m),
                            i > 1 && qa(a.slice(0, i - 1).concat({ value: " " === a[i - 2].type ? "*" : "" })).replace(Q, "$1"),
                            c,
                            e > i && wa(a.slice(i, e)),
                            f > e && wa((a = a.slice(e))),
                            f > e && qa(a)
                        );
                    }
                    m.push(c);
                }
            return sa(m);
        }
        function xa(a, b) {
            var c = b.length > 0,
                e = a.length > 0,
                f = function(f, g, h, i, k) {
                    var l,
                        o,
                        q,
                        r = 0,
                        s = "0",
                        t = f && [],
                        u = [],
                        v = j,
                        x = f || (e && d.find.TAG("*", k)),
                        y = (w += null == v ? 1 : Math.random() || 0.1),
                        z = x.length;
                    for (k && (j = g === n || g || k); s !== z && null != (l = x[s]); s++) {
                        if (e && l) {
                            (o = 0), g || l.ownerDocument === n || (m(l), (h = !p));
                            while ((q = a[o++]))
                                if (q(l, g || n, h)) {
                                    i.push(l);
                                    break;
                                }
                            k && (w = y);
                        }
                        c && ((l = !q && l) && r--, f && t.push(l));
                    }
                    if (((r += s), c && s !== r)) {
                        o = 0;
                        while ((q = b[o++])) q(t, u, g, h);
                        if (f) {
                            if (r > 0) while (s--) t[s] || u[s] || (u[s] = F.call(i));
                            u = ua(u);
                        }
                        H.apply(i, u), k && !f && u.length > 0 && r + b.length > 1 && fa.uniqueSort(i);
                    }
                    return k && ((w = y), (j = v)), t;
                };
            return c ? ha(f) : f;
        }
        return (
            (h = fa.compile = function(a, b) {
                var c,
                    d = [],
                    e = [],
                    f = A[a + " "];
                if (!f) {
                    b || (b = g(a)), (c = b.length);
                    while (c--) (f = wa(b[c])), f[u] ? d.push(f) : e.push(f);
                    (f = A(a, xa(e, d))), (f.selector = a);
                }
                return f;
            }),
            (i = fa.select = function(a, b, e, f) {
                var i,
                    j,
                    k,
                    l,
                    m,
                    n = "function" == typeof a && a,
                    o = !f && g((a = n.selector || a));
                if (((e = e || []), 1 === o.length)) {
                    if (((j = o[0] = o[0].slice(0)), j.length > 2 && "ID" === (k = j[0]).type && c.getById && 9 === b.nodeType && p && d.relative[j[1].type])) {
                        if (((b = (d.find.ID(k.matches[0].replace(ba, ca), b) || [])[0]), !b)) return e;
                        n && (b = b.parentNode), (a = a.slice(j.shift().value.length));
                    }
                    i = W.needsContext.test(a) ? 0 : j.length;
                    while (i--) {
                        if (((k = j[i]), d.relative[(l = k.type)])) break;
                        if ((m = d.find[l]) && (f = m(k.matches[0].replace(ba, ca), (_.test(j[0].type) && oa(b.parentNode)) || b))) {
                            if ((j.splice(i, 1), (a = f.length && qa(j)), !a)) return H.apply(e, f), e;
                            break;
                        }
                    }
                }
                return (n || h(a, o))(f, b, !p, e, !b || (_.test(a) && oa(b.parentNode)) || b), e;
            }),
            (c.sortStable =
                u
                    .split("")
                    .sort(B)
                    .join("") === u),
            (c.detectDuplicates = !!l),
            m(),
            (c.sortDetached = ia(function(a) {
                return 1 & a.compareDocumentPosition(n.createElement("div"));
            })),
            ia(function(a) {
                return (a.innerHTML = "<a href='#'></a>"), "#" === a.firstChild.getAttribute("href");
            }) ||
                ja("type|href|height|width", function(a, b, c) {
                    return c ? void 0 : a.getAttribute(b, "type" === b.toLowerCase() ? 1 : 2);
                }),
            (c.attributes &&
                ia(function(a) {
                    return (a.innerHTML = "<input/>"), a.firstChild.setAttribute("value", ""), "" === a.firstChild.getAttribute("value");
                })) ||
                ja("value", function(a, b, c) {
                    return c || "input" !== a.nodeName.toLowerCase() ? void 0 : a.defaultValue;
                }),
            ia(function(a) {
                return null == a.getAttribute("disabled");
            }) ||
                ja(K, function(a, b, c) {
                    var d;
                    return c ? void 0 : a[b] === !0 ? b.toLowerCase() : (d = a.getAttributeNode(b)) && d.specified ? d.value : null;
                }),
            fa
        );
    })(a);
    (n.find = t),
        (n.expr = t.selectors),
        (n.expr[":"] = n.expr.pseudos),
        (n.uniqueSort = n.unique = t.uniqueSort),
        (n.text = t.getText),
        (n.isXMLDoc = t.isXML),
        (n.contains = t.contains);
    var u = function(a, b, c) {
            var d = [],
                e = void 0 !== c;
            while ((a = a[b]) && 9 !== a.nodeType)
                if (1 === a.nodeType) {
                    if (e && n(a).is(c)) break;
                    d.push(a);
                }
            return d;
        },
        v = function(a, b) {
            for (var c = []; a; a = a.nextSibling) 1 === a.nodeType && a !== b && c.push(a);
            return c;
        },
        w = n.expr.match.needsContext,
        x = /^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,
        y = /^.[^:#\[\.,]*$/;
    function z(a, b, c) {
        if (n.isFunction(b))
            return n.grep(a, function(a, d) {
                return !!b.call(a, d, a) !== c;
            });
        if (b.nodeType)
            return n.grep(a, function(a) {
                return (a === b) !== c;
            });
        if ("string" == typeof b) {
            if (y.test(b)) return n.filter(b, a, c);
            b = n.filter(b, a);
        }
        return n.grep(a, function(a) {
            return n.inArray(a, b) > -1 !== c;
        });
    }
    (n.filter = function(a, b, c) {
        var d = b[0];
        return (
            c && (a = ":not(" + a + ")"),
            1 === b.length && 1 === d.nodeType
                ? n.find.matchesSelector(d, a)
                    ? [d]
                    : []
                : n.find.matches(
                      a,
                      n.grep(b, function(a) {
                          return 1 === a.nodeType;
                      })
                  )
        );
    }),
        n.fn.extend({
            find: function(a) {
                var b,
                    c = [],
                    d = this,
                    e = d.length;
                if ("string" != typeof a)
                    return this.pushStack(
                        n(a).filter(function() {
                            for (b = 0; e > b; b++) if (n.contains(d[b], this)) return !0;
                        })
                    );
                for (b = 0; e > b; b++) n.find(a, d[b], c);
                return (c = this.pushStack(e > 1 ? n.unique(c) : c)), (c.selector = this.selector ? this.selector + " " + a : a), c;
            },
            filter: function(a) {
                return this.pushStack(z(this, a || [], !1));
            },
            not: function(a) {
                return this.pushStack(z(this, a || [], !0));
            },
            is: function(a) {
                return !!z(this, "string" == typeof a && w.test(a) ? n(a) : a || [], !1).length;
            }
        });
    var A,
        B = /^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,
        C = (n.fn.init = function(a, b, c) {
            var e, f;
            if (!a) return this;
            if (((c = c || A), "string" == typeof a)) {
                if (((e = "<" === a.charAt(0) && ">" === a.charAt(a.length - 1) && a.length >= 3 ? [null, a, null] : B.exec(a)), !e || (!e[1] && b)))
                    return !b || b.jquery ? (b || c).find(a) : this.constructor(b).find(a);
                if (e[1]) {
                    if (((b = b instanceof n ? b[0] : b), n.merge(this, n.parseHTML(e[1], b && b.nodeType ? b.ownerDocument || b : d, !0)), x.test(e[1]) && n.isPlainObject(b)))
                        for (e in b) n.isFunction(this[e]) ? this[e](b[e]) : this.attr(e, b[e]);
                    return this;
                }
                if (((f = d.getElementById(e[2])), f && f.parentNode)) {
                    if (f.id !== e[2]) return A.find(a);
                    (this.length = 1), (this[0] = f);
                }
                return (this.context = d), (this.selector = a), this;
            }
            return a.nodeType
                ? ((this.context = this[0] = a), (this.length = 1), this)
                : n.isFunction(a)
                ? "undefined" != typeof c.ready
                    ? c.ready(a)
                    : a(n)
                : (void 0 !== a.selector && ((this.selector = a.selector), (this.context = a.context)), n.makeArray(a, this));
        });
    (C.prototype = n.fn), (A = n(d));
    var D = /^(?:parents|prev(?:Until|All))/,
        E = { children: !0, contents: !0, next: !0, prev: !0 };
    n.fn.extend({
        has: function(a) {
            var b,
                c = n(a, this),
                d = c.length;
            return this.filter(function() {
                for (b = 0; d > b; b++) if (n.contains(this, c[b])) return !0;
            });
        },
        closest: function(a, b) {
            for (var c, d = 0, e = this.length, f = [], g = w.test(a) || "string" != typeof a ? n(a, b || this.context) : 0; e > d; d++)
                for (c = this[d]; c && c !== b; c = c.parentNode)
                    if (c.nodeType < 11 && (g ? g.index(c) > -1 : 1 === c.nodeType && n.find.matchesSelector(c, a))) {
                        f.push(c);
                        break;
                    }
            return this.pushStack(f.length > 1 ? n.uniqueSort(f) : f);
        },
        index: function(a) {
            return a
                ? "string" == typeof a
                    ? n.inArray(this[0], n(a))
                    : n.inArray(a.jquery ? a[0] : a, this)
                : this[0] && this[0].parentNode
                ? this.first().prevAll().length
                : -1;
        },
        add: function(a, b) {
            return this.pushStack(n.uniqueSort(n.merge(this.get(), n(a, b))));
        },
        addBack: function(a) {
            return this.add(null == a ? this.prevObject : this.prevObject.filter(a));
        }
    });
    function F(a, b) {
        do a = a[b];
        while (a && 1 !== a.nodeType);
        return a;
    }
    n.each(
        {
            parent: function(a) {
                var b = a.parentNode;
                return b && 11 !== b.nodeType ? b : null;
            },
            parents: function(a) {
                return u(a, "parentNode");
            },
            parentsUntil: function(a, b, c) {
                return u(a, "parentNode", c);
            },
            next: function(a) {
                return F(a, "nextSibling");
            },
            prev: function(a) {
                return F(a, "previousSibling");
            },
            nextAll: function(a) {
                return u(a, "nextSibling");
            },
            prevAll: function(a) {
                return u(a, "previousSibling");
            },
            nextUntil: function(a, b, c) {
                return u(a, "nextSibling", c);
            },
            prevUntil: function(a, b, c) {
                return u(a, "previousSibling", c);
            },
            siblings: function(a) {
                return v((a.parentNode || {}).firstChild, a);
            },
            children: function(a) {
                return v(a.firstChild);
            },
            contents: function(a) {
                return n.nodeName(a, "iframe") ? a.contentDocument || a.contentWindow.document : n.merge([], a.childNodes);
            }
        },
        function(a, b) {
            n.fn[a] = function(c, d) {
                var e = n.map(this, b, c);
                return (
                    "Until" !== a.slice(-5) && (d = c),
                    d && "string" == typeof d && (e = n.filter(d, e)),
                    this.length > 1 && (E[a] || (e = n.uniqueSort(e)), D.test(a) && (e = e.reverse())),
                    this.pushStack(e)
                );
            };
        }
    );
    var G = /\S+/g;
    function H(a) {
        var b = {};
        return (
            n.each(a.match(G) || [], function(a, c) {
                b[c] = !0;
            }),
            b
        );
    }
    (n.Callbacks = function(a) {
        a = "string" == typeof a ? H(a) : n.extend({}, a);
        var b,
            c,
            d,
            e,
            f = [],
            g = [],
            h = -1,
            i = function() {
                for (e = a.once, d = b = !0; g.length; h = -1) {
                    c = g.shift();
                    while (++h < f.length) f[h].apply(c[0], c[1]) === !1 && a.stopOnFalse && ((h = f.length), (c = !1));
                }
                a.memory || (c = !1), (b = !1), e && (f = c ? [] : "");
            },
            j = {
                add: function() {
                    return (
                        f &&
                            (c && !b && ((h = f.length - 1), g.push(c)),
                            (function d(b) {
                                n.each(b, function(b, c) {
                                    n.isFunction(c) ? (a.unique && j.has(c)) || f.push(c) : c && c.length && "string" !== n.type(c) && d(c);
                                });
                            })(arguments),
                            c && !b && i()),
                        this
                    );
                },
                remove: function() {
                    return (
                        n.each(arguments, function(a, b) {
                            var c;
                            while ((c = n.inArray(b, f, c)) > -1) f.splice(c, 1), h >= c && h--;
                        }),
                        this
                    );
                },
                has: function(a) {
                    return a ? n.inArray(a, f) > -1 : f.length > 0;
                },
                empty: function() {
                    return f && (f = []), this;
                },
                disable: function() {
                    return (e = g = []), (f = c = ""), this;
                },
                disabled: function() {
                    return !f;
                },
                lock: function() {
                    return (e = !0), c || j.disable(), this;
                },
                locked: function() {
                    return !!e;
                },
                fireWith: function(a, c) {
                    return e || ((c = c || []), (c = [a, c.slice ? c.slice() : c]), g.push(c), b || i()), this;
                },
                fire: function() {
                    return j.fireWith(this, arguments), this;
                },
                fired: function() {
                    return !!d;
                }
            };
        return j;
    }),
        n.extend({
            Deferred: function(a) {
                var b = [
                        ["resolve", "done", n.Callbacks("once memory"), "resolved"],
                        ["reject", "fail", n.Callbacks("once memory"), "rejected"],
                        ["notify", "progress", n.Callbacks("memory")]
                    ],
                    c = "pending",
                    d = {
                        state: function() {
                            return c;
                        },
                        always: function() {
                            return e.done(arguments).fail(arguments), this;
                        },
                        then: function() {
                            var a = arguments;
                            return n
                                .Deferred(function(c) {
                                    n.each(b, function(b, f) {
                                        var g = n.isFunction(a[b]) && a[b];
                                        e[f[1]](function() {
                                            var a = g && g.apply(this, arguments);
                                            a && n.isFunction(a.promise)
                                                ? a
                                                      .promise()
                                                      .progress(c.notify)
                                                      .done(c.resolve)
                                                      .fail(c.reject)
                                                : c[f[0] + "With"](this === d ? c.promise() : this, g ? [a] : arguments);
                                        });
                                    }),
                                        (a = null);
                                })
                                .promise();
                        },
                        promise: function(a) {
                            return null != a ? n.extend(a, d) : d;
                        }
                    },
                    e = {};
                return (
                    (d.pipe = d.then),
                    n.each(b, function(a, f) {
                        var g = f[2],
                            h = f[3];
                        (d[f[1]] = g.add),
                            h &&
                                g.add(
                                    function() {
                                        c = h;
                                    },
                                    b[1 ^ a][2].disable,
                                    b[2][2].lock
                                ),
                            (e[f[0]] = function() {
                                return e[f[0] + "With"](this === e ? d : this, arguments), this;
                            }),
                            (e[f[0] + "With"] = g.fireWith);
                    }),
                    d.promise(e),
                    a && a.call(e, e),
                    e
                );
            },
            when: function(a) {
                var b = 0,
                    c = e.call(arguments),
                    d = c.length,
                    f = 1 !== d || (a && n.isFunction(a.promise)) ? d : 0,
                    g = 1 === f ? a : n.Deferred(),
                    h = function(a, b, c) {
                        return function(d) {
                            (b[a] = this), (c[a] = arguments.length > 1 ? e.call(arguments) : d), c === i ? g.notifyWith(b, c) : --f || g.resolveWith(b, c);
                        };
                    },
                    i,
                    j,
                    k;
                if (d > 1)
                    for (i = new Array(d), j = new Array(d), k = new Array(d); d > b; b++)
                        c[b] && n.isFunction(c[b].promise)
                            ? c[b]
                                  .promise()
                                  .progress(h(b, j, i))
                                  .done(h(b, k, c))
                                  .fail(g.reject)
                            : --f;
                return f || g.resolveWith(k, c), g.promise();
            }
        });
    var I;
    (n.fn.ready = function(a) {
        return n.ready.promise().done(a), this;
    }),
        n.extend({
            isReady: !1,
            readyWait: 1,
            holdReady: function(a) {
                a ? n.readyWait++ : n.ready(!0);
            },
            ready: function(a) {
                (a === !0 ? --n.readyWait : n.isReady) ||
                    ((n.isReady = !0), (a !== !0 && --n.readyWait > 0) || (I.resolveWith(d, [n]), n.fn.triggerHandler && (n(d).triggerHandler("ready"), n(d).off("ready"))));
            }
        });
    function J() {
        d.addEventListener
            ? (d.removeEventListener("DOMContentLoaded", K), a.removeEventListener("load", K))
            : (d.detachEvent("onreadystatechange", K), a.detachEvent("onload", K));
    }
    function K() {
        (d.addEventListener || "load" === a.event.type || "complete" === d.readyState) && (J(), n.ready());
    }
    (n.ready.promise = function(b) {
        if (!I)
            if (((I = n.Deferred()), "complete" === d.readyState || ("loading" !== d.readyState && !d.documentElement.doScroll))) a.setTimeout(n.ready);
            else if (d.addEventListener) d.addEventListener("DOMContentLoaded", K), a.addEventListener("load", K);
            else {
                d.attachEvent("onreadystatechange", K), a.attachEvent("onload", K);
                var c = !1;
                try {
                    c = null == a.frameElement && d.documentElement;
                } catch (e) {}
                c &&
                    c.doScroll &&
                    !(function f() {
                        if (!n.isReady) {
                            try {
                                c.doScroll("left");
                            } catch (b) {
                                return a.setTimeout(f, 50);
                            }
                            J(), n.ready();
                        }
                    })();
            }
        return I.promise(b);
    }),
        n.ready.promise();
    var L;
    for (L in n(l)) break;
    (l.ownFirst = "0" === L),
        (l.inlineBlockNeedsLayout = !1),
        n(function() {
            var a, b, c, e;
            (c = d.getElementsByTagName("body")[0]),
                c &&
                    c.style &&
                    ((b = d.createElement("div")),
                    (e = d.createElement("div")),
                    (e.style.cssText = "position:absolute;border:0;width:0;height:0;top:0;left:-9999px"),
                    c.appendChild(e).appendChild(b),
                    "undefined" != typeof b.style.zoom &&
                        ((b.style.cssText = "display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1"),
                        (l.inlineBlockNeedsLayout = a = 3 === b.offsetWidth),
                        a && (c.style.zoom = 1)),
                    c.removeChild(e));
        }),
        (function() {
            var a = d.createElement("div");
            l.deleteExpando = !0;
            try {
                delete a.test;
            } catch (b) {
                l.deleteExpando = !1;
            }
            a = null;
        })();
    var M = function(a) {
            var b = n.noData[(a.nodeName + " ").toLowerCase()],
                c = +a.nodeType || 1;
            return 1 !== c && 9 !== c ? !1 : !b || (b !== !0 && a.getAttribute("classid") === b);
        },
        N = /^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,
        O = /([A-Z])/g;
    function P(a, b, c) {
        if (void 0 === c && 1 === a.nodeType) {
            var d = "data-" + b.replace(O, "-$1").toLowerCase();
            if (((c = a.getAttribute(d)), "string" == typeof c)) {
                try {
                    c = "true" === c ? !0 : "false" === c ? !1 : "null" === c ? null : +c + "" === c ? +c : N.test(c) ? n.parseJSON(c) : c;
                } catch (e) {}
                n.data(a, b, c);
            } else c = void 0;
        }
        return c;
    }
    function Q(a) {
        var b;
        for (b in a) if (("data" !== b || !n.isEmptyObject(a[b])) && "toJSON" !== b) return !1;
        return !0;
    }
    function R(a, b, d, e) {
        if (M(a)) {
            var f,
                g,
                h = n.expando,
                i = a.nodeType,
                j = i ? n.cache : a,
                k = i ? a[h] : a[h] && h;
            if ((k && j[k] && (e || j[k].data)) || void 0 !== d || "string" != typeof b)
                return (
                    k || (k = i ? (a[h] = c.pop() || n.guid++) : h),
                    j[k] || (j[k] = i ? {} : { toJSON: n.noop }),
                    ("object" != typeof b && "function" != typeof b) || (e ? (j[k] = n.extend(j[k], b)) : (j[k].data = n.extend(j[k].data, b))),
                    (g = j[k]),
                    e || (g.data || (g.data = {}), (g = g.data)),
                    void 0 !== d && (g[n.camelCase(b)] = d),
                    "string" == typeof b ? ((f = g[b]), null == f && (f = g[n.camelCase(b)])) : (f = g),
                    f
                );
        }
    }
    function S(a, b, c) {
        if (M(a)) {
            var d,
                e,
                f = a.nodeType,
                g = f ? n.cache : a,
                h = f ? a[n.expando] : n.expando;
            if (g[h]) {
                if (b && (d = c ? g[h] : g[h].data)) {
                    n.isArray(b) ? (b = b.concat(n.map(b, n.camelCase))) : b in d ? (b = [b]) : ((b = n.camelCase(b)), (b = b in d ? [b] : b.split(" "))), (e = b.length);
                    while (e--) delete d[b[e]];
                    if (c ? !Q(d) : !n.isEmptyObject(d)) return;
                }
                (c || (delete g[h].data, Q(g[h]))) && (f ? n.cleanData([a], !0) : l.deleteExpando || g != g.window ? delete g[h] : (g[h] = void 0));
            }
        }
    }
    n.extend({
        cache: {},
        noData: { "applet ": !0, "embed ": !0, "object ": "clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" },
        hasData: function(a) {
            return (a = a.nodeType ? n.cache[a[n.expando]] : a[n.expando]), !!a && !Q(a);
        },
        data: function(a, b, c) {
            return R(a, b, c);
        },
        removeData: function(a, b) {
            return S(a, b);
        },
        _data: function(a, b, c) {
            return R(a, b, c, !0);
        },
        _removeData: function(a, b) {
            return S(a, b, !0);
        }
    }),
        n.fn.extend({
            data: function(a, b) {
                var c,
                    d,
                    e,
                    f = this[0],
                    g = f && f.attributes;
                if (void 0 === a) {
                    if (this.length && ((e = n.data(f)), 1 === f.nodeType && !n._data(f, "parsedAttrs"))) {
                        c = g.length;
                        while (c--) g[c] && ((d = g[c].name), 0 === d.indexOf("data-") && ((d = n.camelCase(d.slice(5))), P(f, d, e[d])));
                        n._data(f, "parsedAttrs", !0);
                    }
                    return e;
                }
                return "object" == typeof a
                    ? this.each(function() {
                          n.data(this, a);
                      })
                    : arguments.length > 1
                    ? this.each(function() {
                          n.data(this, a, b);
                      })
                    : f
                    ? P(f, a, n.data(f, a))
                    : void 0;
            },
            removeData: function(a) {
                return this.each(function() {
                    n.removeData(this, a);
                });
            }
        }),
        n.extend({
            queue: function(a, b, c) {
                var d;
                return a ? ((b = (b || "fx") + "queue"), (d = n._data(a, b)), c && (!d || n.isArray(c) ? (d = n._data(a, b, n.makeArray(c))) : d.push(c)), d || []) : void 0;
            },
            dequeue: function(a, b) {
                b = b || "fx";
                var c = n.queue(a, b),
                    d = c.length,
                    e = c.shift(),
                    f = n._queueHooks(a, b),
                    g = function() {
                        n.dequeue(a, b);
                    };
                "inprogress" === e && ((e = c.shift()), d--), e && ("fx" === b && c.unshift("inprogress"), delete f.stop, e.call(a, g, f)), !d && f && f.empty.fire();
            },
            _queueHooks: function(a, b) {
                var c = b + "queueHooks";
                return (
                    n._data(a, c) ||
                    n._data(a, c, {
                        empty: n.Callbacks("once memory").add(function() {
                            n._removeData(a, b + "queue"), n._removeData(a, c);
                        })
                    })
                );
            }
        }),
        n.fn.extend({
            queue: function(a, b) {
                var c = 2;
                return (
                    "string" != typeof a && ((b = a), (a = "fx"), c--),
                    arguments.length < c
                        ? n.queue(this[0], a)
                        : void 0 === b
                        ? this
                        : this.each(function() {
                              var c = n.queue(this, a, b);
                              n._queueHooks(this, a), "fx" === a && "inprogress" !== c[0] && n.dequeue(this, a);
                          })
                );
            },
            dequeue: function(a) {
                return this.each(function() {
                    n.dequeue(this, a);
                });
            },
            clearQueue: function(a) {
                return this.queue(a || "fx", []);
            },
            promise: function(a, b) {
                var c,
                    d = 1,
                    e = n.Deferred(),
                    f = this,
                    g = this.length,
                    h = function() {
                        --d || e.resolveWith(f, [f]);
                    };
                "string" != typeof a && ((b = a), (a = void 0)), (a = a || "fx");
                while (g--) (c = n._data(f[g], a + "queueHooks")), c && c.empty && (d++, c.empty.add(h));
                return h(), e.promise(b);
            }
        }),
        (function() {
            var a;
            l.shrinkWrapBlocks = function() {
                if (null != a) return a;
                a = !1;
                var b, c, e;
                return (
                    (c = d.getElementsByTagName("body")[0]),
                    c && c.style
                        ? ((b = d.createElement("div")),
                          (e = d.createElement("div")),
                          (e.style.cssText = "position:absolute;border:0;width:0;height:0;top:0;left:-9999px"),
                          c.appendChild(e).appendChild(b),
                          "undefined" != typeof b.style.zoom &&
                              ((b.style.cssText =
                                  "-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:1px;width:1px;zoom:1"),
                              (b.appendChild(d.createElement("div")).style.width = "5px"),
                              (a = 3 !== b.offsetWidth)),
                          c.removeChild(e),
                          a)
                        : void 0
                );
            };
        })();
    var T = /[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,
        U = new RegExp("^(?:([+-])=|)(" + T + ")([a-z%]*)$", "i"),
        V = ["Top", "Right", "Bottom", "Left"],
        W = function(a, b) {
            return (a = b || a), "none" === n.css(a, "display") || !n.contains(a.ownerDocument, a);
        };
    function X(a, b, c, d) {
        var e,
            f = 1,
            g = 20,
            h = d
                ? function() {
                      return d.cur();
                  }
                : function() {
                      return n.css(a, b, "");
                  },
            i = h(),
            j = (c && c[3]) || (n.cssNumber[b] ? "" : "px"),
            k = (n.cssNumber[b] || ("px" !== j && +i)) && U.exec(n.css(a, b));
        if (k && k[3] !== j) {
            (j = j || k[3]), (c = c || []), (k = +i || 1);
            do (f = f || ".5"), (k /= f), n.style(a, b, k + j);
            while (f !== (f = h() / i) && 1 !== f && --g);
        }
        return c && ((k = +k || +i || 0), (e = c[1] ? k + (c[1] + 1) * c[2] : +c[2]), d && ((d.unit = j), (d.start = k), (d.end = e))), e;
    }
    var Y = function(a, b, c, d, e, f, g) {
            var h = 0,
                i = a.length,
                j = null == c;
            if ("object" === n.type(c)) {
                e = !0;
                for (h in c) Y(a, b, h, c[h], !0, f, g);
            } else if (
                void 0 !== d &&
                ((e = !0),
                n.isFunction(d) || (g = !0),
                j &&
                    (g
                        ? (b.call(a, d), (b = null))
                        : ((j = b),
                          (b = function(a, b, c) {
                              return j.call(n(a), c);
                          }))),
                b)
            )
                for (; i > h; h++) b(a[h], c, g ? d : d.call(a[h], h, b(a[h], c)));
            return e ? a : j ? b.call(a) : i ? b(a[0], c) : f;
        },
        Z = /^(?:checkbox|radio)$/i,
        $ = /<([\w:-]+)/,
        _ = /^$|\/(?:java|ecma)script/i,
        aa = /^\s+/,
        ba =
            "abbr|article|aside|audio|bdi|canvas|data|datalist|details|dialog|figcaption|figure|footer|header|hgroup|main|mark|meter|nav|output|picture|progress|section|summary|template|time|video";
    function ca(a) {
        var b = ba.split("|"),
            c = a.createDocumentFragment();
        if (c.createElement) while (b.length) c.createElement(b.pop());
        return c;
    }
    !(function() {
        var a = d.createElement("div"),
            b = d.createDocumentFragment(),
            c = d.createElement("input");
        (a.innerHTML = "  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>"),
            (l.leadingWhitespace = 3 === a.firstChild.nodeType),
            (l.tbody = !a.getElementsByTagName("tbody").length),
            (l.htmlSerialize = !!a.getElementsByTagName("link").length),
            (l.html5Clone = "<:nav></:nav>" !== d.createElement("nav").cloneNode(!0).outerHTML),
            (c.type = "checkbox"),
            (c.checked = !0),
            b.appendChild(c),
            (l.appendChecked = c.checked),
            (a.innerHTML = "<textarea>x</textarea>"),
            (l.noCloneChecked = !!a.cloneNode(!0).lastChild.defaultValue),
            b.appendChild(a),
            (c = d.createElement("input")),
            c.setAttribute("type", "radio"),
            c.setAttribute("checked", "checked"),
            c.setAttribute("name", "t"),
            a.appendChild(c),
            (l.checkClone = a.cloneNode(!0).cloneNode(!0).lastChild.checked),
            (l.noCloneEvent = !!a.addEventListener),
            (a[n.expando] = 1),
            (l.attributes = !a.getAttribute(n.expando));
    })();
    var da = {
        option: [1, "<select multiple='multiple'>", "</select>"],
        legend: [1, "<fieldset>", "</fieldset>"],
        area: [1, "<map>", "</map>"],
        param: [1, "<object>", "</object>"],
        thead: [1, "<table>", "</table>"],
        tr: [2, "<table><tbody>", "</tbody></table>"],
        col: [2, "<table><tbody></tbody><colgroup>", "</colgroup></table>"],
        td: [3, "<table><tbody><tr>", "</tr></tbody></table>"],
        _default: l.htmlSerialize ? [0, "", ""] : [1, "X<div>", "</div>"]
    };
    (da.optgroup = da.option), (da.tbody = da.tfoot = da.colgroup = da.caption = da.thead), (da.th = da.td);
    function ea(a, b) {
        var c,
            d,
            e = 0,
            f = "undefined" != typeof a.getElementsByTagName ? a.getElementsByTagName(b || "*") : "undefined" != typeof a.querySelectorAll ? a.querySelectorAll(b || "*") : void 0;
        if (!f) for (f = [], c = a.childNodes || a; null != (d = c[e]); e++) !b || n.nodeName(d, b) ? f.push(d) : n.merge(f, ea(d, b));
        return void 0 === b || (b && n.nodeName(a, b)) ? n.merge([a], f) : f;
    }
    function fa(a, b) {
        for (var c, d = 0; null != (c = a[d]); d++) n._data(c, "globalEval", !b || n._data(b[d], "globalEval"));
    }
    var ga = /<|&#?\w+;/,
        ha = /<tbody/i;
    function ia(a) {
        Z.test(a.type) && (a.defaultChecked = a.checked);
    }
    function ja(a, b, c, d, e) {
        for (var f, g, h, i, j, k, m, o = a.length, p = ca(b), q = [], r = 0; o > r; r++)
            if (((g = a[r]), g || 0 === g))
                if ("object" === n.type(g)) n.merge(q, g.nodeType ? [g] : g);
                else if (ga.test(g)) {
                    (i = i || p.appendChild(b.createElement("div"))),
                        (j = ($.exec(g) || ["", ""])[1].toLowerCase()),
                        (m = da[j] || da._default),
                        (i.innerHTML = m[1] + n.htmlPrefilter(g) + m[2]),
                        (f = m[0]);
                    while (f--) i = i.lastChild;
                    if ((!l.leadingWhitespace && aa.test(g) && q.push(b.createTextNode(aa.exec(g)[0])), !l.tbody)) {
                        (g = "table" !== j || ha.test(g) ? ("<table>" !== m[1] || ha.test(g) ? 0 : i) : i.firstChild), (f = g && g.childNodes.length);
                        while (f--) n.nodeName((k = g.childNodes[f]), "tbody") && !k.childNodes.length && g.removeChild(k);
                    }
                    n.merge(q, i.childNodes), (i.textContent = "");
                    while (i.firstChild) i.removeChild(i.firstChild);
                    i = p.lastChild;
                } else q.push(b.createTextNode(g));
        i && p.removeChild(i), l.appendChecked || n.grep(ea(q, "input"), ia), (r = 0);
        while ((g = q[r++]))
            if (d && n.inArray(g, d) > -1) e && e.push(g);
            else if (((h = n.contains(g.ownerDocument, g)), (i = ea(p.appendChild(g), "script")), h && fa(i), c)) {
                f = 0;
                while ((g = i[f++])) _.test(g.type || "") && c.push(g);
            }
        return (i = null), p;
    }
    !(function() {
        var b,
            c,
            e = d.createElement("div");
        for (b in { submit: !0, change: !0, focusin: !0 }) (c = "on" + b), (l[b] = c in a) || (e.setAttribute(c, "t"), (l[b] = e.attributes[c].expando === !1));
        e = null;
    })();
    var ka = /^(?:input|select|textarea)$/i,
        la = /^key/,
        ma = /^(?:mouse|pointer|contextmenu|drag|drop)|click/,
        na = /^(?:focusinfocus|focusoutblur)$/,
        oa = /^([^.]*)(?:\.(.+)|)/;
    function pa() {
        return !0;
    }
    function qa() {
        return !1;
    }
    function ra() {
        try {
            return d.activeElement;
        } catch (a) {}
    }
    function sa(a, b, c, d, e, f) {
        var g, h;
        if ("object" == typeof b) {
            "string" != typeof c && ((d = d || c), (c = void 0));
            for (h in b) sa(a, h, c, d, b[h], f);
            return a;
        }
        if ((null == d && null == e ? ((e = c), (d = c = void 0)) : null == e && ("string" == typeof c ? ((e = d), (d = void 0)) : ((e = d), (d = c), (c = void 0))), e === !1))
            e = qa;
        else if (!e) return a;
        return (
            1 === f &&
                ((g = e),
                (e = function(a) {
                    return n().off(a), g.apply(this, arguments);
                }),
                (e.guid = g.guid || (g.guid = n.guid++))),
            a.each(function() {
                n.event.add(this, b, e, d, c);
            })
        );
    }
    (n.event = {
        global: {},
        add: function(a, b, c, d, e) {
            var f,
                g,
                h,
                i,
                j,
                k,
                l,
                m,
                o,
                p,
                q,
                r = n._data(a);
            if (r) {
                c.handler && ((i = c), (c = i.handler), (e = i.selector)),
                    c.guid || (c.guid = n.guid++),
                    (g = r.events) || (g = r.events = {}),
                    (k = r.handle) ||
                        ((k = r.handle = function(a) {
                            return "undefined" == typeof n || (a && n.event.triggered === a.type) ? void 0 : n.event.dispatch.apply(k.elem, arguments);
                        }),
                        (k.elem = a)),
                    (b = (b || "").match(G) || [""]),
                    (h = b.length);
                while (h--)
                    (f = oa.exec(b[h]) || []),
                        (o = q = f[1]),
                        (p = (f[2] || "").split(".").sort()),
                        o &&
                            ((j = n.event.special[o] || {}),
                            (o = (e ? j.delegateType : j.bindType) || o),
                            (j = n.event.special[o] || {}),
                            (l = n.extend(
                                {
                                    type: o,
                                    origType: q,
                                    data: d,
                                    handler: c,
                                    guid: c.guid,
                                    selector: e,
                                    needsContext: e && n.expr.match.needsContext.test(e),
                                    namespace: p.join(".")
                                },
                                i
                            )),
                            (m = g[o]) ||
                                ((m = g[o] = []),
                                (m.delegateCount = 0),
                                (j.setup && j.setup.call(a, d, p, k) !== !1) || (a.addEventListener ? a.addEventListener(o, k, !1) : a.attachEvent && a.attachEvent("on" + o, k))),
                            j.add && (j.add.call(a, l), l.handler.guid || (l.handler.guid = c.guid)),
                            e ? m.splice(m.delegateCount++, 0, l) : m.push(l),
                            (n.event.global[o] = !0));
                a = null;
            }
        },
        remove: function(a, b, c, d, e) {
            var f,
                g,
                h,
                i,
                j,
                k,
                l,
                m,
                o,
                p,
                q,
                r = n.hasData(a) && n._data(a);
            if (r && (k = r.events)) {
                (b = (b || "").match(G) || [""]), (j = b.length);
                while (j--)
                    if (((h = oa.exec(b[j]) || []), (o = q = h[1]), (p = (h[2] || "").split(".").sort()), o)) {
                        (l = n.event.special[o] || {}),
                            (o = (d ? l.delegateType : l.bindType) || o),
                            (m = k[o] || []),
                            (h = h[2] && new RegExp("(^|\\.)" + p.join("\\.(?:.*\\.|)") + "(\\.|$)")),
                            (i = f = m.length);
                        while (f--)
                            (g = m[f]),
                                (!e && q !== g.origType) ||
                                    (c && c.guid !== g.guid) ||
                                    (h && !h.test(g.namespace)) ||
                                    (d && d !== g.selector && ("**" !== d || !g.selector)) ||
                                    (m.splice(f, 1), g.selector && m.delegateCount--, l.remove && l.remove.call(a, g));
                        i && !m.length && ((l.teardown && l.teardown.call(a, p, r.handle) !== !1) || n.removeEvent(a, o, r.handle), delete k[o]);
                    } else for (o in k) n.event.remove(a, o + b[j], c, d, !0);
                n.isEmptyObject(k) && (delete r.handle, n._removeData(a, "events"));
            }
        },
        trigger: function(b, c, e, f) {
            var g,
                h,
                i,
                j,
                l,
                m,
                o,
                p = [e || d],
                q = k.call(b, "type") ? b.type : b,
                r = k.call(b, "namespace") ? b.namespace.split(".") : [];
            if (
                ((i = m = e = e || d),
                3 !== e.nodeType &&
                    8 !== e.nodeType &&
                    !na.test(q + n.event.triggered) &&
                    (q.indexOf(".") > -1 && ((r = q.split(".")), (q = r.shift()), r.sort()),
                    (h = q.indexOf(":") < 0 && "on" + q),
                    (b = b[n.expando] ? b : new n.Event(q, "object" == typeof b && b)),
                    (b.isTrigger = f ? 2 : 3),
                    (b.namespace = r.join(".")),
                    (b.rnamespace = b.namespace ? new RegExp("(^|\\.)" + r.join("\\.(?:.*\\.|)") + "(\\.|$)") : null),
                    (b.result = void 0),
                    b.target || (b.target = e),
                    (c = null == c ? [b] : n.makeArray(c, [b])),
                    (l = n.event.special[q] || {}),
                    f || !l.trigger || l.trigger.apply(e, c) !== !1))
            ) {
                if (!f && !l.noBubble && !n.isWindow(e)) {
                    for (j = l.delegateType || q, na.test(j + q) || (i = i.parentNode); i; i = i.parentNode) p.push(i), (m = i);
                    m === (e.ownerDocument || d) && p.push(m.defaultView || m.parentWindow || a);
                }
                o = 0;
                while ((i = p[o++]) && !b.isPropagationStopped())
                    (b.type = o > 1 ? j : l.bindType || q),
                        (g = (n._data(i, "events") || {})[b.type] && n._data(i, "handle")),
                        g && g.apply(i, c),
                        (g = h && i[h]),
                        g && g.apply && M(i) && ((b.result = g.apply(i, c)), b.result === !1 && b.preventDefault());
                if (((b.type = q), !f && !b.isDefaultPrevented() && (!l._default || l._default.apply(p.pop(), c) === !1) && M(e) && h && e[q] && !n.isWindow(e))) {
                    (m = e[h]), m && (e[h] = null), (n.event.triggered = q);
                    try {
                        e[q]();
                    } catch (s) {}
                    (n.event.triggered = void 0), m && (e[h] = m);
                }
                return b.result;
            }
        },
        dispatch: function(a) {
            a = n.event.fix(a);
            var b,
                c,
                d,
                f,
                g,
                h = [],
                i = e.call(arguments),
                j = (n._data(this, "events") || {})[a.type] || [],
                k = n.event.special[a.type] || {};
            if (((i[0] = a), (a.delegateTarget = this), !k.preDispatch || k.preDispatch.call(this, a) !== !1)) {
                (h = n.event.handlers.call(this, a, j)), (b = 0);
                while ((f = h[b++]) && !a.isPropagationStopped()) {
                    (a.currentTarget = f.elem), (c = 0);
                    while ((g = f.handlers[c++]) && !a.isImmediatePropagationStopped())
                        (a.rnamespace && !a.rnamespace.test(g.namespace)) ||
                            ((a.handleObj = g),
                            (a.data = g.data),
                            (d = ((n.event.special[g.origType] || {}).handle || g.handler).apply(f.elem, i)),
                            void 0 !== d && (a.result = d) === !1 && (a.preventDefault(), a.stopPropagation()));
                }
                return k.postDispatch && k.postDispatch.call(this, a), a.result;
            }
        },
        handlers: function(a, b) {
            var c,
                d,
                e,
                f,
                g = [],
                h = b.delegateCount,
                i = a.target;
            if (h && i.nodeType && ("click" !== a.type || isNaN(a.button) || a.button < 1))
                for (; i != this; i = i.parentNode || this)
                    if (1 === i.nodeType && (i.disabled !== !0 || "click" !== a.type)) {
                        for (d = [], c = 0; h > c; c++)
                            (f = b[c]),
                                (e = f.selector + " "),
                                void 0 === d[e] && (d[e] = f.needsContext ? n(e, this).index(i) > -1 : n.find(e, this, null, [i]).length),
                                d[e] && d.push(f);
                        d.length && g.push({ elem: i, handlers: d });
                    }
            return h < b.length && g.push({ elem: this, handlers: b.slice(h) }), g;
        },
        fix: function(a) {
            if (a[n.expando]) return a;
            var b,
                c,
                e,
                f = a.type,
                g = a,
                h = this.fixHooks[f];
            h || (this.fixHooks[f] = h = ma.test(f) ? this.mouseHooks : la.test(f) ? this.keyHooks : {}),
                (e = h.props ? this.props.concat(h.props) : this.props),
                (a = new n.Event(g)),
                (b = e.length);
            while (b--) (c = e[b]), (a[c] = g[c]);
            return (
                a.target || (a.target = g.srcElement || d), 3 === a.target.nodeType && (a.target = a.target.parentNode), (a.metaKey = !!a.metaKey), h.filter ? h.filter(a, g) : a
            );
        },
        props: "altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),
        fixHooks: {},
        keyHooks: {
            props: "char charCode key keyCode".split(" "),
            filter: function(a, b) {
                return null == a.which && (a.which = null != b.charCode ? b.charCode : b.keyCode), a;
            }
        },
        mouseHooks: {
            props: "button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),
            filter: function(a, b) {
                var c,
                    e,
                    f,
                    g = b.button,
                    h = b.fromElement;
                return (
                    null == a.pageX &&
                        null != b.clientX &&
                        ((e = a.target.ownerDocument || d),
                        (f = e.documentElement),
                        (c = e.body),
                        (a.pageX = b.clientX + ((f && f.scrollLeft) || (c && c.scrollLeft) || 0) - ((f && f.clientLeft) || (c && c.clientLeft) || 0)),
                        (a.pageY = b.clientY + ((f && f.scrollTop) || (c && c.scrollTop) || 0) - ((f && f.clientTop) || (c && c.clientTop) || 0))),
                    !a.relatedTarget && h && (a.relatedTarget = h === a.target ? b.toElement : h),
                    a.which || void 0 === g || (a.which = 1 & g ? 1 : 2 & g ? 3 : 4 & g ? 2 : 0),
                    a
                );
            }
        },
        special: {
            load: { noBubble: !0 },
            focus: {
                trigger: function() {
                    if (this !== ra() && this.focus)
                        try {
                            return this.focus(), !1;
                        } catch (a) {}
                },
                delegateType: "focusin"
            },
            blur: {
                trigger: function() {
                    return this === ra() && this.blur ? (this.blur(), !1) : void 0;
                },
                delegateType: "focusout"
            },
            click: {
                trigger: function() {
                    return n.nodeName(this, "input") && "checkbox" === this.type && this.click ? (this.click(), !1) : void 0;
                },
                _default: function(a) {
                    return n.nodeName(a.target, "a");
                }
            },
            beforeunload: {
                postDispatch: function(a) {
                    void 0 !== a.result && a.originalEvent && (a.originalEvent.returnValue = a.result);
                }
            }
        },
        simulate: function(a, b, c) {
            var d = n.extend(new n.Event(), c, { type: a, isSimulated: !0 });
            n.event.trigger(d, null, b), d.isDefaultPrevented() && c.preventDefault();
        }
    }),
        (n.removeEvent = d.removeEventListener
            ? function(a, b, c) {
                  a.removeEventListener && a.removeEventListener(b, c);
              }
            : function(a, b, c) {
                  var d = "on" + b;
                  a.detachEvent && ("undefined" == typeof a[d] && (a[d] = null), a.detachEvent(d, c));
              }),
        (n.Event = function(a, b) {
            return this instanceof n.Event
                ? (a && a.type
                      ? ((this.originalEvent = a),
                        (this.type = a.type),
                        (this.isDefaultPrevented = a.defaultPrevented || (void 0 === a.defaultPrevented && a.returnValue === !1) ? pa : qa))
                      : (this.type = a),
                  b && n.extend(this, b),
                  (this.timeStamp = (a && a.timeStamp) || n.now()),
                  void (this[n.expando] = !0))
                : new n.Event(a, b);
        }),
        (n.Event.prototype = {
            constructor: n.Event,
            isDefaultPrevented: qa,
            isPropagationStopped: qa,
            isImmediatePropagationStopped: qa,
            preventDefault: function() {
                var a = this.originalEvent;
                (this.isDefaultPrevented = pa), a && (a.preventDefault ? a.preventDefault() : (a.returnValue = !1));
            },
            stopPropagation: function() {
                var a = this.originalEvent;
                (this.isPropagationStopped = pa), a && !this.isSimulated && (a.stopPropagation && a.stopPropagation(), (a.cancelBubble = !0));
            },
            stopImmediatePropagation: function() {
                var a = this.originalEvent;
                (this.isImmediatePropagationStopped = pa), a && a.stopImmediatePropagation && a.stopImmediatePropagation(), this.stopPropagation();
            }
        }),
        n.each({ mouseenter: "mouseover", mouseleave: "mouseout", pointerenter: "pointerover", pointerleave: "pointerout" }, function(a, b) {
            n.event.special[a] = {
                delegateType: b,
                bindType: b,
                handle: function(a) {
                    var c,
                        d = this,
                        e = a.relatedTarget,
                        f = a.handleObj;
                    return (e && (e === d || n.contains(d, e))) || ((a.type = f.origType), (c = f.handler.apply(this, arguments)), (a.type = b)), c;
                }
            };
        }),
        l.submit ||
            (n.event.special.submit = {
                setup: function() {
                    return n.nodeName(this, "form")
                        ? !1
                        : void n.event.add(this, "click._submit keypress._submit", function(a) {
                              var b = a.target,
                                  c = n.nodeName(b, "input") || n.nodeName(b, "button") ? n.prop(b, "form") : void 0;
                              c &&
                                  !n._data(c, "submit") &&
                                  (n.event.add(c, "submit._submit", function(a) {
                                      a._submitBubble = !0;
                                  }),
                                  n._data(c, "submit", !0));
                          });
                },
                postDispatch: function(a) {
                    a._submitBubble && (delete a._submitBubble, this.parentNode && !a.isTrigger && n.event.simulate("submit", this.parentNode, a));
                },
                teardown: function() {
                    return n.nodeName(this, "form") ? !1 : void n.event.remove(this, "._submit");
                }
            }),
        l.change ||
            (n.event.special.change = {
                setup: function() {
                    return ka.test(this.nodeName)
                        ? (("checkbox" !== this.type && "radio" !== this.type) ||
                              (n.event.add(this, "propertychange._change", function(a) {
                                  "checked" === a.originalEvent.propertyName && (this._justChanged = !0);
                              }),
                              n.event.add(this, "click._change", function(a) {
                                  this._justChanged && !a.isTrigger && (this._justChanged = !1), n.event.simulate("change", this, a);
                              })),
                          !1)
                        : void n.event.add(this, "beforeactivate._change", function(a) {
                              var b = a.target;
                              ka.test(b.nodeName) &&
                                  !n._data(b, "change") &&
                                  (n.event.add(b, "change._change", function(a) {
                                      !this.parentNode || a.isSimulated || a.isTrigger || n.event.simulate("change", this.parentNode, a);
                                  }),
                                  n._data(b, "change", !0));
                          });
                },
                handle: function(a) {
                    var b = a.target;
                    return this !== b || a.isSimulated || a.isTrigger || ("radio" !== b.type && "checkbox" !== b.type) ? a.handleObj.handler.apply(this, arguments) : void 0;
                },
                teardown: function() {
                    return n.event.remove(this, "._change"), !ka.test(this.nodeName);
                }
            }),
        l.focusin ||
            n.each({ focus: "focusin", blur: "focusout" }, function(a, b) {
                var c = function(a) {
                    n.event.simulate(b, a.target, n.event.fix(a));
                };
                n.event.special[b] = {
                    setup: function() {
                        var d = this.ownerDocument || this,
                            e = n._data(d, b);
                        e || d.addEventListener(a, c, !0), n._data(d, b, (e || 0) + 1);
                    },
                    teardown: function() {
                        var d = this.ownerDocument || this,
                            e = n._data(d, b) - 1;
                        e ? n._data(d, b, e) : (d.removeEventListener(a, c, !0), n._removeData(d, b));
                    }
                };
            }),
        n.fn.extend({
            on: function(a, b, c, d) {
                return sa(this, a, b, c, d);
            },
            one: function(a, b, c, d) {
                return sa(this, a, b, c, d, 1);
            },
            off: function(a, b, c) {
                var d, e;
                if (a && a.preventDefault && a.handleObj)
                    return (d = a.handleObj), n(a.delegateTarget).off(d.namespace ? d.origType + "." + d.namespace : d.origType, d.selector, d.handler), this;
                if ("object" == typeof a) {
                    for (e in a) this.off(e, b, a[e]);
                    return this;
                }
                return (
                    (b !== !1 && "function" != typeof b) || ((c = b), (b = void 0)),
                    c === !1 && (c = qa),
                    this.each(function() {
                        n.event.remove(this, a, c, b);
                    })
                );
            },
            trigger: function(a, b) {
                return this.each(function() {
                    n.event.trigger(a, b, this);
                });
            },
            triggerHandler: function(a, b) {
                var c = this[0];
                return c ? n.event.trigger(a, b, c, !0) : void 0;
            }
        });
    var ta = / jQuery\d+="(?:null|\d+)"/g,
        ua = new RegExp("<(?:" + ba + ")[\\s/>]", "i"),
        va = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,
        wa = /<script|<style|<link/i,
        xa = /checked\s*(?:[^=]|=\s*.checked.)/i,
        ya = /^true\/(.*)/,
        za = /^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,
        Aa = ca(d),
        Ba = Aa.appendChild(d.createElement("div"));
    function Ca(a, b) {
        return n.nodeName(a, "table") && n.nodeName(11 !== b.nodeType ? b : b.firstChild, "tr")
            ? a.getElementsByTagName("tbody")[0] || a.appendChild(a.ownerDocument.createElement("tbody"))
            : a;
    }
    function Da(a) {
        return (a.type = (null !== n.find.attr(a, "type")) + "/" + a.type), a;
    }
    function Ea(a) {
        var b = ya.exec(a.type);
        return b ? (a.type = b[1]) : a.removeAttribute("type"), a;
    }
    function Fa(a, b) {
        if (1 === b.nodeType && n.hasData(a)) {
            var c,
                d,
                e,
                f = n._data(a),
                g = n._data(b, f),
                h = f.events;
            if (h) {
                delete g.handle, (g.events = {});
                for (c in h) for (d = 0, e = h[c].length; e > d; d++) n.event.add(b, c, h[c][d]);
            }
            g.data && (g.data = n.extend({}, g.data));
        }
    }
    function Ga(a, b) {
        var c, d, e;
        if (1 === b.nodeType) {
            if (((c = b.nodeName.toLowerCase()), !l.noCloneEvent && b[n.expando])) {
                e = n._data(b);
                for (d in e.events) n.removeEvent(b, d, e.handle);
                b.removeAttribute(n.expando);
            }
            "script" === c && b.text !== a.text
                ? ((Da(b).text = a.text), Ea(b))
                : "object" === c
                ? (b.parentNode && (b.outerHTML = a.outerHTML), l.html5Clone && a.innerHTML && !n.trim(b.innerHTML) && (b.innerHTML = a.innerHTML))
                : "input" === c && Z.test(a.type)
                ? ((b.defaultChecked = b.checked = a.checked), b.value !== a.value && (b.value = a.value))
                : "option" === c
                ? (b.defaultSelected = b.selected = a.defaultSelected)
                : ("input" !== c && "textarea" !== c) || (b.defaultValue = a.defaultValue);
        }
    }
    function Ha(a, b, c, d) {
        b = f.apply([], b);
        var e,
            g,
            h,
            i,
            j,
            k,
            m = 0,
            o = a.length,
            p = o - 1,
            q = b[0],
            r = n.isFunction(q);
        if (r || (o > 1 && "string" == typeof q && !l.checkClone && xa.test(q)))
            return a.each(function(e) {
                var f = a.eq(e);
                r && (b[0] = q.call(this, e, f.html())), Ha(f, b, c, d);
            });
        if (o && ((k = ja(b, a[0].ownerDocument, !1, a, d)), (e = k.firstChild), 1 === k.childNodes.length && (k = e), e || d)) {
            for (i = n.map(ea(k, "script"), Da), h = i.length; o > m; m++) (g = k), m !== p && ((g = n.clone(g, !0, !0)), h && n.merge(i, ea(g, "script"))), c.call(a[m], g, m);
            if (h)
                for (j = i[i.length - 1].ownerDocument, n.map(i, Ea), m = 0; h > m; m++)
                    (g = i[m]),
                        _.test(g.type || "") &&
                            !n._data(g, "globalEval") &&
                            n.contains(j, g) &&
                            (g.src ? n._evalUrl && n._evalUrl(g.src) : n.globalEval((g.text || g.textContent || g.innerHTML || "").replace(za, "")));
            k = e = null;
        }
        return a;
    }
    function Ia(a, b, c) {
        for (var d, e = b ? n.filter(b, a) : a, f = 0; null != (d = e[f]); f++)
            c || 1 !== d.nodeType || n.cleanData(ea(d)), d.parentNode && (c && n.contains(d.ownerDocument, d) && fa(ea(d, "script")), d.parentNode.removeChild(d));
        return a;
    }
    n.extend({
        htmlPrefilter: function(a) {
            return a.replace(va, "<$1></$2>");
        },
        clone: function(a, b, c) {
            var d,
                e,
                f,
                g,
                h,
                i = n.contains(a.ownerDocument, a);
            if (
                (l.html5Clone || n.isXMLDoc(a) || !ua.test("<" + a.nodeName + ">") ? (f = a.cloneNode(!0)) : ((Ba.innerHTML = a.outerHTML), Ba.removeChild((f = Ba.firstChild))),
                !((l.noCloneEvent && l.noCloneChecked) || (1 !== a.nodeType && 11 !== a.nodeType) || n.isXMLDoc(a)))
            )
                for (d = ea(f), h = ea(a), g = 0; null != (e = h[g]); ++g) d[g] && Ga(e, d[g]);
            if (b)
                if (c) for (h = h || ea(a), d = d || ea(f), g = 0; null != (e = h[g]); g++) Fa(e, d[g]);
                else Fa(a, f);
            return (d = ea(f, "script")), d.length > 0 && fa(d, !i && ea(a, "script")), (d = h = e = null), f;
        },
        cleanData: function(a, b) {
            for (var d, e, f, g, h = 0, i = n.expando, j = n.cache, k = l.attributes, m = n.event.special; null != (d = a[h]); h++)
                if ((b || M(d)) && ((f = d[i]), (g = f && j[f]))) {
                    if (g.events) for (e in g.events) m[e] ? n.event.remove(d, e) : n.removeEvent(d, e, g.handle);
                    j[f] && (delete j[f], k || "undefined" == typeof d.removeAttribute ? (d[i] = void 0) : d.removeAttribute(i), c.push(f));
                }
        }
    }),
        n.fn.extend({
            domManip: Ha,
            detach: function(a) {
                return Ia(this, a, !0);
            },
            remove: function(a) {
                return Ia(this, a);
            },
            text: function(a) {
                return Y(
                    this,
                    function(a) {
                        return void 0 === a ? n.text(this) : this.empty().append(((this[0] && this[0].ownerDocument) || d).createTextNode(a));
                    },
                    null,
                    a,
                    arguments.length
                );
            },
            append: function() {
                return Ha(this, arguments, function(a) {
                    if (1 === this.nodeType || 11 === this.nodeType || 9 === this.nodeType) {
                        var b = Ca(this, a);
                        b.appendChild(a);
                    }
                });
            },
            prepend: function() {
                return Ha(this, arguments, function(a) {
                    if (1 === this.nodeType || 11 === this.nodeType || 9 === this.nodeType) {
                        var b = Ca(this, a);
                        b.insertBefore(a, b.firstChild);
                    }
                });
            },
            before: function() {
                return Ha(this, arguments, function(a) {
                    this.parentNode && this.parentNode.insertBefore(a, this);
                });
            },
            after: function() {
                return Ha(this, arguments, function(a) {
                    this.parentNode && this.parentNode.insertBefore(a, this.nextSibling);
                });
            },
            empty: function() {
                for (var a, b = 0; null != (a = this[b]); b++) {
                    1 === a.nodeType && n.cleanData(ea(a, !1));
                    while (a.firstChild) a.removeChild(a.firstChild);
                    a.options && n.nodeName(a, "select") && (a.options.length = 0);
                }
                return this;
            },
            clone: function(a, b) {
                return (
                    (a = null == a ? !1 : a),
                    (b = null == b ? a : b),
                    this.map(function() {
                        return n.clone(this, a, b);
                    })
                );
            },
            html: function(a) {
                return Y(
                    this,
                    function(a) {
                        var b = this[0] || {},
                            c = 0,
                            d = this.length;
                        if (void 0 === a) return 1 === b.nodeType ? b.innerHTML.replace(ta, "") : void 0;
                        if (
                            "string" == typeof a &&
                            !wa.test(a) &&
                            (l.htmlSerialize || !ua.test(a)) &&
                            (l.leadingWhitespace || !aa.test(a)) &&
                            !da[($.exec(a) || ["", ""])[1].toLowerCase()]
                        ) {
                            a = n.htmlPrefilter(a);
                            try {
                                for (; d > c; c++) (b = this[c] || {}), 1 === b.nodeType && (n.cleanData(ea(b, !1)), (b.innerHTML = a));
                                b = 0;
                            } catch (e) {}
                        }
                        b && this.empty().append(a);
                    },
                    null,
                    a,
                    arguments.length
                );
            },
            replaceWith: function() {
                var a = [];
                return Ha(
                    this,
                    arguments,
                    function(b) {
                        var c = this.parentNode;
                        n.inArray(this, a) < 0 && (n.cleanData(ea(this)), c && c.replaceChild(b, this));
                    },
                    a
                );
            }
        }),
        n.each({ appendTo: "append", prependTo: "prepend", insertBefore: "before", insertAfter: "after", replaceAll: "replaceWith" }, function(a, b) {
            n.fn[a] = function(a) {
                for (var c, d = 0, e = [], f = n(a), h = f.length - 1; h >= d; d++) (c = d === h ? this : this.clone(!0)), n(f[d])[b](c), g.apply(e, c.get());
                return this.pushStack(e);
            };
        });
    var Ja,
        Ka = { HTML: "block", BODY: "block" };
    function La(a, b) {
        var c = n(b.createElement(a)).appendTo(b.body),
            d = n.css(c[0], "display");
        return c.detach(), d;
    }
    function Ma(a) {
        var b = d,
            c = Ka[a];
        return (
            c ||
                ((c = La(a, b)),
                ("none" !== c && c) ||
                    ((Ja = (Ja || n("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement)),
                    (b = (Ja[0].contentWindow || Ja[0].contentDocument).document),
                    b.write(),
                    b.close(),
                    (c = La(a, b)),
                    Ja.detach()),
                (Ka[a] = c)),
            c
        );
    }
    var Na = /^margin/,
        Oa = new RegExp("^(" + T + ")(?!px)[a-z%]+$", "i"),
        Pa = function(a, b, c, d) {
            var e,
                f,
                g = {};
            for (f in b) (g[f] = a.style[f]), (a.style[f] = b[f]);
            e = c.apply(a, d || []);
            for (f in b) a.style[f] = g[f];
            return e;
        },
        Qa = d.documentElement;
    !(function() {
        var b,
            c,
            e,
            f,
            g,
            h,
            i = d.createElement("div"),
            j = d.createElement("div");
        if (j.style) {
            (j.style.cssText = "float:left;opacity:.5"),
                (l.opacity = "0.5" === j.style.opacity),
                (l.cssFloat = !!j.style.cssFloat),
                (j.style.backgroundClip = "content-box"),
                (j.cloneNode(!0).style.backgroundClip = ""),
                (l.clearCloneStyle = "content-box" === j.style.backgroundClip),
                (i = d.createElement("div")),
                (i.style.cssText = "border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute"),
                (j.innerHTML = ""),
                i.appendChild(j),
                (l.boxSizing = "" === j.style.boxSizing || "" === j.style.MozBoxSizing || "" === j.style.WebkitBoxSizing),
                n.extend(l, {
                    reliableHiddenOffsets: function() {
                        return null == b && k(), f;
                    },
                    boxSizingReliable: function() {
                        return null == b && k(), e;
                    },
                    pixelMarginRight: function() {
                        return null == b && k(), c;
                    },
                    pixelPosition: function() {
                        return null == b && k(), b;
                    },
                    reliableMarginRight: function() {
                        return null == b && k(), g;
                    },
                    reliableMarginLeft: function() {
                        return null == b && k(), h;
                    }
                });
            function k() {
                var k,
                    l,
                    m = d.documentElement;
                m.appendChild(i),
                    (j.style.cssText = "-webkit-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%"),
                    (b = e = h = !1),
                    (c = g = !0),
                    a.getComputedStyle &&
                        ((l = a.getComputedStyle(j)),
                        (b = "1%" !== (l || {}).top),
                        (h = "2px" === (l || {}).marginLeft),
                        (e = "4px" === (l || { width: "4px" }).width),
                        (j.style.marginRight = "50%"),
                        (c = "4px" === (l || { marginRight: "4px" }).marginRight),
                        (k = j.appendChild(d.createElement("div"))),
                        (k.style.cssText = j.style.cssText =
                            "-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0"),
                        (k.style.marginRight = k.style.width = "0"),
                        (j.style.width = "1px"),
                        (g = !parseFloat((a.getComputedStyle(k) || {}).marginRight)),
                        j.removeChild(k)),
                    (j.style.display = "none"),
                    (f = 0 === j.getClientRects().length),
                    f &&
                        ((j.style.display = ""),
                        (j.innerHTML = "<table><tr><td></td><td>t</td></tr></table>"),
                        (j.childNodes[0].style.borderCollapse = "separate"),
                        (k = j.getElementsByTagName("td")),
                        (k[0].style.cssText = "margin:0;border:0;padding:0;display:none"),
                        (f = 0 === k[0].offsetHeight),
                        f && ((k[0].style.display = ""), (k[1].style.display = "none"), (f = 0 === k[0].offsetHeight))),
                    m.removeChild(i);
            }
        }
    })();
    var Ra,
        Sa,
        Ta = /^(top|right|bottom|left)$/;
    a.getComputedStyle
        ? ((Ra = function(b) {
              var c = b.ownerDocument.defaultView;
              return (c && c.opener) || (c = a), c.getComputedStyle(b);
          }),
          (Sa = function(a, b, c) {
              var d,
                  e,
                  f,
                  g,
                  h = a.style;
              return (
                  (c = c || Ra(a)),
                  (g = c ? c.getPropertyValue(b) || c[b] : void 0),
                  ("" !== g && void 0 !== g) || n.contains(a.ownerDocument, a) || (g = n.style(a, b)),
                  c &&
                      !l.pixelMarginRight() &&
                      Oa.test(g) &&
                      Na.test(b) &&
                      ((d = h.width),
                      (e = h.minWidth),
                      (f = h.maxWidth),
                      (h.minWidth = h.maxWidth = h.width = g),
                      (g = c.width),
                      (h.width = d),
                      (h.minWidth = e),
                      (h.maxWidth = f)),
                  void 0 === g ? g : g + ""
              );
          }))
        : Qa.currentStyle &&
          ((Ra = function(a) {
              return a.currentStyle;
          }),
          (Sa = function(a, b, c) {
              var d,
                  e,
                  f,
                  g,
                  h = a.style;
              return (
                  (c = c || Ra(a)),
                  (g = c ? c[b] : void 0),
                  null == g && h && h[b] && (g = h[b]),
                  Oa.test(g) &&
                      !Ta.test(b) &&
                      ((d = h.left),
                      (e = a.runtimeStyle),
                      (f = e && e.left),
                      f && (e.left = a.currentStyle.left),
                      (h.left = "fontSize" === b ? "1em" : g),
                      (g = h.pixelLeft + "px"),
                      (h.left = d),
                      f && (e.left = f)),
                  void 0 === g ? g : g + "" || "auto"
              );
          }));
    function Ua(a, b) {
        return {
            get: function() {
                return a() ? void delete this.get : (this.get = b).apply(this, arguments);
            }
        };
    }
    var Va = /alpha\([^)]*\)/i,
        Wa = /opacity\s*=\s*([^)]*)/i,
        Xa = /^(none|table(?!-c[ea]).+)/,
        Ya = new RegExp("^(" + T + ")(.*)$", "i"),
        Za = { position: "absolute", visibility: "hidden", display: "block" },
        $a = { letterSpacing: "0", fontWeight: "400" },
        _a = ["Webkit", "O", "Moz", "ms"],
        ab = d.createElement("div").style;
    function bb(a) {
        if (a in ab) return a;
        var b = a.charAt(0).toUpperCase() + a.slice(1),
            c = _a.length;
        while (c--) if (((a = _a[c] + b), a in ab)) return a;
    }
    function cb(a, b) {
        for (var c, d, e, f = [], g = 0, h = a.length; h > g; g++)
            (d = a[g]),
                d.style &&
                    ((f[g] = n._data(d, "olddisplay")),
                    (c = d.style.display),
                    b
                        ? (f[g] || "none" !== c || (d.style.display = ""), "" === d.style.display && W(d) && (f[g] = n._data(d, "olddisplay", Ma(d.nodeName))))
                        : ((e = W(d)), ((c && "none" !== c) || !e) && n._data(d, "olddisplay", e ? c : n.css(d, "display"))));
        for (g = 0; h > g; g++) (d = a[g]), d.style && ((b && "none" !== d.style.display && "" !== d.style.display) || (d.style.display = b ? f[g] || "" : "none"));
        return a;
    }
    function db(a, b, c) {
        var d = Ya.exec(b);
        return d ? Math.max(0, d[1] - (c || 0)) + (d[2] || "px") : b;
    }
    function eb(a, b, c, d, e) {
        for (var f = c === (d ? "border" : "content") ? 4 : "width" === b ? 1 : 0, g = 0; 4 > f; f += 2)
            "margin" === c && (g += n.css(a, c + V[f], !0, e)),
                d
                    ? ("content" === c && (g -= n.css(a, "padding" + V[f], !0, e)), "margin" !== c && (g -= n.css(a, "border" + V[f] + "Width", !0, e)))
                    : ((g += n.css(a, "padding" + V[f], !0, e)), "padding" !== c && (g += n.css(a, "border" + V[f] + "Width", !0, e)));
        return g;
    }
    function fb(a, b, c) {
        var d = !0,
            e = "width" === b ? a.offsetWidth : a.offsetHeight,
            f = Ra(a),
            g = l.boxSizing && "border-box" === n.css(a, "boxSizing", !1, f);
        if (0 >= e || null == e) {
            if (((e = Sa(a, b, f)), (0 > e || null == e) && (e = a.style[b]), Oa.test(e))) return e;
            (d = g && (l.boxSizingReliable() || e === a.style[b])), (e = parseFloat(e) || 0);
        }
        return e + eb(a, b, c || (g ? "border" : "content"), d, f) + "px";
    }
    n.extend({
        cssHooks: {
            opacity: {
                get: function(a, b) {
                    if (b) {
                        var c = Sa(a, "opacity");
                        return "" === c ? "1" : c;
                    }
                }
            }
        },
        cssNumber: {
            animationIterationCount: !0,
            columnCount: !0,
            fillOpacity: !0,
            flexGrow: !0,
            flexShrink: !0,
            fontWeight: !0,
            lineHeight: !0,
            opacity: !0,
            order: !0,
            orphans: !0,
            widows: !0,
            zIndex: !0,
            zoom: !0
        },
        cssProps: { float: l.cssFloat ? "cssFloat" : "styleFloat" },
        style: function(a, b, c, d) {
            if (a && 3 !== a.nodeType && 8 !== a.nodeType && a.style) {
                var e,
                    f,
                    g,
                    h = n.camelCase(b),
                    i = a.style;
                if (((b = n.cssProps[h] || (n.cssProps[h] = bb(h) || h)), (g = n.cssHooks[b] || n.cssHooks[h]), void 0 === c))
                    return g && "get" in g && void 0 !== (e = g.get(a, !1, d)) ? e : i[b];
                if (
                    ((f = typeof c),
                    "string" === f && (e = U.exec(c)) && e[1] && ((c = X(a, b, e)), (f = "number")),
                    null != c &&
                        c === c &&
                        ("number" === f && (c += (e && e[3]) || (n.cssNumber[h] ? "" : "px")),
                        l.clearCloneStyle || "" !== c || 0 !== b.indexOf("background") || (i[b] = "inherit"),
                        !(g && "set" in g && void 0 === (c = g.set(a, c, d)))))
                )
                    try {
                        i[b] = c;
                    } catch (j) {}
            }
        },
        css: function(a, b, c, d) {
            var e,
                f,
                g,
                h = n.camelCase(b);
            return (
                (b = n.cssProps[h] || (n.cssProps[h] = bb(h) || h)),
                (g = n.cssHooks[b] || n.cssHooks[h]),
                g && "get" in g && (f = g.get(a, !0, c)),
                void 0 === f && (f = Sa(a, b, d)),
                "normal" === f && b in $a && (f = $a[b]),
                "" === c || c ? ((e = parseFloat(f)), c === !0 || isFinite(e) ? e || 0 : f) : f
            );
        }
    }),
        n.each(["height", "width"], function(a, b) {
            n.cssHooks[b] = {
                get: function(a, c, d) {
                    return c
                        ? Xa.test(n.css(a, "display")) && 0 === a.offsetWidth
                            ? Pa(a, Za, function() {
                                  return fb(a, b, d);
                              })
                            : fb(a, b, d)
                        : void 0;
                },
                set: function(a, c, d) {
                    var e = d && Ra(a);
                    return db(a, c, d ? eb(a, b, d, l.boxSizing && "border-box" === n.css(a, "boxSizing", !1, e), e) : 0);
                }
            };
        }),
        l.opacity ||
            (n.cssHooks.opacity = {
                get: function(a, b) {
                    return Wa.test((b && a.currentStyle ? a.currentStyle.filter : a.style.filter) || "") ? 0.01 * parseFloat(RegExp.$1) + "" : b ? "1" : "";
                },
                set: function(a, b) {
                    var c = a.style,
                        d = a.currentStyle,
                        e = n.isNumeric(b) ? "alpha(opacity=" + 100 * b + ")" : "",
                        f = (d && d.filter) || c.filter || "";
                    (c.zoom = 1),
                        ((b >= 1 || "" === b) && "" === n.trim(f.replace(Va, "")) && c.removeAttribute && (c.removeAttribute("filter"), "" === b || (d && !d.filter))) ||
                            (c.filter = Va.test(f) ? f.replace(Va, e) : f + " " + e);
                }
            }),
        (n.cssHooks.marginRight = Ua(l.reliableMarginRight, function(a, b) {
            return b ? Pa(a, { display: "inline-block" }, Sa, [a, "marginRight"]) : void 0;
        })),
        (n.cssHooks.marginLeft = Ua(l.reliableMarginLeft, function(a, b) {
            return b
                ? (parseFloat(Sa(a, "marginLeft")) ||
                      (n.contains(a.ownerDocument, a)
                          ? a.getBoundingClientRect().left -
                            Pa(
                                a,
                                {
                                    marginLeft: 0
                                },
                                function() {
                                    return a.getBoundingClientRect().left;
                                }
                            )
                          : 0)) + "px"
                : void 0;
        })),
        n.each({ margin: "", padding: "", border: "Width" }, function(a, b) {
            (n.cssHooks[a + b] = {
                expand: function(c) {
                    for (var d = 0, e = {}, f = "string" == typeof c ? c.split(" ") : [c]; 4 > d; d++) e[a + V[d] + b] = f[d] || f[d - 2] || f[0];
                    return e;
                }
            }),
                Na.test(a) || (n.cssHooks[a + b].set = db);
        }),
        n.fn.extend({
            css: function(a, b) {
                return Y(
                    this,
                    function(a, b, c) {
                        var d,
                            e,
                            f = {},
                            g = 0;
                        if (n.isArray(b)) {
                            for (d = Ra(a), e = b.length; e > g; g++) f[b[g]] = n.css(a, b[g], !1, d);
                            return f;
                        }
                        return void 0 !== c ? n.style(a, b, c) : n.css(a, b);
                    },
                    a,
                    b,
                    arguments.length > 1
                );
            },
            show: function() {
                return cb(this, !0);
            },
            hide: function() {
                return cb(this);
            },
            toggle: function(a) {
                return "boolean" == typeof a
                    ? a
                        ? this.show()
                        : this.hide()
                    : this.each(function() {
                          W(this) ? n(this).show() : n(this).hide();
                      });
            }
        });
    function gb(a, b, c, d, e) {
        return new gb.prototype.init(a, b, c, d, e);
    }
    (n.Tween = gb),
        (gb.prototype = {
            constructor: gb,
            init: function(a, b, c, d, e, f) {
                (this.elem = a),
                    (this.prop = c),
                    (this.easing = e || n.easing._default),
                    (this.options = b),
                    (this.start = this.now = this.cur()),
                    (this.end = d),
                    (this.unit = f || (n.cssNumber[c] ? "" : "px"));
            },
            cur: function() {
                var a = gb.propHooks[this.prop];
                return a && a.get ? a.get(this) : gb.propHooks._default.get(this);
            },
            run: function(a) {
                var b,
                    c = gb.propHooks[this.prop];
                return (
                    this.options.duration ? (this.pos = b = n.easing[this.easing](a, this.options.duration * a, 0, 1, this.options.duration)) : (this.pos = b = a),
                    (this.now = (this.end - this.start) * b + this.start),
                    this.options.step && this.options.step.call(this.elem, this.now, this),
                    c && c.set ? c.set(this) : gb.propHooks._default.set(this),
                    this
                );
            }
        }),
        (gb.prototype.init.prototype = gb.prototype),
        (gb.propHooks = {
            _default: {
                get: function(a) {
                    var b;
                    return 1 !== a.elem.nodeType || (null != a.elem[a.prop] && null == a.elem.style[a.prop])
                        ? a.elem[a.prop]
                        : ((b = n.css(a.elem, a.prop, "")), b && "auto" !== b ? b : 0);
                },
                set: function(a) {
                    n.fx.step[a.prop]
                        ? n.fx.step[a.prop](a)
                        : 1 !== a.elem.nodeType || (null == a.elem.style[n.cssProps[a.prop]] && !n.cssHooks[a.prop])
                        ? (a.elem[a.prop] = a.now)
                        : n.style(a.elem, a.prop, a.now + a.unit);
                }
            }
        }),
        (gb.propHooks.scrollTop = gb.propHooks.scrollLeft = {
            set: function(a) {
                a.elem.nodeType && a.elem.parentNode && (a.elem[a.prop] = a.now);
            }
        }),
        (n.easing = {
            linear: function(a) {
                return a;
            },
            swing: function(a) {
                return 0.5 - Math.cos(a * Math.PI) / 2;
            },
            _default: "swing"
        }),
        (n.fx = gb.prototype.init),
        (n.fx.step = {});
    var hb,
        ib,
        jb = /^(?:toggle|show|hide)$/,
        kb = /queueHooks$/;
    function lb() {
        return (
            a.setTimeout(function() {
                hb = void 0;
            }),
            (hb = n.now())
        );
    }
    function mb(a, b) {
        var c,
            d = { height: a },
            e = 0;
        for (b = b ? 1 : 0; 4 > e; e += 2 - b) (c = V[e]), (d["margin" + c] = d["padding" + c] = a);
        return b && (d.opacity = d.width = a), d;
    }
    function nb(a, b, c) {
        for (var d, e = (qb.tweeners[b] || []).concat(qb.tweeners["*"]), f = 0, g = e.length; g > f; f++) if ((d = e[f].call(c, b, a))) return d;
    }
    function ob(a, b, c) {
        var d,
            e,
            f,
            g,
            h,
            i,
            j,
            k,
            m = this,
            o = {},
            p = a.style,
            q = a.nodeType && W(a),
            r = n._data(a, "fxshow");
        c.queue ||
            ((h = n._queueHooks(a, "fx")),
            null == h.unqueued &&
                ((h.unqueued = 0),
                (i = h.empty.fire),
                (h.empty.fire = function() {
                    h.unqueued || i();
                })),
            h.unqueued++,
            m.always(function() {
                m.always(function() {
                    h.unqueued--, n.queue(a, "fx").length || h.empty.fire();
                });
            })),
            1 === a.nodeType &&
                ("height" in b || "width" in b) &&
                ((c.overflow = [p.overflow, p.overflowX, p.overflowY]),
                (j = n.css(a, "display")),
                (k = "none" === j ? n._data(a, "olddisplay") || Ma(a.nodeName) : j),
                "inline" === k && "none" === n.css(a, "float") && (l.inlineBlockNeedsLayout && "inline" !== Ma(a.nodeName) ? (p.zoom = 1) : (p.display = "inline-block"))),
            c.overflow &&
                ((p.overflow = "hidden"),
                l.shrinkWrapBlocks() ||
                    m.always(function() {
                        (p.overflow = c.overflow[0]), (p.overflowX = c.overflow[1]), (p.overflowY = c.overflow[2]);
                    }));
        for (d in b)
            if (((e = b[d]), jb.exec(e))) {
                if ((delete b[d], (f = f || "toggle" === e), e === (q ? "hide" : "show"))) {
                    if ("show" !== e || !r || void 0 === r[d]) continue;
                    q = !0;
                }
                o[d] = (r && r[d]) || n.style(a, d);
            } else j = void 0;
        if (n.isEmptyObject(o)) "inline" === ("none" === j ? Ma(a.nodeName) : j) && (p.display = j);
        else {
            r ? "hidden" in r && (q = r.hidden) : (r = n._data(a, "fxshow", {})),
                f && (r.hidden = !q),
                q
                    ? n(a).show()
                    : m.done(function() {
                          n(a).hide();
                      }),
                m.done(function() {
                    var b;
                    n._removeData(a, "fxshow");
                    for (b in o) n.style(a, b, o[b]);
                });
            for (d in o) (g = nb(q ? r[d] : 0, d, m)), d in r || ((r[d] = g.start), q && ((g.end = g.start), (g.start = "width" === d || "height" === d ? 1 : 0)));
        }
    }
    function pb(a, b) {
        var c, d, e, f, g;
        for (c in a)
            if (
                ((d = n.camelCase(c)),
                (e = b[d]),
                (f = a[c]),
                n.isArray(f) && ((e = f[1]), (f = a[c] = f[0])),
                c !== d && ((a[d] = f), delete a[c]),
                (g = n.cssHooks[d]),
                g && "expand" in g)
            ) {
                (f = g.expand(f)), delete a[d];
                for (c in f) c in a || ((a[c] = f[c]), (b[c] = e));
            } else b[d] = e;
    }
    function qb(a, b, c) {
        var d,
            e,
            f = 0,
            g = qb.prefilters.length,
            h = n.Deferred().always(function() {
                delete i.elem;
            }),
            i = function() {
                if (e) return !1;
                for (var b = hb || lb(), c = Math.max(0, j.startTime + j.duration - b), d = c / j.duration || 0, f = 1 - d, g = 0, i = j.tweens.length; i > g; g++)
                    j.tweens[g].run(f);
                return h.notifyWith(a, [j, f, c]), 1 > f && i ? c : (h.resolveWith(a, [j]), !1);
            },
            j = h.promise({
                elem: a,
                props: n.extend({}, b),
                opts: n.extend(!0, { specialEasing: {}, easing: n.easing._default }, c),
                originalProperties: b,
                originalOptions: c,
                startTime: hb || lb(),
                duration: c.duration,
                tweens: [],
                createTween: function(b, c) {
                    var d = n.Tween(a, j.opts, b, c, j.opts.specialEasing[b] || j.opts.easing);
                    return j.tweens.push(d), d;
                },
                stop: function(b) {
                    var c = 0,
                        d = b ? j.tweens.length : 0;
                    if (e) return this;
                    for (e = !0; d > c; c++) j.tweens[c].run(1);
                    return b ? (h.notifyWith(a, [j, 1, 0]), h.resolveWith(a, [j, b])) : h.rejectWith(a, [j, b]), this;
                }
            }),
            k = j.props;
        for (pb(k, j.opts.specialEasing); g > f; f++)
            if ((d = qb.prefilters[f].call(j, a, k, j.opts))) return n.isFunction(d.stop) && (n._queueHooks(j.elem, j.opts.queue).stop = n.proxy(d.stop, d)), d;
        return (
            n.map(k, nb, j),
            n.isFunction(j.opts.start) && j.opts.start.call(a, j),
            n.fx.timer(n.extend(i, { elem: a, anim: j, queue: j.opts.queue })),
            j
                .progress(j.opts.progress)
                .done(j.opts.done, j.opts.complete)
                .fail(j.opts.fail)
                .always(j.opts.always)
        );
    }
    (n.Animation = n.extend(qb, {
        tweeners: {
            "*": [
                function(a, b) {
                    var c = this.createTween(a, b);
                    return X(c.elem, a, U.exec(b), c), c;
                }
            ]
        },
        tweener: function(a, b) {
            n.isFunction(a) ? ((b = a), (a = ["*"])) : (a = a.match(G));
            for (var c, d = 0, e = a.length; e > d; d++) (c = a[d]), (qb.tweeners[c] = qb.tweeners[c] || []), qb.tweeners[c].unshift(b);
        },
        prefilters: [ob],
        prefilter: function(a, b) {
            b ? qb.prefilters.unshift(a) : qb.prefilters.push(a);
        }
    })),
        (n.speed = function(a, b, c) {
            var d =
                a && "object" == typeof a ? n.extend({}, a) : { complete: c || (!c && b) || (n.isFunction(a) && a), duration: a, easing: (c && b) || (b && !n.isFunction(b) && b) };
            return (
                (d.duration = n.fx.off ? 0 : "number" == typeof d.duration ? d.duration : d.duration in n.fx.speeds ? n.fx.speeds[d.duration] : n.fx.speeds._default),
                (null != d.queue && d.queue !== !0) || (d.queue = "fx"),
                (d.old = d.complete),
                (d.complete = function() {
                    n.isFunction(d.old) && d.old.call(this), d.queue && n.dequeue(this, d.queue);
                }),
                d
            );
        }),
        n.fn.extend({
            fadeTo: function(a, b, c, d) {
                return this.filter(W)
                    .css("opacity", 0)
                    .show()
                    .end()
                    .animate({ opacity: b }, a, c, d);
            },
            animate: function(a, b, c, d) {
                var e = n.isEmptyObject(a),
                    f = n.speed(b, c, d),
                    g = function() {
                        var b = qb(this, n.extend({}, a), f);
                        (e || n._data(this, "finish")) && b.stop(!0);
                    };
                return (g.finish = g), e || f.queue === !1 ? this.each(g) : this.queue(f.queue, g);
            },
            stop: function(a, b, c) {
                var d = function(a) {
                    var b = a.stop;
                    delete a.stop, b(c);
                };
                return (
                    "string" != typeof a && ((c = b), (b = a), (a = void 0)),
                    b && a !== !1 && this.queue(a || "fx", []),
                    this.each(function() {
                        var b = !0,
                            e = null != a && a + "queueHooks",
                            f = n.timers,
                            g = n._data(this);
                        if (e) g[e] && g[e].stop && d(g[e]);
                        else for (e in g) g[e] && g[e].stop && kb.test(e) && d(g[e]);
                        for (e = f.length; e--; ) f[e].elem !== this || (null != a && f[e].queue !== a) || (f[e].anim.stop(c), (b = !1), f.splice(e, 1));
                        (!b && c) || n.dequeue(this, a);
                    })
                );
            },
            finish: function(a) {
                return (
                    a !== !1 && (a = a || "fx"),
                    this.each(function() {
                        var b,
                            c = n._data(this),
                            d = c[a + "queue"],
                            e = c[a + "queueHooks"],
                            f = n.timers,
                            g = d ? d.length : 0;
                        for (c.finish = !0, n.queue(this, a, []), e && e.stop && e.stop.call(this, !0), b = f.length; b--; )
                            f[b].elem === this && f[b].queue === a && (f[b].anim.stop(!0), f.splice(b, 1));
                        for (b = 0; g > b; b++) d[b] && d[b].finish && d[b].finish.call(this);
                        delete c.finish;
                    })
                );
            }
        }),
        n.each(["toggle", "show", "hide"], function(a, b) {
            var c = n.fn[b];
            n.fn[b] = function(a, d, e) {
                return null == a || "boolean" == typeof a ? c.apply(this, arguments) : this.animate(mb(b, !0), a, d, e);
            };
        }),
        n.each(
            { slideDown: mb("show"), slideUp: mb("hide"), slideToggle: mb("toggle"), fadeIn: { opacity: "show" }, fadeOut: { opacity: "hide" }, fadeToggle: { opacity: "toggle" } },
            function(a, b) {
                n.fn[a] = function(a, c, d) {
                    return this.animate(b, a, c, d);
                };
            }
        ),
        (n.timers = []),
        (n.fx.tick = function() {
            var a,
                b = n.timers,
                c = 0;
            for (hb = n.now(); c < b.length; c++) (a = b[c]), a() || b[c] !== a || b.splice(c--, 1);
            b.length || n.fx.stop(), (hb = void 0);
        }),
        (n.fx.timer = function(a) {
            n.timers.push(a), a() ? n.fx.start() : n.timers.pop();
        }),
        (n.fx.interval = 13),
        (n.fx.start = function() {
            ib || (ib = a.setInterval(n.fx.tick, n.fx.interval));
        }),
        (n.fx.stop = function() {
            a.clearInterval(ib), (ib = null);
        }),
        (n.fx.speeds = { slow: 600, fast: 200, _default: 400 }),
        (n.fn.delay = function(b, c) {
            return (
                (b = n.fx ? n.fx.speeds[b] || b : b),
                (c = c || "fx"),
                this.queue(c, function(c, d) {
                    var e = a.setTimeout(c, b);
                    d.stop = function() {
                        a.clearTimeout(e);
                    };
                })
            );
        }),
        (function() {
            var a,
                b = d.createElement("input"),
                c = d.createElement("div"),
                e = d.createElement("select"),
                f = e.appendChild(d.createElement("option"));
            (c = d.createElement("div")),
                c.setAttribute("className", "t"),
                (c.innerHTML = "  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>"),
                (a = c.getElementsByTagName("a")[0]),
                b.setAttribute("type", "checkbox"),
                c.appendChild(b),
                (a = c.getElementsByTagName("a")[0]),
                (a.style.cssText = "top:1px"),
                (l.getSetAttribute = "t" !== c.className),
                (l.style = /top/.test(a.getAttribute("style"))),
                (l.hrefNormalized = "/a" === a.getAttribute("href")),
                (l.checkOn = !!b.value),
                (l.optSelected = f.selected),
                (l.enctype = !!d.createElement("form").enctype),
                (e.disabled = !0),
                (l.optDisabled = !f.disabled),
                (b = d.createElement("input")),
                b.setAttribute("value", ""),
                (l.input = "" === b.getAttribute("value")),
                (b.value = "t"),
                b.setAttribute("type", "radio"),
                (l.radioValue = "t" === b.value);
        })();
    var rb = /\r/g,
        sb = /[\x20\t\r\n\f]+/g;
    n.fn.extend({
        val: function(a) {
            var b,
                c,
                d,
                e = this[0];
            {
                if (arguments.length)
                    return (
                        (d = n.isFunction(a)),
                        this.each(function(c) {
                            var e;
                            1 === this.nodeType &&
                                ((e = d ? a.call(this, c, n(this).val()) : a),
                                null == e
                                    ? (e = "")
                                    : "number" == typeof e
                                    ? (e += "")
                                    : n.isArray(e) &&
                                      (e = n.map(e, function(a) {
                                          return null == a ? "" : a + "";
                                      })),
                                (b = n.valHooks[this.type] || n.valHooks[this.nodeName.toLowerCase()]),
                                (b && "set" in b && void 0 !== b.set(this, e, "value")) || (this.value = e));
                        })
                    );
                if (e)
                    return (
                        (b = n.valHooks[e.type] || n.valHooks[e.nodeName.toLowerCase()]),
                        b && "get" in b && void 0 !== (c = b.get(e, "value")) ? c : ((c = e.value), "string" == typeof c ? c.replace(rb, "") : null == c ? "" : c)
                    );
            }
        }
    }),
        n.extend({
            valHooks: {
                option: {
                    get: function(a) {
                        var b = n.find.attr(a, "value");
                        return null != b ? b : n.trim(n.text(a)).replace(sb, " ");
                    }
                },
                select: {
                    get: function(a) {
                        for (
                            var b,
                                c,
                                d = a.options,
                                e = a.selectedIndex,
                                f = "select-one" === a.type || 0 > e,
                                g = f ? null : [],
                                h = f ? e + 1 : d.length,
                                i = 0 > e ? h : f ? e : 0;
                            h > i;
                            i++
                        )
                            if (
                                ((c = d[i]),
                                (c.selected || i === e) &&
                                    (l.optDisabled ? !c.disabled : null === c.getAttribute("disabled")) &&
                                    (!c.parentNode.disabled || !n.nodeName(c.parentNode, "optgroup")))
                            ) {
                                if (((b = n(c).val()), f)) return b;
                                g.push(b);
                            }
                        return g;
                    },
                    set: function(a, b) {
                        var c,
                            d,
                            e = a.options,
                            f = n.makeArray(b),
                            g = e.length;
                        while (g--)
                            if (((d = e[g]), n.inArray(n.valHooks.option.get(d), f) > -1))
                                try {
                                    d.selected = c = !0;
                                } catch (h) {
                                    d.scrollHeight;
                                }
                            else d.selected = !1;
                        return c || (a.selectedIndex = -1), e;
                    }
                }
            }
        }),
        n.each(["radio", "checkbox"], function() {
            (n.valHooks[this] = {
                set: function(a, b) {
                    return n.isArray(b) ? (a.checked = n.inArray(n(a).val(), b) > -1) : void 0;
                }
            }),
                l.checkOn ||
                    (n.valHooks[this].get = function(a) {
                        return null === a.getAttribute("value") ? "on" : a.value;
                    });
        });
    var tb,
        ub,
        vb = n.expr.attrHandle,
        wb = /^(?:checked|selected)$/i,
        xb = l.getSetAttribute,
        yb = l.input;
    n.fn.extend({
        attr: function(a, b) {
            return Y(this, n.attr, a, b, arguments.length > 1);
        },
        removeAttr: function(a) {
            return this.each(function() {
                n.removeAttr(this, a);
            });
        }
    }),
        n.extend({
            attr: function(a, b, c) {
                var d,
                    e,
                    f = a.nodeType;
                if (3 !== f && 8 !== f && 2 !== f)
                    return "undefined" == typeof a.getAttribute
                        ? n.prop(a, b, c)
                        : ((1 === f && n.isXMLDoc(a)) || ((b = b.toLowerCase()), (e = n.attrHooks[b] || (n.expr.match.bool.test(b) ? ub : tb))),
                          void 0 !== c
                              ? null === c
                                  ? void n.removeAttr(a, b)
                                  : e && "set" in e && void 0 !== (d = e.set(a, c, b))
                                  ? d
                                  : (a.setAttribute(b, c + ""), c)
                              : e && "get" in e && null !== (d = e.get(a, b))
                              ? d
                              : ((d = n.find.attr(a, b)), null == d ? void 0 : d));
            },
            attrHooks: {
                type: {
                    set: function(a, b) {
                        if (!l.radioValue && "radio" === b && n.nodeName(a, "input")) {
                            var c = a.value;
                            return a.setAttribute("type", b), c && (a.value = c), b;
                        }
                    }
                }
            },
            removeAttr: function(a, b) {
                var c,
                    d,
                    e = 0,
                    f = b && b.match(G);
                if (f && 1 === a.nodeType)
                    while ((c = f[e++]))
                        (d = n.propFix[c] || c),
                            n.expr.match.bool.test(c) ? ((yb && xb) || !wb.test(c) ? (a[d] = !1) : (a[n.camelCase("default-" + c)] = a[d] = !1)) : n.attr(a, c, ""),
                            a.removeAttribute(xb ? c : d);
            }
        }),
        (ub = {
            set: function(a, b, c) {
                return b === !1 ? n.removeAttr(a, c) : (yb && xb) || !wb.test(c) ? a.setAttribute((!xb && n.propFix[c]) || c, c) : (a[n.camelCase("default-" + c)] = a[c] = !0), c;
            }
        }),
        n.each(n.expr.match.bool.source.match(/\w+/g), function(a, b) {
            var c = vb[b] || n.find.attr;
            (yb && xb) || !wb.test(b)
                ? (vb[b] = function(a, b, d) {
                      var e, f;
                      return d || ((f = vb[b]), (vb[b] = e), (e = null != c(a, b, d) ? b.toLowerCase() : null), (vb[b] = f)), e;
                  })
                : (vb[b] = function(a, b, c) {
                      return c ? void 0 : a[n.camelCase("default-" + b)] ? b.toLowerCase() : null;
                  });
        }),
        (yb && xb) ||
            (n.attrHooks.value = {
                set: function(a, b, c) {
                    return n.nodeName(a, "input") ? void (a.defaultValue = b) : tb && tb.set(a, b, c);
                }
            }),
        xb ||
            ((tb = {
                set: function(a, b, c) {
                    var d = a.getAttributeNode(c);
                    return d || a.setAttributeNode((d = a.ownerDocument.createAttribute(c))), (d.value = b += ""), "value" === c || b === a.getAttribute(c) ? b : void 0;
                }
            }),
            (vb.id = vb.name = vb.coords = function(a, b, c) {
                var d;
                return c ? void 0 : (d = a.getAttributeNode(b)) && "" !== d.value ? d.value : null;
            }),
            (n.valHooks.button = {
                get: function(a, b) {
                    var c = a.getAttributeNode(b);
                    return c && c.specified ? c.value : void 0;
                },
                set: tb.set
            }),
            (n.attrHooks.contenteditable = {
                set: function(a, b, c) {
                    tb.set(a, "" === b ? !1 : b, c);
                }
            }),
            n.each(["width", "height"], function(a, b) {
                n.attrHooks[b] = {
                    set: function(a, c) {
                        return "" === c ? (a.setAttribute(b, "auto"), c) : void 0;
                    }
                };
            })),
        l.style ||
            (n.attrHooks.style = {
                get: function(a) {
                    return a.style.cssText || void 0;
                },
                set: function(a, b) {
                    return (a.style.cssText = b + "");
                }
            });
    var zb = /^(?:input|select|textarea|button|object)$/i,
        Ab = /^(?:a|area)$/i;
    n.fn.extend({
        prop: function(a, b) {
            return Y(this, n.prop, a, b, arguments.length > 1);
        },
        removeProp: function(a) {
            return (
                (a = n.propFix[a] || a),
                this.each(function() {
                    try {
                        (this[a] = void 0), delete this[a];
                    } catch (b) {}
                })
            );
        }
    }),
        n.extend({
            prop: function(a, b, c) {
                var d,
                    e,
                    f = a.nodeType;
                if (3 !== f && 8 !== f && 2 !== f)
                    return (
                        (1 === f && n.isXMLDoc(a)) || ((b = n.propFix[b] || b), (e = n.propHooks[b])),
                        void 0 !== c ? (e && "set" in e && void 0 !== (d = e.set(a, c, b)) ? d : (a[b] = c)) : e && "get" in e && null !== (d = e.get(a, b)) ? d : a[b]
                    );
            },
            propHooks: {
                tabIndex: {
                    get: function(a) {
                        var b = n.find.attr(a, "tabindex");
                        return b ? parseInt(b, 10) : zb.test(a.nodeName) || (Ab.test(a.nodeName) && a.href) ? 0 : -1;
                    }
                }
            },
            propFix: { for: "htmlFor", class: "className" }
        }),
        l.hrefNormalized ||
            n.each(["href", "src"], function(a, b) {
                n.propHooks[b] = {
                    get: function(a) {
                        return a.getAttribute(b, 4);
                    }
                };
            }),
        l.optSelected ||
            (n.propHooks.selected = {
                get: function(a) {
                    var b = a.parentNode;
                    return b && (b.selectedIndex, b.parentNode && b.parentNode.selectedIndex), null;
                },
                set: function(a) {
                    var b = a.parentNode;
                    b && (b.selectedIndex, b.parentNode && b.parentNode.selectedIndex);
                }
            }),
        n.each(["tabIndex", "readOnly", "maxLength", "cellSpacing", "cellPadding", "rowSpan", "colSpan", "useMap", "frameBorder", "contentEditable"], function() {
            n.propFix[this.toLowerCase()] = this;
        }),
        l.enctype || (n.propFix.enctype = "encoding");
    var Bb = /[\t\r\n\f]/g;
    function Cb(a) {
        return n.attr(a, "class") || "";
    }
    n.fn.extend({
        addClass: function(a) {
            var b,
                c,
                d,
                e,
                f,
                g,
                h,
                i = 0;
            if (n.isFunction(a))
                return this.each(function(b) {
                    n(this).addClass(a.call(this, b, Cb(this)));
                });
            if ("string" == typeof a && a) {
                b = a.match(G) || [];
                while ((c = this[i++]))
                    if (((e = Cb(c)), (d = 1 === c.nodeType && (" " + e + " ").replace(Bb, " ")))) {
                        g = 0;
                        while ((f = b[g++])) d.indexOf(" " + f + " ") < 0 && (d += f + " ");
                        (h = n.trim(d)), e !== h && n.attr(c, "class", h);
                    }
            }
            return this;
        },
        removeClass: function(a) {
            var b,
                c,
                d,
                e,
                f,
                g,
                h,
                i = 0;
            if (n.isFunction(a))
                return this.each(function(b) {
                    n(this).removeClass(a.call(this, b, Cb(this)));
                });
            if (!arguments.length) return this.attr("class", "");
            if ("string" == typeof a && a) {
                b = a.match(G) || [];
                while ((c = this[i++]))
                    if (((e = Cb(c)), (d = 1 === c.nodeType && (" " + e + " ").replace(Bb, " ")))) {
                        g = 0;
                        while ((f = b[g++])) while (d.indexOf(" " + f + " ") > -1) d = d.replace(" " + f + " ", " ");
                        (h = n.trim(d)), e !== h && n.attr(c, "class", h);
                    }
            }
            return this;
        },
        toggleClass: function(a, b) {
            var c = typeof a;
            return "boolean" == typeof b && "string" === c
                ? b
                    ? this.addClass(a)
                    : this.removeClass(a)
                : n.isFunction(a)
                ? this.each(function(c) {
                      n(this).toggleClass(a.call(this, c, Cb(this), b), b);
                  })
                : this.each(function() {
                      var b, d, e, f;
                      if ("string" === c) {
                          (d = 0), (e = n(this)), (f = a.match(G) || []);
                          while ((b = f[d++])) e.hasClass(b) ? e.removeClass(b) : e.addClass(b);
                      } else (void 0 !== a && "boolean" !== c) || ((b = Cb(this)), b && n._data(this, "__className__", b), n.attr(this, "class", b || a === !1 ? "" : n._data(this, "__className__") || ""));
                  });
        },
        hasClass: function(a) {
            var b,
                c,
                d = 0;
            b = " " + a + " ";
            while ((c = this[d++])) if (1 === c.nodeType && (" " + Cb(c) + " ").replace(Bb, " ").indexOf(b) > -1) return !0;
            return !1;
        }
    }),
        n.each(
            "blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(
                " "
            ),
            function(a, b) {
                n.fn[b] = function(a, c) {
                    return arguments.length > 0 ? this.on(b, null, a, c) : this.trigger(b);
                };
            }
        ),
        n.fn.extend({
            hover: function(a, b) {
                return this.mouseenter(a).mouseleave(b || a);
            }
        });
    var Db = a.location,
        Eb = n.now(),
        Fb = /\?/,
        Gb = /(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;
    (n.parseJSON = function(b) {
        if (a.JSON && a.JSON.parse) return a.JSON.parse(b + "");
        var c,
            d = null,
            e = n.trim(b + "");
        return e &&
            !n.trim(
                e.replace(Gb, function(a, b, e, f) {
                    return c && b && (d = 0), 0 === d ? a : ((c = e || b), (d += !f - !e), "");
                })
            )
            ? Function("return " + e)()
            : n.error("Invalid JSON: " + b);
    }),
        (n.parseXML = function(b) {
            var c, d;
            if (!b || "string" != typeof b) return null;
            try {
                a.DOMParser
                    ? ((d = new a.DOMParser()), (c = d.parseFromString(b, "text/xml")))
                    : ((c = new a.ActiveXObject("Microsoft.XMLDOM")), (c.async = "false"), c.loadXML(b));
            } catch (e) {
                c = void 0;
            }
            return (c && c.documentElement && !c.getElementsByTagName("parsererror").length) || n.error("Invalid XML: " + b), c;
        });
    var Hb = /#.*$/,
        Ib = /([?&])_=[^&]*/,
        Jb = /^(.*?):[ \t]*([^\r\n]*)\r?$/gm,
        Kb = /^(?:about|app|app-storage|.+-extension|file|res|widget):$/,
        Lb = /^(?:GET|HEAD)$/,
        Mb = /^\/\//,
        Nb = /^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,
        Ob = {},
        Pb = {},
        Qb = "*/".concat("*"),
        Rb = Db.href,
        Sb = Nb.exec(Rb.toLowerCase()) || [];
    function Tb(a) {
        return function(b, c) {
            "string" != typeof b && ((c = b), (b = "*"));
            var d,
                e = 0,
                f = b.toLowerCase().match(G) || [];
            if (n.isFunction(c)) while ((d = f[e++])) "+" === d.charAt(0) ? ((d = d.slice(1) || "*"), (a[d] = a[d] || []).unshift(c)) : (a[d] = a[d] || []).push(c);
        };
    }
    function Ub(a, b, c, d) {
        var e = {},
            f = a === Pb;
        function g(h) {
            var i;
            return (
                (e[h] = !0),
                n.each(a[h] || [], function(a, h) {
                    var j = h(b, c, d);
                    return "string" != typeof j || f || e[j] ? (f ? !(i = j) : void 0) : (b.dataTypes.unshift(j), g(j), !1);
                }),
                i
            );
        }
        return g(b.dataTypes[0]) || (!e["*"] && g("*"));
    }
    function Vb(a, b) {
        var c,
            d,
            e = n.ajaxSettings.flatOptions || {};
        for (d in b) void 0 !== b[d] && ((e[d] ? a : c || (c = {}))[d] = b[d]);
        return c && n.extend(!0, a, c), a;
    }
    function Wb(a, b, c) {
        var d,
            e,
            f,
            g,
            h = a.contents,
            i = a.dataTypes;
        while ("*" === i[0]) i.shift(), void 0 === e && (e = a.mimeType || b.getResponseHeader("Content-Type"));
        if (e)
            for (g in h)
                if (h[g] && h[g].test(e)) {
                    i.unshift(g);
                    break;
                }
        if (i[0] in c) f = i[0];
        else {
            for (g in c) {
                if (!i[0] || a.converters[g + " " + i[0]]) {
                    f = g;
                    break;
                }
                d || (d = g);
            }
            f = f || d;
        }
        return f ? (f !== i[0] && i.unshift(f), c[f]) : void 0;
    }
    function Xb(a, b, c, d) {
        var e,
            f,
            g,
            h,
            i,
            j = {},
            k = a.dataTypes.slice();
        if (k[1]) for (g in a.converters) j[g.toLowerCase()] = a.converters[g];
        f = k.shift();
        while (f)
            if ((a.responseFields[f] && (c[a.responseFields[f]] = b), !i && d && a.dataFilter && (b = a.dataFilter(b, a.dataType)), (i = f), (f = k.shift())))
                if ("*" === f) f = i;
                else if ("*" !== i && i !== f) {
                    if (((g = j[i + " " + f] || j["* " + f]), !g))
                        for (e in j)
                            if (((h = e.split(" ")), h[1] === f && (g = j[i + " " + h[0]] || j["* " + h[0]]))) {
                                g === !0 ? (g = j[e]) : j[e] !== !0 && ((f = h[0]), k.unshift(h[1]));
                                break;
                            }
                    if (g !== !0)
                        if (g && a["throws"]) b = g(b);
                        else
                            try {
                                b = g(b);
                            } catch (l) {
                                return { state: "parsererror", error: g ? l : "No conversion from " + i + " to " + f };
                            }
                }
        return { state: "success", data: b };
    }
    n.extend({
        active: 0,
        lastModified: {},
        etag: {},
        ajaxSettings: {
            url: Rb,
            type: "GET",
            isLocal: Kb.test(Sb[1]),
            global: !0,
            processData: !0,
            async: !0,
            contentType: "application/x-www-form-urlencoded; charset=UTF-8",
            accepts: { "*": Qb, text: "text/plain", html: "text/html", xml: "application/xml, text/xml", json: "application/json, text/javascript" },
            contents: { xml: /\bxml\b/, html: /\bhtml/, json: /\bjson\b/ },
            responseFields: { xml: "responseXML", text: "responseText", json: "responseJSON" },
            converters: { "* text": String, "text html": !0, "text json": n.parseJSON, "text xml": n.parseXML },
            flatOptions: { url: !0, context: !0 }
        },
        ajaxSetup: function(a, b) {
            return b ? Vb(Vb(a, n.ajaxSettings), b) : Vb(n.ajaxSettings, a);
        },
        ajaxPrefilter: Tb(Ob),
        ajaxTransport: Tb(Pb),
        ajax: function(b, c) {
            "object" == typeof b && ((c = b), (b = void 0)), (c = c || {});
            var d,
                e,
                f,
                g,
                h,
                i,
                j,
                k,
                l = n.ajaxSetup({}, c),
                m = l.context || l,
                o = l.context && (m.nodeType || m.jquery) ? n(m) : n.event,
                p = n.Deferred(),
                q = n.Callbacks("once memory"),
                r = l.statusCode || {},
                s = {},
                t = {},
                u = 0,
                v = "canceled",
                w = {
                    readyState: 0,
                    getResponseHeader: function(a) {
                        var b;
                        if (2 === u) {
                            if (!k) {
                                k = {};
                                while ((b = Jb.exec(g))) k[b[1].toLowerCase()] = b[2];
                            }
                            b = k[a.toLowerCase()];
                        }
                        return null == b ? null : b;
                    },
                    getAllResponseHeaders: function() {
                        return 2 === u ? g : null;
                    },
                    setRequestHeader: function(a, b) {
                        var c = a.toLowerCase();
                        return u || ((a = t[c] = t[c] || a), (s[a] = b)), this;
                    },
                    overrideMimeType: function(a) {
                        return u || (l.mimeType = a), this;
                    },
                    statusCode: function(a) {
                        var b;
                        if (a)
                            if (2 > u) for (b in a) r[b] = [r[b], a[b]];
                            else w.always(a[w.status]);
                        return this;
                    },
                    abort: function(a) {
                        var b = a || v;
                        return j && j.abort(b), y(0, b), this;
                    }
                };
            if (
                ((p.promise(w).complete = q.add),
                (w.success = w.done),
                (w.error = w.fail),
                (l.url = ((b || l.url || Rb) + "").replace(Hb, "").replace(Mb, Sb[1] + "//")),
                (l.type = c.method || c.type || l.method || l.type),
                (l.dataTypes = n
                    .trim(l.dataType || "*")
                    .toLowerCase()
                    .match(G) || [""]),
                null == l.crossDomain &&
                    ((d = Nb.exec(l.url.toLowerCase())),
                    (l.crossDomain = !(!d || (d[1] === Sb[1] && d[2] === Sb[2] && (d[3] || ("http:" === d[1] ? "80" : "443")) === (Sb[3] || ("http:" === Sb[1] ? "80" : "443")))))),
                l.data && l.processData && "string" != typeof l.data && (l.data = n.param(l.data, l.traditional)),
                Ub(Ob, l, c, w),
                2 === u)
            )
                return w;
            (i = n.event && l.global),
                i && 0 === n.active++ && n.event.trigger("ajaxStart"),
                (l.type = l.type.toUpperCase()),
                (l.hasContent = !Lb.test(l.type)),
                (f = l.url),
                l.hasContent ||
                    (l.data && ((f = l.url += (Fb.test(f) ? "&" : "?") + l.data), delete l.data),
                    l.cache === !1 && (l.url = Ib.test(f) ? f.replace(Ib, "$1_=" + Eb++) : f + (Fb.test(f) ? "&" : "?") + "_=" + Eb++)),
                l.ifModified && (n.lastModified[f] && w.setRequestHeader("If-Modified-Since", n.lastModified[f]), n.etag[f] && w.setRequestHeader("If-None-Match", n.etag[f])),
                ((l.data && l.hasContent && l.contentType !== !1) || c.contentType) && w.setRequestHeader("Content-Type", l.contentType),
                w.setRequestHeader(
                    "Accept",
                    l.dataTypes[0] && l.accepts[l.dataTypes[0]] ? l.accepts[l.dataTypes[0]] + ("*" !== l.dataTypes[0] ? ", " + Qb + "; q=0.01" : "") : l.accepts["*"]
                );
            for (e in l.headers) w.setRequestHeader(e, l.headers[e]);
            if (l.beforeSend && (l.beforeSend.call(m, w, l) === !1 || 2 === u)) return w.abort();
            v = "abort";
            for (e in { success: 1, error: 1, complete: 1 }) w[e](l[e]);
            if ((j = Ub(Pb, l, c, w))) {
                if (((w.readyState = 1), i && o.trigger("ajaxSend", [w, l]), 2 === u)) return w;
                l.async &&
                    l.timeout > 0 &&
                    (h = a.setTimeout(function() {
                        w.abort("timeout");
                    }, l.timeout));
                try {
                    (u = 1), j.send(s, y);
                } catch (x) {
                    if (!(2 > u)) throw x;
                    y(-1, x);
                }
            } else y(-1, "No Transport");
            function y(b, c, d, e) {
                var k,
                    s,
                    t,
                    v,
                    x,
                    y = c;
                2 !== u &&
                    ((u = 2),
                    h && a.clearTimeout(h),
                    (j = void 0),
                    (g = e || ""),
                    (w.readyState = b > 0 ? 4 : 0),
                    (k = (b >= 200 && 300 > b) || 304 === b),
                    d && (v = Wb(l, w, d)),
                    (v = Xb(l, v, w, k)),
                    k
                        ? (l.ifModified && ((x = w.getResponseHeader("Last-Modified")), x && (n.lastModified[f] = x), (x = w.getResponseHeader("etag")), x && (n.etag[f] = x)),
                          204 === b || "HEAD" === l.type ? (y = "nocontent") : 304 === b ? (y = "notmodified") : ((y = v.state), (s = v.data), (t = v.error), (k = !t)))
                        : ((t = y), (!b && y) || ((y = "error"), 0 > b && (b = 0))),
                    (w.status = b),
                    (w.statusText = (c || y) + ""),
                    k ? p.resolveWith(m, [s, y, w]) : p.rejectWith(m, [w, y, t]),
                    w.statusCode(r),
                    (r = void 0),
                    i && o.trigger(k ? "ajaxSuccess" : "ajaxError", [w, l, k ? s : t]),
                    q.fireWith(m, [w, y]),
                    i && (o.trigger("ajaxComplete", [w, l]), --n.active || n.event.trigger("ajaxStop")));
            }
            return w;
        },
        getJSON: function(a, b, c) {
            return n.get(a, b, c, "json");
        },
        getScript: function(a, b) {
            return n.get(a, void 0, b, "script");
        }
    }),
        n.each(["get", "post"], function(a, b) {
            n[b] = function(a, c, d, e) {
                return n.isFunction(c) && ((e = e || d), (d = c), (c = void 0)), n.ajax(n.extend({ url: a, type: b, dataType: e, data: c, success: d }, n.isPlainObject(a) && a));
            };
        }),
        (n._evalUrl = function(a) {
            return n.ajax({ url: a, type: "GET", dataType: "script", cache: !0, async: !1, global: !1, throws: !0 });
        }),
        n.fn.extend({
            wrapAll: function(a) {
                if (n.isFunction(a))
                    return this.each(function(b) {
                        n(this).wrapAll(a.call(this, b));
                    });
                if (this[0]) {
                    var b = n(a, this[0].ownerDocument)
                        .eq(0)
                        .clone(!0);
                    this[0].parentNode && b.insertBefore(this[0]),
                        b
                            .map(function() {
                                var a = this;
                                while (a.firstChild && 1 === a.firstChild.nodeType) a = a.firstChild;
                                return a;
                            })
                            .append(this);
                }
                return this;
            },
            wrapInner: function(a) {
                return n.isFunction(a)
                    ? this.each(function(b) {
                          n(this).wrapInner(a.call(this, b));
                      })
                    : this.each(function() {
                          var b = n(this),
                              c = b.contents();
                          c.length ? c.wrapAll(a) : b.append(a);
                      });
            },
            wrap: function(a) {
                var b = n.isFunction(a);
                return this.each(function(c) {
                    n(this).wrapAll(b ? a.call(this, c) : a);
                });
            },
            unwrap: function() {
                return this.parent()
                    .each(function() {
                        n.nodeName(this, "body") || n(this).replaceWith(this.childNodes);
                    })
                    .end();
            }
        });
    function Yb(a) {
        return (a.style && a.style.display) || n.css(a, "display");
    }
    function Zb(a) {
        if (!n.contains(a.ownerDocument || d, a)) return !0;
        while (a && 1 === a.nodeType) {
            if ("none" === Yb(a) || "hidden" === a.type) return !0;
            a = a.parentNode;
        }
        return !1;
    }
    (n.expr.filters.hidden = function(a) {
        return l.reliableHiddenOffsets() ? a.offsetWidth <= 0 && a.offsetHeight <= 0 && !a.getClientRects().length : Zb(a);
    }),
        (n.expr.filters.visible = function(a) {
            return !n.expr.filters.hidden(a);
        });
    var $b = /%20/g,
        _b = /\[\]$/,
        ac = /\r?\n/g,
        bc = /^(?:submit|button|image|reset|file)$/i,
        cc = /^(?:input|select|textarea|keygen)/i;
    function dc(a, b, c, d) {
        var e;
        if (n.isArray(b))
            n.each(b, function(b, e) {
                c || _b.test(a) ? d(a, e) : dc(a + "[" + ("object" == typeof e && null != e ? b : "") + "]", e, c, d);
            });
        else if (c || "object" !== n.type(b)) d(a, b);
        else for (e in b) dc(a + "[" + e + "]", b[e], c, d);
    }
    (n.param = function(a, b) {
        var c,
            d = [],
            e = function(a, b) {
                (b = n.isFunction(b) ? b() : null == b ? "" : b), (d[d.length] = encodeURIComponent(a) + "=" + encodeURIComponent(b));
            };
        if ((void 0 === b && (b = n.ajaxSettings && n.ajaxSettings.traditional), n.isArray(a) || (a.jquery && !n.isPlainObject(a))))
            n.each(a, function() {
                e(this.name, this.value);
            });
        else for (c in a) dc(c, a[c], b, e);
        return d.join("&").replace($b, "+");
    }),
        n.fn.extend({
            serialize: function() {
                return n.param(this.serializeArray());
            },
            serializeArray: function() {
                return this.map(function() {
                    var a = n.prop(this, "elements");
                    return a ? n.makeArray(a) : this;
                })
                    .filter(function() {
                        var a = this.type;
                        return this.name && !n(this).is(":disabled") && cc.test(this.nodeName) && !bc.test(a) && (this.checked || !Z.test(a));
                    })
                    .map(function(a, b) {
                        var c = n(this).val();
                        return null == c
                            ? null
                            : n.isArray(c)
                            ? n.map(c, function(a) {
                                  return { name: b.name, value: a.replace(ac, "\r\n") };
                              })
                            : { name: b.name, value: c.replace(ac, "\r\n") };
                    })
                    .get();
            }
        }),
        (n.ajaxSettings.xhr =
            void 0 !== a.ActiveXObject
                ? function() {
                      return this.isLocal ? ic() : d.documentMode > 8 ? hc() : (/^(get|post|head|put|delete|options)$/i.test(this.type) && hc()) || ic();
                  }
                : hc);
    var ec = 0,
        fc = {},
        gc = n.ajaxSettings.xhr();
    a.attachEvent &&
        a.attachEvent("onunload", function() {
            for (var a in fc) fc[a](void 0, !0);
        }),
        (l.cors = !!gc && "withCredentials" in gc),
        (gc = l.ajax = !!gc),
        gc &&
            n.ajaxTransport(function(b) {
                if (!b.crossDomain || l.cors) {
                    var c;
                    return {
                        send: function(d, e) {
                            var f,
                                g = b.xhr(),
                                h = ++ec;
                            if ((g.open(b.type, b.url, b.async, b.username, b.password), b.xhrFields)) for (f in b.xhrFields) g[f] = b.xhrFields[f];
                            b.mimeType && g.overrideMimeType && g.overrideMimeType(b.mimeType),
                                b.crossDomain || d["X-Requested-With"] || (d["X-Requested-With"] = "XMLHttpRequest");
                            for (f in d) void 0 !== d[f] && g.setRequestHeader(f, d[f] + "");
                            g.send((b.hasContent && b.data) || null),
                                (c = function(a, d) {
                                    var f, i, j;
                                    if (c && (d || 4 === g.readyState))
                                        if ((delete fc[h], (c = void 0), (g.onreadystatechange = n.noop), d)) 4 !== g.readyState && g.abort();
                                        else {
                                            (j = {}), (f = g.status), "string" == typeof g.responseText && (j.text = g.responseText);
                                            try {
                                                i = g.statusText;
                                            } catch (k) {
                                                i = "";
                                            }
                                            f || !b.isLocal || b.crossDomain ? 1223 === f && (f = 204) : (f = j.text ? 200 : 404);
                                        }
                                    j && e(f, i, j, g.getAllResponseHeaders());
                                }),
                                b.async ? (4 === g.readyState ? a.setTimeout(c) : (g.onreadystatechange = fc[h] = c)) : c();
                        },
                        abort: function() {
                            c && c(void 0, !0);
                        }
                    };
                }
            });
    function hc() {
        try {
            return new a.XMLHttpRequest();
        } catch (b) {}
    }
    function ic() {
        try {
            return new a.ActiveXObject("Microsoft.XMLHTTP");
        } catch (b) {}
    }
    n.ajaxSetup({
        accepts: { script: "text/javascript, application/javascript, application/ecmascript, application/x-ecmascript" },
        contents: { script: /\b(?:java|ecma)script\b/ },
        converters: {
            "text script": function(a) {
                return n.globalEval(a), a;
            }
        }
    }),
        n.ajaxPrefilter("script", function(a) {
            void 0 === a.cache && (a.cache = !1), a.crossDomain && ((a.type = "GET"), (a.global = !1));
        }),
        n.ajaxTransport("script", function(a) {
            if (a.crossDomain) {
                var b,
                    c = d.head || n("head")[0] || d.documentElement;
                return {
                    send: function(e, f) {
                        (b = d.createElement("script")),
                            (b.async = !0),
                            a.scriptCharset && (b.charset = a.scriptCharset),
                            (b.src = a.url),
                            (b.onload = b.onreadystatechange = function(a, c) {
                                (c || !b.readyState || /loaded|complete/.test(b.readyState)) &&
                                    ((b.onload = b.onreadystatechange = null), b.parentNode && b.parentNode.removeChild(b), (b = null), c || f(200, "success"));
                            }),
                            c.insertBefore(b, c.firstChild);
                    },
                    abort: function() {
                        b && b.onload(void 0, !0);
                    }
                };
            }
        });
    var jc = [],
        kc = /(=)\?(?=&|$)|\?\?/;
    n.ajaxSetup({
        jsonp: "callback",
        jsonpCallback: function() {
            var a = jc.pop() || n.expando + "_" + Eb++;
            return (this[a] = !0), a;
        }
    }),
        n.ajaxPrefilter("json jsonp", function(b, c, d) {
            var e,
                f,
                g,
                h =
                    b.jsonp !== !1 &&
                    (kc.test(b.url) ? "url" : "string" == typeof b.data && 0 === (b.contentType || "").indexOf("application/x-www-form-urlencoded") && kc.test(b.data) && "data");
            return h || "jsonp" === b.dataTypes[0]
                ? ((e = b.jsonpCallback = n.isFunction(b.jsonpCallback) ? b.jsonpCallback() : b.jsonpCallback),
                  h ? (b[h] = b[h].replace(kc, "$1" + e)) : b.jsonp !== !1 && (b.url += (Fb.test(b.url) ? "&" : "?") + b.jsonp + "=" + e),
                  (b.converters["script json"] = function() {
                      return g || n.error(e + " was not called"), g[0];
                  }),
                  (b.dataTypes[0] = "json"),
                  (f = a[e]),
                  (a[e] = function() {
                      g = arguments;
                  }),
                  d.always(function() {
                      void 0 === f ? n(a).removeProp(e) : (a[e] = f), b[e] && ((b.jsonpCallback = c.jsonpCallback), jc.push(e)), g && n.isFunction(f) && f(g[0]), (g = f = void 0);
                  }),
                  "script")
                : void 0;
        }),
        (n.parseHTML = function(a, b, c) {
            if (!a || "string" != typeof a) return null;
            "boolean" == typeof b && ((c = b), (b = !1)), (b = b || d);
            var e = x.exec(a),
                f = !c && [];
            return e ? [b.createElement(e[1])] : ((e = ja([a], b, f)), f && f.length && n(f).remove(), n.merge([], e.childNodes));
        });
    var lc = n.fn.load;
    (n.fn.load = function(a, b, c) {
        if ("string" != typeof a && lc) return lc.apply(this, arguments);
        var d,
            e,
            f,
            g = this,
            h = a.indexOf(" ");
        return (
            h > -1 && ((d = n.trim(a.slice(h, a.length))), (a = a.slice(0, h))),
            n.isFunction(b) ? ((c = b), (b = void 0)) : b && "object" == typeof b && (e = "POST"),
            g.length > 0 &&
                n
                    .ajax({ url: a, type: e || "GET", dataType: "html", data: b })
                    .done(function(a) {
                        (f = arguments),
                            g.html(
                                d
                                    ? n("<div>")
                                          .append(n.parseHTML(a))
                                          .find(d)
                                    : a
                            );
                    })
                    .always(
                        c &&
                            function(a, b) {
                                g.each(function() {
                                    c.apply(this, f || [a.responseText, b, a]);
                                });
                            }
                    ),
            this
        );
    }),
        n.each(["ajaxStart", "ajaxStop", "ajaxComplete", "ajaxError", "ajaxSuccess", "ajaxSend"], function(a, b) {
            n.fn[b] = function(a) {
                return this.on(b, a);
            };
        }),
        (n.expr.filters.animated = function(a) {
            return n.grep(n.timers, function(b) {
                return a === b.elem;
            }).length;
        });
    function mc(a) {
        return n.isWindow(a) ? a : 9 === a.nodeType ? a.defaultView || a.parentWindow : !1;
    }
    (n.offset = {
        setOffset: function(a, b, c) {
            var d,
                e,
                f,
                g,
                h,
                i,
                j,
                k = n.css(a, "position"),
                l = n(a),
                m = {};
            "static" === k && (a.style.position = "relative"),
                (h = l.offset()),
                (f = n.css(a, "top")),
                (i = n.css(a, "left")),
                (j = ("absolute" === k || "fixed" === k) && n.inArray("auto", [f, i]) > -1),
                j ? ((d = l.position()), (g = d.top), (e = d.left)) : ((g = parseFloat(f) || 0), (e = parseFloat(i) || 0)),
                n.isFunction(b) && (b = b.call(a, c, n.extend({}, h))),
                null != b.top && (m.top = b.top - h.top + g),
                null != b.left && (m.left = b.left - h.left + e),
                "using" in b ? b.using.call(a, m) : l.css(m);
        }
    }),
        n.fn.extend({
            offset: function(a) {
                if (arguments.length)
                    return void 0 === a
                        ? this
                        : this.each(function(b) {
                              n.offset.setOffset(this, a, b);
                          });
                var b,
                    c,
                    d = { top: 0, left: 0 },
                    e = this[0],
                    f = e && e.ownerDocument;
                if (f)
                    return (
                        (b = f.documentElement),
                        n.contains(b, e)
                            ? ("undefined" != typeof e.getBoundingClientRect && (d = e.getBoundingClientRect()),
                              (c = mc(f)),
                              { top: d.top + (c.pageYOffset || b.scrollTop) - (b.clientTop || 0), left: d.left + (c.pageXOffset || b.scrollLeft) - (b.clientLeft || 0) })
                            : d
                    );
            },
            position: function() {
                if (this[0]) {
                    var a,
                        b,
                        c = { top: 0, left: 0 },
                        d = this[0];
                    return (
                        "fixed" === n.css(d, "position")
                            ? (b = d.getBoundingClientRect())
                            : ((a = this.offsetParent()),
                              (b = this.offset()),
                              n.nodeName(a[0], "html") || (c = a.offset()),
                              (c.top += n.css(a[0], "borderTopWidth", !0)),
                              (c.left += n.css(a[0], "borderLeftWidth", !0))),
                        { top: b.top - c.top - n.css(d, "marginTop", !0), left: b.left - c.left - n.css(d, "marginLeft", !0) }
                    );
                }
            },
            offsetParent: function() {
                return this.map(function() {
                    var a = this.offsetParent;
                    while (a && !n.nodeName(a, "html") && "static" === n.css(a, "position")) a = a.offsetParent;
                    return a || Qa;
                });
            }
        }),
        n.each({ scrollLeft: "pageXOffset", scrollTop: "pageYOffset" }, function(a, b) {
            var c = /Y/.test(b);
            n.fn[a] = function(d) {
                return Y(
                    this,
                    function(a, d, e) {
                        var f = mc(a);
                        return void 0 === e
                            ? f
                                ? b in f
                                    ? f[b]
                                    : f.document.documentElement[d]
                                : a[d]
                            : void (f ? f.scrollTo(c ? n(f).scrollLeft() : e, c ? e : n(f).scrollTop()) : (a[d] = e));
                    },
                    a,
                    d,
                    arguments.length,
                    null
                );
            };
        }),
        n.each(["top", "left"], function(a, b) {
            n.cssHooks[b] = Ua(l.pixelPosition, function(a, c) {
                return c ? ((c = Sa(a, b)), Oa.test(c) ? n(a).position()[b] + "px" : c) : void 0;
            });
        }),
        n.each({ Height: "height", Width: "width" }, function(a, b) {
            n.each(
                {
                    padding: "inner" + a,
                    content: b,
                    "": "outer" + a
                },
                function(c, d) {
                    n.fn[d] = function(d, e) {
                        var f = arguments.length && (c || "boolean" != typeof d),
                            g = c || (d === !0 || e === !0 ? "margin" : "border");
                        return Y(
                            this,
                            function(b, c, d) {
                                var e;
                                return n.isWindow(b)
                                    ? b.document.documentElement["client" + a]
                                    : 9 === b.nodeType
                                    ? ((e = b.documentElement), Math.max(b.body["scroll" + a], e["scroll" + a], b.body["offset" + a], e["offset" + a], e["client" + a]))
                                    : void 0 === d
                                    ? n.css(b, c, g)
                                    : n.style(b, c, d, g);
                            },
                            b,
                            f ? d : void 0,
                            f,
                            null
                        );
                    };
                }
            );
        }),
        n.fn.extend({
            bind: function(a, b, c) {
                return this.on(a, null, b, c);
            },
            unbind: function(a, b) {
                return this.off(a, null, b);
            },
            delegate: function(a, b, c, d) {
                return this.on(b, a, c, d);
            },
            undelegate: function(a, b, c) {
                return 1 === arguments.length ? this.off(a, "**") : this.off(b, a || "**", c);
            }
        }),
        (n.fn.size = function() {
            return this.length;
        }),
        (n.fn.andSelf = n.fn.addBack),
        "function" === typeof wwplayer.define &&
            wwplayer.define.amd &&
            wwplayer.define("jquery", [], function() {
                return n;
            });
    var nc = a.jQuery,
        oc = a.$;
    return (
        (n.noConflict = function(b) {
            return a.$ === n && (a.$ = oc), b && a.jQuery === n && (a.jQuery = nc), n;
        }),
        b || (a.jQuery = a.$ = n),
        n
    );
});


}
/**
	Sets jQuery's noConflict flag

	@module jquery-private
	@requires jquery
**/
wwplayer.define("jquery-private", ["jquery"], function($) {
    if(window.wirewax.pdkPlugin && window.requestor_id === "BBCA") {
        return jQuery
    }

    return $.noConflict(true);
});
wwplayer.define("globals", [], function() {
    /**
		Is the current browser IE 10
		@property {boolean} isIE10

		Is the current browser IE 9
		@property {boolean} isIE9

		Is the current browser IE 8
		@property {boolean} isIE8
	**/

    var isIE11 = !!navigator.userAgent.match(/Trident.*rv[ :]*11\./),
        isIE10 = false,
        isIE9 = false,
        isIE8 = window.attachEvent && !window.addEventListener;

    /**
		Returns the major version of IOS if we're on an iDevice

		@method iosVersion
		@private
		@returns {Number} version the major version of IOS if we're on an iDevice, null otherwise
	**/
    var iosVersion = function() {
        if (/iP(hone|od|ad)/.test(navigator.userAgent)) {
            var v = navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);
            if (v) {
                return parseInt(v[1], 10);
            } else {
                return null;
            }
        }

        return null;
    };

    /**
		Returns the major.minor version of IOS if we're on an iDevice

		@method iosVersionVerbose
		@private
		@returns {Number} version the major.minor (string) version of IOS if we're on an iDevice, null otherwise
	**/
    var iosVersionVerbose = function() {
        if (/iP(hone|od|ad)/.test(navigator.userAgent)) {
            var v = navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);
            if (v) {
                return parseInt(v[1], 10) + "." + parseInt(v[2], 10);
            } else {
                return null;
            }
        }

        return null;
    };

    /**
		Returns the major version of Android if we're on an Android device

		@method androidVersion
		@private
		@returns {Number} version the major version of Android if we're on an Android device, null otherwise
	**/
    var androidVersion = function() {
        if (navigator.userAgent.indexOf("Android") >= 0) {
            return parseFloat(navigator.userAgent.slice(navigator.userAgent.indexOf("Android") + 8));
        }

        return null;
    };

    /**
		Returns the major version of Chrome

		@method chromeVersion
		@private
		@returns {Number} version the major version of Chrome if we're in Chrome, null otherwise
	**/
    var chromeVersion = function() {
        if (navigator.userAgent.indexOf("Chrome") >= 0) {
            return parseFloat(navigator.userAgent.match(/Chrome\/([0-9]*\.[0-9]*)/)[1]);
        }

        return null;
    };

    /**
		Returns the major version of the Silk Browser if we're on an Kindle

		@method kindleVersion
		@private
		@returns {Number} version the major version of the Silk Browser if we're on an Kindle, null otherwise
	**/
    var kindleVersion = function() {
        if (navigator.userAgent.indexOf("Silk") >= 0) {
            return 1;
        }

        return null;
    };

    /**
		Returns false if the device is incapable of autoplaying, true otherwise

		@method canAutoPlay
		@private
		@returns {boolean} canAutoPlay
	**/
    var canAutoPlay = function() {
        if (iosVersion() && iosVersion() < 10) {
            return false;
        }
        if (androidVersion() && chromeVersion() && (androidVersion() < 4 || chromeVersion() < 53)) {
            return false;
        }
        //check for data saver on chrome, as it blocks even muted autoplay
        if (navigator.connection) {
            if (navigator.connection.saveData === true) {
                return false;
            }
        }
        // if(kindleVersion()) { return false; }
        return true;
    };

    /*@cc_on
		if (/^10/.test(@_jscript_version)) {
			isIE10 = true;
		}
		else if (/^9/.test(@_jscript_version)) {
			isIE9 = true;
		}
	@*/

    /**
		The globals object keeps track of all vars used globally in the app without polluting the window object

	 	Event names
		Configuration options
		Browser information and capabilities
		Player settings
		Localized Strings
		Error codes
	**/

    /**
     * @author legacy developers, Jose Rego
     * @module Globals
     * @description The globals object keeps track of all vars used globally in the app without polluting the window object. <br/>
     * -Event names <br/>
     * -Configuration options <br/>
     * -Browser information and capabilities <br/>
     * -Player settings <br/>
     * -Localized Strings <br/>
     * -Error codes <br/>
     * Since all variables are in the globals object I'm using variable type to organize them in several types. This doesnt mean that that property cant be used for other purposes.
     *
     * @property {Object} PlayerEvent These are player triggers and listenners
     * @property {String} PlayerEvent.DO_PLAY Trigger video to play
     * @property {String} PlayerEvent.DO_PAUSE Trigger video to pause
     * @property {String} PlayerEvent.DO_SEEK Trigger video to seek
     * @property {String} PlayerEvent.NEW_CLIP Trigger sync tags
     * @property {String} PlayerEvent.GO_TO_NEXT_CLIP Trigger video to seek to next clip
     * @property {String} PlayerEvent.GO_TO_PREV_CLIP Trigger video to seek to previous clip
     * @property {Function} PlayerEvent.GET_CURRENT_PLAYING_TIME Returns current playing time in seconds
     * @property {Function} PlayerEvent.IS_PLAYING Returns false if not playing
     * @property {Function} PlayerEvent.PLAY_FUNCTION Trigger video to play
     * @property {Function} PlayerEvent.PAUSE_FUNCTION Trigger video to pause
     * @property {Function} PlayerEvent.PLAY_PAUSE_FUNCTION Returns when either a play or pause event happens
     *
     *
     * @property {String} PlayerEvent.ERROR Error event triggered if something goes wrong. Ex: player error, files failing to load
     * @property {String} PlayerEvent.ANIMATIONS_READY Triggered when tag controller and tags are ready (Jose Note: not sure how exact this is )
     * @property {String} PlayerEvent.VIDEO_READY Triggered when video is ready to play
     * @property {String} PlayerEvent.HAS_PAUSED Triggered when video is paused
     * @property {String} PlayerEvent.HAS_PLAYED Triggered when video is played
     * @property {String} PlayerEvent.HAS_SEEKED Triggered when video is seeked
     * @property {String} PlayerEvent.HAS_VIDEO_CLICKED Triggered when PLAY_PAUSE_FUNCTION is triggered. Common use is when people click the video to play/pause.
     * @property {String} PlayerEvent.VIDEO_END Triggered when video ends
     * @property {String} PlayerEvent.TAG_CLICK Triggered when tag is clicked
     * @property {String} PlayerEvent.SHOW_WIDGET Triggers widget to be appended and showned ( Ex: when tag is clicked )
     * @property {String} PlayerEvent.CLOSE_WIDGET Triggers widget to be closed and remove element
     * @property {String} PlayerEvent.WIDGET_SHOWN Triggered when overlay is showned
     * @property {String} PlayerEvent.WIDGET_CLOSED Triggered when overlay is closed
     * @property {String} PlayerEvent.SHOW_LOADER Triggers loading screen to show
     * @property {String} PlayerEvent.SHOW_LOADER_TRANSPARENT Triggers transparent loading screen
     * @property {String} PlayerEvent.HIDE_LOADER Triggers loading screen to hide
     * @property {String} PlayerEvent.SHOW_MESSAGE Triggers displays the message in the UserMessage box ( Jose Note: no idea what user message box is )
     * @property {String} PlayerEvent.ENABLE_AUDIO Triggers the audio to be enabled. This is used for autoplay videos in iphone that need to start muted and can only have audio enabled upon an user interaction.
     * @property {String} PlayerEvent.DISMISS_ERROR_MESSAGE Triggers the message in the UserMessage box to be dismissed ( Jose Note: no idea what user message box is )
     * @property {String} PlayerEvent.SHOW_CONSOLE Triggers the player console to show
     * @property {String} PlayerEvent.WINDOW_RESIZE Triggers the player to resize. recalculates the font size and all the elements
     * @property {String} PlayerEvent.CANCEL_FULLSCREEN Triggers the player to leave fullscreen mode
     * @property {String} PlayerEvent.CHANGE_RENDITION Triggers the player to change rendition
     * @property {String} PlayerEvent.OPEN_SHARE_SCREEN Triggers the share panel to show
     * @property {String} PlayerEvent.HIDE_TAG Triggers the tags to hide
     * @property {String} PlayerEvent.STARTED_BUFFERING Triggered when player starts buffering ( Jose Note: not sure how exact this is )
     * @property {String} PlayerEvent.ENDED_BUFFERING Triggered when player ends buffering ( Jose Note: not sure how exact this is )
     * @property {String} PlayerEvent.WEBGLERROR Triggered when there is a webgl error (Ex: 360 videos )
     * @property {String} PlayerEvent.RENDITION_CHANGED Triggered when the video rendition is changed
     * @property {String} PlayerEvent.TAG_SHOW !DEPRECATED! Triggered when tag is showned
     * @property {String} PlayerEvent.VIDEO_CLICK !DEPRECATED!
     * @property {String} PlayerEvent.TOGGLE_PLAY !DERECATED! Trigger video to pause/play
     * @property {String} PlayerEvent.TAG_HOVER_IN !DEPRECATED! Triggers tag to be selected ( adds css classes )
     * @property {String} PlayerEvent.TAG_HOVER_OUT !DEPRECATED! Triggers tag to be unselected (removes css classes )
     * @property {String} PlayerEvent.DO_STOP ?? not being used anywhere ??
     * @property {String} PlayerEvent.NEW_FRAME ?? not being used anywhere ??
     * @property {String} PlayerEvent.SEND_ERROR ?? not being used anywhere ??
     * @property {String} PlayerEvent.TAG_HIDE ?? not being used anywhere ??
     * @property {String} PlayerEvent.ADD_OVERLAY ?? not being used anywhere ??
     * @property {Boolean} PlayerEvent.AUTOPLAY=false set video autoplay
     * @property {Boolean} PlayerEvent.LOOP=false set video loop
     *
     *
     * @property {Object} MetricEvent These are metric events
     * @property {String} MetricEvent.DO_HANDSHAKE Record this impression as a view
     * @property {String} MetricEvent.UI_EVENT Record UI click ( player controllers )
     * @property {String} MetricEvent.WIDGET_ACTION Record widget actions (Ex: open, close)
     * @property {String} MetricEvent.WIDGET_CLICKOUT Record widget clickout (Ex: "buy now" button that clicksout to store website)
     * @property {String} MetricEvent.CURRENT_TIME_SET Record time that was set ( Ex: when we seek in the timeline )
     * @property {String} MetricEvent.LOAD_METRIC Record loading time of a file (Ex: css files, video data)
     * @property {String} MetricEvent.THROBBER_METRIC Record amount of time with the loader being showned
     *
     *
     * @property {Object} IframeAPIEvent These are iframe API triggers and listenners
     * @property {String} IframeAPIEvent.DEVICE_ORIENTATION Used for 360 videos. To update device orientation
     * @property {String} IframeAPIEvent.DEVICE_MOTION Used for 360 videos. To update device motion
     * @property {String} IframeAPIEvent.DEVICE_SCREEN_ORIENTATION Used for 360 videos. To update device screen orientation
     * @property {String} IframeAPIEvent.CLIENT_CUSTOM_TRIGGER Used for custom projects. Trigger custom functionality/behaviour or populate data
     * @property {String} IframeAPIEvent.CLIENT_CUSTOM_EVENT Used for custom projects. Triggered when we want. Example: Send data of all products in the wishlist.
     * @property {String} IframeAPIEvent.MUTE_VOLUME Trigger the player to mute
     * @property {String} IframeAPIEvent.UNMUTE_VOLUME Trigger the player to unmute
     * @property {String} IframeAPIEvent.CHANGE_VOLUME Trigger update on the player volume
     * @property {String} IframeAPIEvent.VOLUME_CHANGE Triggered on player volume change. Sends the volume. Our player needs a value between 0 and 1.
     * @property {String} IframeAPIEvent.DURATION_CHANGE Triggered on loading. Sends the duration of the video.
     * @property {String} IframeAPIEvent.GET_CURRENT_TIME Triggers RETURN_CURRENT_TIME to be triggered
     * @property {String} IframeAPIEvent.RETURN_CURRENT_TIME Triggered by GET_CURRENT_TIME. Sends the current time
     * @property {String} IframeAPIEvent.TOGGLE_SUBTITLES Triggers the subtitles to show/hide
     * @property {String} IframeAPIEvent.PRODUCT_ADD_TO_CART Used to send information about a product. Used by websites to add products to their cart
     * @property {String} IframeAPIEvent.GO_TO_TAG Trigger the video to seek to the tag time and play
     * @property {String} IframeAPIEvent.OPEN_TAG Trigger the video to seek to the tag time and open it
     * @property {String} IframeAPIEvent.GET_TAGS Trigger RETURN_TAGS to be trigger ( deprecated ? )
     * @property {String} IframeAPIEvent.RETURN_TAGS Triggered by GEt_TAGS and returns all tags objects ( deprecated ? )
     * @property {String} IframeAPIEvent.VIDEO_FIRST_QUARTILE Triggered when video reach the first quartile
     * @property {String} IframeAPIEvent.VIDEO_MIDPOINT Triggered when video reach the mid point
     * @property {String} IframeAPIEvent.VIDEO_THIRD_QUARTILE Triggered when video reach the third quartile
     * @property {String} IframeAPIEvent.IS_PLAYER_READY !DEPRECATED! Triggers VIDEO_READY if video ready
     * @property {String} IframeAPIEvent.CUSTOM_EVENT !DEPRECATED!( Read: CLIENT_CUSTOM_TRIGGER and CLIENT_CUSTOM_EVENT ) Used to send custom information.
     *
     *
     * @property {Object} StudioEditorEvent These are triggers/listenners for the studio editor
     * @property {String} StudioEditorEvent.ADD_TAG Change player to tag creator mode. Where people can draw the bounding box
     * @property {String} StudioEditorEvent.CLOSE_WRITER Close tag creator mode.
     * @property {String} StudioEditorEvent.NAME_TAG Triggered when new tag is created or when a suggested tag receives a name
     * @property {String} StudioEditorEvent.EDIT_TAG Triggered when user clicks to edit tag ( deprecated ? )
     * @property {String} StudioEditorEvent.SAVE_TAG ?? not being used anywhere ??
     * @property {String} StudioEditorEvent.DELETE_TAG Deletes tag (Want to deprecate. Lets try to avoid manipulate data in the player and calls to hobnob )
     * @property {String} StudioEditorEvent.TAG_ADDED ?? not being used anywhere ??
     * @property {String} StudioEditorEvent.TAG_NAMED ?? not being used anywhere ??
     * @property {String} StudioEditorEvent.UPDATE_TAG !DEPRECATED!
     * @property {String} StudioEditorEvent.REDRAW_TAGS Triggers the player to redraw all tags
     * @property {String} StudioEditorEvent.REFRESH_PLAYER Triggers the player to refresh (right now is setting the time to the current time, to force a tag sync) ( deprecated ? )
     * @property {String} StudioEditorEvent.MERGE_MODE Triggers the player to be on merge mode. To merge 2 tags(sprites)
     * @property {String} StudioEditorEvent.CHANGE_CUSTOM_CONFIG Triggers an update to the custom config data. Used for previewing tag/overlay changes in the data schema
     * @property {String} StudioEditorEvent.START_EDIT_TRACKING Triggers edit tracking mode
     * @property {String} StudioEditorEvent.UNDO_EDIT_TRACKING Triggers revert last tracking change
     * @property {String} StudioEditorEvent.END_EDIT_TRACKING Triggers end of edit tracking mode
     * @property {String} StudioEditorEvent.EDIT_TAG_INPOINT Triggers change to the tag start frame ( Want to deprecate. Lets try to avoid manipulate data in the player and calls to hobnob )
     * @property {String} StudioEditorEvent.EDIT_TAG_OUTPOINT Triggers change to the tag start frame ( Want to deprecate. Lets try to avoid manipulate data in the player and calls to hobnob )
     * @property {String} StudioEditorEvent.WRITER_ERROR Trigerred when there is an error
     * @property {String} StudioEditorEvent.WRITER_CLOSING Trigered when the tag creator mode is closed.
     * @property {String} StudioEditorEvent.TIMELINE_TAG_SETTINGS Trigger seek to tag time and highlight tag
     * @property {String} StudioEditorEvent.EDITOR_TAG_SETTINGS Trigger highlight tag
     * @property {String} StudioEditorEvent.EDITOR_DO_EDIT_TRACKING Triggered when user clicks the edit tracking button in the tag
     * @property {String} StudioEditorEvent.EDITOR_DELETE_TAG  Triggered when user clicks the delete button in the tag
     * @property {String} StudioEditorEvent.EDITOR_REFRESH_TIMELINE Triggered when there is a change to the sprite (Ex: undo/edit tracking, merge)
     * @property {String} StudioEditorEvent.CHANGE_SUBTITLES Trigger the player to load new subtitles
     * @property {String} StudioEditorEvent.SEND_SUBTITLES Triggered when there is a change to the subtitle
     *
     *
     * @property {Object} PlayerParam These are the properties related to the player
     * @property {boolean} PlayerParam.AUDIO_DISABLED This is used for autoplay videos in iphone that need to start muted and can only have audio enabled upon an user interaction.
     * @property {String} PlayerParam.VIDEO_PRELOAD='none' If we want the browser to preload the video
     *
     * @property {Object} SizeParam This are the properties related with size
     * @property {Number} SizeParam.ASPECT_RATIO_WIDTH=16 Aspect ratio width. Used with ASPECT_RATIO_HEIGHT to calculate player dimentions.
     * @property {Number} SizeParam.ASPECT_RATIO_HEIGHT=9 Aspect ratio height. Used with ASPECT_RATIO_WIDTH to calculate player dimentions.
     * @property {Number} SizeParam.BASE_WIDTH=960 ?? not being used anywhere ??
     * @property {Number} SizeParam.BASE_HEIGHT=540 ?? not being used anywhere ??
     * @property {Number} SizeParam.MIN_HEIGHT=199 Minimum player height
     * @property {Number} SizeParam.MIN_WIDTH=395 Minimum player width
     * @property {Number} SizeParam.OVERLAY_HEIGHT Overlay div height
     * @property {Number} SizeParam.OVERLAY_WIDTH Overlay div width
     *
     *
     * @property {Object} RenditionParam These are the properties related with renditions
     * @property {Boolean} RenditionParam.IS_STACKED=false If is a stacked video or not. Stacked = 2 videos in 1. Used for multistream projects e.g. Jungle Book
     * @property {String} RenditionParam.RENDITION='540' Rendition being used
     * @property {String} RenditionParam.HD_RENDITION='720' Rendition considered HD
     * @property {String} RenditionParam.BANDWIDTH_PREFERRED_RENDITION Rendition prefered based on the loading times.
     * @property {String} RenditionParam.FORCE_RENDITION When we want to force the initial rendition.
     * @property {enum} RenditionParam.RESOLUTION_CODES Rendition_code: Rendition_String enum ( Ex: 2:'720' )
     * @property {Number} RenditionParam.RESOLUTION_CODES.0 360
     * @property {Number} RenditionParam.RESOLUTION_CODES.1 720
     * @property {Number} RenditionParam.RESOLUTION_CODES.2 1080
     * @property {Number} RenditionParam.RESOLUTION_CODES.3 480
     * @property {Number} RenditionParam.RESOLUTION_CODES.4 540
     * @property {Number} RenditionParam.RESOLUTION_CODES.16 360
     * @property {Number} RenditionParam.RESOLUTION_CODES.17 540
     * @property {Number} RenditionParam.RESOLUTION_CODES.18 720
     * @property {Number} RenditionParam.RESOLUTION_CODES.19 1080
     * @property {Number} RenditionParam.RESOLUTION_CODES.1000 540image
     * @property {Number} RenditionParam.RESOLUTION_CODES.1001 1080image
     * @property {Number} RenditionParam.RESOLUTION_CODES.1002 2160image
     * @property {enum} RenditionParam.RENDITIONS Renditions available ( should be refactored since is doesn't take in account all of them )
     * @property {Number} RenditionParam.RENDITIONS.360 360
     * @property {Number} RenditionParam.RENDITIONS.540 540
     * @property {Number} RenditionParam.RENDITIONS.720 720
     * @property {Number} RenditionParam.RENDITIONS.1080 1080
     *
     *
     * @property {Object} BranchingParam These are the properties for branching events e.g. BRANCHING_TYPE.JUMP
     * @property {enum} BranchingParam.BRANCHING_TYPE There are 3 types of branching event
     * @property {String} BranchingParam.BRANCHING_TYPE.JUMP Automatically jumps
     * @property {String} BranchingParam.BRANCHING_TYPE.PAUSE PAUSE
     * @property {String} BranchingParam.BRANCHING_TYPE.CUSTOM CUSTOM
     *
     *
     * @property {Object} MediaParams These are the properties for media types
     * @property {enum} MediaParams.MEDIA_TYPES These are the properties for the media type of the video e.g. MEDIA_TYPES.VIDEO
     * @property {String} MediaParams.MEDIA_TYPES.VIDEO Video
     * @property {String} MediaParams.MEDIA_TYPES.IMAGE Image
     * @property {String} MediaParams.MEDIA_TYPES.AUDIO Audio
     *
     *
     * @property {enum} MediaParams.MEDIA_TYPE Alternative media type of video e.g. MEDIA_TYPE.0
     * @property {Number} MediaParams.MEDIA_TYPE.0 Video
     * @property {Number} MediaParams.MEDIA_TYPE.1 Image
     * @property {Number} MediaParams.MEDIA_TYPE.2 Audio
     *
     *
     * @property {Object} userAgentParams These are properties relating to the browser user agent
     * @property {string} userAgentParams.IP_ADDRESS The browser's IP address
     * @property {string} userAgentParams.USER_AGENT The browser's user agent information
     * @property {Boolean} userAgentParams.IS_CYOA=false used to load a special flash video for IE8 that buffers the whole video before ready
     * @property {Boolean} userAgentParams.IS_IE Browser is Internet Explorer, any version
     * @property {Boolean} userAgentParams.IS_IE_11 Browser is Internet Explorer version 11
     * @property {Boolean} userAgentParams.IS_IE_10 Browser is Internet Explorer version 10
     * @property {Boolean} userAgentParams.IS_IE_9 Browser is Internet Explorer version 9
     * @property {Boolean} userAgentParams.IS_IE_8 Browser is Internet Explorer version 8
     * @property {Boolean} userAgentParams.NON_INTERACTIVE=false
     * @property {Boolean} userAgentParams.IS_SAMSUNG_TV=false deprecated
     * @property {Boolean} userAgentParams.HAS_FLASH=false ???
     * @property {Boolean} userAgentParams.FORCE_HTML5=false deprecated
     * @property {Boolean} userAgentParams.IS_MOBILE_USERAGENT browser is a mobile version
     * @property {Boolean} userAgentParams.IS_IPAD user device is iPad
     * @property {Boolean} userAgentParams.IS_IPHONE user device is iPhone
     * @property {Boolean} userAgentParams.IS_ANDROID user device is Android phone
     * @property {Boolean} userAgentParams.IS_KINDLE user device is Kindle
     * @property {Boolean} userAgentParams.IS_BLACKBERRY user device is Blackberry phone
     * @property {Boolean} userAgentParams.IS_WINDOWS_PHONE user device is Windows phone
     * @property {Boolean} userAgentParams.IS_SAFARI browser is Safari
     * @property {Boolean} userAgentParams.IS_CHROME browser is Chrome
     * @property {Boolean} userAgentParams.IS_CHROME_PAST_40 browser is Chrome with version > 40
     * @property {Boolean} userAgentParams.IS_EDGE browser is Edge
     * @property {Boolean} userAgentParams.IS_FIREFOX browser is Firefox
     * @property {Boolean} userAgentParams.IS_GOOGLE_SEARCH_APP ???
     * @property {Boolean} userAgentParams.IS_GOOGLE_BOT user is a Google search bot
     * @property {Boolean} userAgentParams.IS_DEJACLICK_BOT user is a Dejaclick bot
     * @property {Boolean} userAgentParams.IS_WINDOWS user OS is Windows
     * @property {Boolean} userAgentParams.IS_MAC user OS is Mac
     * @property {Number} userAgentParams.IOS_VERSION iOS version
     * @property {Number} userAgentParams.IOS_VERSION_VERBOSE iOS version verbose
     * @property {Boolean} userAgentParams.CAN_AUTOPLAY If the device can autoplay videos
     * @property {String} userAgentParams.IDEVICE_GENERATION Device Pixel Ratio 2 is IPhone4 & IPad3 and above
     * @property {Boolean} userAgentParams.LITE_VERSION=false ???
     * @property {String} userAgentParams.LANG browser's language
     * @property {String} userAgentParams.LOCALE browser's country code e.g. 'fr'
     * @property {String} userAgentParams.COUNTRY browser's country code e.g. 'fr'
     *
     *
     * @property {Object} overrideParams These are defaults for overrides
     * @property {String} overrideParams.SHARE_TEXT set in the metadata
     * @property {String} overrideParams.SHARE_URL set in the metadata
     * @property {Boolean} overrideParams.WHITELABEL=false hides the wirewax logo
     * @property {Boolean} overrideParams.DISABLE_STANDARD_END_FRAME=false hides the standard end frame
     * @property {Boolean} overrideParams.DISABLE_SHARES=false toggles the functionality of the share button
     * @property {Boolean} overrideParams.DISABLE_FULLSCREEN=false toggles subtitles as track files or as crumpet style divs
     * @property {Boolean} overrideParams.STYLED_SUBTITLES=false toggles subtitles on and off
     * @property {Boolean} overrideParams.SUBTITLES_ON=false resumes playing the video when a widget is closed
     * @property {Boolean} overrideParams.PLAY_ON_WIDGET_CLOSE=false resumes playing the video when a widget is closed
     * @property {Boolean} overrideParams.TAGS_ON_END_FRAME=false allows tags to be displayed on the end frame
     * @property {Boolean} overrideParams.PLAY_ON_WAKE=false resumes playing the video when a user switches back to the player tab
     * @property {Boolean} overrideParams.HIDE_SCRUBBER=false controls the scrubber bar hiding behaviour on hover
     * @property {Boolean} overrideParams.PREVENT_SCROLL=false prevents scrolling on touchmove
     * @property {Boolean} overrideParams.PREVENT_VIDEO_CLICK=false prevents clicking the video to play / pause
     * @property {Boolean} overrideParams.PREVENT_VIDEO_DOUBLE_CLICK=false prevents double clicking the video to play / pause ( 360 videos )
     * @property {Boolean} overrideParams.DISABLE_LOGO=false Disables clicking on the logo
     * @property {Boolean} overrideParams.OPEN_WIDGET_ON_SPRITE_SEEK_TO=false automatically opens a widget when seeking to a sprite id
     * @property {Boolean} overrideParams.DISABLE_METRICS=false disables metrics collection
     * @property {Boolean} overrideParams.DISABLE_SPACE_BAR_PLAY=false disables the space bar
     * @property {Boolean} overrideParams.DISABLE_MOBILE_DOUBLE_TAP=false disables double tap to play / pause on mobile
     * @property {Boolean} overrideParams.DISABLE_360_CONTROLS=false disables the panning controls on 360 videos
     * @property {Boolean} overrideParams.DISABLE_CUSTOMISATIONS=false disables tags/widgets/modules
     * @property {Boolean} overrideParams.ENABLE_360_RADAR=false enables the radar on 360 videos
     * @property {Boolean} overrideParams.ENABLE_STALL_DETECTION=false throws up a message when a video has been buffering for too long
     * @property {Boolean} overrideParams.ENABLE_TIME_CODE_COVER=false enable/disable the time code cover
     * @property {Boolean} overrideParams.SMOOTH_FONT_STEPS=false enables / disables font size rounding on the main video element. should be set to false in all new customisations.
     * @property {Boolean} overrideParams.SHOW_THROBBER_ON_BUFFER=false show the throbber on video buffer
     * @property {Boolean} overrideParams.SHOW_DISABLED_AUDIO_ICON=false show an icon to indicate that the audio is disabled (i.e. silent autoplay)
     * @property {Boolean} overrideParams.ENABLE_STALL_MESSAGES=false ???
     * @property {Boolean} overrideParams.ALLOW_LOADER_VIDEO_RELOAD=false ???
     * @property {Boolean} overrideParams.ENABLE_OVERLAY_FULL_BLEED=false enable / disable the fullbleed resize for the overlays
     * @property {Boolean} overrideParams.VIDEOELEMENT_SIZE_CHECK=false constant checking to see if the size of the window has changed, used with brightcove
     * @property {Boolean} overrideParams.RECORD_MOUSE_METRICS=false ???
     * @property {Boolean} overrideParams.ENABLE_ALT_VIDEO_SOURCE=false enable hack for the 360 webgl in ios and ie11. the video source needs to be from the same origin.
     * @property {Boolean} overrideParams.ENABLE_VIDEO_CANVAS_SOURCE=false enable hack for the 360 webgl. the source is a video in a canvas
     * @property {Boolean} overrideParams.ENABLE_IMAGE_SOURCE=false enable the source for the 360 player to be an image
     * @property {Boolean} overrideParams.INNOVID_EVENTS=false use the innovideventmanger instead of the regular event manager
     * @property {Function} overrideParams.CLICK_EVENT set to touchend on touch enabled devices
     * @property {Number} overrideParams.VOLUME curent volume of the player
     * @property {String} overrideParams.BUTTON_BACKGROUND_COLOR Used to switch between light / dark depending on the window.wirewax.colour
     * @property {Boolean} overrideParams.CUSTOM_METRICS=false record custom mouse-like metrics (e.g. jungle book slider),
     * @property {Function} overrideParams.CUSTOM_METRICS_CALLBACK callback to send custom metrics
     *
     *
     * @property {Object} flashParams These are properties for flash - deprecated
     * @property {String} flashParams.WIREWAX_URL_COMMS deprecated
     * @property {String} flashParams.AMBER_URL_COMMS deprecated
     * @property {Boolean} flashParams.USE_FLASH_FALLBACK=true deprecated
     * @property {Boolean} flashParams.DISABLE_SCRUBBER_TAGS=false deprecated
     * @property {Boolean} flashParams.DISABLE_ADS=false deprecated
     * @property {Boolean} flashParams.DISABLE_CC=true enables / disables subtitles - deprecated
     *
     *
     * @property {Object} dataparams These are properties for data
     * @property {Object} dataparams.ASSETS empty array
     * @property {Boolean} dataparams.CUSTOM_CONFIG_DATA=false has all the custom config data
     *
     *
     * @property {Object} AWSParams These are properties for AWS/SQS
     * @property {String} AWSParams.AWS_REGION 'eu-west-1'
     * @property {String} AWSParams.AWS_ACCESS_KEY 'AKIAIFV7VXOGTTGPJZDQ'
     * @property {String} AWSParams.AWS_SECRET_KEY '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'
     * @property {String} AWSParams.SQS_METRIC_QUEUE_URL 'https://sqs.eu-west-1.amazonaws.com/142936586381/wirewaxMetricsInsert'
     * @property {String} AWSParams.SQS_SUB_METRC_QUEUE_URL 'https://sqs.eu-west-1.amazonaws.com/142936586381/wirewaxSubDocumentPush'
     * @property {String} AWSParams.SQS_TEST_QUEUE_URL 'https://sqs.us-east-1.amazonaws.com/142936586381/wirewaxMetricsTest'
     * @property {String} AWSParams.SQS_IMPRESSION_TEST_QUEUE_URL 'https://sqs.eu-west-1.amazonaws.com/142936586381/wirewaxImpressionsTest'
     * @property {String} AWSParams.SQS_IMPRESSION_QUEUE_URL 'https://sqs.us-east-1.amazonaws.com/142936586381/wirewaxImpressions'
     * @property {String} AWSParams.SQS_SUB_TEST_QUEUE_URL 'https://sqs.us-east-1.amazonaws.com/142936586381/wirewaxSubDocumentTest'
     * @property {String} AWSParams.SQS_ERROR_QUEUE_URL 'https://sqs.us-east-1.amazonaws.com/142936586381/wirewaxErrors'
     * @property {String} AWSParams.SQS_LEGACY_CODE_QUEUE_URL 'https://sqs.us-east-1.amazonaws.com/142936586381/wirewaxDeprecated'
     *
     *
     * @property {Object} stringParams These are strings for future use with future localisation
     * @property {Enum} stringParams.STRINGS strings
     * @property {String} stringParams.STRINGS.FEATURE_NOT_SUPPORTED "Sorry, this feature is not supported by your current browser."
     * @property {String} stringParams.STRINGS.DISPLAY_ALL_TAGS "always display tags"
     * @property {String} stringParams.STRINGS.DISABLE_TAGS "disable all tags"
     * @property {String} stringParams.STRINGS.DISPLAY_TAGS_ON_HOVER "only display tags when i'm near them"
     * @property {String} stringParams.STRINGS.FULLSCREEN "full screen"
     * @property {String} stringParams.STRINGS.SPONSOR_MESSAGE "sponsor message, your video will restart in:"
     * @property {String} stringParams.STRINGS.AD_MARKER "sponsor message"
     *
     *
     * @property {Object} metricParams These are widget metric types, see Waxipedia for useage https://smc.wirewax.com/waxipedia/Player_metrics
     * @property {Enum} metricParams.WIDGET_METRIC_TYPES
     * @property {String} metricParams.WIDGET_METRIC_TYPES.CLICK_OUT 1
     * @property {String} metricParams.WIDGET_METRIC_TYPES.LEGACY 2
     * @property {String} metricParams.WIDGET_METRIC_TYPES.SHARE 3
     * @property {String} metricParams.WIDGET_METRIC_TYPES.THUMB_DISPLAYED 4
     * @property {String} metricParams.WIDGET_METRIC_TYPES.THUMB_CLICKED 5
     * @property {String} metricParams.WIDGET_METRIC_TYPES.CAROUSEL_REVEAL 6
     * @property {String} metricParams.WIDGET_METRIC_TYPES.CAROUSEL_CLOSE 7
     * @property {String} metricParams.WIDGET_METRIC_TYPES.CAROUSEL_NEXT 8
     * @property {String} metricParams.WIDGET_METRIC_TYPES.CAROUSEL_PREV 9
     * @property {String} metricParams.WIDGET_METRIC_TYPES.MEDIA_EXPAND 10
     * @property {String} metricParams.WIDGET_METRIC_TYPES.MEDIA_CLOSE 11
     * @property {String} metricParams.WIDGET_METRIC_TYPES.EXPANDED_MEDIA_NEXT 12
     * @property {String} metricParams.WIDGET_METRIC_TYPES.EXPANDED_MEDIA_PREV 13
     * @property {String} metricParams.WIDGET_METRIC_TYPES.MEDIA_PLAY 14
     * @property {String} metricParams.WIDGET_METRIC_TYPES.MEDIA_PAUSE 15
     * @property {String} metricParams.WIDGET_METRIC_TYPES.MEDIA_SKIP 16
     * @property {String} metricParams.WIDGET_METRIC_TYPES.CLOSE 17
     * @property {String} metricParams.WIDGET_METRIC_TYPES.AUTO_CLOSE 18
     * @property {String} metricParams.WIDGET_METRIC_TYPES.ADD_TO_CART 19
     * @property {String} metricParams.WIDGET_METRIC_TYPES.SHOW_PRODUCT_VARIANTS 20
     * @property {String} metricParams.WIDGET_METRIC_TYPES.CHANGE_VARIANT 21
     * @property {String} metricParams.WIDGET_METRIC_TYPES.CHANGE_PRODUCT 22
     * @property {String} metricParams.WIDGET_METRIC_TYPES.TAB_CLICKED 23
     * @property {String} metricParams.WIDGET_METRIC_TYPES.VIEW_OPTIONS 24
     * @property {String} metricParams.WIDGET_METRIC_TYPES.SELECT_OPTION 25
     * @property {String} metricParams.WIDGET_METRIC_TYPES.MEDIA_ENDED 26
     * @property {String} metricParams.WIDGET_METRIC_TYPES.AUTO_TRIGGER 27
     *
     *
     * @property {Object} legecyParams These are properties relating to legacy code
     * @property {Enum} legecyParams.LEGACY_TYPE
     * @property {String} legecyParams.LEGACY_TYPE.UNKNOWN 1- default value
     * @property {String} legecyParams.LEGACY_TYPE.DEAD_CODE 2 - applies to flash, php and system that should be dead
     * @property {String} legecyParams.LEGACY_TYPE.DEPRECATED 3 - has been deprecated and should be replaced
     * @property {String} legecyParams.LEGACY_TYPE.RECENT_DEPRECATED 4 - was recently deprecated should avoid using
     *
     *
     * @property {Object} errorParams These are properties for messages and errors
     * @property {Enum} errorParams.MESSAGES
     * @property {Number} errorParams.MESSAGES.6001 code: 5001, displayMessage: 'It's possible the video has stalled, would you like to reload?', behaviour: 1
     * @property {Enum} errorParams.ERRORS
     * @property {Number} errorParams.ERRORS.5001 displayMessage: 'It's possible the video has stalled, would you like to reload?'
     * @property {Number} errorParams.ERRORS.5002 displayMessage: 'Video Element not found'
     * @property {Number} errorParams.ERRORS.5003 displayMessage: 'Handshake with server failed', behaviour:0
     * @property {Number} errorParams.ERRORS.5004 displayMessage: 'Error loading modules - unknown'
     * @property {Number} errorParams.ERRORS.5005 displayMessage: 'Error downloading data for video'
     * @property {Number} errorParams.ERRORS.5006 displayMessage: 'Cannot update scrubber when duration is not set'
     * @property {Number} errorParams.ERRORS.5007 displayMessage: 'Clip Data not loaded'
     * @property {Number} errorParams.ERRORS.5008 displayMessage: 'Video Data not loaded'
     * @property {Number} errorParams.ERRORS.5009 displayMessage: 'Failed to load Flash fallback video'
     * @property {Number} errorParams.ERRORS.5010 displayMessage: 'Browser does not support playback of Flash content'
     * @property {Number} errorParams.ERRORS.5011 displayMessage: 'Video Element must be at least 394x198'
     * @property {Number} errorParams.ERRORS.5012 displayMessage: 'Player could not be started'
     * @property {Number} errorParams.ERRORS.5013 displayMessage: 'Error loading modules - timeout'
     * @property {Number} errorParams.ERRORS.5014 displayMessage: 'Error loading modules - script error'
     * @property {Number} errorParams.ERRORS.5015 displayMessage: 'Error loading widget data', behaviour: 1
     * @property {Number} errorParams.ERRORS.5016 displayMessage: 'Failed to fetch widget data from server', behaviour: 1
     * @property {Number} errorParams.ERRORS.5017 displayMessage: 'Tag and Widget Data not available for this video'
     * @property {Number} errorParams.ERRORS.5018 displayMessage: 'Failed to find a video source'
     * @property {Number} errorParams.ERRORS.5019 displayMessage: 'Video buffering but not downloading.'
     * @property {Number} errorParams.ERRORS.5020 displayMessage: 'XDR connection could not be opened. requests must be targeted to the same scheme as the hosting page.'
     * @property {Number} errorParams.ERRORS.5021 displayMessage: 'Failed to record uiMetric event.', behaviour:0
     * @property {Number} errorParams.ERRORS.5022 displayMessage: 'Failed to download widget', behaviour:1
     * @property {Number} errorParams.ERRORS.5023 displayMessage: 'Stalled loading video', behaviour: 2
     * @property {Number} errorParams.ERRORS.5024 displayMessage: 'Unknown error when loading sources for video', behaviour: 2
     * @property {Number} errorParams.ERRORS.5025 displayMessage: 'Failed to load font', behaviour: 0
     * @property {Number} errorParams.ERRORS.5026 displayMessage: 'Failed to load CSS for tag or widget', behaviour: 2
     * @property {Number} errorParams.ERRORS.5027 displayMessage: 'Browser not supported', behaviour: 2
     * @property {Number} errorParams.ERRORS.5028 displayMessage: 'Failed to load Template for widget', behaviour: 1
     * @property {Number} errorParams.ERRORS.5029 displayMessage: 'Failed to record impression', behaviour: 0
     * @property {Number} errorParams.ERRORS.5031 displayMessage: 'SQS Failed, falling back to PHP', behaviour: 0
     * @property {Number} errorParams.ERRORS.5032, displayMessage: 'This video is not available in your region.', behaviour: 2
     * @property {Number} errorParams.ERRORS.5033 displayMessage: 'There was an issue with playing this video. Please refresh the page.', behaviour: 2
     *
     *
     * @property {Object} animationParams These are properties for animation controllers
     * @property {Enum} animationParams.ANIMATION_CONTROLLERS
     * @property {String} animationParams.ANIMATION_CONTROLLERS.NON_TAG "javascripts/player/animationcontrollers/nonTagTagController.js"
     * @property {String} animationParams.ANIMATION_CONTROLLERS.THREE_SIXTY "javascripts/player/animationcontrollers/threeSixtyAnimationController.js"
     * @property {String} animationParams.ANIMATION_CONTROLLERS.JS "javascripts/player/animationcontrollers/jsAnimationController.js"
     * @property {String} animationParams.ANIMATION_CONTROLLERS.DEFAULT "javascripts/player/animationcontrollers/improvedJSAnimationController.js"
     * @property {String} animationParams.ANIMATION_CONTROLLERS.TRANSFORM "javascripts/player/animationcontrollers/transformAnimationController.js"
     *
     *
     * @property {Object} SCORM_EVENT These are SCORM events
     * @property {String} SCORM_EVENT.GET_PASSING_SCORE
     * @property {String} SCORM_EVENT.SET_SCORE
     * @property {String} SCORM_EVENT.GET_SCORE
     * @property {String} SCORM_EVENT.RECORD_TRUE_FALSE_INTERACTION
     * @property {String} SCORM_EVENT.RECORD_MULTIPLE_CHOICE_INTERACTION
     * @property {String} SCORM_EVENT.RECORD_FILL_IN_INTERACTION
     * @property {String} SCORM_EVENT.RECORD_RECORD_MATCHING_INTERACTION
     * @property {String} SCORM_EVENT.RECORD_PERFORMANCE_INTERACTION
     * @property {String} SCORM_EVENT.RECORD_SEQUENCING_INTERACTION
     * @property {String} SCORM_EVENT.RECORD_LIKERT_INTERACTION
     * @property {String} SCORM_EVENT.RECORD_NUMERIC_INTERACTION
     *
     **/

    var globals = {
        // VIDEO EVENTS
        DO_PLAY: "videoPlay",
        DO_STOP: "videoStop",
        DO_HANDSHAKE: "doHandshake",
        DO_PAUSE: "videoPause",
        DO_SEEK: "videoSeek",
        NEW_CLIP: "clipNew",
        NEW_FRAME: "frameNew",
        TOGGLE_PLAY: "togglePlay",
        GO_TO_NEXT_CLIP: "goToNextClip",
        GO_TO_PREV_CLIP: "goToPrevClip",
        ERROR: "error",
        SEND_ERROR: "sendError",
        ANIMATIONS_READY: "ready",
        VIDEO_READY: "videoReady",
        VIDEO_BUFFERING: "videoBuffering",
        PLAYER_READY: "playerReady",
        IS_PLAYER_READY: "isPlayerReady",
        HAS_PAUSED: "hasPaused",
        HAS_PLAYED: "hasPlayed",
        HAS_SEEKED: "hasSeeked",
        //TODO: JOSE: legacy stuff, delete me pls
        VIDEO_CLICK: "videoClick",
        HAS_VIDEO_CLICKED: "hasVideoClicked",
        VIDEO_END: "videoEnd",
        TAG_SHOW: "tagShow",
        TAG_HIDE: "tagHide",
        TAG_CLICK: "tagClick",
        TAG_HOVER_IN: "tagHoverIn",
        TAG_HOVER_OUT: "tagHoverOut",
        DEVICE_ORIENTATION: "deviceOrientation",
        DEVICE_MOTION: "deviceMotion",
        DEVICE_SCREEN_ORIENTATION: "deviceScreenOrientation",
        CLIENT_CUSTOM_TRIGGER: "clientCustomTrigger",
        CLIENT_CUSTOM_EVENT: "clientCustomEvent",
        SCORM_EVENT: "scormEvent",
        UI_EVENT: "uiEvent",
        WIDGET_ACTION: "widgetAction",
        WIDGET_CLICKOUT: "widgetClickout",
        SHOW_WIDGET: "showWidget",
        CLOSE_WIDGET: "closeWidget",
        WIDGET_SHOWN: "widgetShown",
        WIDGET_CLOSED: "widgetClosed",
        SHOW_LOADER: "showLoader",
        SHOW_LOADER_TRANSPARENT: "showLoaderTransparent",
        HIDE_LOADER: "hideLoader",
        SHOW_MESSAGE: "showMessage",
        MUTE_VOLUME: "muteVolume",
        CHANGE_VOLUME: "changeVolume",
        UNMUTE_VOLUME: "unMuteVolume",
        ENABLE_AUDIO: "enableAudio",
        AUDIO_DISABLED: false,
        VOLUME_CHANGE: "volumeChange",
        DURATION_CHANGE: "durationChange",
        DISMISS_ERROR_MESSAGE: "hideMessage",
        GET_CURRENT_TIME: "getCurrentTime",
        RETURN_CURRENT_TIME: "returnCurrentTime",
        CURRENT_TIME_SET: "currentTimeSet",
        SHOW_CONSOLE: "showConsole",
        LOAD_METRIC: "loadMetric",
        THROBBER_METRIC: "throbberMetric",
        TOGGLE_SUBTITLES: "toggleSubtitles",
        SHOW_SUBTITLES: "showSubtitles",
        WINDOW_RESIZE: "windowResize",
        ADD_OVERLAY: "addOverlay",
        CANCEL_FULLSCREEN: "cancelFullscreen",
        CHANGE_RENDITION: "changeRendition",
        PRODUCT_ADD_TO_CART: "addToCart",
        CUSTOM_EVENT: "customEvent",
        OPEN_SHARE_SCREEN: "openShareScreen",
        HIDE_TAG: "hideTag",
        STARTED_BUFFERING: "startedBuffering",
        ENDED_BUFFERING: "endedBuffering",

        GO_TO_TAG: "goToTag",
        OPEN_TAG: "openTag",
        GET_TAGS: "getTags",
        RETURN_TAGS: "returnTags",

        //WRITER EVENTS
        ADD_TAG: "addTag",
        CLOSE_WRITER: "closeWriter",
        NAME_TAG: "nameTag",
        EDIT_TAG: "editTag",
        SAVE_TAG: "saveTag",
        DELETE_TAG: "deleteTag",
        TAG_ADDED: "tagAdded",
        TAG_NAMED: "tagNamed",
        UPDATE_TAG: "updateTag",
        REDRAW_TAGS: "redrawTags",
        REFRESH_PLAYER: "refreshPlayer",
        MERGE_MODE: "MERGE_MODE",
        CHANGE_CUSTOM_CONFIG: "changeCustomConfig",

        START_EDIT_TRACKING: "startEditTracking",
        UNDO_EDIT_TRACKING: "undoEditTracking",
        END_EDIT_TRACKING: "endEditTracking",
        EDIT_TAG_INPOINT: "editTagInPoint",
        EDIT_TAG_OUTPOINT: "editTagOutPoint",
        WRITER_ERROR: "writerError",
        WRITER_CLOSING: "writerClosing",

        TIMELINE_TAG_SETTINGS: "timelineTagSettings",
        EDITOR_TAG_SETTINGS: "editorTagSettings",
        EDITOR_DO_EDIT_TRACKING: "editorDoEditTracking",
        EDITOR_DELETE_TAG: "editorDeleteTag",
        EDITOR_REFRESH_TIMELINE: "editorRefreshTimeline",

        CHANGE_SUBTITLES: "changeSubtitles",
        SEND_SUBTITLES: "sendSubtitles",

        // VPAID Events
        VIDEO_FIRST_QUARTILE: "videoFirstQuartile",
        VIDEO_MIDPOINT: "videoMidpoint",
        VIDEO_THIRD_QUARTILE: "videoThirdQuartile",

        // WEBGLEVENTS
        WEBGLERROR: "webglError",

        VIDEO_PRELOAD: "none",
        ASPECT_RATIO_WIDTH: 16,
        ASPECT_RATIO_HEIGHT: 9,
        BASE_WIDTH: 960,
        BASE_HEIGHT: 540,
        MIN_HEIGHT: 199,
        MIN_WIDTH: 395,
        OVERLAY_HEIGHT: 0,
        OVERLAY_WIDTH: 0,
        IS_STACKED: false,
        RENDITION: "540",
        HD_RENDITION: "720",
        BANDWIDTH_PREFERRED_RENDITION: null,
        FORCE_RENDITION: null,
        RENDITION_CHANGED: "renditionChanged",
        RESOLUTION_CODES: {
            0: "360",
            1: "480",
            4: "540",
            2: "720",
            3: "1080",
            16: "360",
            17: "540",
            18: "720",
            19: "1080",
            1000: "540image",
            1001: "1080image",
            1002: "2160image"
        },
        RENDITION_CODES: {
            "360": 16,
            "540": 17,
            "720": 18,
            "1080": 19,
            "540image": 1000,
            "1080image": 1001,
            "2160image": 1002
        },
        RENDITIONS: ["360", "540", "720", "1080"],
        BRANCHING_TYPE: {
            JUMP: 0,
            PAUSE: 1,
            CUSTOM: 2,
            OVERLAY: 3
        },
        BRANCHING_EVENTS: {
            JUMP: "branchingJump",
            PAUSE: "branchingPause",
            CUSTOM: "branchingCustom"
        },
        MEDIA_TYPES: {
            VIDEO: 0,
            IMAGE: 1,
            AUDIO: 2
        },
        MEDIA_TYPE: 0,

        IP_ADDRESS: "",
        USER_AGENT: "",

        IS_CYOA: false, // used to load a special flash video for IE8 that buffers the whole video before ready
        IS_IE: navigator.userAgent.match(/Trident/i) != null,
        // IS_IE_10: isIE10,
        IS_IE_10: navigator.userAgent.match(/Trident\/6/i) != null,
        IS_IE_9: isIE9 || navigator.userAgent.match(/MSIE 9/i) != null,
        IS_IE_8: isIE8,
        IS_IE_11: isIE11,
        NON_INTERACTIVE: false,
        IS_SAMSUNG_TV: false, // deprecated
        HAS_FLASH: false,
        FORCE_HTML5: false,
        IS_MOBILE_USERAGENT: navigator.userAgent.match(/Mobile/i) != null,
        IS_IPAD: navigator.userAgent.match(/iPad/i) != null,
        IS_IPHONE: navigator.userAgent.match(/iPhone/i) != null || navigator.userAgent.match(/iPod/i) != null,
        IS_ANDROID: navigator.userAgent.match(/Android/i) != null,
        IS_KINDLE: navigator.userAgent.match(/Silk/i) != null,
        IS_BLACKBERRY: navigator.userAgent.match(/Blackberry/i) != null || navigator.userAgent.match(/RIM/i) != null,
        IS_WINDOWS_PHONE:
            navigator.userAgent.match(/Windows Phone/i) != null ||
            navigator.userAgent.match(/IEMobile/i) != null ||
            navigator.userAgent.match(/WPDesktop/i) != null ||
            (navigator.userAgent.match(/Windows NT/i) != null && navigator.userAgent.match(/Touch/i) != null && navigator.userAgent.match(/Windows Phone/i) != null),
        IS_SAFARI: navigator.userAgent.search("Safari") >= 0 && navigator.userAgent.search("Chrome") < 0,
        IS_SAFARI_11: navigator.userAgent.search("Safari") >= 0 && navigator.userAgent.search("Chrome") < 0 && navigator.userAgent.match(/Version\/11/i) != null,
        IS_SAFARI_VERSION:
            navigator.userAgent.search("Safari") >= 0 &&
            navigator.userAgent.substring(navigator.userAgent.indexOf("Version/") + 8, navigator.userAgent.indexOf("Version/") + 8 + 2),
        IS_CHROME: (navigator.userAgent.match(/Chrome/i) != null || navigator.userAgent.match(/CriOS/i) != null) && navigator.userAgent.indexOf("Edge") === -1,
        IS_CHROME_PAST_40: navigator.userAgent.match(/Chrome\/4/i) != null,
        IS_CHROME_VERSION: navigator.userAgent.substring(navigator.userAgent.indexOf("Chrome/") + 7, navigator.userAgent.indexOf("Chrome/") + 7 + 2),
        IS_EDGE: navigator.userAgent.match(/Edge/i) != null,
        // IS_FIREFOX: typeof InstallTrigger !== 'undefined', // DEPRECATED
        IS_FIREFOX: navigator.userAgent.search("Firefox") >= 0,
        IS_FIREFOX_VERSION: navigator.userAgent.substring(navigator.userAgent.indexOf("Firefox/") + 8, navigator.userAgent.indexOf("Firefox/") + 8 + 2),
        IS_GOOGLE_SEARCH_APP: navigator.userAgent.match(/GSA/) != null,
        IS_GOOGLE_BOT: navigator.userAgent.match(/Google Web Preview/i) != null || navigator.userAgent.match(/Googlebot/i) != null, // since this bot ignores robots.txt
        IS_DEJACLICK_BOT: navigator.userAgent.match(/DejaClick/i) != null, // since this bot ignores robots.txt
        IS_WINDOWS: navigator.userAgent.match(/Windows/i) != null,
        IS_MAC: navigator.userAgent.match(/Macintosh/i) != null,
        IS_PHANTOM: navigator.userAgent.match(/PhantomJS/i) != null,
        IOS_VERSION: iosVersion(),
        IOS_VERSION_VERBOSE: iosVersionVerbose(),
        CAN_AUTOPLAY: canAutoPlay(),
        AUTOPLAY: false,
        LOOP: false,
        IDEVICE_GENERATION: window.devicePixelRatio, // Device Pixel Ratio 2 is IPhone4 & IPad3 and above
        LITE_VERSION: false,

        LANG: window.wirewax.lang ? window.wirewax.lang : "en",
        LOCALE: window.wirewax.locale ? window.wirewax.locale : "en-GB",
        COUNTRY: window.wirewax.country ? window.wirewax.country : "GB",

        // Defaults for overrides
        SHARE_TEXT: "", // set in the metadata
        SHARE_URL: "", // set in the metadata
        WHITELABEL: false, // hides the wirewax logo
        DISABLE_STANDARD_END_FRAME: false, // hides the standard end frame
        DISABLE_SHARES: false, // toggles the functionality of the share button
        DISABLE_FULLSCREEN: false, // toggles the functionality of the full screen button
        STYLED_SUBTITLES: true, // toggles subtitles as track files or as crumpet style divs
        SUBTITLES_ON: false, // toggles subtitles on and off
        VR_ENABLED: false, // enables VR player
        SINGLE_PIXEL: false, // forces pixel density to 1 in 360 videos
        CHOSEN_SUBTITLES: "", // 2 letter country code like Lang, used to chose language of subtitles
        PLAY_ON_WIDGET_CLOSE: true, // resumes playing the video when a widget is closed
        TAGS_ON_END_FRAME: false, // allows tags to be displayed on the end frame
        PLAY_ON_WAKE: false, // resumes playing the video when a user switches back to the player tab
        HIDE_SCRUBBER: true, // controls the scrubber bar hiding behaviour on hover
        PREVENT_SCROLL: false, // prevents scrolling on touchmove
        PREVENT_VIDEO_CLICK: false, // prevents clicking the video to play / pause
        PREVENT_VIDEO_DOUBLE_CLICK: false, // prevents double clicking the video to play / pause ( 360 videos )
        DISABLE_LOGO: false, // Disables clicking on the logo,
        OPEN_WIDGET_ON_SPRITE_SEEK_TO: true, // automatically opens a widget when seeking to a sprite id
        DISABLE_METRICS: false, //disables metrics collection
        DISABLE_SPACE_BAR_PLAY: false, // disables the space bar
        DISABLE_MOBILE_DOUBLE_TAP: false, // disables double tap to play / pause on mobile
        DISABLE_360_CONTROLS: false, // disables the panning controls on 360 videos
        DISABLE_CUSTOMISATIONS: false, // disables tags/widgets/modules
        ENABLE_360_RADAR: false, // enables the radar on 360 videos
        ENABLE_STALL_DETECTION: false, // throws up a message when a video has been buffering for too long
        ENABLE_TIME_CODE_COVER: false, // enable/disable the time code cover
        SMOOTH_FONT_STEPS: true, // enables / disables font size rounding on the main video element. should be set to false in all new customisations.
        SHOW_THROBBER_ON_BUFFER: true, // show the throbber on video buffer
        SHOW_DISABLED_AUDIO_ICON: false, // show an icon to indicate that the audio is disabled (i.e. silent autoplay)
        ENABLE_STALL_MESSAGES: false,
        ALLOW_LOADER_VIDEO_RELOAD: true,
        ENABLE_OVERLAY_FULL_BLEED: false, // enable / disable the fullbleed resize for the overlays
        IS_360_FULLBLEED: false, // sets different fullbleed dimensions in interfaceController for use in mobile 360
        VIDEOELEMENT_SIZE_CHECK: false, // constant checking to see if the size of the window has changed, used with brightcove
        RECORD_MOUSE_METRICS: true,
        ENABLE_ALT_VIDEO_SOURCE: false, // enable hack for the 360 webgl in ios and ie11. the video source needs to be from the same origin.
        ENABLE_VIDEO_CANVAS_SOURCE: false, // enable hack for the 360 webgl. the source is a video in a canvas
        ENABLE_IMAGE_SOURCE: false, // enable the source for the 360 player to be an image
        INNOVID_EVENTS: false, // use the innovideventmanger instead of the regular event manager
        CLICK_EVENT: "click", // set to touchend on touch enabled devices
        //  "LINK": 1, "TAG_CLICK":2, "SHARE": 3, "TOUCH": 4, "DWELL_TIME": 5
        // INTERACTION_TYPE: 3,
        VOLUME: 1, // curent volume of the player
        BUTTON_BACKGROUND_COLOR: "#303030", // Used to switch between light / dark depending on the window.wirewax.colour
        CUSTOM_METRICS: false, // record custom mouse-like metrics (e.g. jungle book slider),
        CUSTOM_METRICS_CALLBACK: function() {}, // callback to send custom metrics

        SHARE_VERSION: "version1",
        SHARE_VERSIONS: {
            VERSION_1: "version1",
            VERSION_2: "version2"
        },
        SHARE_BUTTON_TYPES: {
            FACEBOOK: "facebook",
            TWITTER: "twitter",
            LINKEDIN: "linkedin",
            PINTEREST: "pinterest",
            EMBED: "embed"
        },
        SHARE_BUTTONS: ["facebook", "twitter", "linkedin", "embed"],
        SHARE_BG_COLOR: "#FFFFFF",
        SHARE_ICON_COLOR: "#231F20",

        //360 player options
        HFOV: 100,
        STARTING_YAW: 0,

        // AMBER flashvars
        WIREWAX_URL_COMMS: "https://player.wirewax.com/3/wirewax3.php", // deprecated
        AMBER_URL_COMMS: "https://amber.wirewax.com/amber3.php", // deprecated
        USE_FLASH_FALLBACK: true, // deprecated
        DISABLE_SCRUBBER_TAGS: false, // deprecated
        DISABLE_ADS: false, // deprecated
        DISABLE_CC: true, // enables / disables subtitles

        ASSETS: [],
        CUSTOM_CONFIG_DATA: null, // has all the custom config data

        GET_CURRENT_PLAYING_TIME: function() {
            return 0;
        },
        IS_PLAYING: function() {
            return false;
        },
        PLAY_FUNCTION: function() {},
        PAUSE_FUNCTION: function() {},
        PLAY_PAUSE_FUNCTION: function() {},

        AWS_REGION: "eu-west-1",
        AWS_ACCESS_KEY: "AKIAIFV7VXOGTTGPJZDQ",
        AWS_SECRET_KEY: "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",
        SQS_METRIC_QUEUE_URL: "https://sqs.eu-west-1.amazonaws.com/142936586381/wirewaxMetricsInsert",
        SQS_SUB_METRC_QUEUE_URL: "https://sqs.eu-west-1.amazonaws.com/142936586381/wirewaxSubDocumentPush",
        SQS_TEST_QUEUE_URL: "https://sqs.us-east-1.amazonaws.com/142936586381/wirewaxMetricsTest",
        SQS_IMPRESSION_TEST_QUEUE_URL: "https://sqs.eu-west-1.amazonaws.com/142936586381/wirewaxImpressionsTest",
        SQS_IMPRESSION_QUEUE_URL: "https://sqs.us-east-1.amazonaws.com/142936586381/wirewaxImpressions",
        SQS_SUB_TEST_QUEUE_URL: "https://sqs.us-east-1.amazonaws.com/142936586381/wirewaxSubDocumentTest",
        SQS_ERROR_QUEUE_URL: "https://sqs.us-east-1.amazonaws.com/142936586381/wirewaxErrors",
        SQS_LEGACY_CODE_QUEUE_URL: "https://sqs.us-east-1.amazonaws.com/142936586381/wirewaxDeprecated",
        // In case of future localization support
        STRINGS: {
            FEATURE_NOT_SUPPORTED: "Sorry, this feature is not supported by your current browser.",
            DISPLAY_ALL_TAGS: "always display tags",
            DISABLE_TAGS: "disable all tags",
            DISPLAY_TAGS_ON_HOVER: "only display tags when i'm near them",
            FULLSCREEN: "full screen",
            SPONSOR_MESSAGE: "sponsor message, your video will restart in:",
            AD_MARKER: "sponsor message"
        },

        WIDGET_METRIC_TYPES: {
            CLICK_OUT: 1,
            LEGACY: 2,
            SHARE: 3,
            THUMB_DISPLAYED: 4,
            THUMB_CLICKED: 5,
            CAROUSEL_REVEAL: 6,
            CAROUSEL_CLOSE: 7,
            CAROUSEL_NEXT: 8,
            CAROUSEL_PREV: 9,
            MEDIA_EXPAND: 10,
            MEDIA_CLOSE: 11,
            EXPANDED_MEDIA_NEXT: 12,
            EXPANDED_MEDIA_PREV: 13,
            MEDIA_PLAY: 14,
            MEDIA_PAUSE: 15,
            MEDIA_SKIP: 16,
            FORM_SUBMIT: 17,
            CLOSE: 18,
            AUTO_CLOSE: 19,
            ADD_TO_CART: 20,
            SHOW_PRODUCT_VARIANTS: 21,
            CHANGE_VARIANT: 22,
            CHANGE_PRODUCT: 23,
            TAB_CLICKED: 24,
            VIEW_OPTIONS: 25,
            SELECT_OPTION: 26,
            MEDIA_ENDED: 27,
            AUTO_TRIGGER: 28
        },

        UI_EVENTS: {
            PLAY: 1,
            PAUSE: 2,
            SCRUB_START: 3,
            SCRUB_STOP: 4,
            FULLSCREEN: 5,
            NORMAL_SCREEN: 6,
            ADJUST_VOL: 7,
            CHANGE_RENDITION: 8,
            CHANGE_TAG_DISPLAY_STATE: 9,
            ADMIN_LOGIN_BUTTON: 10,
            ADD_TAGS_BUTTON: 11,
            WIREWAX_TAB: 12,
            TIMELINE_JUMP: 13,
            SOCIAL_SHARE_BUTTON: 14,
            SHARE_TOOL: 15,
            LOGOUT: 16,
            FIND_FACES: 17,
            SETTINGS: 18,
            FACEBOOK: 19,
            TWITTER: 20,
            GOOGLE_PLUS: 21,
            PEEKY_DOWN: 22,
            CLEAR_TRACKING_QUEUE: 23,
            TRACKING_QUEUE_ITEM: 24,
            CHANGE_TAG: 25,
            SWAP_STILL_POSTER_FRAME: 26,
            CHANGE_STATIC_TAG_MODE: 27,
            SHARE_SCREEN_COPY_LINK: 28,
            SHARE_SCREEN_COPY_EMBED: 29,
            BACK_TO_MAIN_VIDEO: 30,
            ENDCARD_REPLAY: 31,
            ENDCARD_SIGNUP: 32,
            ENDCARD_END: 33
        },

        LEGACY_TYPE: {
            UNKNOWN: 1, // default value
            DEAD_CODE: 2, // applies to flash, php and system that should be dead
            DEPRECATED: 3, // has been deprecated and should be replaced
            RECENT_DEPRECATED: 4 // was recently deprecated should avoid using
        },

        SCORM_EVENT_TYPE: {
            GET_PASSING_SCORE: "passingScore",
            SET_SCORE: "setScore",
            GET_SCORE: "getScore",
            RECORD_TRUE_FALSE_INTERACTION: "recordTrueFalseInteraction",
            RECORD_MULTIPLE_CHOICE_INTERACTION: "recordMultipleChoiceInteraction",
            RECORD_FILL_IN_INTERACTION: "recordFillInInteraction",
            RECORD_MATCHING_INTERACTION: "recordMatchingInteraction",
            RECORD_PERFORMANCE_INTERACTION: "recordPerformanceInteraction",
            RECORD_SEQUENCING_INTERACTION: "recordSequencingInteraction",
            RECORD_LIKERT_INTERACTION: "recordLikertInteraction",
            RECORD_NUMERIC_INTERACTION: "recordNumericInteraction",
            FINISH: "finish"
        },

        CONSOLE_EVENTS: {
            SENT_METRIC: "sentMetric",
            SENT_API_EVENT: "sentApiEvent",
            RECEIVED_API_EVENT: "receivedApiEvent"
        },

        MESSAGES: {
            6001: { code: 5001, displayMessage: "It's possible the video has stalled, would you like to reload?", behaviour: 1 }
        },
        ERRORS: {
            5001: { code: 5001, displayMessage: "Video Element not found" },
            5002: { code: 5002, displayMessage: "Handshake with server failed", behaviour: 0 },
            5003: { code: 5003, displayMessage: "Error loading modules - unknown" },
            5004: { code: 5004, displayMessage: "Error downloading data for video" },
            5005: { code: 5005, displayMessage: "Cannot update scrubber when duration is not set" },
            5006: { code: 5006, displayMessage: "Clip Data not loaded" },
            5007: { code: 5007, displayMessage: "Video Data not loaded" },
            5008: { code: 5008, displayMessage: "Failed to load Flash fallback video" },
            5009: { code: 5009, displayMessage: "Browser does not support playback of Flash content" },
            5010: { code: 5010, displayMessage: "Video Element must be at least 394x198" },
            5011: { code: 5011, displayMessage: "Player could not be started" },
            5012: { code: 5012, displayMessage: "Error loading modules - timeout" },
            5013: { code: 5013, displayMessage: "Error loading modules - script error" },
            5014: { code: 5014, displayMessage: "Corrupted video data downloaded" },
            5015: { code: 5015, displayMessage: "Error loading widget data", behaviour: 1 },
            5016: { code: 5016, displayMessage: "Failed to fetch widget data from server", behaviour: 1 },
            5017: { code: 5017, displayMessage: "Tag and Widget Data not available for this video" },
            5018: { code: 5018, displayMessage: "Failed to find a video source" },
            5019: { code: 5019, displayMessage: "Video buffering but not downloading." },
            5020: { code: 5020, displayMessage: "XDR connection could not be opened. requests must be targeted to the same scheme as the hosting page." },
            5021: { code: 5021, displayMessage: "Failed to record uiMetric event.", behaviour: 0 },
            5022: { code: 5022, displayMessage: "Failed to download widget", behaviour: 1 },
            5023: { code: 5023, displayMessage: "Stalled loading video", behaviour: 2 },
            5024: { code: 5024, displayMessage: "Unknown error when loading sources for video", behaviour: 2 },
            5025: { code: 5025, displayMessage: "Failed to load font", behaviour: 0 },
            5026: { code: 5026, displayMessage: "Failed to load CSS for tag or widget", behaviour: 2 },
            5027: { code: 5027, displayMessage: "Browser not supported", behaviour: 2 },
            5028: { code: 5028, displayMessage: "Failed to load Template for widget", behaviour: 1 },
            5029: { code: 5029, displayMessage: "Failed to record impression", behaviour: 0 },
            5031: { code: 5031, displayMessage: "SQS Failed, falling back to PHP", behaviour: 0 },
            5032: { code: 5032, displayMessage: "This video is not available in your region.", behaviour: 2 },
            5033: { code: 5033, displayMessage: "There was an issue with playing this video. Please refresh the page.", behaviour: 2 }
        },
        LOG: function() {
            if (window.wirewax && window.wirewax.debug) {
                var thisLog = arguments;
                var date = new Date();
                var ts = date.getHours() + ":" + date.getMinutes() + ":" + date.getSeconds() + "." + date.getMilliseconds();
                [].unshift.call(thisLog, ts);
                if (console.log) {
                    if (isIE8 || isIE9) {
                        console.log(Array.prototype.slice.call(arguments));
                    } else {
                        console.log.apply(console, thisLog);
                        if (!globals.IS_DESKTOP && document.getElementById("logMobile")) {
                            var node = document.createElement("P");
                            var textnode = document.createTextNode(Array.prototype.slice.call(arguments));
                            node.appendChild(textnode);
                            document.getElementById("logMobile").appendChild(node);
                        }
                    }
                }
            }
        },
        ANIMATION_CONTROLLERS: {
            NON_TAG: "javascripts/player/animationcontrollers/nonTagTagController.js",
            THREE_SIXTY: "javascripts/player/animationcontrollers/threeSixtyAnimationController.js",
            JS: "javascripts/player/animationcontrollers/jsAnimationController.js",
            DEFAULT: "javascripts/player/animationcontrollers/improvedJSAnimationController.js",
            TRANSFORM: "javascripts/player/animationcontrollers/transformAnimationController.js"
        }
    };

    globals.IS_DESKTOP = !(
        globals.IS_MOBILE_USERAGENT ||
        globals.IS_IPAD ||
        globals.IS_KINDLE ||
        globals.IS_ANDROID ||
        globals.IS_IPHONE ||
        globals.IS_BLACKBERRY ||
        globals.IS_WINDOWS_PHONE
    );
    globals.ENABLE_PIXEL_TIMECODE = (globals.IS_CHROME || globals.IS_FIREFOX) && globals.IS_DESKTOP && !globals.IS_EDGE && !window.wirewax.offline;
    globals.ENABLE_STALL_DETECTION = globals.IS_DESKTOP && (globals.IS_CHROME || globals.IS_FIREFOX || globals.IS_IE_11);
    globals.METRICS_INTERVAL = globals.IS_DESKTOP ? 3000 : 10000;

    // If the iPhone is old or we're in a UIWebView, we need bagel.
    globals.REQUIRES_BAGEL = (globals.IS_IPHONE || globals.IS_IPAD) && (globals.IOS_VERSION < 10 || (!globals.IS_SAFARI && !globals.IS_CHROME) || globals.IS_GOOGLE_SEARCH_APP);

    // Create div for debugging in mobile
    if (window.wirewax.debug && !globals.IS_DESKTOP) {
        var logDiv = document.createElement("DIV");
        logDiv.setAttribute("id", "logMobile");
        logDiv.setAttribute(
            "style",
            "overflow: scroll;max-height: 30%;position: absolute;top: 0px;left: 0px;padding: 10px;z-index: 9000;width: 100%;border: 5px solid red;color: white;box-sizing: border-box;"
        );
        document.body.appendChild(logDiv);
    }

    // Sets browsers that don't allow autoplay with sound to start muted
    var isMobileAndCanAutoplay = !globals.IS_DESKTOP && globals.CAN_AUTOPLAY;
    var isSafari11 = globals.IS_DESKTOP && globals.IS_SAFARI && globals.IS_SAFARI_11;
    var isSafariAbove11 = globals.IS_DESKTOP && globals.IS_SAFARI && globals.IS_SAFARI_VERSION >= 11;
    var isChromeAbove66 = globals.IS_DESKTOP && globals.IS_CHROME && globals.IS_CHROME_VERSION >= 66;
    var isFirefoxAbove66 = globals.IS_DESKTOP && globals.IS_FIREFOX && globals.IS_FIREFOX_VERSION >= 66;

    if (isMobileAndCanAutoplay || isSafariAbove11 || isChromeAbove66 || isFirefoxAbove66) {
        globals.AUDIO_DISABLED = true;
        globals.AUTOPLAY_MUTED = true;
    }

    return globals;
});

wwplayer.define("Class", [], function() {
    /* Simple JavaScript Inheritance
     * By John Resig http://ejohn.org/
     * MIT Licensed.
     */
    // Inspired by base2 and Prototype

    var initializing = false,
        fnTest = /xyz/.test(function() {
            xyz;
        })
            ? /\b_super\b/
            : /.*/;

    // The base Class implementation (does nothing)
    this.Class = function() {};

    // Create a new Class that inherits from this class
    Class.extend = function(prop) {
        var _super = this.prototype;

        // Instantiate a base class (but only create the instance,
        // don't run the init constructor)
        initializing = true;
        var prototype = new this();
        initializing = false;

        // Copy the properties over onto the new prototype
        for (var name in prop) {
            // Check if we're overwriting an existing function
            prototype[name] =
                typeof prop[name] == "function" && typeof _super[name] == "function" && fnTest.test(prop[name])
                    ? (function(name, fn) {
                          return function() {
                              var tmp = this._super;

                              // Add a new ._super() method that is the same method
                              // but on the super-class
                              this._super = _super[name];

                              // The method only need to be bound temporarily, so we
                              // remove it when we're done executing
                              var ret = fn.apply(this, arguments);
                              this._super = tmp;

                              return ret;
                          };
                      })(name, prop[name])
                    : prop[name];
        }

        // The dummy class constructor
        function Class() {
            // All construction is actually done in the init method
            if (!initializing && this.init) this.init.apply(this, arguments);
        }

        // Populate our constructed prototype object
        Class.prototype = prototype;

        // Enforce the constructor to be what we expect
        Class.prototype.constructor = Class;

        // And make this class extendable
        Class.extend = arguments.callee;

        return Class;
    };

    return this.Class;
});

/**
	@module LogEvent
	@requires Class
**/
wwplayer.define("LogEvent", ["Class"], function(Class) {
    /**
		Representation of an event that can be logged

		@class Logevent
		@extends Class
	**/
    var LogEvent = Class.extend({
        /**
			@method init
			@constructor
			@param {String} eventType the name of the event
			@param {Object} eventObject the event data
			@param {Object} args optional arguments passed to the event
		**/
        init: function(eventType, eventObject, args) {
            this.eventObject = eventObject;
            this.code = eventObject.code;
            this.message = eventObject.displayMessage;
            if (eventObject.type) {
                this.type = eventObject.type;
            } else {
                this.type = eventObject.behaviour;
            }

            this.args = args;
        },
        /**
			Returns the events code
			@method getCode
		**/
        getCode: function() {
            return this.code;
        },
        /**
			Returns the events message
			@method getMessage
		**/
        getMessage: function() {
            return this.message;
        },
        /**
			Returns the args
			@method getArgs
		**/
        getArgs: function() {
            return this.args;
        },
        /**
			Returns the actual event object
			@method getObject
		**/
        getObject: function() {
            return {
                code: this.code,
                message: this.message,
                args: this.args,
                type: this.type,
                behaviour: this.type
            };
        }
    });

    return LogEvent;
});

//     Underscore.js 1.6.0
//     http://underscorejs.org
//     (c) 2009-2014 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Underscore may be freely distributed under the MIT license.
(function() {
    var n = this,
        t = n._,
        r = {},
        e = Array.prototype,
        u = Object.prototype,
        i = Function.prototype,
        a = e.push,
        o = e.slice,
        c = e.concat,
        l = u.toString,
        f = u.hasOwnProperty,
        s = e.forEach,
        p = e.map,
        h = e.reduce,
        v = e.reduceRight,
        g = e.filter,
        d = e.every,
        m = e.some,
        y = e.indexOf,
        b = e.lastIndexOf,
        x = Array.isArray,
        w = Object.keys,
        _ = i.bind,
        j = function(n) {
            return n instanceof j ? n : this instanceof j ? void (this._wrapped = n) : new j(n);
        };
    "undefined" != typeof exports ? ("undefined" != typeof module && module.exports && (exports = module.exports = j), (exports._ = j)) : (n._ = j), (j.VERSION = "1.6.0");
    var A = (j.each = j.forEach = function(n, t, e) {
        if (null == n) return n;
        if (s && n.forEach === s) n.forEach(t, e);
        else if (n.length === +n.length) {
            for (var u = 0, i = n.length; i > u; u++) if (t.call(e, n[u], u, n) === r) return;
        } else for (var a = j.keys(n), u = 0, i = a.length; i > u; u++) if (t.call(e, n[a[u]], a[u], n) === r) return;
        return n;
    });
    j.map = j.collect = function(n, t, r) {
        var e = [];
        return null == n
            ? e
            : p && n.map === p
            ? n.map(t, r)
            : (A(n, function(n, u, i) {
                  e.push(t.call(r, n, u, i));
              }),
              e);
    };
    var O = "Reduce of empty array with no initial value";
    (j.reduce = j.foldl = j.inject = function(n, t, r, e) {
        var u = arguments.length > 2;
        if ((null == n && (n = []), h && n.reduce === h)) return e && (t = j.bind(t, e)), u ? n.reduce(t, r) : n.reduce(t);
        if (
            (A(n, function(n, i, a) {
                u ? (r = t.call(e, r, n, i, a)) : ((r = n), (u = !0));
            }),
            !u)
        )
            throw new TypeError(O);
        return r;
    }),
        (j.reduceRight = j.foldr = function(n, t, r, e) {
            var u = arguments.length > 2;
            if ((null == n && (n = []), v && n.reduceRight === v)) return e && (t = j.bind(t, e)), u ? n.reduceRight(t, r) : n.reduceRight(t);
            var i = n.length;
            if (i !== +i) {
                var a = j.keys(n);
                i = a.length;
            }
            if (
                (A(n, function(o, c, l) {
                    (c = a ? a[--i] : --i), u ? (r = t.call(e, r, n[c], c, l)) : ((r = n[c]), (u = !0));
                }),
                !u)
            )
                throw new TypeError(O);
            return r;
        }),
        (j.find = j.detect = function(n, t, r) {
            var e;
            return (
                k(n, function(n, u, i) {
                    return t.call(r, n, u, i) ? ((e = n), !0) : void 0;
                }),
                e
            );
        }),
        (j.filter = j.select = function(n, t, r) {
            var e = [];
            return null == n
                ? e
                : g && n.filter === g
                ? n.filter(t, r)
                : (A(n, function(n, u, i) {
                      t.call(r, n, u, i) && e.push(n);
                  }),
                  e);
        }),
        (j.reject = function(n, t, r) {
            return j.filter(
                n,
                function(n, e, u) {
                    return !t.call(r, n, e, u);
                },
                r
            );
        }),
        (j.every = j.all = function(n, t, e) {
            t || (t = j.identity);
            var u = !0;
            return null == n
                ? u
                : d && n.every === d
                ? n.every(t, e)
                : (A(n, function(n, i, a) {
                      return (u = u && t.call(e, n, i, a)) ? void 0 : r;
                  }),
                  !!u);
        });
    var k = (j.some = j.any = function(n, t, e) {
        t || (t = j.identity);
        var u = !1;
        return null == n
            ? u
            : m && n.some === m
            ? n.some(t, e)
            : (A(n, function(n, i, a) {
                  return u || (u = t.call(e, n, i, a)) ? r : void 0;
              }),
              !!u);
    });
    (j.contains = j.include = function(n, t) {
        return null == n
            ? !1
            : y && n.indexOf === y
            ? n.indexOf(t) != -1
            : k(n, function(n) {
                  return n === t;
              });
    }),
        (j.invoke = function(n, t) {
            var r = o.call(arguments, 2),
                e = j.isFunction(t);
            return j.map(n, function(n) {
                return (e ? t : n[t]).apply(n, r);
            });
        }),
        (j.pluck = function(n, t) {
            return j.map(n, j.property(t));
        }),
        (j.where = function(n, t) {
            return j.filter(n, j.matches(t));
        }),
        (j.findWhere = function(n, t) {
            return j.find(n, j.matches(t));
        }),
        (j.max = function(n, t, r) {
            if (!t && j.isArray(n) && n[0] === +n[0] && n.length < 65535) return Math.max.apply(Math, n);
            var e = -1 / 0,
                u = -1 / 0;
            return (
                A(n, function(n, i, a) {
                    var o = t ? t.call(r, n, i, a) : n;
                    o > u && ((e = n), (u = o));
                }),
                e
            );
        }),
        (j.min = function(n, t, r) {
            if (!t && j.isArray(n) && n[0] === +n[0] && n.length < 65535) return Math.min.apply(Math, n);
            var e = 1 / 0,
                u = 1 / 0;
            return (
                A(n, function(n, i, a) {
                    var o = t ? t.call(r, n, i, a) : n;
                    u > o && ((e = n), (u = o));
                }),
                e
            );
        }),
        (j.shuffle = function(n) {
            var t,
                r = 0,
                e = [];
            return (
                A(n, function(n) {
                    (t = j.random(r++)), (e[r - 1] = e[t]), (e[t] = n);
                }),
                e
            );
        }),
        (j.sample = function(n, t, r) {
            return null == t || r ? (n.length !== +n.length && (n = j.values(n)), n[j.random(n.length - 1)]) : j.shuffle(n).slice(0, Math.max(0, t));
        });
    var E = function(n) {
        return null == n ? j.identity : j.isFunction(n) ? n : j.property(n);
    };
    j.sortBy = function(n, t, r) {
        return (
            (t = E(t)),
            j.pluck(
                j
                    .map(n, function(n, e, u) {
                        return { value: n, index: e, criteria: t.call(r, n, e, u) };
                    })
                    .sort(function(n, t) {
                        var r = n.criteria,
                            e = t.criteria;
                        if (r !== e) {
                            if (r > e || r === void 0) return 1;
                            if (e > r || e === void 0) return -1;
                        }
                        return n.index - t.index;
                    }),
                "value"
            )
        );
    };
    var F = function(n) {
        return function(t, r, e) {
            var u = {};
            return (
                (r = E(r)),
                A(t, function(i, a) {
                    var o = r.call(e, i, a, t);
                    n(u, o, i);
                }),
                u
            );
        };
    };
    (j.groupBy = F(function(n, t, r) {
        j.has(n, t) ? n[t].push(r) : (n[t] = [r]);
    })),
        (j.indexBy = F(function(n, t, r) {
            n[t] = r;
        })),
        (j.countBy = F(function(n, t) {
            j.has(n, t) ? n[t]++ : (n[t] = 1);
        })),
        (j.sortedIndex = function(n, t, r, e) {
            r = E(r);
            for (var u = r.call(e, t), i = 0, a = n.length; a > i; ) {
                var o = (i + a) >>> 1;
                r.call(e, n[o]) < u ? (i = o + 1) : (a = o);
            }
            return i;
        }),
        (j.toArray = function(n) {
            return n ? (j.isArray(n) ? o.call(n) : n.length === +n.length ? j.map(n, j.identity) : j.values(n)) : [];
        }),
        (j.size = function(n) {
            return null == n ? 0 : n.length === +n.length ? n.length : j.keys(n).length;
        }),
        (j.first = j.head = j.take = function(n, t, r) {
            return null == n ? void 0 : null == t || r ? n[0] : 0 > t ? [] : o.call(n, 0, t);
        }),
        (j.initial = function(n, t, r) {
            return o.call(n, 0, n.length - (null == t || r ? 1 : t));
        }),
        (j.last = function(n, t, r) {
            return null == n ? void 0 : null == t || r ? n[n.length - 1] : o.call(n, Math.max(n.length - t, 0));
        }),
        (j.rest = j.tail = j.drop = function(n, t, r) {
            return o.call(n, null == t || r ? 1 : t);
        }),
        (j.compact = function(n) {
            return j.filter(n, j.identity);
        });
    var M = function(n, t, r) {
        return t && j.every(n, j.isArray)
            ? c.apply(r, n)
            : (A(n, function(n) {
                  j.isArray(n) || j.isArguments(n) ? (t ? a.apply(r, n) : M(n, t, r)) : r.push(n);
              }),
              r);
    };
    (j.flatten = function(n, t) {
        return M(n, t, []);
    }),
        (j.without = function(n) {
            return j.difference(n, o.call(arguments, 1));
        }),
        (j.partition = function(n, t) {
            var r = [],
                e = [];
            return (
                A(n, function(n) {
                    (t(n) ? r : e).push(n);
                }),
                [r, e]
            );
        }),
        (j.uniq = j.unique = function(n, t, r, e) {
            j.isFunction(t) && ((e = r), (r = t), (t = !1));
            var u = r ? j.map(n, r, e) : n,
                i = [],
                a = [];
            return (
                A(u, function(r, e) {
                    (t ? e && a[a.length - 1] === r : j.contains(a, r)) || (a.push(r), i.push(n[e]));
                }),
                i
            );
        }),
        (j.union = function() {
            return j.uniq(j.flatten(arguments, !0));
        }),
        (j.intersection = function(n) {
            var t = o.call(arguments, 1);
            return j.filter(j.uniq(n), function(n) {
                return j.every(t, function(t) {
                    return j.contains(t, n);
                });
            });
        }),
        (j.difference = function(n) {
            var t = c.apply(e, o.call(arguments, 1));
            return j.filter(n, function(n) {
                return !j.contains(t, n);
            });
        }),
        (j.zip = function() {
            for (var n = j.max(j.pluck(arguments, "length").concat(0)), t = new Array(n), r = 0; n > r; r++) t[r] = j.pluck(arguments, "" + r);
            return t;
        }),
        (j.object = function(n, t) {
            if (null == n) return {};
            for (var r = {}, e = 0, u = n.length; u > e; e++) t ? (r[n[e]] = t[e]) : (r[n[e][0]] = n[e][1]);
            return r;
        }),
        (j.indexOf = function(n, t, r) {
            if (null == n) return -1;
            var e = 0,
                u = n.length;
            if (r) {
                if ("number" != typeof r) return (e = j.sortedIndex(n, t)), n[e] === t ? e : -1;
                e = 0 > r ? Math.max(0, u + r) : r;
            }
            if (y && n.indexOf === y) return n.indexOf(t, r);
            for (; u > e; e++) if (n[e] === t) return e;
            return -1;
        }),
        (j.lastIndexOf = function(n, t, r) {
            if (null == n) return -1;
            var e = null != r;
            if (b && n.lastIndexOf === b) return e ? n.lastIndexOf(t, r) : n.lastIndexOf(t);
            for (var u = e ? r : n.length; u--; ) if (n[u] === t) return u;
            return -1;
        }),
        (j.range = function(n, t, r) {
            arguments.length <= 1 && ((t = n || 0), (n = 0)), (r = arguments[2] || 1);
            for (var e = Math.max(Math.ceil((t - n) / r), 0), u = 0, i = new Array(e); e > u; ) (i[u++] = n), (n += r);
            return i;
        });
    var R = function() {};
    (j.bind = function(n, t) {
        var r, e;
        if (_ && n.bind === _) return _.apply(n, o.call(arguments, 1));
        if (!j.isFunction(n)) throw new TypeError();
        return (
            (r = o.call(arguments, 2)),
            (e = function() {
                if (!(this instanceof e)) return n.apply(t, r.concat(o.call(arguments)));
                R.prototype = n.prototype;
                var u = new R();
                R.prototype = null;
                var i = n.apply(u, r.concat(o.call(arguments)));
                return Object(i) === i ? i : u;
            })
        );
    }),
        (j.partial = function(n) {
            var t = o.call(arguments, 1);
            return function() {
                for (var r = 0, e = t.slice(), u = 0, i = e.length; i > u; u++) e[u] === j && (e[u] = arguments[r++]);
                for (; r < arguments.length; ) e.push(arguments[r++]);
                return n.apply(this, e);
            };
        }),
        (j.bindAll = function(n) {
            var t = o.call(arguments, 1);
            if (0 === t.length) throw new Error("bindAll must be passed function names");
            return (
                A(t, function(t) {
                    n[t] = j.bind(n[t], n);
                }),
                n
            );
        }),
        (j.memoize = function(n, t) {
            var r = {};
            return (
                t || (t = j.identity),
                function() {
                    var e = t.apply(this, arguments);
                    return j.has(r, e) ? r[e] : (r[e] = n.apply(this, arguments));
                }
            );
        }),
        (j.delay = function(n, t) {
            var r = o.call(arguments, 2);
            return setTimeout(function() {
                return n.apply(null, r);
            }, t);
        }),
        (j.defer = function(n) {
            return j.delay.apply(j, [n, 1].concat(o.call(arguments, 1)));
        }),
        (j.throttle = function(n, t, r) {
            var e,
                u,
                i,
                a = null,
                o = 0;
            r || (r = {});
            var c = function() {
                (o = r.leading === !1 ? 0 : j.now()), (a = null), (i = n.apply(e, u)), (e = u = null);
            };
            return function() {
                var l = j.now();
                o || r.leading !== !1 || (o = l);
                var f = t - (l - o);
                return (
                    (e = this),
                    (u = arguments),
                    0 >= f ? (clearTimeout(a), (a = null), (o = l), (i = n.apply(e, u)), (e = u = null)) : a || r.trailing === !1 || (a = setTimeout(c, f)),
                    i
                );
            };
        }),
        (j.debounce = function(n, t, r) {
            var e,
                u,
                i,
                a,
                o,
                c = function() {
                    var l = j.now() - a;
                    t > l ? (e = setTimeout(c, t - l)) : ((e = null), r || ((o = n.apply(i, u)), (i = u = null)));
                };
            return function() {
                (i = this), (u = arguments), (a = j.now());
                var l = r && !e;
                return e || (e = setTimeout(c, t)), l && ((o = n.apply(i, u)), (i = u = null)), o;
            };
        }),
        (j.once = function(n) {
            var t,
                r = !1;
            return function() {
                return r ? t : ((r = !0), (t = n.apply(this, arguments)), (n = null), t);
            };
        }),
        (j.wrap = function(n, t) {
            return j.partial(t, n);
        }),
        (j.compose = function() {
            var n = arguments;
            return function() {
                for (var t = arguments, r = n.length - 1; r >= 0; r--) t = [n[r].apply(this, t)];
                return t[0];
            };
        }),
        (j.after = function(n, t) {
            return function() {
                return --n < 1 ? t.apply(this, arguments) : void 0;
            };
        }),
        (j.keys = function(n) {
            if (!j.isObject(n)) return [];
            if (w) return w(n);
            var t = [];
            for (var r in n) j.has(n, r) && t.push(r);
            return t;
        }),
        (j.values = function(n) {
            for (var t = j.keys(n), r = t.length, e = new Array(r), u = 0; r > u; u++) e[u] = n[t[u]];
            return e;
        }),
        (j.pairs = function(n) {
            for (var t = j.keys(n), r = t.length, e = new Array(r), u = 0; r > u; u++) e[u] = [t[u], n[t[u]]];
            return e;
        }),
        (j.invert = function(n) {
            for (var t = {}, r = j.keys(n), e = 0, u = r.length; u > e; e++) t[n[r[e]]] = r[e];
            return t;
        }),
        (j.functions = j.methods = function(n) {
            var t = [];
            for (var r in n) j.isFunction(n[r]) && t.push(r);
            return t.sort();
        }),
        (j.extend = function(n) {
            return (
                A(o.call(arguments, 1), function(t) {
                    if (t) for (var r in t) n[r] = t[r];
                }),
                n
            );
        }),
        (j.pick = function(n) {
            var t = {},
                r = c.apply(e, o.call(arguments, 1));
            return (
                A(r, function(r) {
                    r in n && (t[r] = n[r]);
                }),
                t
            );
        }),
        (j.omit = function(n) {
            var t = {},
                r = c.apply(e, o.call(arguments, 1));
            for (var u in n) j.contains(r, u) || (t[u] = n[u]);
            return t;
        }),
        (j.defaults = function(n) {
            return (
                A(o.call(arguments, 1), function(t) {
                    if (t) for (var r in t) n[r] === void 0 && (n[r] = t[r]);
                }),
                n
            );
        }),
        (j.clone = function(n) {
            return j.isObject(n) ? (j.isArray(n) ? n.slice() : j.extend({}, n)) : n;
        }),
        (j.tap = function(n, t) {
            return t(n), n;
        });
    var S = function(n, t, r, e) {
        if (n === t) return 0 !== n || 1 / n == 1 / t;
        if (null == n || null == t) return n === t;
        n instanceof j && (n = n._wrapped), t instanceof j && (t = t._wrapped);
        var u = l.call(n);
        if (u != l.call(t)) return !1;
        switch (u) {
            case "[object String]":
                return n == String(t);
            case "[object Number]":
                return n != +n ? t != +t : 0 == n ? 1 / n == 1 / t : n == +t;
            case "[object Date]":
            case "[object Boolean]":
                return +n == +t;
            case "[object RegExp]":
                return n.source == t.source && n.global == t.global && n.multiline == t.multiline && n.ignoreCase == t.ignoreCase;
        }
        if ("object" != typeof n || "object" != typeof t) return !1;
        for (var i = r.length; i--; ) if (r[i] == n) return e[i] == t;
        var a = n.constructor,
            o = t.constructor;
        if (a !== o && !(j.isFunction(a) && a instanceof a && j.isFunction(o) && o instanceof o) && "constructor" in n && "constructor" in t) return !1;
        r.push(n), e.push(t);
        var c = 0,
            f = !0;
        if ("[object Array]" == u) {
            if (((c = n.length), (f = c == t.length))) for (; c-- && (f = S(n[c], t[c], r, e)); );
        } else {
            for (var s in n) if (j.has(n, s) && (c++, !(f = j.has(t, s) && S(n[s], t[s], r, e)))) break;
            if (f) {
                for (s in t) if (j.has(t, s) && !c--) break;
                f = !c;
            }
        }
        return r.pop(), e.pop(), f;
    };
    (j.isEqual = function(n, t) {
        return S(n, t, [], []);
    }),
        (j.isEmpty = function(n) {
            if (null == n) return !0;
            if (j.isArray(n) || j.isString(n)) return 0 === n.length;
            for (var t in n) if (j.has(n, t)) return !1;
            return !0;
        }),
        (j.isElement = function(n) {
            return !(!n || 1 !== n.nodeType);
        }),
        (j.isArray =
            x ||
            function(n) {
                return "[object Array]" == l.call(n);
            }),
        (j.isObject = function(n) {
            return n === Object(n);
        }),
        A(["Arguments", "Function", "String", "Number", "Date", "RegExp"], function(n) {
            j["is" + n] = function(t) {
                return l.call(t) == "[object " + n + "]";
            };
        }),
        j.isArguments(arguments) ||
            (j.isArguments = function(n) {
                return !(!n || !j.has(n, "callee"));
            }),
        "function" != typeof /./ &&
            (j.isFunction = function(n) {
                return "function" == typeof n;
            }),
        (j.isFinite = function(n) {
            return isFinite(n) && !isNaN(parseFloat(n));
        }),
        (j.isNaN = function(n) {
            return j.isNumber(n) && n != +n;
        }),
        (j.isBoolean = function(n) {
            return n === !0 || n === !1 || "[object Boolean]" == l.call(n);
        }),
        (j.isNull = function(n) {
            return null === n;
        }),
        (j.isUndefined = function(n) {
            return n === void 0;
        }),
        (j.has = function(n, t) {
            return f.call(n, t);
        }),
        (j.noConflict = function() {
            return (n._ = t), this;
        }),
        (j.identity = function(n) {
            return n;
        }),
        (j.constant = function(n) {
            return function() {
                return n;
            };
        }),
        (j.property = function(n) {
            return function(t) {
                return t[n];
            };
        }),
        (j.matches = function(n) {
            return function(t) {
                if (t === n) return !0;
                for (var r in n) if (n[r] !== t[r]) return !1;
                return !0;
            };
        }),
        (j.times = function(n, t, r) {
            for (var e = Array(Math.max(0, n)), u = 0; n > u; u++) e[u] = t.call(r, u);
            return e;
        }),
        (j.random = function(n, t) {
            return null == t && ((t = n), (n = 0)), n + Math.floor(Math.random() * (t - n + 1));
        }),
        (j.now =
            Date.now ||
            function() {
                return new Date().getTime();
            });
    var T = { escape: { "&": "&amp;", "<": "&lt;", ">": "&gt;", '"': "&quot;", "'": "&#x27;" } };
    T.unescape = j.invert(T.escape);
    var I = { escape: new RegExp("[" + j.keys(T.escape).join("") + "]", "g"), unescape: new RegExp("(" + j.keys(T.unescape).join("|") + ")", "g") };
    j.each(["escape", "unescape"], function(n) {
        j[n] = function(t) {
            return null == t
                ? ""
                : ("" + t).replace(I[n], function(t) {
                      return T[n][t];
                  });
        };
    }),
        (j.result = function(n, t) {
            if (null == n) return void 0;
            var r = n[t];
            return j.isFunction(r) ? r.call(n) : r;
        }),
        (j.mixin = function(n) {
            A(j.functions(n), function(t) {
                var r = (j[t] = n[t]);
                j.prototype[t] = function() {
                    var n = [this._wrapped];
                    return a.apply(n, arguments), z.call(this, r.apply(j, n));
                };
            });
        });
    var N = 0;
    (j.uniqueId = function(n) {
        var t = ++N + "";
        return n ? n + t : t;
    }),
        (j.templateSettings = { evaluate: /<%([\s\S]+?)%>/g, interpolate: /<%=([\s\S]+?)%>/g, escape: /<%-([\s\S]+?)%>/g });
    var q = /(.)^/,
        B = { "'": "'", "\\": "\\", "\r": "r", "\n": "n", "	": "t", "\u2028": "u2028", "\u2029": "u2029" },
        D = /\\|'|\r|\n|\t|\u2028|\u2029/g;
    (j.template = function(n, t, r) {
        var e;
        r = j.defaults({}, r, j.templateSettings);
        var u = new RegExp([(r.escape || q).source, (r.interpolate || q).source, (r.evaluate || q).source].join("|") + "|$", "g"),
            i = 0,
            a = "__p+='";
        n.replace(u, function(t, r, e, u, o) {
            return (
                (a += n.slice(i, o).replace(D, function(n) {
                    return "\\" + B[n];
                })),
                r && (a += "'+\n((__t=(" + r + "))==null?'':_.escape(__t))+\n'"),
                e && (a += "'+\n((__t=(" + e + "))==null?'':__t)+\n'"),
                u && (a += "';\n" + u + "\n__p+='"),
                (i = o + t.length),
                t
            );
        }),
            (a += "';\n"),
            r.variable || (a = "with(obj||{}){\n" + a + "}\n"),
            (a = "var __t,__p='',__j=Array.prototype.join," + "print=function(){__p+=__j.call(arguments,'');};\n" + a + "return __p;\n");
        try {
            e = new Function(r.variable || "obj", "_", a);
        } catch (o) {
            throw ((o.source = a), o);
        }
        if (t) return e(t, j);
        var c = function(n) {
            return e.call(this, n, j);
        };
        return (c.source = "function(" + (r.variable || "obj") + "){\n" + a + "}"), c;
    }),
        (j.chain = function(n) {
            return j(n).chain();
        });
    var z = function(n) {
        return this._chain ? j(n).chain() : n;
    };
    j.mixin(j),
        A(["pop", "push", "reverse", "shift", "sort", "splice", "unshift"], function(n) {
            var t = e[n];
            j.prototype[n] = function() {
                var r = this._wrapped;
                return t.apply(r, arguments), ("shift" != n && "splice" != n) || 0 !== r.length || delete r[0], z.call(this, r);
            };
        }),
        A(["concat", "join", "slice"], function(n) {
            var t = e[n];
            j.prototype[n] = function() {
                return z.call(this, t.apply(this._wrapped, arguments));
            };
        }),
        j.extend(j.prototype, {
            chain: function() {
                return (this._chain = !0), this;
            },
            value: function() {
                return this._wrapped;
            }
        }),
        "function" === typeof wwplayer.define &&
            wwplayer.define.amd &&
            wwplayer.define("underscore", [], function() {
                return j;
            });
}.call(this));
//# sourceMappingURL=underscore-min.map;
/**
 Sets Underscore's noConflict flag

 @module underscore-private
 @requires underscore
 **/
wwplayer.define("underscore-private", ["underscore"], function(_) {
    return _.noConflict();
});
wwplayer.define("awsCond", ["module"], function(module) {
    return {
        load: function(id, require, load, config) {
            if (config.isBuild) {
                return load();
            }
            var isIE8 = window.attachEvent && !window.addEventListener;
            if (!isIE8) {
                wwplayer.require(["aws"], function(value) {
                    load(value);
                });
            } else {
                load(null);
            }
        }
    };
});

/**
 *
 *  Base64 encode / decode
 *  http://www.webtoolkit.info/
 *
 **/

var Base64 = {
    // private property
    _keyStr: "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",

    // public method for encoding
    encode: function(input) {
        var output = "";
        var chr1, chr2, chr3, enc1, enc2, enc3, enc4;
        var i = 0;

        input = Base64._utf8_encode(input);

        while (i < input.length) {
            chr1 = input.charCodeAt(i++);
            chr2 = input.charCodeAt(i++);
            chr3 = input.charCodeAt(i++);

            enc1 = chr1 >> 2;
            enc2 = ((chr1 & 3) << 4) | (chr2 >> 4);
            enc3 = ((chr2 & 15) << 2) | (chr3 >> 6);
            enc4 = chr3 & 63;

            if (isNaN(chr2)) {
                enc3 = enc4 = 64;
            } else if (isNaN(chr3)) {
                enc4 = 64;
            }

            output = output + this._keyStr.charAt(enc1) + this._keyStr.charAt(enc2) + this._keyStr.charAt(enc3) + this._keyStr.charAt(enc4);
        }

        return output;
    },

    // public method for decoding
    decode: function(input) {
        var output = "";
        var chr1, chr2, chr3;
        var enc1, enc2, enc3, enc4;
        var i = 0;

        input = input.replace(/[^A-Za-z0-9\+\/\=]/g, "");

        while (i < input.length) {
            enc1 = this._keyStr.indexOf(input.charAt(i++));
            enc2 = this._keyStr.indexOf(input.charAt(i++));
            enc3 = this._keyStr.indexOf(input.charAt(i++));
            enc4 = this._keyStr.indexOf(input.charAt(i++));

            chr1 = (enc1 << 2) | (enc2 >> 4);
            chr2 = ((enc2 & 15) << 4) | (enc3 >> 2);
            chr3 = ((enc3 & 3) << 6) | enc4;

            output = output + String.fromCharCode(chr1);

            if (enc3 != 64) {
                output = output + String.fromCharCode(chr2);
            }
            if (enc4 != 64) {
                output = output + String.fromCharCode(chr3);
            }
        }

        output = Base64._utf8_decode(output);

        return output;
    },

    // private method for UTF-8 encoding
    _utf8_encode: function(string) {
        string = string.replace(/\r\n/g, "\n");
        var utftext = "";

        for (var n = 0; n < string.length; n++) {
            var c = string.charCodeAt(n);

            if (c < 128) {
                utftext += String.fromCharCode(c);
            } else if (c > 127 && c < 2048) {
                utftext += String.fromCharCode((c >> 6) | 192);
                utftext += String.fromCharCode((c & 63) | 128);
            } else {
                utftext += String.fromCharCode((c >> 12) | 224);
                utftext += String.fromCharCode(((c >> 6) & 63) | 128);
                utftext += String.fromCharCode((c & 63) | 128);
            }
        }

        return utftext;
    },

    // private method for UTF-8 decoding
    _utf8_decode: function(utftext) {
        var string = "";
        var i = 0;
        var c = (c1 = c2 = 0);

        while (i < utftext.length) {
            c = utftext.charCodeAt(i);

            if (c < 128) {
                string += String.fromCharCode(c);
                i++;
            } else if (c > 191 && c < 224) {
                c2 = utftext.charCodeAt(i + 1);
                string += String.fromCharCode(((c & 31) << 6) | (c2 & 63));
                i += 2;
            } else {
                c2 = utftext.charCodeAt(i + 1);
                c3 = utftext.charCodeAt(i + 2);
                string += String.fromCharCode(((c & 15) << 12) | ((c2 & 63) << 6) | (c3 & 63));
                i += 3;
            }
        }

        return string;
    }
};
wwplayer.define(
    "b64",
    (function(global) {
        return function() {
            var ret, fn;
            return ret || global.Base64;
        };
    })(this)
);

// Deprecated

/**
	@module Security
	@requires jquery, pubsub, globals, LogEvent
**/

wwplayer.define("Security", ["jquery", "pubsub", "globals", "LogEvent"], function($, PubSub, globals, LogEvent) {
    /**
	Stores the viewId  and playerKey after a successful handshake

	@class Security
	@constructor
	**/
    var Security = function() {
        var self = this;

        /**
			Version

			@property {String} version
		**/
        self.version = "0.1 - Danesh";

        /**
			Sets the view id

			@method
			@param {Number} viewId the view id
		**/
        self.setViewId = function(viewId) {
            self.viewId = viewId;
        };

        /**
			Gets the view id

			@method
			@return {Number} viewId the view id
		**/
        self.getViewId = function() {
            return self.viewId;
        };

        /**
			Sets the player key

			@method
			@param {String} key the player key
		**/
        self.setSecurityKey = function(key) {
            self.securityKey = key;
        };

        /**
			Gets the player key

			@method
			@return {String} key the player key
		**/
        self.getSecurityKey = function() {
            return self.securityKey;
        };
    };

    return Security;
});
/*!
 * jQuery Cookie Plugin v1.4.0
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2013 Klaus Hartl
 * Released under the MIT license
 */
(function(factory) {
    if (typeof wwplayer.define === "function" && wwplayer.define.amd) {
        // AMD
        wwplayer.define("Cookie", ["jquery"], factory);
    } else if (typeof exports === "object") {
        // CommonJS
        factory(require("jquery"));
    } else {
        // Browser globals
        factory(jQuery);
    }
})(function($) {
    var pluses = /\+/g;

    function encode(s) {
        return config.raw ? s : encodeURIComponent(s);
    }

    function decode(s) {
        return config.raw ? s : decodeURIComponent(s);
    }

    function stringifyCookieValue(value) {
        return encode(config.json ? JSON.stringify(value) : String(value));
    }

    function parseCookieValue(s) {
        if (s.indexOf('"') === 0) {
            // This is a quoted cookie as according to RFC2068, unescape...
            s = s
                .slice(1, -1)
                .replace(/\\"/g, '"')
                .replace(/\\\\/g, "\\");
        }

        try {
            // Replace server-side written pluses with spaces.
            // If we can't decode the cookie, ignore it, it's unusable.
            // If we can't parse the cookie, ignore it, it's unusable.
            s = decodeURIComponent(s.replace(pluses, " "));
            return config.json ? JSON.parse(s) : s;
        } catch (e) {}
    }

    function read(s, converter) {
        var value = config.raw ? s : parseCookieValue(s);
        return $.isFunction(converter) ? converter(value) : value;
    }

    var config = ($.cookie = function(key, value, options) {
        // Write

        if (value !== undefined && !$.isFunction(value)) {
            options = $.extend({}, config.defaults, options);

            if (typeof options.expires === "number") {
                var days = options.expires,
                    t = (options.expires = new Date());
                t.setTime(+t + days * 864e5);
            }

            return (document.cookie = [
                encode(key),
                "=",
                stringifyCookieValue(value),
                options.expires ? "; expires=" + options.expires.toUTCString() : "", // use expires attribute, max-age is not supported by IE
                options.path ? "; path=" + options.path : "",
                options.domain ? "; domain=" + options.domain : "",
                options.secure ? "; secure" : ""
            ].join(""));
        }

        // Read

        var result = key ? undefined : {};

        // To prevent the for loop in the first place assign an empty array
        // in case there are no cookies at all. Also prevents odd result when
        // calling $.cookie().
        var cookies = document.cookie ? document.cookie.split("; ") : [];

        for (var i = 0, l = cookies.length; i < l; i++) {
            var parts = cookies[i].split("=");
            var name = decode(parts.shift());
            var cookie = parts.join("=");

            if (key && key === name) {
                // If second argument (value) is a function it's a converter...
                result = read(cookie, value);
                break;
            }

            // Prevent storing a cookie that we couldn't decode.
            if (!key && (cookie = read(cookie)) !== undefined) {
                result[name] = cookie;
            }
        }

        return result;
    });

    config.defaults = {};

    $.removeCookie = function(key, options) {
        if ($.cookie(key) === undefined) {
            return false;
        }

        // Must not alter options, thus extending a fresh object...
        $.cookie(key, "", $.extend({}, options, { expires: -1 }));
        return !$.cookie(key);
    };
});

/*! http://mths.be/utf8js v2.0.0 by @mathias */
(function(root) {
    // Detect free variables `exports`
    var freeExports = typeof exports == "object" && exports;

    // Detect free variable `module`
    var freeModule = typeof module == "object" && module && module.exports == freeExports && module;

    // Detect free variable `global`, from Node.js or Browserified code,
    // and use it as `root`
    var freeGlobal = typeof global == "object" && global;
    if (freeGlobal.global === freeGlobal || freeGlobal.window === freeGlobal) {
        root = freeGlobal;
    }

    /*--------------------------------------------------------------------------*/

    var stringFromCharCode = String.fromCharCode;

    // Taken from http://mths.be/punycode
    function ucs2decode(string) {
        var output = [];
        var counter = 0;
        var length = string.length;
        var value;
        var extra;
        while (counter < length) {
            value = string.charCodeAt(counter++);
            if (value >= 0xd800 && value <= 0xdbff && counter < length) {
                // high surrogate, and there is a next character
                extra = string.charCodeAt(counter++);
                if ((extra & 0xfc00) == 0xdc00) {
                    // low surrogate
                    output.push(((value & 0x3ff) << 10) + (extra & 0x3ff) + 0x10000);
                } else {
                    // unmatched surrogate; only append this code unit, in case the next
                    // code unit is the high surrogate of a surrogate pair
                    output.push(value);
                    counter--;
                }
            } else {
                output.push(value);
            }
        }
        return output;
    }

    // Taken from http://mths.be/punycode
    function ucs2encode(array) {
        var length = array.length;
        var index = -1;
        var value;
        var output = "";
        while (++index < length) {
            value = array[index];
            if (value > 0xffff) {
                value -= 0x10000;
                output += stringFromCharCode(((value >>> 10) & 0x3ff) | 0xd800);
                value = 0xdc00 | (value & 0x3ff);
            }
            output += stringFromCharCode(value);
        }
        return output;
    }

    /*--------------------------------------------------------------------------*/

    function createByte(codePoint, shift) {
        return stringFromCharCode(((codePoint >> shift) & 0x3f) | 0x80);
    }

    function encodeCodePoint(codePoint) {
        if ((codePoint & 0xffffff80) == 0) {
            // 1-byte sequence
            return stringFromCharCode(codePoint);
        }
        var symbol = "";
        if ((codePoint & 0xfffff800) == 0) {
            // 2-byte sequence
            symbol = stringFromCharCode(((codePoint >> 6) & 0x1f) | 0xc0);
        } else if ((codePoint & 0xffff0000) == 0) {
            // 3-byte sequence
            symbol = stringFromCharCode(((codePoint >> 12) & 0x0f) | 0xe0);
            symbol += createByte(codePoint, 6);
        } else if ((codePoint & 0xffe00000) == 0) {
            // 4-byte sequence
            symbol = stringFromCharCode(((codePoint >> 18) & 0x07) | 0xf0);
            symbol += createByte(codePoint, 12);
            symbol += createByte(codePoint, 6);
        }
        symbol += stringFromCharCode((codePoint & 0x3f) | 0x80);
        return symbol;
    }

    function utf8encode(string) {
        var codePoints = ucs2decode(string);

        // console.log(JSON.stringify(codePoints.map(function(x) {
        // 	return 'U+' + x.toString(16).toUpperCase();
        // })));

        var length = codePoints.length;
        var index = -1;
        var codePoint;
        var byteString = "";
        while (++index < length) {
            codePoint = codePoints[index];
            byteString += encodeCodePoint(codePoint);
        }
        return byteString;
    }

    /*--------------------------------------------------------------------------*/

    function readContinuationByte() {
        if (byteIndex >= byteCount) {
            throw Error("Invalid byte index");
        }

        var continuationByte = byteArray[byteIndex] & 0xff;
        byteIndex++;

        if ((continuationByte & 0xc0) == 0x80) {
            return continuationByte & 0x3f;
        }

        // If we end up here, it’s not a continuation byte
        throw Error("Invalid continuation byte");
    }

    function decodeSymbol() {
        var byte1;
        var byte2;
        var byte3;
        var byte4;
        var codePoint;

        if (byteIndex > byteCount) {
            throw Error("Invalid byte index");
        }

        if (byteIndex == byteCount) {
            return false;
        }

        // Read first byte
        byte1 = byteArray[byteIndex] & 0xff;
        byteIndex++;

        // 1-byte sequence (no continuation bytes)
        if ((byte1 & 0x80) == 0) {
            return byte1;
        }

        // 2-byte sequence
        if ((byte1 & 0xe0) == 0xc0) {
            var byte2 = readContinuationByte();
            codePoint = ((byte1 & 0x1f) << 6) | byte2;
            if (codePoint >= 0x80) {
                return codePoint;
            } else {
                throw Error("Invalid continuation byte");
            }
        }

        // 3-byte sequence (may include unpaired surrogates)
        if ((byte1 & 0xf0) == 0xe0) {
            byte2 = readContinuationByte();
            byte3 = readContinuationByte();
            codePoint = ((byte1 & 0x0f) << 12) | (byte2 << 6) | byte3;
            if (codePoint >= 0x0800) {
                return codePoint;
            } else {
                throw Error("Invalid continuation byte");
            }
        }

        // 4-byte sequence
        if ((byte1 & 0xf8) == 0xf0) {
            byte2 = readContinuationByte();
            byte3 = readContinuationByte();
            byte4 = readContinuationByte();
            codePoint = ((byte1 & 0x0f) << 0x12) | (byte2 << 0x0c) | (byte3 << 0x06) | byte4;
            if (codePoint >= 0x010000 && codePoint <= 0x10ffff) {
                return codePoint;
            }
        }

        throw Error("Invalid UTF-8 detected");
    }

    var byteArray;
    var byteCount;
    var byteIndex;
    function utf8decode(byteString) {
        byteArray = ucs2decode(byteString);
        byteCount = byteArray.length;
        byteIndex = 0;
        var codePoints = [];
        var tmp;
        while ((tmp = decodeSymbol()) !== false) {
            codePoints.push(tmp);
        }
        return ucs2encode(codePoints);
    }

    /*--------------------------------------------------------------------------*/

    var utf8 = {
        version: "2.0.0",
        encode: utf8encode,
        decode: utf8decode
    };

    // Some AMD build optimizers, like r.js, check for specific condition patterns
    // like the following:
    if (typeof wwplayer.define === "function" && typeof wwplayer.define.amd === "object" && wwplayer.define.amd) {
        wwplayer.define("utf8", [], function() {
            return utf8;
        });
    } else if (freeExports && !freeExports.nodeType) {
        if (freeModule) {
            // in Node.js or RingoJS v0.8.0+
            freeModule.exports = utf8;
        } else {
            // in Narwhal or RingoJS v0.7.0-
            var object = {};
            var hasOwnProperty = object.hasOwnProperty;
            for (var key in utf8) {
                hasOwnProperty.call(utf8, key) && (freeExports[key] = utf8[key]);
            }
        }
    } else {
        // in Rhino or a web browser
        root.utf8 = utf8;
    }
})(this);

/*
 ======================================================
 uuid-v4.js :: Random UUID (v4) Generator - Usage: UUID()
 ======================================================

 Copyright (c) 2011 Matt Williams <matt@makeable.co.uk>. All rights reserved.

 Redistribution and use in source and binary forms, with or without modification, are
 permitted provided that the following conditions are met:

 1. Redistributions of source code must retain the above copyright notice, this list of
 conditions and the following disclaimer.

 2. Redistributions in binary form must reproduce the above copyright notice, this list
 of conditions and the following disclaimer in the documentation and/or other materials
 provided with the distribution.

 THIS SOFTWARE IS PROVIDED BY MATT WILLIAMS ''AS IS'' AND ANY EXPRESS OR IMPLIED
 WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND
 FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL MATT WILLIAMS OR
 CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
 SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
 ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
 ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

 The views and conclusions contained in the software and documentation are those of the
 authors and should not be interpreted as representing official policies, either expressed
 or implied, of Matt Williams.

 */

wwplayer.define("uuid", [], function() {
    var randFunction = Math.random;
    if (window.crypto && window.crypto.getRandomValues) {
        randFunction = function() {
            var array = new Uint32Array(1);
            window.crypto.getRandomValues(array);
            return array[0] / 4294967295;
        };
    }
    var dec2hex = [];
    for (var i = 0; i <= 15; i++) {
        dec2hex[i] = i.toString(16);
    }

    var UUID = function() {
        var uuid = "";
        for (var i = 1; i <= 36; i++) {
            if (i === 9 || i === 14 || i === 19 || i === 24) {
                uuid += "-";
            } else if (i === 15) {
                uuid += 4;
            } else if (i === 20) {
                uuid += dec2hex[(randFunction() * 4) | (0 + 8)];
            } else {
                uuid += dec2hex[(randFunction() * 15) | 0];
            }
        }
        return uuid;
    };

    return UUID;
});
wwplayer.define("apiService", ["jquery", "pubsub", "globals", "LogEvent", "underscore", "awsCond!", "b64", "Security", "Cookie", "utf8", "uuid"], function(
    $,
    PubSub,
    globals,
    LogEvent,
    _,
    aws,
    b64,
    Security,
    Cookie,
    utf8,
    uuid
) {
    /**
     * @author legacy developers, Jose Rego
     * @requires jquery, pubsub, globals, LogEvent, underscore, awsCond!, b64, Security, Cookie, utf8, uuid
     **/

    /**
     @constructor ApiService
     @classdesc Helper class to make requests to the WIREWAX API
     **/
    var ApiService = function() {
        var self = this;
        /**
         @name ApiService#retryLimit
         @type Number
         @default 3
         @description Amount of times a failed request should be retried
         **/
        self.retryLimit = 4;

        /**
         @name ApiService#retryDelay
         @type Number
         @default 100
         @description time(ms) between every retry request
         **/
        self.retryDelay = 100;

        $.support.cors = true;

        /**
         @name ApiService#domainUrl
         @type String
         @default //player.wirewax.com/
        */
        self.domainUrl = "//player.wirewax.com/";

        /**
         @name ApiService#apiUrl
         @deprecated
         @description This is the old php endpoint
         @type String
         @default //player.wirewax.com/
         */
        self.apiUrl = "//player.wirewax.com/";

        /**
         @name ApiService#newApiUrl
         @type String
         @description REST API
         @default //api.wirewax.com/api/
         */
        self.newApiUrl = "https://api.wirewax.com/api/";

        /**
         @name ApiService#edgecastApiUrl
         @type String
         @description EXTERNAL REQUEST CDN PROXY API
         @default //edge-api.wirewax.com/api/
         */
        self.edgecastApiUrl = "https://edge-api.wirewax.com/api/";

        /**
         @name ApiService#hobnobApiUrl
         @type String
         @description NODE REST API
         @default //hobnob.wirewax.com/
         **/
        self.hobnobApiUrl = !window.wirewax.stageMode ? "https://hobnob.wirewax.com/" : "https://hobnob.wirewax.tv/";

        /**
         @name ApiService#vidDataUrl
         @type String
         @description vidData url
         @default https://edge-player.wirewax.com
         **/
        self.vidDataUrl = window.wirewax.vidDataUrl || "https://edge-player.wirewax.com";

        self.cachedSheets = {};
        self.isFirstInteraction = false;
        self.hasInteractedBefore = false;
        self.sqsPhpFallback = globals.IS_IE && !globals.IS_IE_10 && !globals.IS_IE_11;

        function makeRand(len) {
            var text = "";
            var possible = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
            for (var i = 0; i < len; i++) text += possible.charAt(Math.floor(Math.random() * possible.length));
            return text;
        }

        /**
         Keeps track of the current state of the handshake process

         @name ApiService#handshakeSuccess
         @type Boolean
         **/
        self.handshakeSuccess = false;
        self.widgetData = [];
        self.widgetDataSent = [];
        self.forceHack = false;

        /**
         Cache overlay data instead of requesting every time we open the overlay

         @name ApiService#cachedPanelData
         **/
        self.cachedPanelData = {};

        /**
         Helper method to send an AJAX request based on the given params.
         Uses XDR if available (IE) and defaults to jQuery's ajax implementation otherwise

         @name ApiService~_ajaxWithRetry
         @method
         @param {String} url The API endpoint we're targetting
         @param {String} type The type of HTTP request, GET or POST
         @param {Object} inputData Data to send to the server with the request
         @param {Function} success Success callback
         @param {Function} error Error callback
         @param {String} dataType Type of data we are sending
         @param {Boolean} cache Cache the request
         @Param {String} headers Headers to add to the request
         **/
        var _ajaxWithRetry = function(url, type, inputData, retryLimit, success, error, dataType, cache, headers) {
            if (cache === undefined) {
                cache = false;
            }
            if (dataType === undefined) {
                dataType = "json";
            } else if (dataType == "hack" || dataType == "hack2") {
                if (globals.IS_IE_9 || globals.IS_IE_8 || self.forceHack) {
                    var jsoncallback = "i";
                    if (dataType == "hack2") {
                        jsoncallback = "wwx";
                        url = url + ".lole";
                    } else {
                        url = url + ".lol";
                    }
                    dataType = "jsonp";
                } else {
                    dataType = "json";
                }
            } else {
                dataType = dataType;
            }

            if (globals.IS_IE_9 && dataType !== "jsonp") {
                // Use Microsoft XDR
                this.xdrTryCount = 0;
                var xdrFail = function(args) {
                    this.xdrTryCount++;
                    if (this.xdrTryCount < retryLimit) {
                        xdrMeth(true);
                    } else {
                        error(args);
                    }
                };

                var xdrMeth = function(retry) {
                    var xdr = new XDomainRequest();

                    xdr.onload = function() {
                        if (success) {
                            if (dataType === "json") {
                                success($.parseJSON(xdr.responseText));
                            } else {
                                success(xdr.responseText);
                            }
                        }
                    };
                    xdr.ontimeout = function() {
                        xdrFail();
                    };
                    xdr.onerror = function(e) {
                        xdrFail();
                    };
                    xdr.onprogress = function() {};

                    xdr.timeout = 3000;
                    try {
                        if (retry) {
                            url = (url.indexOf("?noCache") > 0 ? url.substring(0, url.indexOf("?noCache")) : url) + "?noCache=" + makeRand(10);
                            xdr.open(type, url);
                        } else {
                            xdr.open(type, url);
                        }
                        if (inputData) {
                            xdr.send(JSON.stringify(inputData));
                        } else {
                            xdr.send();
                        }
                    } catch (err) {
                        PubSub.publish(globals.ERROR, new LogEvent(globals.ERROR, globals.ERRORS["5020"]));
                    }
                };
                xdrMeth();
            } else {
                globals.LOG("jquery " + url + " with callback " + jsoncallback);
                var options = {
                    url: url,
                    type: type,
                    data: inputData,
                    tryCount: 0,
                    timeout: 30000,
                    cache: cache,
                    retryLimit: retryLimit,
                    success: function(data, textStatus, jqXHR) {
                        globals.LOG("jquery success");
                        if (success) {
                            success(data, {
                                country: jqXHR.getResponseHeader("Country"),
                                ipAddress: jqXHR.getResponseHeader("IpAddress"),
                                continent: jqXHR.getResponseHeader("Continent")
                            });
                        }
                    },
                    error: function(xhr, textStatus, errorThrown) {
                        // DOCUMENT MODE IE9 in IE!0 workaround
                        if (
                            globals.IS_IE &&
                            errorThrown
                                .toString()
                                .toLowerCase()
                                .indexOf("access is denied") !== -1
                        ) {
                            globals.LOG("forcing jsonp hack");
                            self.forceHack = true;
                        }
                        globals.LOG("jquery error " + url + " because " + textStatus);

                        if (xhr.status == 404) {
                            this.tryCount = this.retryLimit;
                        }

                        this.tryCount++;
                        if (this.tryCount <= this.retryLimit) {
                            var thisRequest = this;
                            thisRequest.url =
                                (thisRequest.url.indexOf("?noCache") > 0 ? thisRequest.url.substring(0, thisRequest.url.indexOf("?noCache")) : thisRequest.url) +
                                "?noCache=" +
                                makeRand(10);
                            window.setTimeout(function() {
                                $.ajax(thisRequest);
                            }, self.retryDelay);
                            return;
                        } else {
                            if (error) {
                                error(textStatus + " - " + errorThrown);
                            }
                        }
                    }
                };
                if (jsoncallback) {
                    options.jsonpCallback = jsoncallback;
                    options.jsonp = false;
                }

                if (dataType != "none") {
                    options.dataType = dataType;
                }

                if (headers) {
                    options.headers = headers;
                }
                globals.LOG("do ajax with options " + JSON.stringify(options));
                $.ajax(options);
            }
        };

        var getHeadersFromCookieData = function() {
            var wwCookie = $.cookie("wirewax");
            var accessCookie = $.cookie("wirewax-access");
            var accessToken = null;

            if (window.wirewax.accessToken) {
                accessToken = window.wirewax.accessToken;
            } else if (wwCookie) {
                accessToken = $.parseJSON(wwCookie)["access_token"];
            } else if (accessCookie) {
                accessToken = $.parseJSON(accessCookie)["access_token"];
            }
            var headers = accessToken ? { Authorization: "Bearer " + accessToken } : {};

            return headers;
        };

        self.setMetricsController = function(metricsController) {
            self.metricsController = metricsController;
        };

        /**
         Sets the protocol of the of the API endpoints to http

         @name ApiService#setHttp
         @method
         **/
        self.setHttp = function() {
            self.domainUrl = "http:" + self.domainUrl;
            self.apiUrl = "http:" + self.apiUrl;
        };

        self.setCurrentTimeFn = function(currentTimeFn) {
            self.getCurrentTime = currentTimeFn;
        };

        self.setCurrentFrameFn = function(currentFrameFn) {
            self.getCurrentFrame = currentFrameFn;
        };

        self.setSqs = function() {
            aws.config.update({
                accessKeyId: globals.AWS_ACCESS_KEY,
                secretAccessKey: globals.AWS_SECRET_KEY,
                region: globals.AWS_REGION,
                sslEnabled: true,
                httpOptions: {
                    timeout: 5000
                }
            });
            self.sqs = new aws.SQS();
            globals.LOG("created sqs");
        };

        self.setUuId = function(uuId) {
            self.uuId = uuId;
        };

        self.sendSqsWithRetry = function(sqsQueue, body, success, error, anonymous) {
            var hackTries = 0;
            var sqsTries = 0;

            var sendSqsViaSdk = function(suc, err) {
                var callback = function(errResp, data) {
                    if (errResp || (data && !data["MessageId"])) {
                        if (sqsTries < self.retryLimit) {
                            sqsTries++;
                            window.setTimeout(function() {
                                sendSqsViaSdk(suc, err);
                            }, self.retryDelay);
                        } else {
                            err();
                        }
                    } else {
                        if (suc) {
                            suc(data);
                        }
                    }
                };
                if (anonymous) {
                    self.sqs.makeUnauthenticatedRequest(
                        "sendMessage",
                        {
                            QueueUrl: sqsQueue,
                            MessageBody: body
                        },
                        callback
                    );
                } else {
                    self.sqs.sendMessage(
                        {
                            QueueUrl: sqsQueue,
                            MessageBody: body
                        },
                        callback
                    );
                }
            };
            var sendSqsViaHack = function(suc, err) {
                $.ajax({
                    dataType: "jsonp",
                    success: function() {},
                    error: function(xOptions, textStatus) {
                        if (textStatus == "error") {
                            if (suc) {
                                suc();
                            }
                        } else {
                            if (hackTries < self.retryLimit) {
                                hackTries++;
                                window.setTimeout(function() {
                                    sendSqsViaHack(suc, error);
                                }, self.retryDelay);
                            } else {
                                err();
                            }
                        }
                    },
                    timeout: 3000,
                    url: "//sqs.us-east-1.amazonaws.com?Action=SendMessage&MessageBody=" + body + "&QueueUrl=" + sqsQueue + "&Version=2012-11-05"
                });
            };

            if (globals.IS_IE_9 || globals.IS_IE_8) {
                // || globals.IS_IPHONE) {
                //if IE9 aws sdk is unsupported so go straight to sqs jsonp hack method
                sendSqsViaHack(success, error);
            } else {
                if (!self.sqs) {
                    self.setSqs();
                }
                //try aws sdk method first, if that fails for whatever reason retry using the jsonp hack method
                sendSqsViaSdk(success, function() {
                    sendSqsViaHack(success, error);
                });
            }
        };

        self.recordError = function(errors, success, error) {
            var msgs = [];
            _.each(errors, function(errorObj) {
                msgs.push({
                    errorCode: errorObj.code,
                    errorDetail: errorObj.args.detail,
                    area: 0
                });
            });
            var errorMessage = {
                type: 4,
                data: {
                    uuId: self.uuId,
                    vidId: self.vidId,
                    embedLoc: window.wirewax.embedLoc,
                    userAgent: window.navigator.userAgent,
                    errors: msgs
                }
            };
            var msgBody = encodeForSqs(errorMessage);
            self.sendSqsWithRetry(globals.SQS_ERROR_QUEUE_URL, msgBody, success, error, true);
        };

        self.recordLegacyCode = function(legacyType, fileName, functionName, warningMessage) {
            var sqsMessage = {
                type: legacyType || globals.LEGACY_TYPE.UNKNOWN,
                data: {
                    uuId: self.uuId,
                    vidId: self.vidId,
                    embedLoc: window.wirewax.embedLoc,
                    userAgent: window.navigator.userAgent,
                    fileName: fileName,
                    functionName: functionName,
                    warningMessage: warningMessage
                }
            };
            if (window.wirewax.dev || window.wirewax.devKit) {
                console.log("WIREWAX LEGACY CODE WARNING: " + fileName + "->" + functionName + "() " + warningMessage);
            } else {
                globals.LOG("WIREWAX LEGACY CODE WARNING: " + fileName + "->" + functionName + "() " + warningMessage);
                var msgBody = encodeForSqs(sqsMessage);
                self.sendSqsWithRetry(
                    globals.SQS_LEGACY_CODE_QUEUE_URL,
                    msgBody,
                    function() {},
                    function() {},
                    false
                );
            }
        };

        function encodeForSqs(object) {
            var objString;

            objString = JSON.stringify(object);
            objString = utf8.encode(objString);
            objString = b64.encode(objString);

            return objString;
        }

        self.getUserUUID = function() {
            var wwUserCookie = getWirewaxUserCookie();
            var generateUserUUID = function() {
                var userUuid = uuid();
                createUserCookie(userUuid);
                return userUuid;
            };
            if (wwUserCookie) {
                try {
                    var userJson = JSON.parse(wwUserCookie);
                    return userJson.uuid;
                } catch (err) {
                    return generateUserUUID();
                }
            } else {
                return generateUserUUID();
            }
        };

        self.getUserId = function() {
            var wwUserCookie = getWirewaxUserCookie();
            if (wwUserCookie) {
                try {
                    var userJson = JSON.parse(wwUserCookie);
                    return userJson.userId;
                } catch (err) {
                    return null;
                }
            }
            return null;
        };

        function getWirewaxUserCookie() {
            var userCookieName = "wirewax-user";
            return $.cookie(userCookieName);
        }

        function createUserCookie(userUuid) {
            if (!window.wirewax.disableExternalTracking) {
                var userCookieName = "wirewax-user";
                $.cookie(userCookieName, JSON.stringify({ uuid: userUuid }), { domain: "wirewax.com", expires: 365 * 2 });
            }
        }

        function getWirewaxPlayerCookie() {
            var playerCookieName = "wirewax-player-impressions";
            return $.cookie(playerCookieName);
        }

        function createPlayerCookie(vidId, hasInteracted) {
            if (!window.wirewax.disableExternalTracking) {
                var playerCookieName = "wirewax-player-impressions";
                if (vidId) {
                    var pjObj = {};
                    pjObj[vidId] = hasInteracted ? "2" : "1";
                    $.cookie(playerCookieName, JSON.stringify({ videos: pjObj }), { expires: 365 * 2 });
                }
            }
        }

        function updatePlayerCookie(playerJson) {
            if (!window.wirewax.disableExternalTracking) {
                var playerCookieName = "wirewax-player-impressions";
                $.cookie(playerCookieName, JSON.stringify(playerJson), { expires: 365 * 2 });
            }
        }

        function updateUniqueInteractionInPlayerCookie(vidId) {
            var wwPlayerCookie = getWirewaxPlayerCookie();
            if (wwPlayerCookie) {
                try {
                    var playerJson = JSON.parse(wwPlayerCookie);

                    if (playerJson.videos) {
                        playerJson.videos[self.vidId] = "2";
                        updatePlayerCookie(playerJson);
                    }
                } catch (err) {
                    createPlayerCookie(vidId, true);
                }
            } else {
                createPlayerCookie(vidId, true);
            }
        }

        self.sendImpression = function(vidId, metric, error) {
            if (!self.security) {
                self.security = new Security();
            }

            self.vidId = vidId;

            metric.userId = self.getUserId();
            metric.userUuId = self.getUserUUID();
            metric.isFirstView = true;

            var wwPlayerCookie = getWirewaxPlayerCookie();
            if (wwPlayerCookie) {
                try {
                    var playerJson = JSON.parse(wwPlayerCookie);

                    if (!playerJson.videos) {
                        createPlayerCookie(self.vidId);
                    } else if (playerJson.videos) {
                        if ((playerJson.videos[self.vidId] && playerJson.videos[self.vidId] == "1") || playerJson.videos[self.vidId] == "2") {
                            metric.isFirstView = false;

                            if (playerJson.videos[self.vidId] === "2") {
                                self.hasInteractedBefore = true;
                            }
                        } else if (self.vidId) {
                            playerJson.videos[self.vidId] = "1";
                        }

                        updatePlayerCookie(playerJson);
                    }
                } catch (err) {
                    createPlayerCookie(self.vidId);
                }
            } else {
                createPlayerCookie(self.vidId);
            }

            var msgBody = encodeForSqs({ data: metric, db: "metrics", type: 1 });
            self.sendSqsWithRetry(globals.SQS_IMPRESSION_QUEUE_URL, msgBody, null, error, true);
        };

        self.isStudioUser = function() {
            var isStudioUser = false;
            if (self.getUserId()) {
                isStudioUser = true;
            }
            return isStudioUser;
        };

        self.sendRootMetric = function(vidId, metric, success, error) {
            if (!self.security) {
                self.security = new Security();
            }
            self.vidId = vidId;
            metric.vidId = vidId;

            var msgBody = encodeForSqs({ data: metric, db: "metrics", type: 2 });
            self.sendSqsWithRetry(globals.SQS_TEST_QUEUE_URL, msgBody, success, error);
        };

        self.sendSubMetrics = function(metrics, hash, success, error, metricIndex) {
            if (metrics.interactions && !self.isFirstInteraction && !self.hasInteractedBefore) {
                self.isFirstInteraction = true;
                metrics.isFirstActive = true;
                updateUniqueInteractionInPlayerCookie(window.wirewax.vidId);
            } else if (self.isFirstInteraction && !self.hasInteractedBefore) {
                metrics.isFirstActive = true;
            } else {
                metrics.isFirstActive = false;
            }

            var msgBody = encodeForSqs({
                keys: { uuId: hash, vidId: window.wirewax.vidId },
                data: metrics,
                db: "metrics",
                type: 3
            });

            self.sendSqsWithRetry(
                globals.SQS_SUB_TEST_QUEUE_URL,
                msgBody,
                function(data) {
                    success(metricIndex, data);
                },
                function(data) {
                    error(metricIndex, data);
                }
            );
        };

        /**
         Handshakes with the server to get the viewId and playerKey

         @method
         @deprecated
         @name ApiService#handshake
         @async
         @param {Number} vidId The id of the video being watched
         @param {String} embedLoc The location the video is embedded
         @param {Function} success The success callback
         @param {Function} error The error callback
         **/
        self.handshake = function(vidId, embedLoc, success, error, hash) {
            self.recordLegacyCode(globals.LEGACY_TYPE.DEAD_CODE, "apiService", "handshake", "handshake is deprecated");
            var successFn = function(data) {
                self.security.setViewId(data.viewId);
                self.security.setSecurityKey(data.playerKey);
                window.wirewax.viewId = data.viewId;
                if (!window.wirewax.country && data.country) {
                    globals.COUNTRY_CODE = data.country;
                }

                self.handshakeSuccess = true;

                success(data);
            };
            self.security = new Security();
            var url = self.apiUrl + "3/playerInterface.php";
            var commArray = {};
            self.vidId = vidId;
            commArray.vidId = vidId;
            commArray.embedLoc = embedLoc;
            commArray.uuId = hash;
            commArray.version = window.wirewax.version;
            commArray.action = "handshake";
            _ajaxWithRetry(url, "GET", { comms: commArray }, self.retryLimit, successFn, error, "jsonp");
        };

        /**
         Gets the data for the video being watched

         @method
         @name ApiService#getVideoData
         @async
         @param {Number} vidId The id of the video being watched
         @param {Function} success The success callback
         @param {Function} error The error callback
         **/
        self.getVideoData = function(vidId, success, error) {
            if (window.wirewax.writer || window.wirewax.preview) {
                var url = self.hobnobApiUrl + "videoData/" + vidId;

                var loadTimeStart = new Date().getTime();
                var successFn = function(data) {
                    PubSub.publish(globals.LOAD_METRIC, {
                        type: 2,
                        urls: [url],
                        loadTime: new Date().getTime() - loadTimeStart
                    });
                    if (success) {
                        success(data);
                    }
                };

                var headers = getHeadersFromCookieData();
                _ajaxWithRetry(url, "GET", {}, self.retryLimit, successFn, error, "json", false, headers);
            } else {
                self.getVideoDataCdn(vidId, success, error);
            }
        };

        self.getVideoDataCdnVersion = function(vidId, success, error) {
            var versionUrl = self.vidDataUrl + "/vidData/" + vidId + "/version.txt";
            _ajaxWithRetry(versionUrl, "GET", {}, self.retryLimit, success, error, "hack", true);
        };

        self.getVideoDataCdnFile = function(vidId, version, success, error) {
            var fileUrl = self.vidDataUrl + "/vidData/" + vidId + "/" + version + "/vidData.json";
            _ajaxWithRetry(
                fileUrl,
                "GET",
                {},
                self.retryLimit,
                function(data, headers) {
                    window.wirewax.country = headers["country"];
                    window.wirewax.continent = headers["continent"];
                    window.wirewax.ipAddress = headers["ipAddress"];
                    success(data);
                },
                error,
                "hack",
                true
            );
        };

        self.getMetaDataCdnFile = function(vidId, version, success, error) {
            var fileUrl = self.vidDataUrl + "/vidData/" + vidId + "/" + version + "/metaData.json";
            _ajaxWithRetry(
                fileUrl,
                "GET",
                {},
                self.retryLimit,
                function(data, headers) {
                    success(data);
                },
                error,
                "hack",
                true
            );
        };

        self.getVideoDataCdn = function(vidId, success, error) {
            globals.LOG("get vid data");
            self.getVideoDataCdnVersion(
                vidId,
                function(versionVideo) {
                    globals.LOG("got vidData version " + versionVideo);
                    self.getVideoDataCdnFile(vidId, versionVideo, success, error);
                },
                error
            );
        };

        self.getMetaDataCdn = function(vidId, success, error) {
            globals.LOG("get meta data");
            self.getVideoDataCdnVersion(
                vidId,
                function(versionVideo) {
                    globals.LOG("got vidData version " + versionVideo);
                    self.getMetaDataCdnFile(vidId, versionVideo, success, error);
                },
                error
            );
        };

        self.getStatsCdn = function(vidId, success, error) {
            var fileUrl = self.vidDataUrl + "/vidData/" + vidId + "/metadata/toplineStats.json";
            _ajaxWithRetry(
                fileUrl,
                "GET",
                {},
                self.retryLimit,
                function(data, headers) {
                    success(data);
                },
                error,
                "hack",
                true
            );
        };

        // these three functions are not currently used
        self.getErrorDataCdnVersion = function(success, error) {
            var versionUrl = self.vidDataUrl + "/metaData/errors/version.txt";
            _ajaxWithRetry(versionUrl, "GET", {}, self.retryLimit, success, error, "hack2", true);
        };

        self.getErrorDataCdnFile = function(version, success, error) {
            var fileUrl = self.vidDataUrl + "/metaData/errors/" + version + "/errors.json";
            _ajaxWithRetry(fileUrl, "GET", {}, self.retryLimit, success, error, "hack2", true);
        };

        self.getErrorDataCdn = function(success, error) {
            self.getErrorDataCdnVersion(function(versionError) {
                globals.LOG("got error data version " + versionError);
                self.getErrorDataCdnFile(versionError, success, error);
            }, error);
        };

        self.getOverlayDataCdnVersion = function(overlayId, success, error) {
            var versionUrl = self.vidDataUrl + "/overlayData/" + overlayId + "/version.txt";
            _ajaxWithRetry(versionUrl, "GET", {}, self.retryLimit, success, error, "hack", true);
        };

        self.getOverlayDataCdnFile = function(overlayId, version, success, error) {
            var fileUrl = self.vidDataUrl + "/overlayData/" + overlayId + "/" + version + "/overlayData.json";
            _ajaxWithRetry(
                fileUrl,
                "GET",
                {},
                self.retryLimit,
                function(data, headers) {
                    window.wirewax.country = headers["country"];
                    window.wirewax.continent = headers["continent"];
                    window.wirewax.ipAddress = headers["ipAddress"];
                    self.cachedPanelData[overlayId] = data;
                    success(data);
                },
                error,
                "hack",
                true
            );
        };

        /**
         Get and cache overlay/panel data

         @method
         @name ApiService#getOverlayDataCdn
         @param {Number} overlayId The overlay id
         @param {Function} success The success callback
         @param {Function} error The error callback
         **/
        self.getOverlayDataCdn = function(overlayId, success, error) {
            globals.LOG("get overlay data");
            if (self.cachedPanelData[overlayId]) {
                success(self.cachedPanelData[overlayId]);
            } else {
                self.getOverlayDataCdnVersion(
                    overlayId,
                    function(versionOverlay) {
                        globals.LOG("got overlayData version " + versionOverlay);
                        self.getOverlayDataCdnFile(overlayId, versionOverlay, success, error);
                    },
                    error
                );
            }
        };

        /**
         * @summary Record a *widget action*.
         * @description
         * **Note: Do not use this in customisations, use the methods on BaseWidget and BaseModule**.
         *
         * It shouldn't be called "recordUiMetric" as a UI metric is something else.
         *
         * @method
         * @name ApiService#recordUiMetric
         * @see BaseModule#recordUiMetric
         * @see BaseWidget#recordUiMetric
         * @param {String} event The event to record
         * @param {Number} appRef The reference to the widget
         * @param {Number} time The time in the video the metric was recorded (LEGACY: just send 0)
         * @param {Number} nameLink The nameLink of the widget
         * @param {Number} spriteId The spriteId of the associated tag
         * @param {Number} actionType Enum representing action type (globals.WIDGET_METRIC_TYPES)
         **/
        self.recordUiMetric = function(event, appRef, time, nameLink, spriteId, actionType) {
            var metric = {
                widgetRef: appRef,
                identifier: event,
                actionType: actionType ? actionType : 2,
                playTime: self.getCurrentTime(),
                nameLink: nameLink
            };
            if (appRef === "undefined") {
                delete metric.widgetRef;
            }
            if (spriteId) {
                metric.spriteId = spriteId;
            }

            if (self.metricsController) {
                self.metricsController.addWidgetInteractionData(metric);
            }
        };

        self.getVidIdFromBrightcove = function(bcVidId, success, error) {
            var url = "https://edge-player.wirewax.com/bcData/" + bcVidId + ".txt";
            _ajaxWithRetry(url, "GET", {}, self.retryLimit, success, error, "text");
        };

        self.getVidIdFromBitmovin = function(bitmovinVideo, success, error) {
            var url = "https://edge-player.wirewax.com/bitmovinData/" + bitmovinVideo + ".txt";
            _ajaxWithRetry(url, "GET", {}, self.retryLimit, success, error, "text");
        };

        self.getVidIdFromOoyala = function(ooyalaEmbedCode, success, error) {
            var url = "https://edge-player.wirewax.com/ooyalaData/" + ooyalaEmbedCode + ".txt";
            _ajaxWithRetry(url, "GET", {}, self.retryLimit, success, error, "text");
        };

        self.getVidIdFromThePlatform = function(platformMediaId, success, error) {
            var url = "https://edge-player.wirewax.com/theplatformData/" + platformMediaId + ".txt";
            _ajaxWithRetry(url, "GET", {}, self.retryLimit, success, error, "text");
        };

        self.getVidIdFromRTL = function(rtlVidId, success, error) {
            var url = "https://edge-player.wirewax.com/rtlData/" + rtlVidId + ".txt";
            _ajaxWithRetry(url, "GET", {}, self.retryLimit, success, error, "text");
        };

        self.getVidIdFromJWPlayer = function(mediaId, success, error) {
            var url = "https://edge-player.wirewax.com/jwPlayerData/" + mediaId + ".txt";
            _ajaxWithRetry(url, "GET", {}, self.retryLimit, success, error, "text");
        };

        /**
         Records Mouse Metrics
         Only sends metrics if the handshake was successful

         @method
         @name ApiService#sendMetrics
         @deprecated
         @async
         @param {Object} metrics Contains mouse metrics as well as timestamps and frame numbers
         @param {Function} success The success callback
         @param {Function} error The error callback
         **/
        self.sendMetrics = function(metrics, success, error) {
            self.recordLegacyCode(globals.LEGACY_TYPE.DEAD_CODE, "apiService", "sendMetrics", "sendMetrics is deprecated");
            var url = self.apiUrl + "3/playerInterface.php";

            if (self.handshakeSuccess) {
                var commArray = {
                    viewId: self.security.getViewId(),
                    playerKey: self.security.getSecurityKey(),
                    action: "metricsNew",
                    metrics: metrics,
                    vidId: self.vidId
                };

                _ajaxWithRetry(url, "GET", { comms: commArray }, self.retryLimit, success, error, "jsonp");
            }
        };

        self.getWidgetDataCdnFile = function(widgetRef, version, success, error, multisheet) {
            if (multisheet) {
                var fileUrl = self.vidDataUrl + "/widgetData/" + widgetRef + "/" + version + "/" + self.vidId + "/data.json";
            } else {
                var fileUrl = self.vidDataUrl + "/widgetData/" + widgetRef + "/" + version + "/data.json";
            }
            _ajaxWithRetry(fileUrl, "GET", {}, self.retryLimit, success, error, "hack", true);
        };

        self.getWidgetDataCdnVersion = function(widgetRef, success, error) {
            var versionUrl = self.vidDataUrl + "/widgetData/" + widgetRef + "/version.txt";
            _ajaxWithRetry(versionUrl, "GET", {}, self.retryLimit, success, error, "hack", true);
        };

        self.getWidgetDataCdn = function(widgetRef, success, error, multiSheet) {
            self.getWidgetDataCdnVersion(
                widgetRef,
                function(version) {
                    self.getWidgetDataCdnFile(widgetRef, version, success, error, multiSheet);
                },
                error
            );
        };

        self.widgetCallbacks = [];

        /**
         Loads Data for a Widget

         @method
         @name ApiService#loadWidgetData
         @deprecated
         @async
         @param {Object} data The data needed to make the request
         @param {Function} success The success callback
         @param {Function} error The error callback
         @see BaseModule#loadWidgetData
         @see BaseWidget#loadWidgetData
         **/
        self.loadWidgetData = function(data, success, error) {
            // TODO Jose: I want to deprecate this, but we still have a LOT of videos using spreadsheets.
            var url = self.domainUrl + "wirewaxAddon.php?format=json&playerType=3";
            var appRef = data.appRef;
            var loadTimeStart = new Date().getTime();

            var errCallback = function(xhr, textStatus, errorThrown) {
                if (error) {
                    error(xhr, textStatus, errorThrown);
                }
            };

            globals.LOG("Loading widget data");
            if (data["widgetCdn"] && appRef) {
                self.recordLegacyCode(globals.LEGACY_TYPE.DEAD_CODE, "apiService", "loadWidgetData", "loadWidgetData is deprecated");
                var successFn = function(data) {
                    globals.LOG("Loaded widget data");
                    //store it so you don't have to do it next time
                    self.widgetData[appRef] = data;
                    PubSub.publish(globals.LOAD_METRIC, {
                        type: 1,
                        urls: [url],
                        loadTime: new Date().getTime() - loadTimeStart
                    });
                    _.each(self.widgetCallbacks[appRef], function(successQ) {
                        successQ(data);
                    });
                };

                //if already grabbed then return this
                if (self.widgetDataSent[appRef]) {
                    if (self.widgetData[appRef]) {
                        success(self.widgetData[appRef]);
                    } else {
                        if (!self.widgetCallbacks[appRef]) {
                            self.widgetCallbacks[appRef] = [];
                        }
                        self.widgetCallbacks[appRef].push(success);
                    }
                } else {
                    self.widgetDataSent[appRef] = true;
                    if (!self.widgetCallbacks[appRef]) {
                        self.widgetCallbacks[appRef] = [];
                    }
                    self.widgetCallbacks[appRef].push(success);
                    self.getWidgetDataCdn(data.appRef, successFn, errCallback, data.multiSheet);
                }
            } else {
                self.recordLegacyCode(globals.LEGACY_TYPE.DEAD_CODE, "apiService", "loadWidgetDataPHP", "PHP is dead! loadWidgetData is deprecated");
                successFn = function(data) {
                    globals.LOG("Loaded widget data");
                    //store it so you don't have to do it next time
                    self.widgetData[appRef] = data;
                    PubSub.publish(globals.LOAD_METRIC, {
                        type: 1,
                        urls: [url],
                        loadTime: new Date().getTime() - loadTimeStart
                    });
                    success(data);
                };
                var vidId = window.wirewax.vidId;
                if (!self.security) {
                    var viewId = 0;
                } else {
                    var viewId = self.security.getViewId();
                }

                var commArray = {
                    appvideo: vidId,
                    appcomms: "action=read&smoke=horsefisting&viewId=" + viewId + "&vidID=" + vidId,
                    app: $.param({
                        appRef: data.appRef,
                        appID: data.appId,
                        lang: data.lang,
                        locale: data.locale,
                        countryCode: data.countryCode,
                        customNameRef: data.customNameRef
                    })
                };

                _ajaxWithRetry(url, "POST", commArray, self.retryLimit, successFn, errCallback);
            }
        };

        /**
         Generates an external URL

         @method
         @deprecated
         @name ApiService#generateWidgetLink
         @param {Number} appRef The data needed to make the request
         @param {Number} nameLink The nameLink of the widget
         @param {String} href The external URL
         @param {String} identifier Optional identifier
         **/
        self.generateWidgetLink = function(appRef, nameLink, href, identifier) {
            self.recordLegacyCode(globals.LEGACY_TYPE.DEAD_CODE, "apiService", "generateWidgetLink", "generateWidgetLink is deprecated. Use widgetShareClick() instead.");
            if (!self.security) {
                var viewId = 0;
            } else {
                var viewId = self.security.getViewId();
            }
            var link =
                self.apiUrl +
                "appGo.php?stamp=1e7ec0d59ab227988fa2ce1bb3dbe2145b82e77a&uuId=" +
                self.uuId +
                "&appref=" +
                appRef +
                "&viewID=" +
                viewId +
                "&action=link&namelink=" +
                nameLink +
                "&urldecode=0" +
                "&playtime=" +
                self.getCurrentTime() +
                "&href=" +
                encodeURIComponent(href);
            if (identifier) {
                link += "&identifier=" + identifier;
            }
            return link;
        };

        // /**
        //  Generates an external URL for a share
        //  @method
        //  @deprecated
        //  @name ApiService#generateShareLink
        //  @param {String} network The network we want to share on FB / TW / GP
        //  @param {Number} currentFrame The frame on which the share event was triggered
        //  @param {Number} currentTime The time on which the share event was triggered
        //  @param {String} shareText The text to prepopulate the share dialog with
        //  **/
        // self.generateShareLink = function (network, currentFrame, currentTime, shareText) {
        //     self.recordLegacyCode(globals.LEGACY_TYPE.DEAD_CODE, "apiService", "generateShareLink", "generateShareLink is deprecated. Use widgetShareClick() instead.");
        //
        //     if (!self.security) {
        //         var viewId = 0;
        //     }
        //     else {
        //         var viewId = self.security.getViewId();
        //     }
        //
        //     if (!shareText) {
        //         shareText = "";
        //     }
        //
        //     var link = self.apiUrl + 'go3.php?stamp=5f6d94c6818ec6aa08941b7ae883dc6dc4c0037c&uuId=' + self.uuId + '&action=share&nwk=' + network + '&viewID=' + viewId + '&frame=' + currentFrame + '&time=' + currentTime + '&shareText=' + escape(shareText) + '&embedLoc=' + encodeURIComponent(window.wirewax.embedLoc) + '&vidId=' + window.wirewax.vidId;
        //     return link;
        // };

        // /**
        //  @method
        //  @deprecated
        //  @name ApiService#generateWidgetShareLink
        //  **/
        // self.generateWidgetShareLink = function (network, currentFrame, currentTime, shareText, shareUrl) {
        //     self.recordLegacyCode(globals.LEGACY_TYPE.DEAD_CODE, "apiService", "generateWidgetShareLink", "generateWidgetShareLink is deprecated. Use widgetShareClick() instead.");
        //
        //     if (!self.security) {
        //         var viewId = 0;
        //     }
        //     else {
        //         var viewId = self.security.getViewId();
        //     }
        //
        //     if (!shareText) {
        //         shareText = "";
        //     }
        //
        //     var link = self.apiUrl + 'appGo.php?stamp=1e7ec0d59ab227988fa2ce1bb3dbe2145b82e77a&uuId=' + self.uuId + '&action=share&nwk=' + network + '&viewID=' + viewId + '&frame=' + currentFrame + '&time=' + currentTime + '&shareText=' + escape(shareText) + '&embedLoc=' + encodeURIComponent(window.wirewax.embedLoc) + '&vidID=' + window.wirewax.vidId;
        //
        //     if (shareUrl) {
        //         link += '&shareURL=' + encodeURIComponent(shareUrl);
        //     }
        //
        //     return link;
        // };

        /**
         Gets the legacy (Amber) vidId based on the current vidId

         @deprecated
         @method
         @name ApiService#getAmberVidId
         @async
         @param {Number} vidId The id of the video being watched
         @param {Function} success The success callback
         @param {Function} error The error callback
         **/
        self.getAmberVidId = function(vidId, success, error) {
            self.recordLegacyCode(globals.LEGACY_TYPE.DEAD_CODE, "apiService", "getAmberVidId", "getAmberVidId is deprecated.");

            var url = self.apiUrl + "3/playerInterface.php";

            var commArray = {
                action: "getAmberVidId",
                vidId: vidId
            };

            _ajaxWithRetry(url, "GET", { comms: commArray }, self.retryLimit, success, error, "jsonp");
        };

        self.getCss = function(url, success) {
            var error = function() {
                $("head").append('<link rel="stylesheet" type="text/css" href="' + url + '">');

                // No need to throw this error anymore
                // PubSub.publish(globals.ERROR, new LogEvent(globals.ERROR, globals.ERRORS['5026']));
            };

            _ajaxWithRetry(url, "GET", null, self.retryLimit, success, error, "text", true);
        };

        /**
         * @see BaseWidget#getTemplate
         */
        self.getTemplate = function(url, success, error, args) {
            if (!self.templateUrls) {
                self.templateUrls = {};
            }

            if (self.templateUrls[url]) {
                success(self.templateUrls[url]);
                return;
            }

            _ajaxWithRetry(
                url,
                "GET",
                null,
                self.retryLimit,
                function(template) {
                    if (args && args.cacheTemplate) {
                        self.templateUrls[url] = template;
                    }

                    success(template);
                },
                error,
                "text",
                true
            );
        };

        self.getJSON = function(url, success) {
            var error = function() {
                PubSub.publish(globals.ERROR, new LogEvent(globals.ERROR, globals.ERRORS["5015"]));
            };

            _ajaxWithRetry(url, "GET", null, self.retryLimit, success, error, "json");
        };

        /**
         Sends email
         @deprecated
         @method
         @name ApiService#sendEmail
         **/
        self.sendEmail = function(to, from, subject, message, success, error) {
            self.recordLegacyCode(globals.LEGACY_TYPE.DEAD_CODE, "apiService", "sendEmail", "sendEmail is deprecated.");
            var url = self.apiUrl + "3/playerInterface.php";

            var commArray = {
                action: "sendEmail",
                sender: from,
                recipient: to,
                subject: subject,
                message: message
            };

            _ajaxWithRetry(url, "POST", { comms: commArray }, self.retryLimit, success, error, "jsonp");
        };

        /**
         * @method
         * @name ApiService#sendEmailWithBcc
         * @author Klaudia Rozgonyiova
         * @description Send an email from videos
         * @param {Array} toEmails array of recipients' email addresses
         * @param {Array} bccEmails array of bcc emails
         * @param {String} sourceEmail sender's email address. Needs to be a wirewax email!
         * @param {String} subject subject
         * @param {String} bodyHtml body of the email
         * @param {Function} success success callback
         * @param {Function} error error callback
         **/
        self.sendEmailWithBcc = function(toEmails, bccEmails, sourceEmail, subject, bodyHtml, success, error) {
            var url = self.hobnobApiUrl + "sendEmail";
            var method = "POST";

            var email = {
                recipients: toEmails,
                bcc: bccEmails,
                sender: sourceEmail,
                subject: subject,
                message: bodyHtml
            };

            _ajaxWithRetry(url, method, email, success, error, "json");
        };

        /**
         record email
         @deprecated
         @method
         @name ApiService#recordEmail
         **/
        self.recordEmail = function(project, email, name, success, error) {
            self.recordLegacyCode(globals.LEGACY_TYPE.DEAD_CODE, "apiService", "recordEmail", "recordEmail is deprecated.");
            var url = self.apiUrl + "3/playerInterface.php";

            var commArray = {
                action: "recordEmail",
                project: project,
                email: email,
                name: name
            };

            _ajaxWithRetry(url, "POST", { comms: commArray }, self.retryLimit, success, error, "jsonp");
        };

        // VAST
        self.loadVastData = function(widgetData, success, error) {
            var errCallback = function(xhr, textStatus, errorThrown) {
                if (error) {
                    error(xhr, textStatus, errorThrown);
                }
            };

            var url = "https://d32gk7d5ulxe8p.cloudfront.net/ads/" + window.wirewax.vidId + ".json?dz=" + window.location.hostname;

            var successFn = function(data) {
                success(data);
            };

            _ajaxWithRetry(url, "GET", null, self.retryLimit, successFn, errCallback);
        };

        self.getVastXML = function(url, success, error) {
            var successFn = function(data) {
                success(data);
            };

            var errCallback = function(xhr, textStatus, errorThrown) {
                if (error) {
                    error(xhr, textStatus, errorThrown);
                }
            };

            _ajaxWithRetry(url, "GET", null, 0, successFn, errCallback, "xml");
        };

        self.recordVastMetric = function(url) {
            _ajaxWithRetry(url, "GET", null, 0, null, null);
        };

        self.getDataFromAPI = function(url, type, data, dataType, success, error) {
            if (type === "GET") {
                _.each(data, function(param, index) {
                    if (index === 0) {
                        url += "?";
                    } else {
                        url += "&";
                    }

                    url += param.name + "=" + param.value;
                });

                data = null;
            }

            _ajaxWithRetry(url, type, data, self.retryLimit, success, error, dataType, true);
        };

        /**
         @deprecated
         @method
         @name ApiService#getDataFromAPIWW
         **/
        self.getDataFromAPIWW = function(service, args, success, error) {
            self.recordLegacyCode(globals.LEGACY_TYPE.DEAD_CODE, "apiService", "getDataFromAPIWW", "getDataFromAPIWW is deprecated.");
            var url = self.apiUrl + "3/playerInterface.php";

            var commArray = {
                action: "loadApi",
                type: service,
                arguments: args
            };

            _ajaxWithRetry(url, "GET", { comms: commArray }, self.retryLimit, success, error, "jsonp");
        };

        // DEPRECATED
        /**
         @deprecated
         @method
         @name ApiService#sendTrackingRequest
         **/
        self.sendTrackingRequest = function(trackingRequest, success, error) {
            self.recordLegacyCode(globals.LEGACY_TYPE.UNKNOWN, "apiService", "sendTrackingRequest", "sendTrackingRequest is deprecated.");
            var url = self.newApiUrl + "trackingRequests";
            var headers = getHeadersFromCookieData();

            _ajaxWithRetry(url, "POST", trackingRequest, self.retryLimit, success, error, "json", false, headers);
        };

        self.getTrackingRequestStatus = function(vidId, spriteId, trackingRequestId, success, error) {
            var url = self.hobnobApiUrl + "video/" + vidId + "/sprite/" + spriteId + "/track/" + trackingRequestId;
            var headers = getHeadersFromCookieData();

            _ajaxWithRetry(url, "GET", null, self.retryLimit, success, error, "json", false, headers);
        };

        /**
         @deprecated
         @method
         @name ApiService#getWidgetDataNew
         **/
        self.getWidgetDataNew = function(args, success, error) {
            self.recordLegacyCode(globals.LEGACY_TYPE.UNKNOWN, "apiService", "getWidgetDataNew", "getWidgetDataNew is deprecated.");
            var url = self.newApiUrl + "widgetDatas/" + args.widgetRef + "?vidId=" + window.wirewax.vidId + "&customNameRef=" + args.customNameRef;

            _ajaxWithRetry(url, "GET", null, 0, success, error, "json", false);
        };

        self.postSpreadsheetData = function(args, success, error) {
            var url = self.hobnobApiUrl + "api/spreadsheet";

            _ajaxWithRetry(url, "POST", args, 0, success, error, "json", false);
        };

        self.downloadImageData = function(url, success, error) {
            _ajaxWithRetry(url, "GET", null, 3, success, error, "text", false);
        };

        /**
         @deprecated
         @method
         @name ApiService#saveTag
         **/
        self.saveTag = function(args, success, error) {
            self.recordLegacyCode(globals.LEGACY_TYPE.UNKNOWN, "apiService", "saveTag", "saveTag is deprecated.");
            var saveTagFn = function() {
                var url = self.newApiUrl + "tags";
                var headers = getHeadersFromCookieData();

                _ajaxWithRetry(url, "POST", args, self.retryLimit, success, error, "json", false, headers);
            };

            if (args.trackingRequestId) {
                var trackingReqFn = function() {
                    self.getTrackingRequestStatus(
                        args.trackingRequestId,
                        function(data) {
                            if (data.status < 2) {
                                window.setTimeout(trackingReqFn, 500);
                            } else if (data.status === 2) {
                                saveTagFn();
                            } else if (data.status > 2) {
                                error();
                            }
                        },
                        function(args) {
                            error(args);
                        }
                    );
                };
                trackingReqFn();
            } else {
                saveTagFn();
            }
        };

        /**
         @deprecated
         @method
         @name ApiService#getSpriteIdByTrackingRequestId
         **/
        self.getSpriteIdByTrackingRequestId = function(trackingRequestId, success, error) {
            self.recordLegacyCode(globals.LEGACY_TYPE.UNKNOWN, "apiService", "getSpriteIdByTrackingRequestId", "getSpriteIdByTrackingRequestId is deprecated.");
            var url = self.newApiUrl + "sprites?trackingRequestId=" + trackingRequestId;
            var headers = getHeadersFromCookieData();

            _ajaxWithRetry(url, "GET", null, self.retryLimit, success, error, "json", false, headers);
        };

        self.deleteTag = function(args, success, error) {
            var deleteTagFn = function(spriteId) {
                var url = self.hobnobApiUrl + "video/" + window.wirewax.vidId + "/sprite/" + spriteId;
                var headers = getHeadersFromCookieData();

                _ajaxWithRetry(url, "DELETE", null, self.retryLimit, success, error, "json", false, headers);
            };

            if (args.trackingRequestId) {
                var trackingReqFn = function() {
                    self.getTrackingRequestStatus(
                        args.trackingRequestId,
                        function(data) {
                            if (data.status < 2) {
                                window.setTimeout(trackingReqFn, 500);
                            } else if (data.status === 2) {
                                self.getSpriteIdByTrackingRequestId(
                                    args.trackingRequestId,
                                    function(data) {
                                        deleteTagFn(data[0].spriteId);
                                    },
                                    function(args) {
                                        error(args);
                                    }
                                );
                            } else if (data.status > 2) {
                                error();
                            }
                        },
                        function(args) {
                            error(args);
                        }
                    );
                };
                trackingReqFn();
            } else {
                deleteTagFn(args.spriteId);
            }
        };

        self.getRegionInfo = function(success, error) {
            var url = "http://ipinfo.io/json";

            _ajaxWithRetry(url, "GET", null, 0, success, error, "jsonp", false);
        };

        self.getClusterData = function(file, success, error) {
            var url = file;
            _ajaxWithRetry(url, "GET", null, 0, success, error, "json", false);
        };

        self.getRetailDataCdnFile = function(widgetRef, productId, version, success, error) {
            var fileUrl = self.vidDataUrl + "/retailData/" + widgetRef + "/" + productId + "/" + version + "/data.json";
            _ajaxWithRetry(fileUrl, "GET", {}, self.retryLimit, success, error, "hack", true);
        };

        self.getRetailDataCdnVersion = function(widgetRef, productId, success, error) {
            var versionUrl = self.vidDataUrl + "/retailData/" + widgetRef + "/" + productId + "/version.txt";
            _ajaxWithRetry(versionUrl, "GET", {}, self.retryLimit, success, error, "hack", true);
        };

        self.getRetailData = function(widgetRef, productId, success, error) {
            self.getRetailDataCdnVersion(
                widgetRef,
                productId,
                function(version) {
                    self.getRetailDataCdnFile(widgetRef, productId, version, success, error);
                },
                error
            );
        };

        //sorry this all changed

        self.getRetailDataCdnFileNew = function(retailer, productId, version, success, error) {
            var fileUrl = self.vidDataUrl + "/retailData/" + retailer + "/" + productId + "/" + version + "/data.json";
            _ajaxWithRetry(fileUrl, "GET", {}, self.retryLimit, success, error, "hack", true);
        };

        self.getRetailDataCdnVersionNew = function(retailer, productId, success, error) {
            var versionUrl = self.vidDataUrl + "/retailData/" + retailer + "/" + productId + "/version.txt";
            _ajaxWithRetry(versionUrl, "GET", {}, self.retryLimit, success, error, "hack", true);
        };

        self.getRetailDataNew = function(retailer, productId, success, error) {
            var retailer = retailer.replace(/\s+/g, "").toLowerCase();
            var productId = '"' + productId + '"';
            self.getRetailDataCdnVersionNew(
                retailer,
                productId,
                function(version) {
                    self.getRetailDataCdnFileNew(retailer, productId, version, success, error);
                },
                error
            );
        };

        self.externalApiRequest = function(identifier, method, args, success, error) {
            var url = self.edgecastApiUrl + "externalApi/" + identifier;
            var data = null;

            if (method === "GET") {
                var joiner = "?";

                _.each(args, function(arg, key) {
                    url += joiner + key + "=" + arg;
                    joiner = "&";
                });
            } else if (method === "POST") {
                data = args;
            }
            _ajaxWithRetry(url, method, data, 0, success, error, "json", true);
        };

        self.widgetLinkClick = function(appRef, nameLink, href, identifier, spriteId, noUtm, thisPage, tagPublicData) {
            var metric = {
                widgetRef: appRef,
                actionType: globals.WIDGET_METRIC_TYPES.CLICK_OUT,
                nameLink: nameLink,
                identifier: identifier,
                href: href,
                playTime: self.getCurrentTime()
            };
            if (appRef === "undefined") {
                delete metric.widgetRef;
            }

            if (spriteId) {
                metric.spriteId = spriteId;
            }

            if (self.metricsController) {
                self.metricsController.addWidgetInteractionData(metric);
            }

            PubSub.publish(globals.WIDGET_CLICKOUT, { url: href, tagData: tagPublicData });

            if (!globals.INNOVID_EVENTS) {
                var joiner = "?";
                if (href.indexOf(joiner) !== -1) {
                    joiner = "&";
                }

                if (href.indexOf("#") !== -1) {
                    noUtm = true;
                }

                if (href.indexOf("mailto:") > -1) {
                    noUtm = true;
                }

                if (href.indexOf("tel:") > -1) {
                    noUtm = true;
                }

                if (href.indexOf("http://mailto:") === 0) {
                    href = "mailto:" + href.slice(14);
                    thisPage = true;
                }

                if (!noUtm) {
                    href = href + joiner + "utm_source=wirewax_" + window.wirewax.vidId;
                }

                var openIn = "_blank";
                if (thisPage) {
                    openIn = "_parent";
                }

                window.open(href, openIn);
            }
        };
        /**
         @method
         @name ApiService#playerShareClick
         */
        self.playerShareClick = function(network, currentFrame, currentTime, shareText, shareUrl) {
            if (self.metricsController) {
                self.metricsController.addInteractionData({
                    type: 3,
                    time: self.getCurrentTime(),
                    network: network,
                    link: shareUrl,
                    frame: self.getCurrentFrame()
                });
            }

            var shareUrl = shareUrl ? shareUrl : window.wirewax.embedLoc;
            var shareText = shareText ? shareText : "I'm watching " + globals.vidName + " on " + window.wirewax.embedLoc;
            var url = "https://view.wirewax.com/" + self.vidId;
            switch (network) {
                case "fb":
                    url = "http://www.facebook.com/sharer.php?u=" + encodeURIComponent(shareUrl);
                    break;
                case "tw":
                    url = "http://twitter.com/home?status=" + encodeURIComponent(shareText);
                    break;
                case "gp":
                    url = "https://plus.google.com/share?url=" + encodeURIComponent(shareText);
                    break;
            }
            window.open(url, "", "width=626,height=436");
        };
        /**
         @method
         @name ApiService#widgetShareClick
         */
        self.widgetShareClick = function(network, shareText, shareUrl, shareImg, spriteId, args) {
            args = args || {};
            var metric = {
                actionType: 3,
                network: network,
                shareText: shareText,
                shareURL: shareUrl,
                playTime: self.getCurrentTime()
            };
            if (args && args.shareDesc) {
                metric.shareDesc = args.shareDesc;
            }
            if (spriteId) {
                metric.spriteId = spriteId;
            }
            if (self.metricsController) {
                self.metricsController.addWidgetInteractionData(metric);
            }

            var url = "https://view.wirewax.com/" + self.vidId;
            switch (network) {
                case "fb":
                    url = "https://www.facebook.com/sharer.php?u=" + encodeURIComponent(shareUrl);
                    break;
                case "tw":
                    url = "https://twitter.com/intent/tweet?text=" + encodeURIComponent(shareText);
                    break;
                case "gp":
                    url = "https://plus.google.com/share?url=" + encodeURIComponent(shareUrl);
                    break;
                case "pt":
                    url =
                        "https://pinterest.com/pin/create/button/?url=" +
                        encodeURIComponent(shareUrl) +
                        "&media=" +
                        encodeURIComponent(shareImg) +
                        "&description=" +
                        encodeURIComponent(shareText);
                    break;
                case "tb":
                    url =
                        "https://www.tumblr.com/share/link?url=" +
                        encodeURIComponent(shareUrl) +
                        "&name=" +
                        encodeURIComponent(shareText) +
                        "&description=" +
                        encodeURIComponent(shareText);
                    break;
                case "li":
                    if (args && args.shareDesc) {
                        url =
                            "https://www.linkedin.com/shareArticle?mini=true&url=" +
                            encodeURIComponent(shareUrl) +
                            "&title=" +
                            encodeURIComponent(shareText) +
                            "&summary=" +
                            encodeURIComponent(args.shareDesc);
                    } else {
                        url = "https://www.linkedin.com/shareArticle?mini=true&url=" + encodeURIComponent(shareUrl) + "&title=" + encodeURIComponent(shareText);
                    }
                    break;
            }
            window.open(url, "", "width=626,height=436");
        };

        self.getSubtitles = function(args, success, error) {
            var file = args.file;
            var external = args["external"];
            globals.LOG("getting subtitles", file);
            var url = external ? file : "https://edge-player.wirewax.com" + file;

            _ajaxWithRetry(
                url,
                "GET",
                {},
                self.retryLimit,
                function(data) {
                    var subtitles = [];
                    var thisSubtitle;
                    var lines = data.split("\n");
                    //states - 0 on end, 1 index, 2 ts, 3 on text
                    var state = -1;
                    for (var i = 0; i < lines.length; i++) {
                        var line = lines[i];
                        //console.log('"'+line+'"');
                        if (state === 0 || state === 1 || state === 2) {
                            state++;
                        }
                        if (line == "" || line == "\r") {
                            if (thisSubtitle) {
                                subtitles.push(thisSubtitle);
                            }
                            thisSubtitle = {};
                            state = 0;
                        }
                        switch (state) {
                            case 1:
                                break;
                            case 2:
                                var inOut = line.split("-->");
                                var inTime = inOut[0];
                                var outTime = inOut[1];
                                var timeArray = inTime.split(":");
                                var inSeconds = parseInt(timeArray[0] * 60 * 60) + parseInt(timeArray[1] * 60) + parseFloat(timeArray[2]);
                                var timeArray = outTime.split(":");
                                var outSeconds = parseInt(timeArray[0] * 60 * 60) + parseInt(timeArray[1] * 60) + parseFloat(timeArray[2]);
                                thisSubtitle["in"] = inSeconds;
                                thisSubtitle["out"] = outSeconds;
                                break;
                            case 3:
                                thisSubtitle["text"] = (thisSubtitle["text"] ? thisSubtitle["text"] + "\n" : "") + line;
                                break;
                        }
                    }
                    var subObect = {
                        subtitles: subtitles,
                        label: args.label || "en"
                    };
                    globals.LOG("got subtitles", subtitles);
                    // console.log("got subtitles", subtitles);
                    success(subObect);
                },
                function() {
                    // FIXME create a new error code
                    console.log("error");
                },
                "text"
            );
        };

        self.sendTrackingInterpolationRequest = function(vidId, spriteId, data, success, error) {
            var url = self.hobnobApiUrl + "trackingInterpolation/video/" + vidId + "/sprite/" + spriteId;
            var method = "PUT";
            var headers = getHeadersFromCookieData();

            _ajaxWithRetry(url, method, data, 0, success, error, "json", false, headers);
        };

        self.sendEditTrackingRequest = function(vidId, spriteId, data, success, error) {
            var url = self.hobnobApiUrl + "trackingForwardsBackwards/video/" + vidId + "/sprite/" + spriteId;
            var method = "PUT";
            var headers = getHeadersFromCookieData();

            _ajaxWithRetry(url, method, data, 3, success, error, "json", false, headers);
        };

        self.sendStaticSpriteCreationRequest = function(vidId, width, height, top, left, timeIn, timeOut, success, error) {
            var url = self.hobnobApiUrl + "video/" + vidId + "/staticSprite";
            var method = "POST";
            var headers = getHeadersFromCookieData();

            var data = {
                w: width,
                h: height,
                x: left,
                y: top,
                timeIn: timeIn,
                timeOut: timeOut
            };

            _ajaxWithRetry(url, method, data, 3, success, error, "json", false, headers);
        };

        self.sendStaticSpriteUpdateRequest = function(vidId, spriteId, width, height, top, left, timeIn, timeOut, success, error) {
            var url = self.hobnobApiUrl + "video/" + vidId + "/staticSprite/" + spriteId;
            var method = "PUT";
            var headers = getHeadersFromCookieData();

            var data = {
                w: width,
                h: height,
                x: left,
                y: top,
                timeIn: timeIn,
                timeOut: timeOut
            };

            _ajaxWithRetry(url, method, data, 3, success, error, "json", false, headers);
        };

        self.sendMergeSpriteTracksRequest = function(vidId, spriteId1, spriteId2, success, error) {
            var url = self.hobnobApiUrl + "video/" + vidId + "/sprite/" + spriteId1 + "/merge/" + spriteId2;
            var method = "POST";
            var headers = getHeadersFromCookieData();

            _ajaxWithRetry(url, method, {}, 3, success, error, "json", false, headers);
        };

        self.updateTrackByTrackingRequestId = function(vidId, spriteId, trackingRequestId, success, error) {
            var url = self.hobnobApiUrl + "video/" + vidId + "/sprite/" + spriteId + "/track/" + trackingRequestId;
            var method = "PUT";
            var headers = getHeadersFromCookieData();

            _ajaxWithRetry(url, method, {}, 3, success, error, "json", false, headers);
        };

        self.undoEditTracking = function(vidId, spriteId, success, error) {
            var url = self.hobnobApiUrl + "video/" + vidId + "/sprite/" + spriteId + "/track/history";
            var method = "DELETE";
            var headers = getHeadersFromCookieData();

            _ajaxWithRetry(url, method, {}, 3, success, error, "json", false, headers);
        };

        self.getEditTrackingHistory = function(vidId, spriteId, success, error) {
            var url = self.hobnobApiUrl + "video/" + vidId + "/sprite/" + spriteId + "/track/history";
            var method = "GET";
            var headers = getHeadersFromCookieData();

            _ajaxWithRetry(url, method, {}, 3, success, error, "json", false, headers);
        };

        self.sendFrameData = function(vidId, spriteId, frameData, editType, success, error) {
            var url = self.hobnobApiUrl + "video/" + vidId + "/sprite/" + spriteId;
            var method = "PUT";

            var wwCookie = $.cookie("wirewax");
            var headers = getHeadersFromCookieData();

            var newFrameData = [];
            _.each(frameData, function(frameDatum, frame) {
                if (frameDatum.disabled !== true) {
                    frameDatum.frame = frame;
                    newFrameData.push(frameDatum);
                }
            });
            var data = {
                editType: editType,
                frameData: newFrameData
            };
            _ajaxWithRetry(url, method, data, 0, success, error, "json", false, headers);
        };

        self.getSheetDataCdnFile = function(sheetId, version, success, error) {
            var fileUrl = self.vidDataUrl + "/sheetData/" + sheetId + "/" + version + "/data.json";
            _ajaxWithRetry(
                fileUrl,
                "GET",
                {},
                self.retryLimit,
                function(data) {
                    success(data);
                },
                error,
                "hack",
                true
            );
        };

        self.getSheetDataCdnVersion = function(sheetId, success, error) {
            var versionUrl = self.vidDataUrl + "/sheetData/" + sheetId + "/version.txt";
            _ajaxWithRetry(versionUrl, "GET", {}, self.retryLimit, success, error, "hack", true);
        };

        self.getSheetDataCdn = function(sheetId, success, error) {
            if (!self.cachedSheets[sheetId]) {
                self.cachedSheets[sheetId] = {
                    successes: [success],
                    errors: [error]
                };
                return self.getSheetDataCdnVersion(
                    sheetId,
                    function(version) {
                        self.getSheetDataCdnFile(
                            sheetId,
                            version,
                            function(data) {
                                self.cachedSheets[sheetId].data = data;
                                _.each(self.cachedSheets[sheetId].successes, function(successFn) {
                                    successFn(data);
                                });
                            },
                            function() {
                                _.each(self.cachedSheets[sheetId].errors, function(errorFn) {
                                    errorFn();
                                });
                            }
                        );
                    },
                    function() {
                        _.each(self.cachedSheets[sheetId].errors, function(errorFn) {
                            errorFn();
                        });
                    }
                );
            }
            if (self.cachedSheets[sheetId].data) {
                return success(self.cachedSheets[sheetId].data);
            }
            self.cachedSheets[sheetId].successes.push(success);
            self.cachedSheets[sheetId].errors.push(error);
        };

        self.sendSegmentationRequest = function(vidId, data, success, error) {
            var url = self.hobnobApiUrl + "video/" + vidId + "/segmentation";
            var method = "POST";
            var headers = getHeadersFromCookieData();
            _ajaxWithRetry(url, method, data, 1, success, error, "json", false, headers);
        };
    };

    return new ApiService();
});

/*! modernizr 3.6.0 (Custom Build) | MIT *
 * https://modernizr.com/download/?-applicationcache-audio-backgroundsize-borderimage-borderradius-boxshadow-canvas-canvastext-cssanimations-csscolumns-cssgradients-cssreflections-csstransforms-csstransforms3d-csstransitions-flexbox-fontface-generatedcontent-geolocation-hashchange-history-hsla-indexeddb-inlinesvg-input-localstorage-multiplebgs-opacity-postmessage-rgba-sessionstorage-smil-svg-svgclippaths-textshadow-touchevents-video-webgl-websockets-websqldatabase-webworkers-setclasses !*/
!(function(e, t, n) {
    function r(e, t) {
        return typeof e === t;
    }

    function o() {
        var e, t, n, o, a, s, i;
        for (var c in w)
            if (w.hasOwnProperty(c)) {
                if (((e = []), (t = w[c]), t.name && (e.push(t.name.toLowerCase()), t.options && t.options.aliases && t.options.aliases.length)))
                    for (n = 0; n < t.options.aliases.length; n++) e.push(t.options.aliases[n].toLowerCase());
                for (o = r(t.fn, "function") ? t.fn() : t.fn, a = 0; a < e.length; a++)
                    (s = e[a]),
                        (i = s.split(".")),
                        1 === i.length
                            ? (Modernizr[i[0]] = o)
                            : (!Modernizr[i[0]] || Modernizr[i[0]] instanceof Boolean || (Modernizr[i[0]] = new Boolean(Modernizr[i[0]])), (Modernizr[i[0]][i[1]] = o)),
                        x.push((o ? "" : "no-") + i.join("-"));
            }
    }

    function a(e) {
        var t = P.className,
            n = Modernizr._config.classPrefix || "";
        if ((k && (t = t.baseVal), Modernizr._config.enableJSClass)) {
            var r = new RegExp("(^|\\s)" + n + "no-js(\\s|$)");
            t = t.replace(r, "$1" + n + "js$2");
        }
        Modernizr._config.enableClasses && ((t += " " + n + e.join(" " + n)), k ? (P.className.baseVal = t) : (P.className = t));
    }

    function s() {
        return "function" != typeof t.createElement
            ? t.createElement(arguments[0])
            : k
            ? t.createElementNS.call(t, "http://www.w3.org/2000/svg", arguments[0])
            : t.createElement.apply(t, arguments);
    }

    function i(e, t) {
        return !!~("" + e).indexOf(t);
    }

    function c(e) {
        return e
            .replace(/([a-z])-([a-z])/g, function(e, t, n) {
                return t + n.toUpperCase();
            })
            .replace(/^-/, "");
    }

    function d(e, t) {
        if ("object" == typeof e) for (var n in e) B(e, n) && d(n, e[n]);
        else {
            e = e.toLowerCase();
            var r = e.split("."),
                o = Modernizr[r[0]];
            if ((2 == r.length && (o = o[r[1]]), "undefined" != typeof o)) return Modernizr;
            (t = "function" == typeof t ? t() : t),
                1 == r.length
                    ? (Modernizr[r[0]] = t)
                    : (!Modernizr[r[0]] || Modernizr[r[0]] instanceof Boolean || (Modernizr[r[0]] = new Boolean(Modernizr[r[0]])), (Modernizr[r[0]][r[1]] = t)),
                a([(t && 0 != t ? "" : "no-") + r.join("-")]),
                Modernizr._trigger(e, t);
        }
        return Modernizr;
    }

    function l() {
        var e = t.body;
        return e || ((e = s(k ? "svg" : "body")), (e.fake = !0)), e;
    }

    function u(e, n, r, o) {
        var a,
            i,
            c,
            d,
            u = "modernizr",
            f = s("div"),
            p = l();
        if (parseInt(r, 10)) for (; r--; ) (c = s("div")), (c.id = o ? o[r] : u + (r + 1)), f.appendChild(c);
        return (
            (a = s("style")),
            (a.type = "text/css"),
            (a.id = "s" + u),
            (p.fake ? p : f).appendChild(a),
            p.appendChild(f),
            a.styleSheet ? (a.styleSheet.cssText = e) : a.appendChild(t.createTextNode(e)),
            (f.id = u),
            p.fake && ((p.style.background = ""), (p.style.overflow = "hidden"), (d = P.style.overflow), (P.style.overflow = "hidden"), P.appendChild(p)),
            (i = n(f, e)),
            p.fake ? (p.parentNode.removeChild(p), (P.style.overflow = d), P.offsetHeight) : f.parentNode.removeChild(f),
            !!i
        );
    }

    function f(e, t) {
        return function() {
            return e.apply(t, arguments);
        };
    }

    function p(e, t, n) {
        var o;
        for (var a in e) if (e[a] in t) return n === !1 ? e[a] : ((o = t[e[a]]), r(o, "function") ? f(o, n || t) : o);
        return !1;
    }

    function g(e) {
        return e
            .replace(/([A-Z])/g, function(e, t) {
                return "-" + t.toLowerCase();
            })
            .replace(/^ms-/, "-ms-");
    }

    function v(t, n, r) {
        var o;
        if ("getComputedStyle" in e) {
            o = getComputedStyle.call(e, t, n);
            var a = e.console;
            if (null !== o) r && (o = o.getPropertyValue(r));
            else if (a) {
                var s = a.error ? "error" : "log";
                a[s].call(a, "getComputedStyle returning null, its possible modernizr test results are inaccurate");
            }
        } else o = !n && t.currentStyle && t.currentStyle[r];
        return o;
    }

    function m(t, r) {
        var o = t.length;
        if ("CSS" in e && "supports" in e.CSS) {
            for (; o--; ) if (e.CSS.supports(g(t[o]), r)) return !0;
            return !1;
        }
        if ("CSSSupportsRule" in e) {
            for (var a = []; o--; ) a.push("(" + g(t[o]) + ":" + r + ")");
            return (
                (a = a.join(" or ")),
                u("@supports (" + a + ") { #modernizr { position: absolute; } }", function(e) {
                    return "absolute" == v(e, null, "position");
                })
            );
        }
        return n;
    }

    function h(e, t, o, a) {
        function d() {
            u && (delete U.style, delete U.modElem);
        }

        if (((a = r(a, "undefined") ? !1 : a), !r(o, "undefined"))) {
            var l = m(e, o);
            if (!r(l, "undefined")) return l;
        }
        for (var u, f, p, g, v, h = ["modernizr", "tspan", "samp"]; !U.style && h.length; ) (u = !0), (U.modElem = s(h.shift())), (U.style = U.modElem.style);
        for (p = e.length, f = 0; p > f; f++)
            if (((g = e[f]), (v = U.style[g]), i(g, "-") && (g = c(g)), U.style[g] !== n)) {
                if (a || r(o, "undefined")) return d(), "pfx" == t ? g : !0;
                try {
                    U.style[g] = o;
                } catch (y) {}
                if (U.style[g] != v) return d(), "pfx" == t ? g : !0;
            }
        return d(), !1;
    }

    function y(e, t, n, o, a) {
        var s = e.charAt(0).toUpperCase() + e.slice(1),
            i = (e + " " + q.join(s + " ") + s).split(" ");
        return r(t, "string") || r(t, "undefined") ? h(i, t, o, a) : ((i = (e + " " + W.join(s + " ") + s).split(" ")), p(i, t, n));
    }

    function b(e, t) {
        var n = e.deleteDatabase(t);
        (n.onsuccess = function() {
            d("indexeddb.deletedatabase", !0);
        }),
            (n.onerror = function() {
                d("indexeddb.deletedatabase", !1);
            });
    }

    function T(e, t, r) {
        return y(e, n, n, t, r);
    }

    var x = [],
        w = [],
        S = {
            _version: "3.6.0",
            _config: { classPrefix: "", enableClasses: !0, enableJSClass: !0, usePrefixes: !0 },
            _q: [],
            on: function(e, t) {
                var n = this;
                setTimeout(function() {
                    t(n[e]);
                }, 0);
            },
            addTest: function(e, t, n) {
                w.push({ name: e, fn: t, options: n });
            },
            addAsyncTest: function(e) {
                w.push({ name: null, fn: e });
            }
        },
        Modernizr = function() {};
    (Modernizr.prototype = S),
        (Modernizr = new Modernizr()),
        Modernizr.addTest("applicationcache", "applicationCache" in e),
        Modernizr.addTest("geolocation", "geolocation" in navigator),
        Modernizr.addTest("history", function() {
            var t = navigator.userAgent;
            return (-1 === t.indexOf("Android 2.") && -1 === t.indexOf("Android 4.0")) ||
                -1 === t.indexOf("Mobile Safari") ||
                -1 !== t.indexOf("Chrome") ||
                -1 !== t.indexOf("Windows Phone") ||
                "file:" === location.protocol
                ? e.history && "pushState" in e.history
                : !1;
        }),
        Modernizr.addTest("postmessage", "postMessage" in e),
        Modernizr.addTest("svg", !!t.createElementNS && !!t.createElementNS("http://www.w3.org/2000/svg", "svg").createSVGRect);
    var C = !1;
    try {
        C = "WebSocket" in e && 2 === e.WebSocket.CLOSING;
    } catch (_) {}
    Modernizr.addTest("websockets", C),
        Modernizr.addTest("localstorage", function() {
            var e = "modernizr";
            try {
                return localStorage.setItem(e, e), localStorage.removeItem(e), !0;
            } catch (t) {
                return !1;
            }
        }),
        Modernizr.addTest("sessionstorage", function() {
            var e = "modernizr";
            try {
                return sessionStorage.setItem(e, e), sessionStorage.removeItem(e), !0;
            } catch (t) {
                return !1;
            }
        }),
        Modernizr.addTest("websqldatabase", "openDatabase" in e),
        Modernizr.addTest("webworkers", "Worker" in e);
    var P = t.documentElement,
        k = "svg" === P.nodeName.toLowerCase();
    Modernizr.addTest("audio", function() {
        var e = s("audio"),
            t = !1;
        try {
            (t = !!e.canPlayType),
                t &&
                    ((t = new Boolean(t)),
                    (t.ogg = e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/, "")),
                    (t.mp3 = e.canPlayType('audio/mpeg; codecs="mp3"').replace(/^no$/, "")),
                    (t.opus = e.canPlayType('audio/ogg; codecs="opus"') || e.canPlayType('audio/webm; codecs="opus"').replace(/^no$/, "")),
                    (t.wav = e.canPlayType('audio/wav; codecs="1"').replace(/^no$/, "")),
                    (t.m4a = (e.canPlayType("audio/x-m4a;") || e.canPlayType("audio/aac;")).replace(/^no$/, "")));
        } catch (n) {}
        return t;
    }),
        Modernizr.addTest("canvas", function() {
            var e = s("canvas");
            return !(!e.getContext || !e.getContext("2d"));
        }),
        Modernizr.addTest("canvastext", function() {
            return Modernizr.canvas === !1 ? !1 : "function" == typeof s("canvas").getContext("2d").fillText;
        }),
        Modernizr.addTest("video", function() {
            var e = s("video"),
                t = !1;
            try {
                (t = !!e.canPlayType),
                    t &&
                        ((t = new Boolean(t)),
                        (t.ogg = e.canPlayType('video/ogg; codecs="theora"').replace(/^no$/, "")),
                        (t.h264 = e.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/, "")),
                        (t.webm = e.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/, "")),
                        (t.vp9 = e.canPlayType('video/webm; codecs="vp9"').replace(/^no$/, "")),
                        (t.hls = e.canPlayType('application/x-mpegURL; codecs="avc1.42E01E"').replace(/^no$/, "")));
            } catch (n) {}
            return t;
        }),
        Modernizr.addTest("multiplebgs", function() {
            var e = s("a").style;
            return (e.cssText = "background:url(https://),url(https://),red url(https://)"), /(url\s*\(.*?){3}/.test(e.background);
        }),
        Modernizr.addTest("rgba", function() {
            var e = s("a").style;
            return (e.cssText = "background-color:rgba(150,255,150,.5)"), ("" + e.backgroundColor).indexOf("rgba") > -1;
        }),
        Modernizr.addTest("inlinesvg", function() {
            var e = s("div");
            return (e.innerHTML = "<svg/>"), "http://www.w3.org/2000/svg" == ("undefined" != typeof SVGRect && e.firstChild && e.firstChild.namespaceURI);
        });
    var E = (function() {
        function e(e, t) {
            var o;
            return e
                ? ((t && "string" != typeof t) || (t = s(t || "div")),
                  (e = "on" + e),
                  (o = e in t),
                  !o && r && (t.setAttribute || (t = s("div")), t.setAttribute(e, ""), (o = "function" == typeof t[e]), t[e] !== n && (t[e] = n), t.removeAttribute(e)),
                  o)
                : !1;
        }

        var r = !("onblur" in t.documentElement);
        return e;
    })();
    (S.hasEvent = E),
        Modernizr.addTest("hashchange", function() {
            return E("hashchange", e) === !1 ? !1 : t.documentMode === n || t.documentMode > 7;
        }),
        Modernizr.addTest("webgl", function() {
            var t = s("canvas"),
                n = "probablySupportsContext" in t ? "probablySupportsContext" : "supportsContext";
            return n in t ? t[n]("webgl") || t[n]("experimental-webgl") : "WebGLRenderingContext" in e;
        });
    var z = s("input"),
        R = "autocomplete autofocus list placeholder max min multiple pattern required step".split(" "),
        A = {};
    Modernizr.input = (function(t) {
        for (var n = 0, r = t.length; r > n; n++) A[t[n]] = !!(t[n] in z);
        return A.list && (A.list = !(!s("datalist") || !e.HTMLDataListElement)), A;
    })(R);
    var O = S._config.usePrefixes ? " -webkit- -moz- -o- -ms- ".split(" ") : ["", ""];
    (S._prefixes = O),
        Modernizr.addTest("cssgradients", function() {
            for (var e, t = "background-image:", n = "gradient(linear,left top,right bottom,from(#9f9),to(white));", r = "", o = 0, a = O.length - 1; a > o; o++)
                (e = 0 === o ? "to " : ""), (r += t + O[o] + "linear-gradient(" + e + "left top, #9f9, white);");
            Modernizr._config.usePrefixes && (r += t + "-webkit-" + n);
            var i = s("a"),
                c = i.style;
            return (c.cssText = r), ("" + c.backgroundImage).indexOf("gradient") > -1;
        }),
        Modernizr.addTest("opacity", function() {
            var e = s("a").style;
            return (e.cssText = O.join("opacity:.55;")), /^0.55$/.test(e.opacity);
        }),
        Modernizr.addTest("hsla", function() {
            var e = s("a").style;
            return (e.cssText = "background-color:hsla(120,40%,100%,.5)"), i(e.backgroundColor, "rgba") || i(e.backgroundColor, "hsla");
        });
    var N = "CSS" in e && "supports" in e.CSS,
        L = "supportsCSS" in e;
    Modernizr.addTest("supports", N || L);
    var $ = {}.toString;
    Modernizr.addTest("svgclippaths", function() {
        return !!t.createElementNS && /SVGClipPath/.test($.call(t.createElementNS("http://www.w3.org/2000/svg", "clipPath")));
    }),
        Modernizr.addTest("smil", function() {
            return !!t.createElementNS && /SVGAnimate/.test($.call(t.createElementNS("http://www.w3.org/2000/svg", "animate")));
        });
    var B;
    !(function() {
        var e = {}.hasOwnProperty;
        B =
            r(e, "undefined") || r(e.call, "undefined")
                ? function(e, t) {
                      return t in e && r(e.constructor.prototype[t], "undefined");
                  }
                : function(t, n) {
                      return e.call(t, n);
                  };
    })(),
        (S._l = {}),
        (S.on = function(e, t) {
            this._l[e] || (this._l[e] = []),
                this._l[e].push(t),
                Modernizr.hasOwnProperty(e) &&
                    setTimeout(function() {
                        Modernizr._trigger(e, Modernizr[e]);
                    }, 0);
        }),
        (S._trigger = function(e, t) {
            if (this._l[e]) {
                var n = this._l[e];
                setTimeout(function() {
                    var e, r;
                    for (e = 0; e < n.length; e++) (r = n[e])(t);
                }, 0),
                    delete this._l[e];
            }
        }),
        Modernizr._q.push(function() {
            S.addTest = d;
        });
    var I = (S.testStyles = u);
    Modernizr.addTest("touchevents", function() {
        var n;
        if ("ontouchstart" in e || (e.DocumentTouch && t instanceof DocumentTouch)) n = !0;
        else {
            var r = ["@media (", O.join("touch-enabled),("), "heartz", ")", "{#modernizr{top:9px;position:absolute}}"].join("");
            I(r, function(e) {
                n = 9 === e.offsetTop;
            });
        }
        return n;
    });
    var j = (function() {
        var e = navigator.userAgent,
            t = e.match(/w(eb)?osbrowser/gi),
            n = e.match(/windows phone/gi) && e.match(/iemobile\/([0-9])+/gi) && parseFloat(RegExp.$1) >= 9;
        return t || n;
    })();
    j
        ? Modernizr.addTest("fontface", !1)
        : I('@font-face {font-family:"font";src:url("https://")}', function(e, n) {
              var r = t.getElementById("smodernizr"),
                  o = r.sheet || r.styleSheet,
                  a = o ? (o.cssRules && o.cssRules[0] ? o.cssRules[0].cssText : o.cssText || "") : "",
                  s = /src/i.test(a) && 0 === a.indexOf(n.split(" ")[0]);
              Modernizr.addTest("fontface", s);
          }),
        I('#modernizr{font:0/0 a}#modernizr:after{content:":)";visibility:hidden;font:7px/1 a}', function(e) {
            Modernizr.addTest("generatedcontent", e.offsetHeight >= 6);
        });
    var M = "Moz O ms Webkit",
        q = S._config.usePrefixes ? M.split(" ") : [];
    S._cssomPrefixes = q;
    var V = function(t) {
        var r,
            o = O.length,
            a = e.CSSRule;
        if ("undefined" == typeof a) return n;
        if (!t) return !1;
        if (((t = t.replace(/^@/, "")), (r = t.replace(/-/g, "_").toUpperCase() + "_RULE"), r in a)) return "@" + t;
        for (var s = 0; o > s; s++) {
            var i = O[s],
                c = i.toUpperCase() + "_" + r;
            if (c in a) return "@-" + i.toLowerCase() + "-" + t;
        }
        return !1;
    };
    S.atRule = V;
    var W = S._config.usePrefixes ? M.toLowerCase().split(" ") : [];
    S._domPrefixes = W;
    var G = { elem: s("modernizr") };
    Modernizr._q.push(function() {
        delete G.elem;
    });
    var U = { style: G.elem.style };
    Modernizr._q.unshift(function() {
        delete U.style;
    });
    var D = (S.testProp = function(e, t, r) {
        return h([e], n, t, r);
    });
    Modernizr.addTest("textshadow", D("textShadow", "1px 1px")), (S.testAllProps = y);
    var H = (S.prefixed = function(e, t, n) {
        return 0 === e.indexOf("@") ? V(e) : (-1 != e.indexOf("-") && (e = c(e)), t ? y(e, t, n) : y(e, "pfx"));
    });
    // this is commented out because it throws an error in iOS Safari
    // this may be fixed by adding event.preventDefault() in the o.onerror function
    // need to set up a proper iframe test environment

    // Modernizr.addAsyncTest(function () {
    //     var t;
    //     try {
    //         t = H("indexedDB", e)
    //     } catch (n) {
    //     }
    //     if (t) {
    //         var r = "modernizr-" + Math.random(), o = t.open(r);
    //         o.onerror = function () {
    //             o.error && "InvalidStateError" === o.error.name ? d("indexeddb", !1) : (d("indexeddb", !0), b(t, r))
    //         }, o.onsuccess = function () {
    //             d("indexeddb", !0), b(t, r)
    //         }
    //     } else d("indexeddb", !1)
    // }),
    (S.testAllProps = T),
        Modernizr.addTest("cssanimations", T("animationName", "a", !0)),
        Modernizr.addTest("backgroundsize", T("backgroundSize", "100%", !0)),
        Modernizr.addTest("borderimage", T("borderImage", "url() 1", !0)),
        Modernizr.addTest("borderradius", T("borderRadius", "0px", !0)),
        Modernizr.addTest("boxshadow", T("boxShadow", "1px 1px", !0)),
        (function() {
            Modernizr.addTest("csscolumns", function() {
                var e = !1,
                    t = T("columnCount");
                try {
                    (e = !!t), e && (e = new Boolean(e));
                } catch (n) {}
                return e;
            });
            for (
                var e, t, n = ["Width", "Span", "Fill", "Gap", "Rule", "RuleColor", "RuleStyle", "RuleWidth", "BreakBefore", "BreakAfter", "BreakInside"], r = 0;
                r < n.length;
                r++
            )
                (e = n[r].toLowerCase()),
                    (t = T("column" + n[r])),
                    ("breakbefore" === e || "breakafter" === e || "breakinside" == e) && (t = t || T(n[r])),
                    Modernizr.addTest("csscolumns." + e, t);
        })(),
        Modernizr.addTest("flexbox", T("flexBasis", "1px", !0)),
        Modernizr.addTest("cssreflections", T("boxReflect", "above", !0)),
        Modernizr.addTest("csstransforms", function() {
            return -1 === navigator.userAgent.indexOf("Android 2.") && T("transform", "scale(1)", !0);
        }),
        Modernizr.addTest("csstransforms3d", function() {
            return !!T("perspective", "1px", !0);
        }),
        Modernizr.addTest("csstransitions", T("transition", "all", !0)),
        o(),
        a(x),
        delete S.addTest,
        delete S.addAsyncTest;
    for (var F = 0; F < Modernizr._q.length; F++) Modernizr._q[F]();
    e.Modernizr = Modernizr;
})(window, document);
wwplayer.define(
    "modernizr",
    (function(global) {
        return function() {
            var ret, fn;
            return ret || global.Modernizr;
        };
    })(this)
);

wwplayer.define("VolumeController", ["jquery", "pubsub", "globals"], function($, PubSub, globals) {
    var volumeController = function(element, getVolumeFn, setVolumeFn, animationController) {
        var self = this;
        self.getVolumeFn = getVolumeFn;
        self.setVolumeFn = setVolumeFn;
        self.element = element;
        self.volumeBar = element.find("#volume-bar");
        self.volumeBarController = element;
        self.volumeBarControllerIcon = self.volumeBarController.find("#volume-bar-icon");
        self.volumeBarControllerMuteIcon = self.volumeBarController.find("#volume-mute-icon");
        //		self.volumeBottomBarIcon = self.element.find('#volume-bottombar-icon');
        self.movingVolume = false;
        self.opened = false;
        self.verticalOffset = 0;

        self.setVolume = function(volume, setPosition) {
            if (setPosition) {
                self.volumeBarControllerIcon.css("bottom", volume * self.volumeBar.height() + 15 - 5);
            }
            globals.VOLUME = volume;

            if (volume === 0) {
                self.volumeBarControllerIcon.find("#speaker").hide();
                self.volumeBarControllerIcon.find("#mute").show();
            } else {
                self.volumeBarControllerIcon.find("#speaker").show();
                self.volumeBarControllerIcon.find("#mute").hide();
            }

            self.setVolumeFn(volume);
        };

        self.open = function() {
            if (!self.minHeight) {
                self.minHeight = self.element.height();
            }
            if (!self.maxHeight) {
                self.maxHeight = self.element.css("max-height");
            }
            self.volumeBarControllerIcon.css("bottom", globals.VOLUME * (90 - 30) + 15 - 5);
            self.volumeBar.addClass("active");
            animationController.animateTo(self.element, 0.3, { height: parseInt(self.maxHeight) }, 0, "cubic-bezier(0.215, 0.610, 0.355, 1.000)");
            self.opened = true;
        };

        self.close = function() {
            self.volumeBar.removeClass("active");
            self.volumeBarControllerIcon.css("bottom", "");
            animationController.animateTo(self.element, 0.3, { height: self.minHeight }, 0.1, "cubic-bezier(0.550, 0.055, 0.675, 0.190)");
            self.opened = false;
        };

        self.toggle = function() {
            if (self.opened) {
                self.close();
            } else {
                self.open();
            }
        };

        $(self.element).bind("mouseenter", function(e) {
            self.open();
        });

        $(self.element).bind("mouseleave", function(e) {
            self.close();
        });

        $(self.element).bind("touchstart", function(e) {
            self.toggle();
        });

        $(self.element).bind("mousedown", function(e) {
            if (e.preventDefault) {
                e.preventDefault();
            } else {
                e.returnValue = false;
            }
            e.stopPropagation();

            if (self.opened && !self.movingVolume) {
                var elem = $(this);
                var y = (globals.IS_IE_8 ? e.clientY + document.body.scrollTop : e.pageY) - elem.offset().top;

                var fromBottom = elem.height() - y;
                var volumeBarHeight = self.volumeBar.height();

                if (fromBottom <= parseInt(self.volumeBar.css("bottom"))) {
                    self.setVolume(0, true);
                } else if (fromBottom > volumeBarHeight) {
                    self.setVolume(1, true);
                } else {
                    self.setVolume((fromBottom - parseInt(self.volumeBar.css("bottom"))) / volumeBarHeight, true);
                }
            }
        });

        $(self.volumeBarControllerIcon).bind("touchstart mousedown", function(event) {
            event.preventDefault();
            event.stopPropagation();
            if (self.opened) {
                self.movingVolume = true;
                $(self.volumeBarControllerIcon).addClass("moving");
                var e = event.originalEvent;
                if (e.changedTouches !== undefined) {
                    self.barTopOffset = e.changedTouches[0].pageY - $(self.volumeBarControllerIcon).offset().top;
                } else {
                    self.barTopOffset = (globals.IS_IE_8 ? e.clientY + document.body.scrollTop : e.pageY) - $(self.volumeBarControllerIcon).offset().top;
                }
            }
        });

        $(self.element).bind("touchmove mousemove", function(event) {
            if (self.movingVolume) {
                event.preventDefault();
                event.stopPropagation();
                var e = event.originalEvent;
                var posY;
                if (e.changedTouches !== undefined) {
                    posY = e.changedTouches[0].pageY - $(self.volumeBar).offset().top;
                } else {
                    posY = (globals.IS_IE_8 ? e.clientY + document.body.scrollTop : e.pageY) - $(self.volumeBar).offset().top;
                }
                var pixels = 60 - posY;

                pixels = Math.max(pixels, 0);
                pixels = Math.min(pixels, 60);
                $(self.volumeBarControllerIcon).css({
                    bottom: 10 + pixels
                });
                var volumePerPixel = 1 / 60;
                volume = volumePerPixel * pixels;
                self.setVolume(volume, false);
            }
        });

        $(self.volumeBarController).bind("touchend mouseup mouseleave", function(event) {
            if (self.movingVolume) {
                self.movingVolume = false;
                $(self.volumeBarControllerIcon).removeClass("moving");

                self.movingVolume = false;
                var e = event.originalEvent;

                var posY;
                if (e.changedTouches !== undefined) {
                    posY = e.changedTouches[0].pageY - $(self.volumeBar).offset().top;
                } else {
                    posY = (globals.IS_IE_8 ? e.clientY + document.body.scrollTop : e.pageY) - $(self.volumeBar).offset().top;
                }
                var pixels = 60 - posY;
                pixels = Math.max(pixels, 0);
                pixels = Math.min(pixels, 60);
                var volumePerPixel = 1 / 60;
                volume = volumePerPixel * pixels;
                self.setVolume(volume, false);
            }
        });

        PubSub.subscribe(globals.HAS_PLAYED, self.close);
        PubSub.subscribe(globals.HAS_VIDEO_CLICKED, self.close);
    };

    return volumeController;
});

/**
	@module ShareController
	@requires jquery, PubSub, globals, underscore, ApiService
**/
wwplayer.define("ShareController", ["jquery", "pubsub", "globals", "underscore", "apiService"], function($, PubSub, globals, _, apiService) {
    // Element generation should be moved to Skin

    /**
		wireWAX sharing buttons

		@class ShareController
		@constructor
		@param {Number} vidId
		@param {AnimationController} animationController
		@param {Function} getFrame
		@param {Function} getCurrentTime
	**/
    var shareController = function(element, vidId, animationController, getFrame, getCurrentTime, onShareButtonClick) {
        var self = this;

        if (!globals.WHITELABEL) {
            return;
        }

        /**
			Flag to check if the share buttons are currently visible
			@property showing
			@type Boolean
			@default false
		**/
        self.showing = false;

        /**
			The share controller element

			@property element
			@type HTMLElement
		**/
        self.element = $(element);

        var canvas = Raphael(self.element.find(".innerSvg")[0], 30, 30);
        canvas.setViewBox(0, 0, 31, 31, true);

        var path_a = canvas.path(
            "M22.8,10.9c0,1.5-1.2,2.7-2.7,2.7s-2.7-1.2-2.7-2.7s1.2-2.7,2.7-2.7S22.8,9.4,22.8,10.9z M10.9,12.9 c-1.5,0-2.7,1.2-2.7,2.7s1.2,2.7,2.7,2.7s2.7-1.2,2.7-2.7S12.3,12.9,10.9,12.9z M20,17.4c-1.5,0-2.7,1.2-2.7,2.7s1.2,2.7,2.7,2.7 s2.7-1.2,2.7-2.7S21.5,17.4,20,17.4z M10.9,15.6l9.2-4.7 M11.4,15.4l9.3,4.6"
        );
        path_a.attr({ fill: window.wirewax.colour, "stroke-width": "0", "stroke-opacity": "1" }).data("id", "path_a");

        self.invertShareIcon = function() {
            path_a.attr({ fill: globals.BUTTON_BACKGROUND_COLOR });
        };

        self.revertShareIcon = function() {
            path_a.attr({ fill: window.wirewax.colour });
        };

        /**
			The facebook share button

			@property fbElement
			@type HTMLElement
		**/
        self.fbElement = self.element.find("#fb-share");
        self.fbElement.bind(globals.CLICK_EVENT, function() {
            PubSub.publish(globals.DO_PAUSE);
            // var link = apiService.generateShareLink('fb', getFrame(), getCurrentTime());
            // window.open(link,'facebook_share_dialog','width=626,height=436');
            apiService.widgetShareClick("fb", window.wirewax.embedLoc, window.wirewax.embedLoc, null, null);

            PubSub.publish(globals.UI_EVENT, { eventName: "facebook", eventId: 19 });
            return false;
        });

        /**
			The twitter share button

			@property twElement
			@type HTMLElement
		**/
        self.twElement = self.element.find("#tw-share");
        self.twElement.bind(globals.CLICK_EVENT, function() {
            PubSub.publish(globals.DO_PAUSE);
            // window.open(
            // 	apiService.generateShareLink('tw', getFrame(), getCurrentTime()),
            // 	'twitter_share_dialog',
            // 	'width=626,height=436');
            apiService.widgetShareClick("tw", window.wirewax.embedLoc, window.wirewax.embedLoc, null, null);
            PubSub.publish(globals.UI_EVENT, { eventName: "twitter", eventId: 20 });
            return false;
        });

        /**
			The google plus share button

			@property gpElement
			@type HTMLElement
		**/
        self.gpElement = self.element.find("#gp-share");
        self.gpElement.bind(globals.CLICK_EVENT, function() {
            PubSub.publish(globals.DO_PAUSE);
            // window.open(
            // 	apiService.generateShareLink('gp', getFrame(), getCurrentTime()),
            // 	'google_plus_share_dialog',
            // 	'width=626,height=436');
            apiService.widgetShareClick("gp", window.wirewax.embedLoc, window.wirewax.embedLoc, null, null);
            PubSub.publish(globals.UI_EVENT, { eventName: "googleplus", eventId: 21 });
            return false;
        });

        self.moreElement = self.element.find("#more-share");
        self.moreElement.bind(globals.CLICK_EVENT, onShareButtonClick);

        /**
			The share button

			@property shareButton
			@type HTMLElement
		**/
        self.shareButton = self.element.find("#bottom-bar-share-button");

        /**
			Shows the share buttons

			@method show
		**/
        self.show = function() {
            if (!self.showing) {
                PubSub.publish(globals.UI_EVENT, { eventName: "socialShareButton", eventId: 14 });
                self.shareButton.addClass("hover-effect");
                self.invertShareIcon();
                $(self.element)
                    .find(".share-icon")
                    .addClass("show");
                self.showing = true;
            }
        };

        /**
			Hides the share buttons

			@method hide
		**/
        self.hide = function() {
            if (self.showing) {
                self.shareButton.removeClass("hover-effect");
                self.revertShareIcon();
                $(self.element)
                    .find(".share-icon")
                    .removeClass("show");
                self.showing = false;
            }
        };

        /**
			Inverts the share icons colors on hover

			@method invertIcon
		**/
        self.invertIcon = function() {
            $(this)
                .find(".icon")
                .toggle();
            $(this)
                .find(".invert-icon")
                .toggle();
        };

        PubSub.subscribe(globals.HAS_PLAYED, self.hide);
        PubSub.subscribe(globals.HAS_VIDEO_CLICKED, self.hide);

        self.fbElement.bind("mouseenter mouseleave", self.invertIcon);
        self.twElement.bind("mouseenter mouseleave", self.invertIcon);
        self.gpElement.bind("mouseenter mouseleave", self.invertIcon);
        self.moreElement.bind("mouseenter mouseleave", self.invertIcon);

        if (globals.CLICK_EVENT === "click" && !globals.IS_WINDOWS_PHONE) {
            self.shareButton.bind("mouseenter", self.show);
            self.element.bind("mouseleave", self.hide);
            self.shareButton.bind(globals.CLICK_EVENT, onShareButtonClick);
        } else if (globals.IS_WINDOWS_PHONE) {
            //windows phone doesn't do touch events, but needs equivalent of hover crap. pile of shit cockmunchers.
            self.shareButton.bind("click", function() {
                if (self.showing) {
                    self.hide();
                } else {
                    self.show();
                }
            });
        } else {
            self.shareButton.bind("touchstart", function() {
                if (self.showing) {
                    self.hide();
                } else {
                    self.show();
                }
            });
        }
    };

    return shareController;
});

wwplayer.define("Suspender", ["pubsub", "globals", "jquery"], function(PubSub, globals, $) {
    var Suspender = function(player) {
        var self = this;
        self.player = player;

        if (!player || globals.IS_IE_8 || globals.IS_IE_9) {
            return;
        }

        self.handleVisibilityChange = function() {
            if (self.hidden !== "undefined") {
                if (document[self.hidden]) {
                    self.suspend();
                } else {
                    self.wake();
                }
            }
        };

        self.pausedOnSleep = false;

        self.suspend = function() {
            if (!self.player.paused()) {
                if(window.wirewax.player !== "pdk5"){
                    PubSub.publish(globals.DO_PAUSE, {origin: "suspend"});
                }
                self.pauseAtFrame = player.getFrame();
                self.pausedOnSleep = true;
            } else {
                self.pausedOnSleep = false;
            }
        };

        self.wake = function() {
            //NOTE: safari on desktop fires the visibilityChange twice, once saying the document is hidden and another saying the document is visible
            if ((globals.IS_IPHONE || globals.IS_IPAD || globals.IS_SAFARI || globals.PLAY_ON_WAKE) && self.pausedOnSleep) {
                globals.PLAY_FUNCTION();
            }
            // DO NOTHING FOR NOW
        };
        //create listeners for loss of focus/visibility
        self.target = document;
        if (typeof document.hidden !== "undefined") {
            self.hidden = "hidden";
            self.visibilityChange = "visibilitychange";
        } else if (typeof document.mozHidden !== "undefined") {
            self.hidden = "mozHidden";
            self.visibilityChange = "mozvisibilitychange";
        } else if (typeof document.msHidden !== "undefined") {
            self.hidden = "msHidden";
            self.visibilityChange = "msvisibilitychange";
        } else if (typeof document.webkitHidden !== "undefined") {
            self.hidden = "webkitHidden";
            self.visibilityChange = "webkitvisibilitychange";
        } else if (typeof document.onfocus !== "undefined") {
            self.focus = "focusin";
            self.blur = "focusout";
        } else if (typeof document.onfocusin !== "undefined") {
            self.focus = "focus";
            self.blur = "blur";
        } else if (typeof window.onpageshow !== "undefined") {
            self.target = window;
            self.focus = "pageshow";
            self.blur = "pagehide";
        }
        if (self.visibilityChange) {
            self.target.addEventListener(self.visibilityChange, self.handleVisibilityChange, false);
        } else if (self.blur) {
            self.target.addEventListener(self.blur, self.suspend, false);
            self.target.addEventListener(self.focus, self.wake, false);
        }
    };
    return Suspender;
});
wwplayer.define("InterfaceController", ["jquery", "modernizr", "pubsub", "globals", "VolumeController", "ShareController", "LogEvent", "Suspender", "underscore"], function(
    $,
    Modernizr,
    PubSub,
    globals,
    VolumeController,
    ShareController,
    LogEvent,
    Suspender,
    _
) {
    var InterfaceController = function(videoElementContainer, vidId, videoData) {
        var self = this;
        init();
        function init() {
            self.videoElementContainer = videoElementContainer;

            if (globals.INNOVID_EVENTS) {
                $(self.videoElementContainer).hide();
            }

            self.waxxer = $('<div id="waxxer"></div>');

            self.tagOverlay = $('<div id="tag-overlay"></div>');
            self.widgetOverlay = $('<div id="widget-overlay"></div>');
            self.controlOverlay = $('<div id="control-overlay"></div>');
            self.fontOverlay = $('<div id="font-overlay"></div>');
            self.shareOverlay = $('<div id="share-overlay"></div>');
            self.timecodeCoverOverlay = $('<div id="timecode-cover-overlay"></div>');

            self.waxxer
                .append(self.widgetOverlay)
                .append(self.tagOverlay)
                .append(self.controlOverlay)
                .append(self.fontOverlay)
                .append(self.shareOverlay)
                .append(self.timecodeCoverOverlay);

            if (globals.VR_ENABLED) {
                self.tagOverlayDuplicate = $('<div id="tag-overlay-duplicate"></div>');
                self.waxxer.append(self.tagOverlayDuplicate);
                self.waxxer.find("#tag-overlay, #tag-overlay-duplicate").append('<div class="vr-target"></div>');
            }

            $(self.videoElementContainer).append(self.waxxer);
            self.overlays = [self.tagOverlay, self.controlOverlay, self.widgetOverlay, self.fontOverlay, self.shareOverlay, self.timecodeCoverOverlay];

            globals.OVERLAY_WIDTH = $(self.tagOverlay).width();
            globals.OVERLAY_HEIGHT = $(self.tagOverlay).height();
            self.disableKeyBindings = false;
        }

        self.addLoader = function(loader) {
            $(self.waxxer).append(self.loader.element);
            self.loader.show(window.wirewax.clearLoaders);
            $(self.videoElementContainer).append(self.waxxer);
            PubSub.subscribe(globals.HIDE_LOADER, self.hideLoader);
        };

        self.loadSkin = function(Skin) {
            // There might be a race condition here that needs to be fixed, elements being drawn before the css has loaded
            self.skin = new Skin(self.controlOverlay, videoData);
            self.skin.apply();

            self.userMessage = self.skin.getUserMessage();
            self.controlOverlay.append(self.userMessage.element);

            self.loader = self.skin.getLoader();
            self.addLoader(self.loader);
        };

        self.bindResizeEvents = function() {
            var resizeFunction = function() {
                if (self.isFullscreen()) {
                    self.resizeInterface(true);
                } else {
                    self.resizeInterface();
                }
            };

            PubSub.subscribe(globals.WINDOW_RESIZE, function() {
                resizeFunction();
            });

            $(window).resize(function() {
                resizeFunction();
            });

            if (globals.VIDEOELEMENT_SIZE_CHECK) {
                var oldHeight = $(self.videoElementContainer).height();
                var oldWidth = $(self.videoElementContainer).width();
                window.setInterval(function() {
                    var height = $(self.videoElementContainer).height();
                    var width = $(self.videoElementContainer).width();

                    if (oldHeight !== height || oldWidth !== width) {
                        resizeFunction();
                        oldHeight = height;
                        oldWidth = width;
                    }
                }, 2000);
            }
        };

        self.bindPlayerEvents = function() {
            PubSub.subscribe(globals.ENABLE_AUDIO, self.hideDisabledAudioIcon);
            PubSub.subscribe(globals.SHOW_LOADER, self.showLoader);
            PubSub.subscribe(globals.SHOW_LOADER_TRANSPARENT, self.showLoaderTransparent);
            PubSub.subscribe(globals.VIDEO_READY, function() {
                globals.LOG("received video ready in interface controller");
                self.videoReady = true;
                if (self.animationsReady) {
                    globals.LOG("animations ready");
                    self.ready();
                } else {
                    globals.LOG("animations not ready");
                }
            });

            PubSub.subscribe(globals.VIDEO_BUFFERING, function() {
                self.videoReady = false;
                globals.LOG("video buffering");
                var currentTime = self.player.getCurrentTime();
                if (globals.SHOW_THROBBER_ON_BUFFER && currentTime > 1) {
                    self.showLoader();
                }
            });

            PubSub.subscribe(globals.ANIMATIONS_READY, function() {
                globals.LOG("animations now ready!");
                self.animationsReady = true;

                if (self.videoReady) {
                    self.ready();
                }
            });

            PubSub.subscribe(globals.HAS_PLAYED, function(eventName, eventData) {
                self.tagOverlay.show();
                if (!globals.LITE_VERSION && !eventData.hideIcon) {
                    self.playButton.flashIn();
                } else {
                    self.playButton.hide();
                }

                if (self.bottomBarPlayButton && self.bottomBarPauseButton) {
                    self.bottomBarPlayButton.hide();
                    self.bottomBarPauseButton.show();
                }

                if (globals.AUDIO_DISABLED && globals.SHOW_DISABLED_AUDIO_ICON) {
                    self.disabledAudioIcon && self.disabledAudioIcon.show();
                }
            });

            // TODO fix this flashIn bullshit, no idea how it works
            PubSub.subscribe(globals.DO_PAUSE, function(eventName, eventData) {
                self.flashInPause = !globals.LITE_VERSION;
                if (eventData && eventData.flashIn === false) {
                    self.flashInPause = false;
                }
            });

            PubSub.subscribe(globals.HAS_PAUSED, function(eventName, eventData) {
                if (self.bottomBarPlayButton && self.bottomBarPauseButton) {
                    self.bottomBarPlayButton.show();
                    self.bottomBarPauseButton.hide();
                }

                if (!self.hasOwnPauseButton && (self.flashInPause === undefined || self.flashInPause === true) && !eventData.hideIcon) {
                    self.pauseButton.flashIn();
                }

                self.flashInPause = undefined;
            });

            PubSub.subscribe(globals.SHOW_WIDGET, self.showWidget);
            PubSub.subscribe(globals.WIDGET_CLOSED, self.postWidgetClose);
            PubSub.subscribe(globals.VIDEO_END, self.onVideoEnd);
            PubSub.subscribe(globals.OPEN_SHARE_SCREEN, function() {
                if (!globals.IS_IE_8) {
                    PubSub.publish(globals.DO_PAUSE);
                    self.shareOverlay.show();
                    self.shareScreen.show(!self.player.paused());

                    if (globals.HIDE_SCRUBBER) {
                        if (self.scrubber) {
                            $(self.scrubber.scrubberBar).hide();
                        }
                    } else {
                        $(self.scrubber.scrubberBar).addClass("greyed-out");
                    }

                    PubSub.publish(globals.UI_EVENT, { eventName: "shareTool", eventId: 14 });
                }
            });
        };

        self.addConsole = function() {
            self.waxConsole = self.skin.getWaxConsole(self.player);

            if (self.waxConsole) {
                self.waxConsole.init();
                $(self.controlOverlay).append(self.waxConsole.element);
            }
        };

        self.addCenterButtons = function() {
            self.playButton = self.skin.getPlayButton();
            self.pauseButton = self.skin.getPauseButton();
            if (!globals.NO_CENTER_BUTTONS) {
                $(self.controlOverlay)
                    .append(self.playButton.element)
                    .append(self.pauseButton.element);
            }
        };

        self.addOverlayButtons = function(player) {
            var overlayButtons = self.skin.getOverlayButtons(player);

            _.each(overlayButtons, function(button) {
                if (button) {
                    $(self.controlOverlay).append(button.element);
                }
            });
        };

        self.addLogo = function() {
            self.logo = self.skin.getLogo();
            if (self.logo) {
                $(self.controlOverlay).append($(self.logo.element));
            }
        };

        self.addStartOverlay = function() {
            self.startOverlay = self.skin.getStartOverlay();
            if (self.startOverlay) {
                $(self.controlOverlay).append($(self.startOverlay.element));
            }
        };

        self.addScrubber = function(player, animationController) {
            var scrubber = self.createScrubberRefactored(self.skin, player, animationController);
            if (scrubber && scrubber.scrubberBar) {
                $(self.controlOverlay).append($(scrubber.scrubberBar));
            }
        };

        function bindVideoClickEvents() {
            if (!self.videoClickEventsBound) {
                //TODO: jose we need to deal with the double click too
                $(self.tagOverlay).bind(globals.CLICK_EVENT, function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    if (!globals.PREVENT_VIDEO_CLICK) {
                        globals.PLAY_PAUSE_FUNCTION(e);
                    }
                });
                if (globals.VR_ENABLED) {
                    $(self.tagOverlayDuplicate).bind(globals.CLICK_EVENT, function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        if (!globals.PREVENT_VIDEO_CLICK) {
                            globals.PLAY_PAUSE_FUNCTION(e);
                        }
                    });
                }

                // IE10 DOESN'T PROPOGATE EVENT CORRECTLY, ALL CLICKS ARE HANDLED BY THE VIDEO
                //TODO: jose we need to deal with the double click too
                $(self.videoElement).bind(globals.CLICK_EVENT, function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    if (!globals.PREVENT_VIDEO_CLICK) {
                        globals.PLAY_PAUSE_FUNCTION(e);
                    }
                });
                self.videoClickEventsBound = true;
            }
        }

        function windowClickListener() {
            PubSub.publishSync(globals.ENABLE_AUDIO);
            // Only do this once
            window.removeEventListener(globals.CLICK_EVENT, windowClickListener, true);
        }

        function onEnableAudio() {
            globals.LOG("Audio is now enabled, binding the remaining click events");
            // Only do this once
            PubSub.unsubscribe(enableAudioSubscription);
            // This must be called async as we're still in an event handler and if called immediately the handlers added
            // will immediately be called, pausing the video. In the future we should use window.requestIdleCallback
            setTimeout(bindVideoClickEvents, 1);
            // Stop listening for window click, as audio is enabled now.
            window.removeEventListener(globals.CLICK_EVENT, windowClickListener, true);
        }

        // need this so we can cancel the subscription in onEnableAudio.
        var enableAudioSubscription;

        self.bindVideoInteractionEvents = function() {
            self.videoClickEventsBound = false;
            $(self.tagOverlay).bind("touchmove", function(e) {
                if (globals.PREVENT_SCROLL) {
                    e.preventDefault();
                    e.stopPropagation();
                    return false;
                } else {
                    return true;
                }
            });

            if (globals.AUDIO_DISABLED) {
                globals.LOG("Audio is disabled, so adding click handler to window");

                // bind windowClickListener to the mute icon as that will enable audio. Also bind videoClickEvents
                // so clicking on the video with play/pause but not unmute.
                if (
                    (self.scrubber && globals.AUTOPLAY && globals.IS_DESKTOP && globals.IS_CHROME && globals.IS_CHROME_VERSION >= 66) ||
                    (self.scrubber && globals.AUTOPLAY && globals.IS_DESKTOP && globals.IS_SAFARI && globals.IS_SAFARI_VERSION >= 11)
                ) {
                    self.disabledAudioIcon[0].addEventListener(globals.CLICK_EVENT, windowClickListener, true);
                    bindVideoClickEvents();
                } else {
                    window.addEventListener(globals.CLICK_EVENT, windowClickListener, true);
                }
                enableAudioSubscription = PubSub.subscribe(globals.ENABLE_AUDIO, onEnableAudio);
            } else {
                globals.LOG("Audio not disabled, so adding click handler to tag overlay");
                bindVideoClickEvents();
            }

            var keydownEvent = _.throttle(function(event) {
                // TODO: This is to prevent a bug in studio where the keydown event propagation can't be stopped
                // There has to be a better way to do this
                if (window.wirewax.preventKeyPress) {
                    return;
                }

                if (event.which === 32 && !globals.DISABLE_SPACE_BAR_PLAY) {
                    globals.PLAY_PAUSE_FUNCTION();
                    // Need to publish sync because otherwise mobile browsers do not count the function call as being user initiated
                    PubSub.publishSync(globals.ENABLE_AUDIO);
                }

                if (!self.disableKeyBindings) {
                    if (event.which === 75) {
                        globals.PLAY_PAUSE_FUNCTION();
                        // Need to publish sync because otherwise mobile browsers do not count the function call as being user initiated
                        PubSub.publishSync(globals.ENABLE_AUDIO);
                    }

                    if (event.which === 74) {
                        PubSub.publish(globals.GO_TO_PREV_CLIP);
                    }

                    if (event.which === 76) {
                        PubSub.publish(globals.GO_TO_NEXT_CLIP);
                    }
                }

                if (event.which === 37) {
                    if (self.player) {
                        self.player.frameBack();
                    }
                }

                if (event.which === 39) {
                    if (self.player) {
                        self.player.frameForward();
                    }
                }
            }, 300);

            if (document.addEventListener) {
                document.addEventListener("keydown", keydownEvent);
            }
        };

        self.createScrubberRefactored = function(skin, player, animationController) {
            self.scrubber = self.skin.getScrubber();
            if (self.scrubberDisabled) {
                self.scrubber.disableScrubber();
            }

            if (self.scrubber) {
                var bottomBarButtons = self.skin.getBottomBarElements(player);
                self.bottomBarPlayButton = self.skin.getBottomBarPlayButton();
                self.bottomBarPauseButton = self.skin.getBottomBarPauseButton();
                self.disabledAudioIcon = self.skin.getDisabledAudioIcon();

                self.scrubber.scrubberBar.prepend(self.bottomBarPlayButton.element);
                self.scrubber.scrubberBar.prepend(self.bottomBarPauseButton.element);

                _.each(bottomBarButtons, function(button) {
                    if (button) {
                        self.scrubber.scrubberBar.append(button.element);
                    }
                });

                if (self.disabledAudioIcon && globals.SHOW_DISABLED_AUDIO_ICON) {
                    self.controlOverlay.append(self.disabledAudioIcon);
                }

                self.shareScreen = self.skin.getShareScreen(function() {
                    var wasPlaying = self.shareScreen.hide();
                    window.setTimeout(function() {
                        self.shareOverlay.hide();
                        self.scrubber.scrubberBar.show();
                        self.scrubber.scrubberBar.removeClass("greyed-out");

                        if (wasPlaying) {
                            globals.PLAY_FUNCTION();
                        }
                    }, 300);
                });
                self.shareOverlay.append(self.shareScreen.element);
            }

            return self.scrubber;
        };

        self.createScrubber = function(skin, player, animationController) {
            self.scrubber = self.skin.getScrubber();

            if (self.scrubberDisabled) {
                self.scrubber.disableScrubber();
            }

            self.bottomBarPlayButton = self.skin.getBottomBarPlayButton();
            self.bottomBarPauseButton = self.skin.getBottomBarPauseButton();

            if (!globals.IS_IE_8) {
                globals.LOG("adding rendition and fullscreen");
                self.bottomBarFullscreenButton = self.skin.getBottomBarFullscreenButton();
                self.bottomBarRenditionController = self.skin.getBottomBarRenditionController();
                self.bottomBarSubtitleController = self.skin.getBottomBarSubtitleController(player.getAvailableSubtitles(), player.switchSubtitles, player, videoData);
            }
            self.volumeControllerElement = self.skin.getVolumeControllerElement();
            self.shareControllerElement = self.skin.getShareControllerElement();

            if (self.scrubber) {
                if (self.bottomBarPlayButton) {
                    self.scrubber.scrubberBar.prepend(self.bottomBarPlayButton.element);
                }

                if (self.bottomBarPauseButton) {
                    self.scrubber.scrubberBar.prepend(self.bottomBarPauseButton.element);
                }

                if (self.bottomBarRenditionController && !player.disableRenditionController) {
                    self.scrubber.scrubberBar.prepend(self.bottomBarRenditionController.element);
                }

                if (self.bottomBarSubtitleController && player.hasSubtitles && globals.HAS_SUBTITLES) {
                    self.scrubber.scrubberBar.prepend(self.bottomBarSubtitleController.element);
                    globals.DISABLE_CC = false;
                }

                if (self.volumeControllerElement && !player.disableVolumeController) {
                    self.volumeController = new VolumeController(self.volumeControllerElement, self.player.getVolume, self.player.setVolume, animationController);
                    self.scrubber.scrubberBar.prepend(self.volumeController.element);
                }

                if (self.shareControllerElement && !globals.DISABLE_SHARES) {
                    self.shareScreen = self.skin.getShareScreen(function() {
                        var wasPlaying = self.shareScreen.hide();
                        window.setTimeout(function() {
                            self.shareOverlay.hide();
                            self.scrubber.scrubberBar.show();
                            self.scrubber.scrubberBar.removeClass("greyed-out");

                            if (wasPlaying) {
                                globals.PLAY_FUNCTION();
                            }
                        }, 300);
                    });
                    self.shareOverlay.append(self.shareScreen.element);

                    self.shareController = new ShareController(self.shareControllerElement, vidId, animationController, player.getFrame, player.getCurrentTime, function() {
                        PubSub.publish(globals.OPEN_SHARE_SCREEN);
                    });
                    self.scrubber.scrubberBar.prepend(self.shareController.element);
                } else {
                    self.scrubber.scrubberBar.addClass("no-share");
                }

                if (self.bottomBarFullscreenButton && !globals.DISABLE_FULLSCREEN) {
                    $(self.bottomBarFullscreenButton.element).bind(globals.CLICK_EVENT, function(e) {
                        self.toggleFullscreen(self.videoElementContainer);
                    });
                    self.scrubber.scrubberBar.prepend(self.bottomBarFullscreenButton.element);
                }
            }

            return self.scrubber;
        };

        self.createInterface = function(videoElement, player, animationController, imageMode) {
            globals.LOG("created interface with", videoElement, player);
            self.videoElement = videoElement;
            self.player = player;
            self.animationController = animationController;
            self.skin.setAnimationController(animationController);

            self.addStartOverlay();
            self.addLogo();
            self.addCenterButtons();
            self.addConsole();

            if (globals.IS_STACKED) {
                $(self.videoElement).wrap($('<div id="stacked-video-wrapper"></div>'));
                //needed for for split audio manipulation
                self.videoElement.crossOrigin = "anonymous";
                self.overlays.push($("#stacked-video-wrapper"));
                self.resizeInterface(false);
            }

            // TODO - This should be temporary while we port over all the old skins to the new method
            if (self.skin.refactored) {
                self.addOverlayButtons(player);
                if (!imageMode) {
                    self.addScrubber(player);
                } else {
                    self.shareScreen = self.skin.getShareScreen(function() {
                        window.setTimeout(function() {
                            self.shareOverlay.hide();
                        }, 300);
                    });
                    self.shareOverlay.append(self.shareScreen.element);
                }
            } else {
                var scrubber = self.createScrubber(self.skin, player, animationController);
                if (scrubber && scrubber.scrubberBar) {
                    $(self.controlOverlay).append($(scrubber.scrubberBar));
                }
            }

            if (!window.wirewax.writer) {
                self.suspender = new Suspender(self.player);
            }

            self.resizeInterface();
            self.bindPlayerEvents();
            self.bindResizeEvents();
            self.skin.applyBindings();
        };

        self.addTagsToScrubberBar = function(tags) {
            _.chain(tags)
                .groupBy(function(tag) {
                    return tag.staticClipIndex ? tag.staticClipIndex : tag.clipIndex;
                })
                .each(function(tagArray, index) {
                    if (self.scrubber && self.scrubber.addTag) {
                        self.scrubber.addTag(tagArray, index);
                    }
                });
        };

        self.addOverlay = function(overlayName) {
            $("#waxxer").append('<div id="' + overlayName + '"></div>');
            var overlay = self.getOverlay(overlayName);
            self.setOverlayDimensions(self.videoElementContainer, overlay);
            self.overlays.push(overlay);

            return overlay;
        };

        self.getOverlay = function(overlayName) {
            return $("#waxxer #" + overlayName);
        };

        self.addTimelineMarker = function(time, marker) {
            if (self.scrubber) {
                self.scrubber.addTimelineMarker(marker);
            }
        };

        self.getVideoElement = function() {
            return self.videoElement;
        };

        self.onVideoEnd = function() {
            if (self.bottomBarPlayButton && self.bottomBarPauseButton) {
                self.bottomBarPlayButton.show();
                self.bottomBarPauseButton.hide();
            }
        };

        self.disableScrubber = function() {
            if (self.scrubber) {
                self.scrubber.disableScrubber();
            } else {
                self.scrubberDisabled = true;
            }
        };

        self.resizeInterface = function(goingFullscreen) {
            globals.LOG("resizing interface", self.overlays);
            self.resized = true;

            //Note jose: i suspect we had this for old iphones when they were slow so we had a bigger timout
            // var resizeTimeout = globals.IS_IPHONE ? 100 : 10;
            var resizeTimeout = 10;

            window.setTimeout(function() {
                self.player.onResize(0, 0);
                if (globals.VR_ENABLED) {
                    _.each([self.controlOverlay, self.widgetOverlay, self.fontOverlay, self.shareOverlay, self.timecodeCoverOverlay], function(overlay) {
                        $(overlay)
                            .css("height", "100%")
                            .css("width", "100%")
                            .css("top", 0)
                            .css("left", 0);
                    });
                    self.tagOverlay.css({
                        height: "100%",
                        width: "50%",
                        top: 0,
                        left: 0,
                        "margin-left": 0,
                        "margin-top": 0
                    });
                    self.tagOverlayDuplicate.css({
                        height: "100%",
                        width: "50%",
                        top: 0,
                        right: 0,
                        "margin-left": 0,
                        "margin-top": 0
                    });
                } else if (!window.wirewax.fullBleed) {
                    _.each(self.overlays, function(overlay) {
                        self.setOverlayDimensions(self.videoElementContainer, overlay, goingFullscreen);
                    });

                    if (!self.player.preventVideoResize) {
                        self.setOverlayDimensions(self.videoElementContainer, self.videoElement, goingFullscreen);
                    }
                    if (globals.IS_STACKED) {
                        $(self.videoElement)
                            .height($(self.videoElement).height() * 2)
                            .css({ top: 0, left: 0 });
                    }
                } else {
                    var normalDimentionsElements = [self.widgetOverlay];
                    var fullbleedElements = [self.tagOverlay, self.videoElement, self.timecodeCoverOverlay];

                    if (globals.ENABLE_OVERLAY_FULL_BLEED) {
                        normalDimentionsElements = [];
                        fullbleedElements = [self.tagOverlay, self.videoElement, self.widgetOverlay];
                    }
                    _.each(normalDimentionsElements, function(overlay) {
                        self.setOverlayDimensions(self.videoElementContainer, overlay, goingFullscreen);
                    });

                    _.each([self.shareOverlay, self.controlOverlay], function(overlay) {
                        $(overlay).css({
                            width: "100%",
                            height: "100%",
                            top: 0,
                            left: 0
                        });
                    });

                    $(self.videoElementContainer).css({
                        overflow: "hidden"
                    });

                    _.each(fullbleedElements, function(element) {
                        self.setFullbleedDimentions(element);
                    });
                }

                var IDEAL_FONT_SIZE = 13.5;
                var IDEAL_PLAYER_WIDTH = 1920;
                var IDEAL_PLAYER_HEIGHT = (IDEAL_PLAYER_WIDTH * globals.ASPECT_RATIO_HEIGHT) / globals.ASPECT_RATIO_WIDTH;

                var referenceElement = self.videoElementContainer;
                if (!globals.SMOOTH_FONT_STEPS && self.videoElement) {
                    referenceElement = self.videoElement;
                }
                if (self.player.forceVideoElementContainerAsResizeReference) {
                    referenceElement = self.videoElementContainer;
                }

                var fontSizeFactor = Math.min($(referenceElement).width() / IDEAL_PLAYER_WIDTH, $(referenceElement).height() / IDEAL_PLAYER_HEIGHT);
                if (globals.IS_STACKED) {
                    fontSizeFactor = Math.min($(referenceElement).width() / IDEAL_PLAYER_WIDTH, $(referenceElement).height() / 2 / IDEAL_PLAYER_HEIGHT);
                }

                if (window.wirewax.fullBleed) {
                    if (globals.IS_IPHONE && !globals.IS_CHROME) {
                        referenceElement = self.videoElement;
                    }
                    fontSizeFactor = Math.min($(referenceElement).width() / IDEAL_PLAYER_WIDTH, $(referenceElement).height() / IDEAL_PLAYER_HEIGHT);
                }
                var wantedFontSize = IDEAL_FONT_SIZE * fontSizeFactor;

                if (window.wirewax.player !== "amazonPlayer" && window.wirewax.player !== "newbcp" && window.wirewax.player !== "flowPlayer") {
                    if (globals.SMOOTH_FONT_STEPS) {
                        wantedFontSize = parseInt(wantedFontSize);
                    }
                    $(self.videoElementContainer).css("font-size", wantedFontSize + "px");
                } else {
                    // Brightcove and Amazon
                    $("#waxxer").css("font-size", wantedFontSize + "px");
                }

                globals.OVERLAY_WIDTH = $(self.tagOverlay).width();
                globals.OVERLAY_HEIGHT = $(self.tagOverlay).height();
                self.player.onResize(globals.OVERLAY_WIDTH, globals.OVERLAY_HEIGHT);
            }, resizeTimeout);
        };

        self.ready = function() {
            globals.LOG("interface controller ready");

            if (globals.DISABLE_FULLSCREEN && self.bottomBarFullscreenButton) {
                if (self.skin.removeFullScreenButton) {
                    self.skin.removeFullScreenButton();
                } else {
                    $(self.bottomBarFullscreenButton.element).unbind(globals.CLICK_EVENT);
                    $(self.bottomBarFullscreenButton.element)
                        .find(".tooltip-container")
                        .remove();
                    $(self.bottomBarFullscreenButton.element).append(
                        '<div style="z-index: 1000; position: absolute; top: 0; left: 0; height: 100%; width: 100%; background: rgba(0,0,0,0.5);" class="button-disabled"></div>'
                    );
                    $(self.bottomBarFullscreenButton.element)
                        .find(".button-disabled")
                        .hover(
                            function(e) {
                                e.preventDefault();
                                e.stopPropagation();
                            },
                            function(e) {
                                e.preventDefault();
                                e.stopPropagation();
                            }
                        );
                }
            }

            if (globals.DISABLE_CC && self.bottomBarSubtitleController) {
                if (self.skin.removeSubtitleButton) {
                    self.skin.removeSubtitleButton();
                } else {
                    $(self.bottomBarSubtitleController.element).unbind(globals.CLICK_EVENT);
                    $(self.bottomBarSubtitleController.element).append(
                        '<div style="z-index: 1000; position: absolute; top: 0; left: 0; height: 100%; width: 100%; background: rgba(0,0,0,0.5);" class="button-disabled"></div>'
                    );
                    $(self.bottomBarSubtitleController.element)
                        .find(".button-disabled")
                        .hover(
                            function(e) {
                                e.preventDefault();
                                e.stopPropagation();
                            },
                            function(e) {
                                e.preventDefault();
                                e.stopPropagation();
                            }
                        );
                }
            }

            if (self.player.has360Controls && !globals.DISABLE_360_CONTROLS && self.skin.get360Controls) {
                self.tagOverlay.append(self.skin.get360Controls(self.player.goUp, self.player.goDown, self.player.goLeft, self.player.goRight));
            }

            if (self.player.has360Radar && globals.ENABLE_360_RADAR && self.skin.get360Radar) {
                var radar = self.skin.get360Radar();
                self.animationController.addTagAnimationCallback(function(tags) {
                    radar.redrawTags(_.pluck(tags, "currentYaw"), self.player.config.yaw, self.player.config.maxYaw, self.player.config.minYaw);
                });
                self.controlOverlay.append(radar.element);
            }

            self.hideLoader();

            if (window.wirewax.timeStamp) {
                var playSub = PubSub.subscribe(globals.HAS_PLAYED, function() {
                    PubSub.unsubscribe(playSub);
                    PubSub.publish(globals.DO_SEEK, window.wirewax.timeStamp);
                });
            }

            if (window.wirewax.spriteId && !globals.OPEN_WIDGET_ON_SPRITE_SEEK_TO) {
                self.playButton.element.css({ visibility: "hidden", opacity: 0 });
            }

            if ((globals.AUTOPLAY && globals.CAN_AUTOPLAY) || self.loadedOnce) {
                self.loadedOnce = true;
                globals.PLAY_FUNCTION();
            }

            if (!globals.AUTOPLAY && !self.loadedOnce) {
                self.loadedOnce = true;

                if (window.wirewax.skin !== "SkinViewer") {
                    self.playButton.element.show();
                }
            }

            if (self.player.hasOwnPlayButton) {
                self.playButton.element.hide();
            }

            self.hasOwnPauseButton = self.player.hasOwnPauseButton;

            if (!window.wirewax.playerReady) {
                self.bindVideoInteractionEvents();

                window.wirewax.playerReady = true;

                PubSub.publish(globals.PLAYER_READY);
                PubSub.publish(globals.LOAD_METRIC, {
                    type: 7,
                    urls: [window.wirewax.cdnUrl],
                    loadTime: new Date().getTime() - window.wirewax.loadTimeStart
                });
                globals.LOG("PLAYER READY");
            }
        };

        self.checkMinHeightWidth = function() {
            if ($(self.videoElementContainer).width() < globals.MIN_WIDTH || $(self.videoElementContainer).height() < globals.MIN_HEIGHT) {
                PubSub.publish(globals.ERROR, new LogEvent(globals.ERROR, globals.ERRORS["5010"]));
                return;
            } else {
                PubSub.publish(globals.DISMISS_ERROR_MESSAGE);
            }
        };

        self.showLoader = function() {
            self.loader.show();
        };

        self.showLoaderTransparent = function() {
            self.loader.show(true);
        };

        self.hideLoader = function() {
            self.loader.hide();
        };

        self.setDuration = function(duration) {
            if (self.scrubber) {
                self.scrubber.setDuration(duration);
            }
        };

        self.updateScrubBar = function(videoWatchedTime, bufferedTime) {
            if (self.scrubber) {
                self.scrubber.updateScrubber(videoWatchedTime, bufferedTime);
            }
        };

        self.showWidget = function(eventName, widgetInstance) {
            self.disableKeyBindings = true;
            if (self.scrubber) {
                if (globals.HIDE_SCRUBBER) {
                    $(self.scrubber.scrubberBar).hide();
                } else {
                    $(self.scrubber.scrubberBar).addClass("greyed-out");
                }
            }

            if (globals.IS_IPHONE && $("#btnClose").length) {
                $("#btnClose").animate({ left: "-40px" });
            }

            self.widgetOverlay.append(widgetInstance.element);

            self.controlOverlay.addClass("hidden");

            window.setTimeout(function() {
                widgetInstance.show();
                PubSub.publish(globals.WIDGET_ACTION, { widget: widgetInstance, eventType: null, action: "open" });
            }, 500);
        };

        self.postWidgetClose = function() {
            self.disableKeyBindings = false;
            self.controlOverlay.removeClass("hidden");

            if (self.scrubber) {
                $(self.scrubber.scrubberBar).show();
                $(self.scrubber.scrubberBar).removeClass("greyed-out");
            }
        };

        self.hideDisabledAudioIcon = function() {
            var hideIcon = function() {
                self.disabledAudioIcon.addClass("hide-mute");
                window.setTimeout(function() {
                    self.disabledAudioIcon.hide();
                    self.disabledAudioIcon.removeClass("hide-mute");
                }, 1500);
            };
            self.disabledAudioIcon && hideIcon();
        };

        self.cancelFullscreen = function() {
            if (self.isFullscreen) {
                self.toggleFullscreen();
            }
        };

        self.isFullscreen = function() {
            return document.fullscreenElement || document.mozFullscreenElement || document.webkitFullscreenElement || document.msFullscreenElement;
        };

        self.toggleFullscreen = function(documentElement) {
            if (!self.isFullscreen()) {
                if (documentElement.requestFullscreen) {
                    documentElement.requestFullscreen();
                } else if (documentElement.mozRequestFullScreen) {
                    documentElement.mozRequestFullScreen();
                } else if (documentElement.msRequestFullscreen) {
                    documentElement.msRequestFullscreen();
                } else if (documentElement.webkitRequestFullscreen) {
                    documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);
                }
                // else if(Modernizr.touchevents){
                //  $(documentElement).toggleClass('fullscreen ');
                //  self.fullscreen = !self.fullscreen;

                //  window.setTimeout(function() {
                //    window.scrollTo(0, 1);
                //  }, 0);

                //  self.resizeInterface();
                // }
                else {
                    alert(globals.STRINGS["FEATURE_NOT_SUPPORTED"]);
                }

                PubSub.publish(globals.UI_EVENT, { eventName: "fullScreen", eventId: 5 });
            } else {
                if (document.cancelFullScreen) {
                    document.cancelFullScreen();
                } else if (document.exitFullscreen) {
                    document.exitFullscreen();
                } else if (document.msCancelFullscreen) {
                    document.msCancelFullscreen();
                } else if (document.msExitFullscreen) {
                    document.msExitFullscreen();
                } else if (document.mozCancelFullScreen) {
                    document.mozCancelFullScreen();
                } else if (document.mozExitFullscreen) {
                    document.mozExitFullscreen();
                } else if (document.webkitCancelFullScreen) {
                    document.webkitCancelFullScreen();
                } else if (document.webkitExitFullscreen) {
                    document.webkitExitFullscreen();
                }

                PubSub.publish(globals.UI_EVENT, { eventName: "normalScreen", eventId: 6 });
            }
        };

        self.setOverlayDimensions = function(element, overlay, goingFullscreen) {
            var videoHeight = $(element).height(),
                videoWidth = $(element).width(),
                actualWidth = videoWidth,
                actualHeight = videoHeight,
                $overlay = $(overlay);

            if ((videoWidth * globals.ASPECT_RATIO_HEIGHT) / globals.ASPECT_RATIO_WIDTH < videoHeight) {
                actualHeight = Math.ceil((videoWidth * globals.ASPECT_RATIO_HEIGHT) / globals.ASPECT_RATIO_WIDTH);
                $overlay
                    .css("height", actualHeight)
                    .css("width", "100%")
                    .css("top", (videoHeight - actualHeight) / 2)
                    .css("left", 0);
            } else if ((videoHeight * globals.ASPECT_RATIO_WIDTH) / globals.ASPECT_RATIO_HEIGHT < videoWidth) {
                actualWidth = Math.ceil((videoHeight * globals.ASPECT_RATIO_WIDTH) / globals.ASPECT_RATIO_HEIGHT);
                $overlay
                    .css("width", actualWidth)
                    .css("height", "100%")
                    .css("left", (videoWidth - actualWidth) / 2)
                    .css("top", 0);
            } else {
                $overlay
                    .css("height", "100%")
                    .css("width", "100%")
                    .css("top", 0)
                    .css("left", 0);
            }

            $overlay.css({
                "margin-left": 0,
                "margin-top": 0
            });

            if (self.player.controlsUnderVideo && !goingFullscreen) {
                $overlay.css("top", 0);
                actualWidth = self.controlOverlay.width();
            }

            if (self.scrubber) {
                if (!self.skin.refactored) {
                    var bottomBarButtonTotalWidth = 0;
                    if (self.bottomBarPlayButton && self.bottomBarPauseButton) {
                        bottomBarButtonTotalWidth += $(self.bottomBarPlayButton.element).width();
                    }

                    if (self.volumeControllerElement) {
                        bottomBarButtonTotalWidth += $(self.volumeControllerElement).width();
                    }

                    if (self.shareController) {
                        bottomBarButtonTotalWidth += $(self.shareController.element).width();
                    }

                    if (self.bottomBarFullscreenButton) {
                        bottomBarButtonTotalWidth += $(self.bottomBarFullscreenButton.element).width();
                    }

                    if (self.bottomBarRenditionController) {
                        bottomBarButtonTotalWidth += $(self.bottomBarRenditionController.element).width();
                    }

                    if (self.bottomBarSubtitleController) {
                        bottomBarButtonTotalWidth += $(self.bottomBarSubtitleController.element).width();
                    }

                    self.scrubber.setSize(actualWidth - bottomBarButtonTotalWidth);
                }
            }
        };

        self.setFullbleedDimentions = function(element) {
            function calculateRatioByHeight(viewportHeight) {
                var gcd = viewportHeight / globals.ASPECT_RATIO_HEIGHT;
                return Math.round(gcd * globals.ASPECT_RATIO_WIDTH);
            }

            function calculateRatioByWidth(viewportWidth) {
                var gcd = viewportWidth / globals.ASPECT_RATIO_WIDTH;
                return Math.round(gcd * globals.ASPECT_RATIO_HEIGHT);
            }

            var viewportHeight = $(window).height();
            var viewportWidth = $(window).width();
            var iframeHeight = viewportHeight;
            var iframeWidth = calculateRatioByHeight(viewportHeight);
            if (iframeWidth < viewportWidth) {
                iframeWidth = viewportWidth;
                iframeHeight = calculateRatioByWidth(viewportWidth);
            }

            self.fullbleedDimentions = {
                iframeWidth: iframeWidth,
                iframeHeight: iframeHeight
            };

            if (globals.IS_360_FULLBLEED) {
                $(element).css({
                    width: viewportWidth,
                    height: viewportHeight,
                    top: "0",
                    left: "0",
                    "margin-left": "initial",
                    "margin-top": "initial"
                });
            } else {
                $(element).css({
                    width: self.fullbleedDimentions.iframeWidth,
                    height: self.fullbleedDimentions.iframeHeight,
                    top: "50%",
                    left: "50%",
                    // 0.05 is a hack that fixes iphone 5, 5S, SE, portrait mode 360 fullbleed
                    "margin-left": (self.fullbleedDimentions.iframeWidth / 2) * -1 - 0.05,
                    "margin-top": (self.fullbleedDimentions.iframeHeight / 2) * -1
                });
            }
        };
    };

    return InterfaceController;
});

// ┌────────────────────────────────────────────────────────────────────┐ \\
// │ Raphaël 2.1.4 - JavaScript Vector Library                          │ \\
// ├────────────────────────────────────────────────────────────────────┤ \\
// │ Copyright © 2008-2012 Dmitry Baranovskiy (http://raphaeljs.com)    │ \\
// │ Copyright © 2008-2012 Sencha Labs (http://sencha.com)              │ \\
// ├────────────────────────────────────────────────────────────────────┤ \\
// │ Licensed under the MIT (http://raphaeljs.com/license.html) license.│ \\
// └────────────────────────────────────────────────────────────────────┘ \\
!(function(a, b) {
    "function" === typeof wwplayer.define && wwplayer.define.amd
        ? wwplayer.define("eve", [], function() {
              return b();
          })
        : "object" == typeof exports
        ? (module.exports = b())
        : (a.eve = b());
})(this, function() {
    var a,
        b,
        c = "0.4.2",
        d = "hasOwnProperty",
        e = /[\.\/]/,
        f = "*",
        g = function() {},
        h = function(a, b) {
            return a - b;
        },
        i = { n: {} },
        j = function(c, d) {
            c = String(c);
            var e,
                f = b,
                g = Array.prototype.slice.call(arguments, 2),
                i = j.listeners(c),
                k = 0,
                l = [],
                m = {},
                n = [],
                o = a;
            (a = c), (b = 0);
            for (var p = 0, q = i.length; q > p; p++) "zIndex" in i[p] && (l.push(i[p].zIndex), i[p].zIndex < 0 && (m[i[p].zIndex] = i[p]));
            for (l.sort(h); l[k] < 0; ) if (((e = m[l[k++]]), n.push(e.apply(d, g)), b)) return (b = f), n;
            for (p = 0; q > p; p++)
                if (((e = i[p]), "zIndex" in e))
                    if (e.zIndex == l[k]) {
                        if ((n.push(e.apply(d, g)), b)) break;
                        do if ((k++, (e = m[l[k]]), e && n.push(e.apply(d, g)), b)) break;
                        while (e);
                    } else m[e.zIndex] = e;
                else if ((n.push(e.apply(d, g)), b)) break;
            return (b = f), (a = o), n.length ? n : null;
        };
    return (
        (j._events = i),
        (j.listeners = function(a) {
            var b,
                c,
                d,
                g,
                h,
                j,
                k,
                l,
                m = a.split(e),
                n = i,
                o = [n],
                p = [];
            for (g = 0, h = m.length; h > g; g++) {
                for (l = [], j = 0, k = o.length; k > j; j++) for (n = o[j].n, c = [n[m[g]], n[f]], d = 2; d--; ) (b = c[d]), b && (l.push(b), (p = p.concat(b.f || [])));
                o = l;
            }
            return p;
        }),
        (j.on = function(a, b) {
            if (((a = String(a)), "function" != typeof b)) return function() {};
            for (var c = a.split(e), d = i, f = 0, h = c.length; h > f; f++) (d = d.n), (d = (d.hasOwnProperty(c[f]) && d[c[f]]) || (d[c[f]] = { n: {} }));
            for (d.f = d.f || [], f = 0, h = d.f.length; h > f; f++) if (d.f[f] == b) return g;
            return (
                d.f.push(b),
                function(a) {
                    +a == +a && (b.zIndex = +a);
                }
            );
        }),
        (j.f = function(a) {
            var b = [].slice.call(arguments, 1);
            return function() {
                j.apply(null, [a, null].concat(b).concat([].slice.call(arguments, 0)));
            };
        }),
        (j.stop = function() {
            b = 1;
        }),
        (j.nt = function(b) {
            return b ? new RegExp("(?:\\.|\\/|^)" + b + "(?:\\.|\\/|$)").test(a) : a;
        }),
        (j.nts = function() {
            return a.split(e);
        }),
        (j.off = j.unbind = function(a, b) {
            if (!a) return void (j._events = i = { n: {} });
            var c,
                g,
                h,
                k,
                l,
                m,
                n,
                o = a.split(e),
                p = [i];
            for (k = 0, l = o.length; l > k; k++)
                for (m = 0; m < p.length; m += h.length - 2) {
                    if (((h = [m, 1]), (c = p[m].n), o[k] != f)) c[o[k]] && h.push(c[o[k]]);
                    else for (g in c) c[d](g) && h.push(c[g]);
                    p.splice.apply(p, h);
                }
            for (k = 0, l = p.length; l > k; k++)
                for (c = p[k]; c.n; ) {
                    if (b) {
                        if (c.f) {
                            for (m = 0, n = c.f.length; n > m; m++)
                                if (c.f[m] == b) {
                                    c.f.splice(m, 1);
                                    break;
                                }
                            !c.f.length && delete c.f;
                        }
                        for (g in c.n)
                            if (c.n[d](g) && c.n[g].f) {
                                var q = c.n[g].f;
                                for (m = 0, n = q.length; n > m; m++)
                                    if (q[m] == b) {
                                        q.splice(m, 1);
                                        break;
                                    }
                                !q.length && delete c.n[g].f;
                            }
                    } else {
                        delete c.f;
                        for (g in c.n) c.n[d](g) && c.n[g].f && delete c.n[g].f;
                    }
                    c = c.n;
                }
        }),
        (j.once = function(a, b) {
            var c = function() {
                return j.unbind(a, c), b.apply(this, arguments);
            };
            return j.on(a, c);
        }),
        (j.version = c),
        (j.toString = function() {
            return "You are running Eve " + c;
        }),
        j
    );
}),
    (function(a, b) {
        "function" === typeof wwplayer.define && wwplayer.define.amd
            ? wwplayer.define("raphael.core", ["eve"], function(a) {
                  return b(a);
              })
            : "object" == typeof exports
            ? (module.exports = b(require("eve")))
            : (a.Raphael = b(a.eve));
    })(this, function(a) {
        function b(c) {
            if (b.is(c, "function")) return t ? c() : a.on("raphael.DOMload", c);
            if (b.is(c, U)) return b._engine.create[C](b, c.splice(0, 3 + b.is(c[0], S))).add(c);
            var d = Array.prototype.slice.call(arguments, 0);
            if (b.is(d[d.length - 1], "function")) {
                var e = d.pop();
                return t
                    ? e.call(b._engine.create[C](b, d))
                    : a.on("raphael.DOMload", function() {
                          e.call(b._engine.create[C](b, d));
                      });
            }
            return b._engine.create[C](b, arguments);
        }
        function c(a) {
            if ("function" == typeof a || Object(a) !== a) return a;
            var b = new a.constructor();
            for (var d in a) a[y](d) && (b[d] = c(a[d]));
            return b;
        }
        function d(a, b) {
            for (var c = 0, d = a.length; d > c; c++) if (a[c] === b) return a.push(a.splice(c, 1)[0]);
        }
        function e(a, b, c) {
            function e() {
                var f = Array.prototype.slice.call(arguments, 0),
                    g = f.join("␀"),
                    h = (e.cache = e.cache || {}),
                    i = (e.count = e.count || []);
                return h[y](g) ? (d(i, g), c ? c(h[g]) : h[g]) : (i.length >= 1e3 && delete h[i.shift()], i.push(g), (h[g] = a[C](b, f)), c ? c(h[g]) : h[g]);
            }
            return e;
        }
        function f() {
            return this.hex;
        }
        function g(a, b) {
            for (var c = [], d = 0, e = a.length; e - 2 * !b > d; d += 2) {
                var f = [
                    { x: +a[d - 2], y: +a[d - 1] },
                    { x: +a[d], y: +a[d + 1] },
                    { x: +a[d + 2], y: +a[d + 3] },
                    { x: +a[d + 4], y: +a[d + 5] }
                ];
                b
                    ? d
                        ? e - 4 == d
                            ? (f[3] = { x: +a[0], y: +a[1] })
                            : e - 2 == d && ((f[2] = { x: +a[0], y: +a[1] }), (f[3] = { x: +a[2], y: +a[3] }))
                        : (f[0] = { x: +a[e - 2], y: +a[e - 1] })
                    : e - 4 == d
                    ? (f[3] = f[2])
                    : d || (f[0] = { x: +a[d], y: +a[d + 1] }),
                    c.push([
                        "C",
                        (-f[0].x + 6 * f[1].x + f[2].x) / 6,
                        (-f[0].y + 6 * f[1].y + f[2].y) / 6,
                        (f[1].x + 6 * f[2].x - f[3].x) / 6,
                        (f[1].y + 6 * f[2].y - f[3].y) / 6,
                        f[2].x,
                        f[2].y
                    ]);
            }
            return c;
        }
        function h(a, b, c, d, e) {
            var f = -3 * b + 9 * c - 9 * d + 3 * e,
                g = a * f + 6 * b - 12 * c + 6 * d;
            return a * g - 3 * b + 3 * c;
        }
        function i(a, b, c, d, e, f, g, i, j) {
            null == j && (j = 1), (j = j > 1 ? 1 : 0 > j ? 0 : j);
            for (
                var k = j / 2,
                    l = 12,
                    m = [-0.1252, 0.1252, -0.3678, 0.3678, -0.5873, 0.5873, -0.7699, 0.7699, -0.9041, 0.9041, -0.9816, 0.9816],
                    n = [0.2491, 0.2491, 0.2335, 0.2335, 0.2032, 0.2032, 0.1601, 0.1601, 0.1069, 0.1069, 0.0472, 0.0472],
                    o = 0,
                    p = 0;
                l > p;
                p++
            ) {
                var q = k * m[p] + k,
                    r = h(q, a, c, e, g),
                    s = h(q, b, d, f, i),
                    t = r * r + s * s;
                o += n[p] * M.sqrt(t);
            }
            return k * o;
        }
        function j(a, b, c, d, e, f, g, h, j) {
            if (!(0 > j || i(a, b, c, d, e, f, g, h) < j)) {
                var k,
                    l = 1,
                    m = l / 2,
                    n = l - m,
                    o = 0.01;
                for (k = i(a, b, c, d, e, f, g, h, n); P(k - j) > o; ) (m /= 2), (n += (j > k ? 1 : -1) * m), (k = i(a, b, c, d, e, f, g, h, n));
                return n;
            }
        }
        function k(a, b, c, d, e, f, g, h) {
            if (!(N(a, c) < O(e, g) || O(a, c) > N(e, g) || N(b, d) < O(f, h) || O(b, d) > N(f, h))) {
                var i = (a * d - b * c) * (e - g) - (a - c) * (e * h - f * g),
                    j = (a * d - b * c) * (f - h) - (b - d) * (e * h - f * g),
                    k = (a - c) * (f - h) - (b - d) * (e - g);
                if (k) {
                    var l = i / k,
                        m = j / k,
                        n = +l.toFixed(2),
                        o = +m.toFixed(2);
                    if (
                        !(
                            n < +O(a, c).toFixed(2) ||
                            n > +N(a, c).toFixed(2) ||
                            n < +O(e, g).toFixed(2) ||
                            n > +N(e, g).toFixed(2) ||
                            o < +O(b, d).toFixed(2) ||
                            o > +N(b, d).toFixed(2) ||
                            o < +O(f, h).toFixed(2) ||
                            o > +N(f, h).toFixed(2)
                        )
                    )
                        return { x: l, y: m };
                }
            }
        }
        function l(a, c, d) {
            var e = b.bezierBBox(a),
                f = b.bezierBBox(c);
            if (!b.isBBoxIntersect(e, f)) return d ? 0 : [];
            for (var g = i.apply(0, a), h = i.apply(0, c), j = N(~~(g / 5), 1), l = N(~~(h / 5), 1), m = [], n = [], o = {}, p = d ? 0 : [], q = 0; j + 1 > q; q++) {
                var r = b.findDotsAtSegment.apply(b, a.concat(q / j));
                m.push({ x: r.x, y: r.y, t: q / j });
            }
            for (q = 0; l + 1 > q; q++) (r = b.findDotsAtSegment.apply(b, c.concat(q / l))), n.push({ x: r.x, y: r.y, t: q / l });
            for (q = 0; j > q; q++)
                for (var s = 0; l > s; s++) {
                    var t = m[q],
                        u = m[q + 1],
                        v = n[s],
                        w = n[s + 1],
                        x = P(u.x - t.x) < 0.001 ? "y" : "x",
                        y = P(w.x - v.x) < 0.001 ? "y" : "x",
                        z = k(t.x, t.y, u.x, u.y, v.x, v.y, w.x, w.y);
                    if (z) {
                        if (o[z.x.toFixed(4)] == z.y.toFixed(4)) continue;
                        o[z.x.toFixed(4)] = z.y.toFixed(4);
                        var A = t.t + P((z[x] - t[x]) / (u[x] - t[x])) * (u.t - t.t),
                            B = v.t + P((z[y] - v[y]) / (w[y] - v[y])) * (w.t - v.t);
                        A >= 0 && 1.001 >= A && B >= 0 && 1.001 >= B && (d ? p++ : p.push({ x: z.x, y: z.y, t1: O(A, 1), t2: O(B, 1) }));
                    }
                }
            return p;
        }
        function m(a, c, d) {
            (a = b._path2curve(a)), (c = b._path2curve(c));
            for (var e, f, g, h, i, j, k, m, n, o, p = d ? 0 : [], q = 0, r = a.length; r > q; q++) {
                var s = a[q];
                if ("M" == s[0]) (e = i = s[1]), (f = j = s[2]);
                else {
                    "C" == s[0] ? ((n = [e, f].concat(s.slice(1))), (e = n[6]), (f = n[7])) : ((n = [e, f, e, f, i, j, i, j]), (e = i), (f = j));
                    for (var t = 0, u = c.length; u > t; t++) {
                        var v = c[t];
                        if ("M" == v[0]) (g = k = v[1]), (h = m = v[2]);
                        else {
                            "C" == v[0] ? ((o = [g, h].concat(v.slice(1))), (g = o[6]), (h = o[7])) : ((o = [g, h, g, h, k, m, k, m]), (g = k), (h = m));
                            var w = l(n, o, d);
                            if (d) p += w;
                            else {
                                for (var x = 0, y = w.length; y > x; x++) (w[x].segment1 = q), (w[x].segment2 = t), (w[x].bez1 = n), (w[x].bez2 = o);
                                p = p.concat(w);
                            }
                        }
                    }
                }
            }
            return p;
        }
        function n(a, b, c, d, e, f) {
            null != a
                ? ((this.a = +a), (this.b = +b), (this.c = +c), (this.d = +d), (this.e = +e), (this.f = +f))
                : ((this.a = 1), (this.b = 0), (this.c = 0), (this.d = 1), (this.e = 0), (this.f = 0));
        }
        function o() {
            return this.x + G + this.y + G + this.width + " × " + this.height;
        }
        function p(a, b, c, d, e, f) {
            function g(a) {
                return ((l * a + k) * a + j) * a;
            }
            function h(a, b) {
                var c = i(a, b);
                return ((o * c + n) * c + m) * c;
            }
            function i(a, b) {
                var c, d, e, f, h, i;
                for (e = a, i = 0; 8 > i; i++) {
                    if (((f = g(e) - a), P(f) < b)) return e;
                    if (((h = (3 * l * e + 2 * k) * e + j), P(h) < 1e-6)) break;
                    e -= f / h;
                }
                if (((c = 0), (d = 1), (e = a), c > e)) return c;
                if (e > d) return d;
                for (; d > c; ) {
                    if (((f = g(e)), P(f - a) < b)) return e;
                    a > f ? (c = e) : (d = e), (e = (d - c) / 2 + c);
                }
                return e;
            }
            var j = 3 * b,
                k = 3 * (d - b) - j,
                l = 1 - j - k,
                m = 3 * c,
                n = 3 * (e - c) - m,
                o = 1 - m - n;
            return h(a, 1 / (200 * f));
        }
        function q(a, b) {
            var c = [],
                d = {};
            if (((this.ms = b), (this.times = 1), a)) {
                for (var e in a) a[y](e) && ((d[$(e)] = a[e]), c.push($(e)));
                c.sort(ka);
            }
            (this.anim = d), (this.top = c[c.length - 1]), (this.percents = c);
        }
        function r(c, d, e, f, g, h) {
            e = $(e);
            var i,
                j,
                k,
                l,
                m,
                o,
                q = c.ms,
                r = {},
                s = {},
                t = {};
            if (f)
                for (w = 0, x = fb.length; x > w; w++) {
                    var u = fb[w];
                    if (u.el.id == d.id && u.anim == c) {
                        u.percent != e ? (fb.splice(w, 1), (k = 1)) : (j = u), d.attr(u.totalOrigin);
                        break;
                    }
                }
            else f = +s;
            for (var w = 0, x = c.percents.length; x > w; w++) {
                if (c.percents[w] == e || c.percents[w] > f * c.top) {
                    (e = c.percents[w]), (m = c.percents[w - 1] || 0), (q = (q / c.top) * (e - m)), (l = c.percents[w + 1]), (i = c.anim[e]);
                    break;
                }
                f && d.attr(c.anim[c.percents[w]]);
            }
            if (i) {
                if (j) (j.initstatus = f), (j.start = new Date() - j.ms * f);
                else {
                    for (var z in i)
                        if (i[y](z) && (ca[y](z) || d.paper.customAttributes[y](z)))
                            switch (((r[z] = d.attr(z)), null == r[z] && (r[z] = ba[z]), (s[z] = i[z]), ca[z])) {
                                case S:
                                    t[z] = (s[z] - r[z]) / q;
                                    break;
                                case "colour":
                                    r[z] = b.getRGB(r[z]);
                                    var A = b.getRGB(s[z]);
                                    t[z] = { r: (A.r - r[z].r) / q, g: (A.g - r[z].g) / q, b: (A.b - r[z].b) / q };
                                    break;
                                case "path":
                                    var B = Ia(r[z], s[z]),
                                        C = B[1];
                                    for (r[z] = B[0], t[z] = [], w = 0, x = r[z].length; x > w; w++) {
                                        t[z][w] = [0];
                                        for (var E = 1, F = r[z][w].length; F > E; E++) t[z][w][E] = (C[w][E] - r[z][w][E]) / q;
                                    }
                                    break;
                                case "transform":
                                    var G = d._,
                                        J = Na(G[z], s[z]);
                                    if (J)
                                        for (r[z] = J.from, s[z] = J.to, t[z] = [], t[z].real = !0, w = 0, x = r[z].length; x > w; w++)
                                            for (t[z][w] = [r[z][w][0]], E = 1, F = r[z][w].length; F > E; E++) t[z][w][E] = (s[z][w][E] - r[z][w][E]) / q;
                                    else {
                                        var K = d.matrix || new n(),
                                            L = {
                                                _: { transform: G.transform },
                                                getBBox: function() {
                                                    return d.getBBox(1);
                                                }
                                            };
                                        (r[z] = [K.a, K.b, K.c, K.d, K.e, K.f]),
                                            La(L, s[z]),
                                            (s[z] = L._.transform),
                                            (t[z] = [
                                                (L.matrix.a - K.a) / q,
                                                (L.matrix.b - K.b) / q,
                                                (L.matrix.c - K.c) / q,
                                                (L.matrix.d - K.d) / q,
                                                (L.matrix.e - K.e) / q,
                                                (L.matrix.f - K.f) / q
                                            ]);
                                    }
                                    break;
                                case "csv":
                                    var M = H(i[z])[I](v),
                                        N = H(r[z])[I](v);
                                    if ("clip-rect" == z) for (r[z] = N, t[z] = [], w = N.length; w--; ) t[z][w] = (M[w] - r[z][w]) / q;
                                    s[z] = M;
                                    break;
                                default:
                                    for (M = [][D](i[z]), N = [][D](r[z]), t[z] = [], w = d.paper.customAttributes[z].length; w--; ) t[z][w] = ((M[w] || 0) - (N[w] || 0)) / q;
                            }
                    var O = i.easing,
                        P = b.easing_formulas[O];
                    if (!P)
                        if (((P = H(O).match(Y)), P && 5 == P.length)) {
                            var Q = P;
                            P = function(a) {
                                return p(a, +Q[1], +Q[2], +Q[3], +Q[4], q);
                            };
                        } else P = la;
                    if (
                        ((o = i.start || c.start || +new Date()),
                        (u = {
                            anim: c,
                            percent: e,
                            timestamp: o,
                            start: o + (c.del || 0),
                            status: 0,
                            initstatus: f || 0,
                            stop: !1,
                            ms: q,
                            easing: P,
                            from: r,
                            diff: t,
                            to: s,
                            el: d,
                            callback: i.callback,
                            prev: m,
                            next: l,
                            repeat: h || c.times,
                            origin: d.attr(),
                            totalOrigin: g
                        }),
                        fb.push(u),
                        f && !j && !k && ((u.stop = !0), (u.start = new Date() - q * f), 1 == fb.length))
                    )
                        return hb();
                    k && (u.start = new Date() - u.ms * f), 1 == fb.length && gb(hb);
                }
                a("raphael.anim.start." + d.id, d, c);
            }
        }
        function s(a) {
            for (var b = 0; b < fb.length; b++) fb[b].el.paper == a && fb.splice(b--, 1);
        }
        (b.version = "2.1.4"), (b.eve = a);
        var t,
            u,
            v = /[, ]+/,
            w = { circle: 1, rect: 1, path: 1, ellipse: 1, text: 1, image: 1 },
            x = /\{(\d+)\}/g,
            y = "hasOwnProperty",
            z = { doc: document, win: window },
            A = { was: Object.prototype[y].call(z.win, "Raphael"), is: z.win.Raphael },
            B = function() {
                this.ca = this.customAttributes = {};
            },
            C = "apply",
            D = "concat",
            E = "ontouchstart" in z.win || (z.win.DocumentTouch && z.doc instanceof DocumentTouch),
            F = "",
            G = " ",
            H = String,
            I = "split",
            J = "click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel"[I](G),
            K = { mousedown: "touchstart", mousemove: "touchmove", mouseup: "touchend" },
            L = H.prototype.toLowerCase,
            M = Math,
            N = M.max,
            O = M.min,
            P = M.abs,
            Q = M.pow,
            R = M.PI,
            S = "number",
            T = "string",
            U = "array",
            V = Object.prototype.toString,
            W =
                ((b._ISURL = /^url\(['"]?(.+?)['"]?\)$/i),
                /^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i),
            X = { NaN: 1, Infinity: 1, "-Infinity": 1 },
            Y = /^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,
            Z = M.round,
            $ = parseFloat,
            _ = parseInt,
            aa = H.prototype.toUpperCase,
            ba = (b._availableAttrs = {
                "arrow-end": "none",
                "arrow-start": "none",
                blur: 0,
                "clip-rect": "0 0 1e9 1e9",
                cursor: "default",
                cx: 0,
                cy: 0,
                fill: "#fff",
                "fill-opacity": 1,
                font: '10px "Arial"',
                "font-family": '"Arial"',
                "font-size": "10",
                "font-style": "normal",
                "font-weight": 400,
                gradient: 0,
                height: 0,
                href: "http://raphaeljs.com/",
                "letter-spacing": 0,
                opacity: 1,
                path: "M0,0",
                r: 0,
                rx: 0,
                ry: 0,
                src: "",
                stroke: "#000",
                "stroke-dasharray": "",
                "stroke-linecap": "butt",
                "stroke-linejoin": "butt",
                "stroke-miterlimit": 0,
                "stroke-opacity": 1,
                "stroke-width": 1,
                target: "_blank",
                "text-anchor": "middle",
                title: "Raphael",
                transform: "",
                width: 0,
                x: 0,
                y: 0
            }),
            ca = (b._availableAnimAttrs = {
                blur: S,
                "clip-rect": "csv",
                cx: S,
                cy: S,
                fill: "colour",
                "fill-opacity": S,
                "font-size": S,
                height: S,
                opacity: S,
                path: "path",
                r: S,
                rx: S,
                ry: S,
                stroke: "colour",
                "stroke-opacity": S,
                "stroke-width": S,
                transform: "transform",
                width: S,
                x: S,
                y: S
            }),
            da = /[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/,
            ea = { hs: 1, rg: 1 },
            fa = /,?([achlmqrstvxz]),?/gi,
            ga = /([achlmrqstvz])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/gi,
            ha = /([rstm])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/gi,
            ia = /(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/gi,
            ja =
                ((b._radial_gradient = /^r(?:\(([^,]+?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*([^\)]+?)\))?/),
                {}),
            ka = function(a, b) {
                return $(a) - $(b);
            },
            la = function(a) {
                return a;
            },
            ma = (b._rectPath = function(a, b, c, d, e) {
                return e
                    ? [
                          ["M", a + e, b],
                          ["l", c - 2 * e, 0],
                          ["a", e, e, 0, 0, 1, e, e],
                          ["l", 0, d - 2 * e],
                          ["a", e, e, 0, 0, 1, -e, e],
                          ["l", 2 * e - c, 0],
                          ["a", e, e, 0, 0, 1, -e, -e],
                          ["l", 0, 2 * e - d],
                          ["a", e, e, 0, 0, 1, e, -e],
                          ["z"]
                      ]
                    : [["M", a, b], ["l", c, 0], ["l", 0, d], ["l", -c, 0], ["z"]];
            }),
            na = function(a, b, c, d) {
                return null == d && (d = c), [["M", a, b], ["m", 0, -d], ["a", c, d, 0, 1, 1, 0, 2 * d], ["a", c, d, 0, 1, 1, 0, -2 * d], ["z"]];
            },
            oa = (b._getPath = {
                path: function(a) {
                    return a.attr("path");
                },
                circle: function(a) {
                    var b = a.attrs;
                    return na(b.cx, b.cy, b.r);
                },
                ellipse: function(a) {
                    var b = a.attrs;
                    return na(b.cx, b.cy, b.rx, b.ry);
                },
                rect: function(a) {
                    var b = a.attrs;
                    return ma(b.x, b.y, b.width, b.height, b.r);
                },
                image: function(a) {
                    var b = a.attrs;
                    return ma(b.x, b.y, b.width, b.height);
                },
                text: function(a) {
                    var b = a._getBBox();
                    return ma(b.x, b.y, b.width, b.height);
                },
                set: function(a) {
                    var b = a._getBBox();
                    return ma(b.x, b.y, b.width, b.height);
                }
            }),
            pa = (b.mapPath = function(a, b) {
                if (!b) return a;
                var c, d, e, f, g, h, i;
                for (a = Ia(a), e = 0, g = a.length; g > e; e++)
                    for (i = a[e], f = 1, h = i.length; h > f; f += 2) (c = b.x(i[f], i[f + 1])), (d = b.y(i[f], i[f + 1])), (i[f] = c), (i[f + 1] = d);
                return a;
            });
        if (
            ((b._g = z), (b.type = z.win.SVGAngle || z.doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure", "1.1") ? "SVG" : "VML"), "VML" == b.type)
        ) {
            var qa,
                ra = z.doc.createElement("div");
            if (((ra.innerHTML = '<v:shape adj="1"/>'), (qa = ra.firstChild), (qa.style.behavior = "url(#default#VML)"), !qa || "object" != typeof qa.adj)) return (b.type = F);
            ra = null;
        }
        (b.svg = !(b.vml = "VML" == b.type)),
            (b._Paper = B),
            (b.fn = u = B.prototype = b.prototype),
            (b._id = 0),
            (b._oid = 0),
            (b.is = function(a, b) {
                return (
                    (b = L.call(b)),
                    "finite" == b
                        ? !X[y](+a)
                        : "array" == b
                        ? a instanceof Array
                        : ("null" == b && null === a) ||
                          (b == typeof a && null !== a) ||
                          ("object" == b && a === Object(a)) ||
                          ("array" == b && Array.isArray && Array.isArray(a)) ||
                          V.call(a)
                              .slice(8, -1)
                              .toLowerCase() == b
                );
            }),
            (b.angle = function(a, c, d, e, f, g) {
                if (null == f) {
                    var h = a - d,
                        i = c - e;
                    return h || i ? (180 + (180 * M.atan2(-i, -h)) / R + 360) % 360 : 0;
                }
                return b.angle(a, c, f, g) - b.angle(d, e, f, g);
            }),
            (b.rad = function(a) {
                return ((a % 360) * R) / 180;
            }),
            (b.deg = function(a) {
                return Math.round((((180 * a) / R) % 360) * 1e3) / 1e3;
            }),
            (b.snapTo = function(a, c, d) {
                if (((d = b.is(d, "finite") ? d : 10), b.is(a, U))) {
                    for (var e = a.length; e--; ) if (P(a[e] - c) <= d) return a[e];
                } else {
                    a = +a;
                    var f = c % a;
                    if (d > f) return c - f;
                    if (f > a - d) return c - f + a;
                }
                return c;
            });
        b.createUUID = (function(a, b) {
            return function() {
                return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(a, b).toUpperCase();
            };
        })(/[xy]/g, function(a) {
            var b = (16 * M.random()) | 0,
                c = "x" == a ? b : (3 & b) | 8;
            return c.toString(16);
        });
        b.setWindow = function(c) {
            a("raphael.setWindow", b, z.win, c), (z.win = c), (z.doc = z.win.document), b._engine.initWin && b._engine.initWin(z.win);
        };
        var sa = function(a) {
                if (b.vml) {
                    var c,
                        d = /^\s+|\s+$/g;
                    try {
                        var f = new ActiveXObject("htmlfile");
                        f.write("<body>"), f.close(), (c = f.body);
                    } catch (g) {
                        c = createPopup().document.body;
                    }
                    var h = c.createTextRange();
                    sa = e(function(a) {
                        try {
                            c.style.color = H(a).replace(d, F);
                            var b = h.queryCommandValue("ForeColor");
                            return (b = ((255 & b) << 16) | (65280 & b) | ((16711680 & b) >>> 16)), "#" + ("000000" + b.toString(16)).slice(-6);
                        } catch (e) {
                            return "none";
                        }
                    });
                } else {
                    var i = z.doc.createElement("i");
                    (i.title = "Raphaël Colour Picker"),
                        (i.style.display = "none"),
                        z.doc.body.appendChild(i),
                        (sa = e(function(a) {
                            return (i.style.color = a), z.doc.defaultView.getComputedStyle(i, F).getPropertyValue("color");
                        }));
                }
                return sa(a);
            },
            ta = function() {
                return "hsb(" + [this.h, this.s, this.b] + ")";
            },
            ua = function() {
                return "hsl(" + [this.h, this.s, this.l] + ")";
            },
            va = function() {
                return this.hex;
            },
            wa = function(a, c, d) {
                if ((null == c && b.is(a, "object") && "r" in a && "g" in a && "b" in a && ((d = a.b), (c = a.g), (a = a.r)), null == c && b.is(a, T))) {
                    var e = b.getRGB(a);
                    (a = e.r), (c = e.g), (d = e.b);
                }
                return (a > 1 || c > 1 || d > 1) && ((a /= 255), (c /= 255), (d /= 255)), [a, c, d];
            },
            xa = function(a, c, d, e) {
                (a *= 255), (c *= 255), (d *= 255);
                var f = { r: a, g: c, b: d, hex: b.rgb(a, c, d), toString: va };
                return b.is(e, "finite") && (f.opacity = e), f;
            };
        (b.color = function(a) {
            var c;
            return (
                b.is(a, "object") && "h" in a && "s" in a && "b" in a
                    ? ((c = b.hsb2rgb(a)), (a.r = c.r), (a.g = c.g), (a.b = c.b), (a.hex = c.hex))
                    : b.is(a, "object") && "h" in a && "s" in a && "l" in a
                    ? ((c = b.hsl2rgb(a)), (a.r = c.r), (a.g = c.g), (a.b = c.b), (a.hex = c.hex))
                    : (b.is(a, "string") && (a = b.getRGB(a)),
                      b.is(a, "object") && "r" in a && "g" in a && "b" in a
                          ? ((c = b.rgb2hsl(a)), (a.h = c.h), (a.s = c.s), (a.l = c.l), (c = b.rgb2hsb(a)), (a.v = c.b))
                          : ((a = { hex: "none" }), (a.r = a.g = a.b = a.h = a.s = a.v = a.l = -1))),
                (a.toString = va),
                a
            );
        }),
            (b.hsb2rgb = function(a, b, c, d) {
                this.is(a, "object") && "h" in a && "s" in a && "b" in a && ((c = a.b), (b = a.s), (d = a.o), (a = a.h)), (a *= 360);
                var e, f, g, h, i;
                return (
                    (a = (a % 360) / 60),
                    (i = c * b),
                    (h = i * (1 - P((a % 2) - 1))),
                    (e = f = g = c - i),
                    (a = ~~a),
                    (e += [i, h, 0, 0, h, i][a]),
                    (f += [h, i, i, h, 0, 0][a]),
                    (g += [0, 0, h, i, i, h][a]),
                    xa(e, f, g, d)
                );
            }),
            (b.hsl2rgb = function(a, b, c, d) {
                this.is(a, "object") && "h" in a && "s" in a && "l" in a && ((c = a.l), (b = a.s), (a = a.h)),
                    (a > 1 || b > 1 || c > 1) && ((a /= 360), (b /= 100), (c /= 100)),
                    (a *= 360);
                var e, f, g, h, i;
                return (
                    (a = (a % 360) / 60),
                    (i = 2 * b * (0.5 > c ? c : 1 - c)),
                    (h = i * (1 - P((a % 2) - 1))),
                    (e = f = g = c - i / 2),
                    (a = ~~a),
                    (e += [i, h, 0, 0, h, i][a]),
                    (f += [h, i, i, h, 0, 0][a]),
                    (g += [0, 0, h, i, i, h][a]),
                    xa(e, f, g, d)
                );
            }),
            (b.rgb2hsb = function(a, b, c) {
                (c = wa(a, b, c)), (a = c[0]), (b = c[1]), (c = c[2]);
                var d, e, f, g;
                return (
                    (f = N(a, b, c)),
                    (g = f - O(a, b, c)),
                    (d = 0 == g ? null : f == a ? (b - c) / g : f == b ? (c - a) / g + 2 : (a - b) / g + 4),
                    (d = (((d + 360) % 6) * 60) / 360),
                    (e = 0 == g ? 0 : g / f),
                    { h: d, s: e, b: f, toString: ta }
                );
            }),
            (b.rgb2hsl = function(a, b, c) {
                (c = wa(a, b, c)), (a = c[0]), (b = c[1]), (c = c[2]);
                var d, e, f, g, h, i;
                return (
                    (g = N(a, b, c)),
                    (h = O(a, b, c)),
                    (i = g - h),
                    (d = 0 == i ? null : g == a ? (b - c) / i : g == b ? (c - a) / i + 2 : (a - b) / i + 4),
                    (d = (((d + 360) % 6) * 60) / 360),
                    (f = (g + h) / 2),
                    (e = 0 == i ? 0 : 0.5 > f ? i / (2 * f) : i / (2 - 2 * f)),
                    { h: d, s: e, l: f, toString: ua }
                );
            }),
            (b._path2string = function() {
                return this.join(",").replace(fa, "$1");
            });
        b._preload = function(a, b) {
            var c = z.doc.createElement("img");
            (c.style.cssText = "position:absolute;left:-9999em;top:-9999em"),
                (c.onload = function() {
                    b.call(this), (this.onload = null), z.doc.body.removeChild(this);
                }),
                (c.onerror = function() {
                    z.doc.body.removeChild(this);
                }),
                z.doc.body.appendChild(c),
                (c.src = a);
        };
        (b.getRGB = e(function(a) {
            if (!a || (a = H(a)).indexOf("-") + 1) return { r: -1, g: -1, b: -1, hex: "none", error: 1, toString: f };
            if ("none" == a) return { r: -1, g: -1, b: -1, hex: "none", toString: f };
            !(ea[y](a.toLowerCase().substring(0, 2)) || "#" == a.charAt()) && (a = sa(a));
            var c,
                d,
                e,
                g,
                h,
                i,
                j = a.match(W);
            return j
                ? (j[2] && ((e = _(j[2].substring(5), 16)), (d = _(j[2].substring(3, 5), 16)), (c = _(j[2].substring(1, 3), 16))),
                  j[3] && ((e = _((h = j[3].charAt(3)) + h, 16)), (d = _((h = j[3].charAt(2)) + h, 16)), (c = _((h = j[3].charAt(1)) + h, 16))),
                  j[4] &&
                      ((i = j[4][I](da)),
                      (c = $(i[0])),
                      "%" == i[0].slice(-1) && (c *= 2.55),
                      (d = $(i[1])),
                      "%" == i[1].slice(-1) && (d *= 2.55),
                      (e = $(i[2])),
                      "%" == i[2].slice(-1) && (e *= 2.55),
                      "rgba" == j[1].toLowerCase().slice(0, 4) && (g = $(i[3])),
                      i[3] && "%" == i[3].slice(-1) && (g /= 100)),
                  j[5]
                      ? ((i = j[5][I](da)),
                        (c = $(i[0])),
                        "%" == i[0].slice(-1) && (c *= 2.55),
                        (d = $(i[1])),
                        "%" == i[1].slice(-1) && (d *= 2.55),
                        (e = $(i[2])),
                        "%" == i[2].slice(-1) && (e *= 2.55),
                        ("deg" == i[0].slice(-3) || "°" == i[0].slice(-1)) && (c /= 360),
                        "hsba" == j[1].toLowerCase().slice(0, 4) && (g = $(i[3])),
                        i[3] && "%" == i[3].slice(-1) && (g /= 100),
                        b.hsb2rgb(c, d, e, g))
                      : j[6]
                      ? ((i = j[6][I](da)),
                        (c = $(i[0])),
                        "%" == i[0].slice(-1) && (c *= 2.55),
                        (d = $(i[1])),
                        "%" == i[1].slice(-1) && (d *= 2.55),
                        (e = $(i[2])),
                        "%" == i[2].slice(-1) && (e *= 2.55),
                        ("deg" == i[0].slice(-3) || "°" == i[0].slice(-1)) && (c /= 360),
                        "hsla" == j[1].toLowerCase().slice(0, 4) && (g = $(i[3])),
                        i[3] && "%" == i[3].slice(-1) && (g /= 100),
                        b.hsl2rgb(c, d, e, g))
                      : ((j = { r: c, g: d, b: e, toString: f }),
                        (j.hex = "#" + (16777216 | e | (d << 8) | (c << 16)).toString(16).slice(1)),
                        b.is(g, "finite") && (j.opacity = g),
                        j))
                : { r: -1, g: -1, b: -1, hex: "none", error: 1, toString: f };
        }, b)),
            (b.hsb = e(function(a, c, d) {
                return b.hsb2rgb(a, c, d).hex;
            })),
            (b.hsl = e(function(a, c, d) {
                return b.hsl2rgb(a, c, d).hex;
            })),
            (b.rgb = e(function(a, b, c) {
                function d(a) {
                    return (a + 0.5) | 0;
                }
                return "#" + (16777216 | d(c) | (d(b) << 8) | (d(a) << 16)).toString(16).slice(1);
            })),
            (b.getColor = function(a) {
                var b = (this.getColor.start = this.getColor.start || { h: 0, s: 1, b: a || 0.75 }),
                    c = this.hsb2rgb(b.h, b.s, b.b);
                return (b.h += 0.075), b.h > 1 && ((b.h = 0), (b.s -= 0.2), b.s <= 0 && (this.getColor.start = { h: 0, s: 1, b: b.b })), c.hex;
            }),
            (b.getColor.reset = function() {
                delete this.start;
            }),
            (b.parsePathString = function(a) {
                if (!a) return null;
                var c = ya(a);
                if (c.arr) return Aa(c.arr);
                var d = { a: 7, c: 6, h: 1, l: 2, m: 2, r: 4, q: 4, s: 4, t: 2, v: 1, z: 0 },
                    e = [];
                return (
                    b.is(a, U) && b.is(a[0], U) && (e = Aa(a)),
                    e.length ||
                        H(a).replace(ga, function(a, b, c) {
                            var f = [],
                                g = b.toLowerCase();
                            if (
                                (c.replace(ia, function(a, b) {
                                    b && f.push(+b);
                                }),
                                "m" == g && f.length > 2 && (e.push([b][D](f.splice(0, 2))), (g = "l"), (b = "m" == b ? "l" : "L")),
                                "r" == g)
                            )
                                e.push([b][D](f));
                            else for (; f.length >= d[g] && (e.push([b][D](f.splice(0, d[g]))), d[g]); );
                        }),
                    (e.toString = b._path2string),
                    (c.arr = Aa(e)),
                    e
                );
            }),
            (b.parseTransformString = e(function(a) {
                if (!a) return null;
                var c = [];
                return (
                    b.is(a, U) && b.is(a[0], U) && (c = Aa(a)),
                    c.length ||
                        H(a).replace(ha, function(a, b, d) {
                            {
                                var e = [];
                                L.call(b);
                            }
                            d.replace(ia, function(a, b) {
                                b && e.push(+b);
                            }),
                                c.push([b][D](e));
                        }),
                    (c.toString = b._path2string),
                    c
                );
            }));
        var ya = function(a) {
            var b = (ya.ps = ya.ps || {});
            return (
                b[a] ? (b[a].sleep = 100) : (b[a] = { sleep: 100 }),
                setTimeout(function() {
                    for (var c in b) b[y](c) && c != a && (b[c].sleep--, !b[c].sleep && delete b[c]);
                }),
                b[a]
            );
        };
        (b.findDotsAtSegment = function(a, b, c, d, e, f, g, h, i) {
            var j = 1 - i,
                k = Q(j, 3),
                l = Q(j, 2),
                m = i * i,
                n = m * i,
                o = k * a + 3 * l * i * c + 3 * j * i * i * e + n * g,
                p = k * b + 3 * l * i * d + 3 * j * i * i * f + n * h,
                q = a + 2 * i * (c - a) + m * (e - 2 * c + a),
                r = b + 2 * i * (d - b) + m * (f - 2 * d + b),
                s = c + 2 * i * (e - c) + m * (g - 2 * e + c),
                t = d + 2 * i * (f - d) + m * (h - 2 * f + d),
                u = j * a + i * c,
                v = j * b + i * d,
                w = j * e + i * g,
                x = j * f + i * h,
                y = 90 - (180 * M.atan2(q - s, r - t)) / R;
            return (q > s || t > r) && (y += 180), { x: o, y: p, m: { x: q, y: r }, n: { x: s, y: t }, start: { x: u, y: v }, end: { x: w, y: x }, alpha: y };
        }),
            (b.bezierBBox = function(a, c, d, e, f, g, h, i) {
                b.is(a, "array") || (a = [a, c, d, e, f, g, h, i]);
                var j = Ha.apply(null, a);
                return { x: j.min.x, y: j.min.y, x2: j.max.x, y2: j.max.y, width: j.max.x - j.min.x, height: j.max.y - j.min.y };
            }),
            (b.isPointInsideBBox = function(a, b, c) {
                return b >= a.x && b <= a.x2 && c >= a.y && c <= a.y2;
            }),
            (b.isBBoxIntersect = function(a, c) {
                var d = b.isPointInsideBBox;
                return (
                    d(c, a.x, a.y) ||
                    d(c, a.x2, a.y) ||
                    d(c, a.x, a.y2) ||
                    d(c, a.x2, a.y2) ||
                    d(a, c.x, c.y) ||
                    d(a, c.x2, c.y) ||
                    d(a, c.x, c.y2) ||
                    d(a, c.x2, c.y2) ||
                    (((a.x < c.x2 && a.x > c.x) || (c.x < a.x2 && c.x > a.x)) && ((a.y < c.y2 && a.y > c.y) || (c.y < a.y2 && c.y > a.y)))
                );
            }),
            (b.pathIntersection = function(a, b) {
                return m(a, b);
            }),
            (b.pathIntersectionNumber = function(a, b) {
                return m(a, b, 1);
            }),
            (b.isPointInsidePath = function(a, c, d) {
                var e = b.pathBBox(a);
                return (
                    b.isPointInsideBBox(e, c, d) &&
                    m(
                        a,
                        [
                            ["M", c, d],
                            ["H", e.x2 + 10]
                        ],
                        1
                    ) %
                        2 ==
                        1
                );
            }),
            (b._removedFactory = function(b) {
                return function() {
                    a("raphael.log", null, "Raphaël: you are calling to method “" + b + "” of removed object", b);
                };
            });
        var za = (b.pathBBox = function(a) {
                var b = ya(a);
                if (b.bbox) return c(b.bbox);
                if (!a) return { x: 0, y: 0, width: 0, height: 0, x2: 0, y2: 0 };
                a = Ia(a);
                for (var d, e = 0, f = 0, g = [], h = [], i = 0, j = a.length; j > i; i++)
                    if (((d = a[i]), "M" == d[0])) (e = d[1]), (f = d[2]), g.push(e), h.push(f);
                    else {
                        var k = Ha(e, f, d[1], d[2], d[3], d[4], d[5], d[6]);
                        (g = g[D](k.min.x, k.max.x)), (h = h[D](k.min.y, k.max.y)), (e = d[5]), (f = d[6]);
                    }
                var l = O[C](0, g),
                    m = O[C](0, h),
                    n = N[C](0, g),
                    o = N[C](0, h),
                    p = n - l,
                    q = o - m,
                    r = { x: l, y: m, x2: n, y2: o, width: p, height: q, cx: l + p / 2, cy: m + q / 2 };
                return (b.bbox = c(r)), r;
            }),
            Aa = function(a) {
                var d = c(a);
                return (d.toString = b._path2string), d;
            },
            Ba = (b._pathToRelative = function(a) {
                var c = ya(a);
                if (c.rel) return Aa(c.rel);
                (b.is(a, U) && b.is(a && a[0], U)) || (a = b.parsePathString(a));
                var d = [],
                    e = 0,
                    f = 0,
                    g = 0,
                    h = 0,
                    i = 0;
                "M" == a[0][0] && ((e = a[0][1]), (f = a[0][2]), (g = e), (h = f), i++, d.push(["M", e, f]));
                for (var j = i, k = a.length; k > j; j++) {
                    var l = (d[j] = []),
                        m = a[j];
                    if (m[0] != L.call(m[0]))
                        switch (((l[0] = L.call(m[0])), l[0])) {
                            case "a":
                                (l[1] = m[1]), (l[2] = m[2]), (l[3] = m[3]), (l[4] = m[4]), (l[5] = m[5]), (l[6] = +(m[6] - e).toFixed(3)), (l[7] = +(m[7] - f).toFixed(3));
                                break;
                            case "v":
                                l[1] = +(m[1] - f).toFixed(3);
                                break;
                            case "m":
                                (g = m[1]), (h = m[2]);
                            default:
                                for (var n = 1, o = m.length; o > n; n++) l[n] = +(m[n] - (n % 2 ? e : f)).toFixed(3);
                        }
                    else {
                        (l = d[j] = []), "m" == m[0] && ((g = m[1] + e), (h = m[2] + f));
                        for (var p = 0, q = m.length; q > p; p++) d[j][p] = m[p];
                    }
                    var r = d[j].length;
                    switch (d[j][0]) {
                        case "z":
                            (e = g), (f = h);
                            break;
                        case "h":
                            e += +d[j][r - 1];
                            break;
                        case "v":
                            f += +d[j][r - 1];
                            break;
                        default:
                            (e += +d[j][r - 2]), (f += +d[j][r - 1]);
                    }
                }
                return (d.toString = b._path2string), (c.rel = Aa(d)), d;
            }),
            Ca = (b._pathToAbsolute = function(a) {
                var c = ya(a);
                if (c.abs) return Aa(c.abs);
                if (((b.is(a, U) && b.is(a && a[0], U)) || (a = b.parsePathString(a)), !a || !a.length)) return [["M", 0, 0]];
                var d = [],
                    e = 0,
                    f = 0,
                    h = 0,
                    i = 0,
                    j = 0;
                "M" == a[0][0] && ((e = +a[0][1]), (f = +a[0][2]), (h = e), (i = f), j++, (d[0] = ["M", e, f]));
                for (var k, l, m = 3 == a.length && "M" == a[0][0] && "R" == a[1][0].toUpperCase() && "Z" == a[2][0].toUpperCase(), n = j, o = a.length; o > n; n++) {
                    if ((d.push((k = [])), (l = a[n]), l[0] != aa.call(l[0])))
                        switch (((k[0] = aa.call(l[0])), k[0])) {
                            case "A":
                                (k[1] = l[1]), (k[2] = l[2]), (k[3] = l[3]), (k[4] = l[4]), (k[5] = l[5]), (k[6] = +(l[6] + e)), (k[7] = +(l[7] + f));
                                break;
                            case "V":
                                k[1] = +l[1] + f;
                                break;
                            case "H":
                                k[1] = +l[1] + e;
                                break;
                            case "R":
                                for (var p = [e, f][D](l.slice(1)), q = 2, r = p.length; r > q; q++) (p[q] = +p[q] + e), (p[++q] = +p[q] + f);
                                d.pop(), (d = d[D](g(p, m)));
                                break;
                            case "M":
                                (h = +l[1] + e), (i = +l[2] + f);
                            default:
                                for (q = 1, r = l.length; r > q; q++) k[q] = +l[q] + (q % 2 ? e : f);
                        }
                    else if ("R" == l[0]) (p = [e, f][D](l.slice(1))), d.pop(), (d = d[D](g(p, m))), (k = ["R"][D](l.slice(-2)));
                    else for (var s = 0, t = l.length; t > s; s++) k[s] = l[s];
                    switch (k[0]) {
                        case "Z":
                            (e = h), (f = i);
                            break;
                        case "H":
                            e = k[1];
                            break;
                        case "V":
                            f = k[1];
                            break;
                        case "M":
                            (h = k[k.length - 2]), (i = k[k.length - 1]);
                        default:
                            (e = k[k.length - 2]), (f = k[k.length - 1]);
                    }
                }
                return (d.toString = b._path2string), (c.abs = Aa(d)), d;
            }),
            Da = function(a, b, c, d) {
                return [a, b, c, d, c, d];
            },
            Ea = function(a, b, c, d, e, f) {
                var g = 1 / 3,
                    h = 2 / 3;
                return [g * a + h * c, g * b + h * d, g * e + h * c, g * f + h * d, e, f];
            },
            Fa = function(a, b, c, d, f, g, h, i, j, k) {
                var l,
                    m = (120 * R) / 180,
                    n = (R / 180) * (+f || 0),
                    o = [],
                    p = e(function(a, b, c) {
                        var d = a * M.cos(c) - b * M.sin(c),
                            e = a * M.sin(c) + b * M.cos(c);
                        return { x: d, y: e };
                    });
                if (k) (y = k[0]), (z = k[1]), (w = k[2]), (x = k[3]);
                else {
                    (l = p(a, b, -n)), (a = l.x), (b = l.y), (l = p(i, j, -n)), (i = l.x), (j = l.y);
                    var q = (M.cos((R / 180) * f), M.sin((R / 180) * f), (a - i) / 2),
                        r = (b - j) / 2,
                        s = (q * q) / (c * c) + (r * r) / (d * d);
                    s > 1 && ((s = M.sqrt(s)), (c = s * c), (d = s * d));
                    var t = c * c,
                        u = d * d,
                        v = (g == h ? -1 : 1) * M.sqrt(P((t * u - t * r * r - u * q * q) / (t * r * r + u * q * q))),
                        w = (v * c * r) / d + (a + i) / 2,
                        x = (v * -d * q) / c + (b + j) / 2,
                        y = M.asin(((b - x) / d).toFixed(9)),
                        z = M.asin(((j - x) / d).toFixed(9));
                    (y = w > a ? R - y : y), (z = w > i ? R - z : z), 0 > y && (y = 2 * R + y), 0 > z && (z = 2 * R + z), h && y > z && (y -= 2 * R), !h && z > y && (z -= 2 * R);
                }
                var A = z - y;
                if (P(A) > m) {
                    var B = z,
                        C = i,
                        E = j;
                    (z = y + m * (h && z > y ? 1 : -1)), (i = w + c * M.cos(z)), (j = x + d * M.sin(z)), (o = Fa(i, j, c, d, f, 0, h, C, E, [z, B, w, x]));
                }
                A = z - y;
                var F = M.cos(y),
                    G = M.sin(y),
                    H = M.cos(z),
                    J = M.sin(z),
                    K = M.tan(A / 4),
                    L = (4 / 3) * c * K,
                    N = (4 / 3) * d * K,
                    O = [a, b],
                    Q = [a + L * G, b - N * F],
                    S = [i + L * J, j - N * H],
                    T = [i, j];
                if (((Q[0] = 2 * O[0] - Q[0]), (Q[1] = 2 * O[1] - Q[1]), k)) return [Q, S, T][D](o);
                o = [Q, S, T]
                    [D](o)
                    .join()
                    [I](",");
                for (var U = [], V = 0, W = o.length; W > V; V++) U[V] = V % 2 ? p(o[V - 1], o[V], n).y : p(o[V], o[V + 1], n).x;
                return U;
            },
            Ga = function(a, b, c, d, e, f, g, h, i) {
                var j = 1 - i;
                return { x: Q(j, 3) * a + 3 * Q(j, 2) * i * c + 3 * j * i * i * e + Q(i, 3) * g, y: Q(j, 3) * b + 3 * Q(j, 2) * i * d + 3 * j * i * i * f + Q(i, 3) * h };
            },
            Ha = e(function(a, b, c, d, e, f, g, h) {
                var i,
                    j = e - 2 * c + a - (g - 2 * e + c),
                    k = 2 * (c - a) - 2 * (e - c),
                    l = a - c,
                    m = (-k + M.sqrt(k * k - 4 * j * l)) / 2 / j,
                    n = (-k - M.sqrt(k * k - 4 * j * l)) / 2 / j,
                    o = [b, h],
                    p = [a, g];
                return (
                    P(m) > "1e12" && (m = 0.5),
                    P(n) > "1e12" && (n = 0.5),
                    m > 0 && 1 > m && ((i = Ga(a, b, c, d, e, f, g, h, m)), p.push(i.x), o.push(i.y)),
                    n > 0 && 1 > n && ((i = Ga(a, b, c, d, e, f, g, h, n)), p.push(i.x), o.push(i.y)),
                    (j = f - 2 * d + b - (h - 2 * f + d)),
                    (k = 2 * (d - b) - 2 * (f - d)),
                    (l = b - d),
                    (m = (-k + M.sqrt(k * k - 4 * j * l)) / 2 / j),
                    (n = (-k - M.sqrt(k * k - 4 * j * l)) / 2 / j),
                    P(m) > "1e12" && (m = 0.5),
                    P(n) > "1e12" && (n = 0.5),
                    m > 0 && 1 > m && ((i = Ga(a, b, c, d, e, f, g, h, m)), p.push(i.x), o.push(i.y)),
                    n > 0 && 1 > n && ((i = Ga(a, b, c, d, e, f, g, h, n)), p.push(i.x), o.push(i.y)),
                    { min: { x: O[C](0, p), y: O[C](0, o) }, max: { x: N[C](0, p), y: N[C](0, o) } }
                );
            }),
            Ia = (b._path2curve = e(
                function(a, b) {
                    var c = !b && ya(a);
                    if (!b && c.curve) return Aa(c.curve);
                    for (
                        var d = Ca(a),
                            e = b && Ca(b),
                            f = { x: 0, y: 0, bx: 0, by: 0, X: 0, Y: 0, qx: null, qy: null },
                            g = { x: 0, y: 0, bx: 0, by: 0, X: 0, Y: 0, qx: null, qy: null },
                            h = function(a, b, c) {
                                var d,
                                    e,
                                    f = { T: 1, Q: 1 };
                                if (!a) return ["C", b.x, b.y, b.x, b.y, b.x, b.y];
                                switch ((!(a[0] in f) && (b.qx = b.qy = null), a[0])) {
                                    case "M":
                                        (b.X = a[1]), (b.Y = a[2]);
                                        break;
                                    case "A":
                                        a = ["C"][D](Fa[C](0, [b.x, b.y][D](a.slice(1))));
                                        break;
                                    case "S":
                                        "C" == c || "S" == c ? ((d = 2 * b.x - b.bx), (e = 2 * b.y - b.by)) : ((d = b.x), (e = b.y)), (a = ["C", d, e][D](a.slice(1)));
                                        break;
                                    case "T":
                                        "Q" == c || "T" == c ? ((b.qx = 2 * b.x - b.qx), (b.qy = 2 * b.y - b.qy)) : ((b.qx = b.x), (b.qy = b.y)),
                                            (a = ["C"][D](Ea(b.x, b.y, b.qx, b.qy, a[1], a[2])));
                                        break;
                                    case "Q":
                                        (b.qx = a[1]), (b.qy = a[2]), (a = ["C"][D](Ea(b.x, b.y, a[1], a[2], a[3], a[4])));
                                        break;
                                    case "L":
                                        a = ["C"][D](Da(b.x, b.y, a[1], a[2]));
                                        break;
                                    case "H":
                                        a = ["C"][D](Da(b.x, b.y, a[1], b.y));
                                        break;
                                    case "V":
                                        a = ["C"][D](Da(b.x, b.y, b.x, a[1]));
                                        break;
                                    case "Z":
                                        a = ["C"][D](Da(b.x, b.y, b.X, b.Y));
                                }
                                return a;
                            },
                            i = function(a, b) {
                                if (a[b].length > 7) {
                                    a[b].shift();
                                    for (var c = a[b]; c.length; ) (k[b] = "A"), e && (l[b] = "A"), a.splice(b++, 0, ["C"][D](c.splice(0, 6)));
                                    a.splice(b, 1), (p = N(d.length, (e && e.length) || 0));
                                }
                            },
                            j = function(a, b, c, f, g) {
                                a &&
                                    b &&
                                    "M" == a[g][0] &&
                                    "M" != b[g][0] &&
                                    (b.splice(g, 0, ["M", f.x, f.y]), (c.bx = 0), (c.by = 0), (c.x = a[g][1]), (c.y = a[g][2]), (p = N(d.length, (e && e.length) || 0)));
                            },
                            k = [],
                            l = [],
                            m = "",
                            n = "",
                            o = 0,
                            p = N(d.length, (e && e.length) || 0);
                        p > o;
                        o++
                    ) {
                        d[o] && (m = d[o][0]),
                            "C" != m && ((k[o] = m), o && (n = k[o - 1])),
                            (d[o] = h(d[o], f, n)),
                            "A" != k[o] && "C" == m && (k[o] = "C"),
                            i(d, o),
                            e && (e[o] && (m = e[o][0]), "C" != m && ((l[o] = m), o && (n = l[o - 1])), (e[o] = h(e[o], g, n)), "A" != l[o] && "C" == m && (l[o] = "C"), i(e, o)),
                            j(d, e, f, g, o),
                            j(e, d, g, f, o);
                        var q = d[o],
                            r = e && e[o],
                            s = q.length,
                            t = e && r.length;
                        (f.x = q[s - 2]),
                            (f.y = q[s - 1]),
                            (f.bx = $(q[s - 4]) || f.x),
                            (f.by = $(q[s - 3]) || f.y),
                            (g.bx = e && ($(r[t - 4]) || g.x)),
                            (g.by = e && ($(r[t - 3]) || g.y)),
                            (g.x = e && r[t - 2]),
                            (g.y = e && r[t - 1]);
                    }
                    return e || (c.curve = Aa(d)), e ? [d, e] : d;
                },
                null,
                Aa
            )),
            Ja =
                ((b._parseDots = e(function(a) {
                    for (var c = [], d = 0, e = a.length; e > d; d++) {
                        var f = {},
                            g = a[d].match(/^([^:]*):?([\d\.]*)/);
                        if (((f.color = b.getRGB(g[1])), f.color.error)) return null;
                        (f.opacity = f.color.opacity), (f.color = f.color.hex), g[2] && (f.offset = g[2] + "%"), c.push(f);
                    }
                    for (d = 1, e = c.length - 1; e > d; d++)
                        if (!c[d].offset) {
                            for (var h = $(c[d - 1].offset || 0), i = 0, j = d + 1; e > j; j++)
                                if (c[j].offset) {
                                    i = c[j].offset;
                                    break;
                                }
                            i || ((i = 100), (j = e)), (i = $(i));
                            for (var k = (i - h) / (j - d + 1); j > d; d++) (h += k), (c[d].offset = h + "%");
                        }
                    return c;
                })),
                (b._tear = function(a, b) {
                    a == b.top && (b.top = a.prev), a == b.bottom && (b.bottom = a.next), a.next && (a.next.prev = a.prev), a.prev && (a.prev.next = a.next);
                })),
            Ka =
                ((b._tofront = function(a, b) {
                    b.top !== a && (Ja(a, b), (a.next = null), (a.prev = b.top), (b.top.next = a), (b.top = a));
                }),
                (b._toback = function(a, b) {
                    b.bottom !== a && (Ja(a, b), (a.next = b.bottom), (a.prev = null), (b.bottom.prev = a), (b.bottom = a));
                }),
                (b._insertafter = function(a, b, c) {
                    Ja(a, c), b == c.top && (c.top = a), b.next && (b.next.prev = a), (a.next = b.next), (a.prev = b), (b.next = a);
                }),
                (b._insertbefore = function(a, b, c) {
                    Ja(a, c), b == c.bottom && (c.bottom = a), b.prev && (b.prev.next = a), (a.prev = b.prev), (b.prev = a), (a.next = b);
                }),
                (b.toMatrix = function(a, b) {
                    var c = za(a),
                        d = {
                            _: { transform: F },
                            getBBox: function() {
                                return c;
                            }
                        };
                    return La(d, b), d.matrix;
                })),
            La =
                ((b.transformPath = function(a, b) {
                    return pa(a, Ka(a, b));
                }),
                (b._extractTransform = function(a, c) {
                    if (null == c) return a._.transform;
                    c = H(c).replace(/\.{3}|\u2026/g, a._.transform || F);
                    var d = b.parseTransformString(c),
                        e = 0,
                        f = 0,
                        g = 0,
                        h = 1,
                        i = 1,
                        j = a._,
                        k = new n();
                    if (((j.transform = d || []), d))
                        for (var l = 0, m = d.length; m > l; l++) {
                            var o,
                                p,
                                q,
                                r,
                                s,
                                t = d[l],
                                u = t.length,
                                v = H(t[0]).toLowerCase(),
                                w = t[0] != v,
                                x = w ? k.invert() : 0;
                            "t" == v && 3 == u
                                ? w
                                    ? ((o = x.x(0, 0)), (p = x.y(0, 0)), (q = x.x(t[1], t[2])), (r = x.y(t[1], t[2])), k.translate(q - o, r - p))
                                    : k.translate(t[1], t[2])
                                : "r" == v
                                ? 2 == u
                                    ? ((s = s || a.getBBox(1)), k.rotate(t[1], s.x + s.width / 2, s.y + s.height / 2), (e += t[1]))
                                    : 4 == u && (w ? ((q = x.x(t[2], t[3])), (r = x.y(t[2], t[3])), k.rotate(t[1], q, r)) : k.rotate(t[1], t[2], t[3]), (e += t[1]))
                                : "s" == v
                                ? 2 == u || 3 == u
                                    ? ((s = s || a.getBBox(1)), k.scale(t[1], t[u - 1], s.x + s.width / 2, s.y + s.height / 2), (h *= t[1]), (i *= t[u - 1]))
                                    : 5 == u &&
                                      (w ? ((q = x.x(t[3], t[4])), (r = x.y(t[3], t[4])), k.scale(t[1], t[2], q, r)) : k.scale(t[1], t[2], t[3], t[4]), (h *= t[1]), (i *= t[2]))
                                : "m" == v && 7 == u && k.add(t[1], t[2], t[3], t[4], t[5], t[6]),
                                (j.dirtyT = 1),
                                (a.matrix = k);
                        }
                    (a.matrix = k),
                        (j.sx = h),
                        (j.sy = i),
                        (j.deg = e),
                        (j.dx = f = k.e),
                        (j.dy = g = k.f),
                        1 == h && 1 == i && !e && j.bbox ? ((j.bbox.x += +f), (j.bbox.y += +g)) : (j.dirtyT = 1);
                })),
            Ma = function(a) {
                var b = a[0];
                switch (b.toLowerCase()) {
                    case "t":
                        return [b, 0, 0];
                    case "m":
                        return [b, 1, 0, 0, 1, 0, 0];
                    case "r":
                        return 4 == a.length ? [b, 0, a[2], a[3]] : [b, 0];
                    case "s":
                        return 5 == a.length ? [b, 1, 1, a[3], a[4]] : 3 == a.length ? [b, 1, 1] : [b, 1];
                }
            },
            Na = (b._equaliseTransform = function(a, c) {
                (c = H(c).replace(/\.{3}|\u2026/g, a)), (a = b.parseTransformString(a) || []), (c = b.parseTransformString(c) || []);
                for (var d, e, f, g, h = N(a.length, c.length), i = [], j = [], k = 0; h > k; k++) {
                    if (
                        ((f = a[k] || Ma(c[k])),
                        (g = c[k] || Ma(f)),
                        f[0] != g[0] || ("r" == f[0].toLowerCase() && (f[2] != g[2] || f[3] != g[3])) || ("s" == f[0].toLowerCase() && (f[3] != g[3] || f[4] != g[4])))
                    )
                        return;
                    for (i[k] = [], j[k] = [], d = 0, e = N(f.length, g.length); e > d; d++) d in f && (i[k][d] = f[d]), d in g && (j[k][d] = g[d]);
                }
                return { from: i, to: j };
            });
        (b._getContainer = function(a, c, d, e) {
            var f;
            return (
                (f = null != e || b.is(a, "object") ? a : z.doc.getElementById(a)),
                null != f
                    ? f.tagName
                        ? null == c
                            ? { container: f, width: f.style.pixelWidth || f.offsetWidth, height: f.style.pixelHeight || f.offsetHeight }
                            : { container: f, width: c, height: d }
                        : { container: 1, x: a, y: c, width: d, height: e }
                    : void 0
            );
        }),
            (b.pathToRelative = Ba),
            (b._engine = {}),
            (b.path2curve = Ia),
            (b.matrix = function(a, b, c, d, e, f) {
                return new n(a, b, c, d, e, f);
            }),
            (function(a) {
                function c(a) {
                    return a[0] * a[0] + a[1] * a[1];
                }
                function d(a) {
                    var b = M.sqrt(c(a));
                    a[0] && (a[0] /= b), a[1] && (a[1] /= b);
                }
                (a.add = function(a, b, c, d, e, f) {
                    var g,
                        h,
                        i,
                        j,
                        k = [[], [], []],
                        l = [
                            [this.a, this.c, this.e],
                            [this.b, this.d, this.f],
                            [0, 0, 1]
                        ],
                        m = [
                            [a, c, e],
                            [b, d, f],
                            [0, 0, 1]
                        ];
                    for (
                        a &&
                            a instanceof n &&
                            (m = [
                                [a.a, a.c, a.e],
                                [a.b, a.d, a.f],
                                [0, 0, 1]
                            ]),
                            g = 0;
                        3 > g;
                        g++
                    )
                        for (h = 0; 3 > h; h++) {
                            for (j = 0, i = 0; 3 > i; i++) j += l[g][i] * m[i][h];
                            k[g][h] = j;
                        }
                    (this.a = k[0][0]), (this.b = k[1][0]), (this.c = k[0][1]), (this.d = k[1][1]), (this.e = k[0][2]), (this.f = k[1][2]);
                }),
                    (a.invert = function() {
                        var a = this,
                            b = a.a * a.d - a.b * a.c;
                        return new n(a.d / b, -a.b / b, -a.c / b, a.a / b, (a.c * a.f - a.d * a.e) / b, (a.b * a.e - a.a * a.f) / b);
                    }),
                    (a.clone = function() {
                        return new n(this.a, this.b, this.c, this.d, this.e, this.f);
                    }),
                    (a.translate = function(a, b) {
                        this.add(1, 0, 0, 1, a, b);
                    }),
                    (a.scale = function(a, b, c, d) {
                        null == b && (b = a), (c || d) && this.add(1, 0, 0, 1, c, d), this.add(a, 0, 0, b, 0, 0), (c || d) && this.add(1, 0, 0, 1, -c, -d);
                    }),
                    (a.rotate = function(a, c, d) {
                        (a = b.rad(a)), (c = c || 0), (d = d || 0);
                        var e = +M.cos(a).toFixed(9),
                            f = +M.sin(a).toFixed(9);
                        this.add(e, f, -f, e, c, d), this.add(1, 0, 0, 1, -c, -d);
                    }),
                    (a.x = function(a, b) {
                        return a * this.a + b * this.c + this.e;
                    }),
                    (a.y = function(a, b) {
                        return a * this.b + b * this.d + this.f;
                    }),
                    (a.get = function(a) {
                        return +this[H.fromCharCode(97 + a)].toFixed(4);
                    }),
                    (a.toString = function() {
                        return b.svg
                            ? "matrix(" + [this.get(0), this.get(1), this.get(2), this.get(3), this.get(4), this.get(5)].join() + ")"
                            : [this.get(0), this.get(2), this.get(1), this.get(3), 0, 0].join();
                    }),
                    (a.toFilter = function() {
                        return (
                            "progid:DXImageTransform.Microsoft.Matrix(M11=" +
                            this.get(0) +
                            ", M12=" +
                            this.get(2) +
                            ", M21=" +
                            this.get(1) +
                            ", M22=" +
                            this.get(3) +
                            ", Dx=" +
                            this.get(4) +
                            ", Dy=" +
                            this.get(5) +
                            ", sizingmethod='auto expand')"
                        );
                    }),
                    (a.offset = function() {
                        return [this.e.toFixed(4), this.f.toFixed(4)];
                    }),
                    (a.split = function() {
                        var a = {};
                        (a.dx = this.e), (a.dy = this.f);
                        var e = [
                            [this.a, this.c],
                            [this.b, this.d]
                        ];
                        (a.scalex = M.sqrt(c(e[0]))),
                            d(e[0]),
                            (a.shear = e[0][0] * e[1][0] + e[0][1] * e[1][1]),
                            (e[1] = [e[1][0] - e[0][0] * a.shear, e[1][1] - e[0][1] * a.shear]),
                            (a.scaley = M.sqrt(c(e[1]))),
                            d(e[1]),
                            (a.shear /= a.scaley);
                        var f = -e[0][1],
                            g = e[1][1];
                        return (
                            0 > g ? ((a.rotate = b.deg(M.acos(g))), 0 > f && (a.rotate = 360 - a.rotate)) : (a.rotate = b.deg(M.asin(f))),
                            (a.isSimple = !(+a.shear.toFixed(9) || (a.scalex.toFixed(9) != a.scaley.toFixed(9) && a.rotate))),
                            (a.isSuperSimple = !+a.shear.toFixed(9) && a.scalex.toFixed(9) == a.scaley.toFixed(9) && !a.rotate),
                            (a.noRotation = !+a.shear.toFixed(9) && !a.rotate),
                            a
                        );
                    }),
                    (a.toTransformString = function(a) {
                        var b = a || this[I]();
                        return b.isSimple
                            ? ((b.scalex = +b.scalex.toFixed(4)),
                              (b.scaley = +b.scaley.toFixed(4)),
                              (b.rotate = +b.rotate.toFixed(4)),
                              (b.dx || b.dy ? "t" + [b.dx, b.dy] : F) +
                                  (1 != b.scalex || 1 != b.scaley ? "s" + [b.scalex, b.scaley, 0, 0] : F) +
                                  (b.rotate ? "r" + [b.rotate, 0, 0] : F))
                            : "m" + [this.get(0), this.get(1), this.get(2), this.get(3), this.get(4), this.get(5)];
                    });
            })(n.prototype);
        for (
            var Oa = function() {
                    this.returnValue = !1;
                },
                Pa = function() {
                    return this.originalEvent.preventDefault();
                },
                Qa = function() {
                    this.cancelBubble = !0;
                },
                Ra = function() {
                    return this.originalEvent.stopPropagation();
                },
                Sa = function(a) {
                    var b = z.doc.documentElement.scrollTop || z.doc.body.scrollTop,
                        c = z.doc.documentElement.scrollLeft || z.doc.body.scrollLeft;
                    return { x: a.clientX + c, y: a.clientY + b };
                },
                Ta = (function() {
                    return z.doc.addEventListener
                        ? function(a, b, c, d) {
                              var e = function(a) {
                                  var b = Sa(a);
                                  return c.call(d, a, b.x, b.y);
                              };
                              if ((a.addEventListener(b, e, !1), E && K[b])) {
                                  var f = function(b) {
                                      for (var e = Sa(b), f = b, g = 0, h = b.targetTouches && b.targetTouches.length; h > g; g++)
                                          if (b.targetTouches[g].target == a) {
                                              (b = b.targetTouches[g]), (b.originalEvent = f), (b.preventDefault = Pa), (b.stopPropagation = Ra);
                                              break;
                                          }
                                      return c.call(d, b, e.x, e.y);
                                  };
                                  a.addEventListener(K[b], f, !1);
                              }
                              return function() {
                                  return a.removeEventListener(b, e, !1), E && K[b] && a.removeEventListener(K[b], f, !1), !0;
                              };
                          }
                        : z.doc.attachEvent
                        ? function(a, b, c, d) {
                              var e = function(a) {
                                  a = a || z.win.event;
                                  var b = z.doc.documentElement.scrollTop || z.doc.body.scrollTop,
                                      e = z.doc.documentElement.scrollLeft || z.doc.body.scrollLeft,
                                      f = a.clientX + e,
                                      g = a.clientY + b;
                                  return (a.preventDefault = a.preventDefault || Oa), (a.stopPropagation = a.stopPropagation || Qa), c.call(d, a, f, g);
                              };
                              a.attachEvent("on" + b, e);
                              var f = function() {
                                  return a.detachEvent("on" + b, e), !0;
                              };
                              return f;
                          }
                        : void 0;
                })(),
                Ua = [],
                Va = function(b) {
                    for (
                        var c,
                            d = b.clientX,
                            e = b.clientY,
                            f = z.doc.documentElement.scrollTop || z.doc.body.scrollTop,
                            g = z.doc.documentElement.scrollLeft || z.doc.body.scrollLeft,
                            h = Ua.length;
                        h--;

                    ) {
                        if (((c = Ua[h]), E && b.touches)) {
                            for (var i, j = b.touches.length; j--; )
                                if (((i = b.touches[j]), i.identifier == c.el._drag.id)) {
                                    (d = i.clientX), (e = i.clientY), (b.originalEvent ? b.originalEvent : b).preventDefault();
                                    break;
                                }
                        } else b.preventDefault();
                        var k,
                            l = c.el.node,
                            m = l.nextSibling,
                            n = l.parentNode,
                            o = l.style.display;
                        z.win.opera && n.removeChild(l),
                            (l.style.display = "none"),
                            (k = c.el.paper.getElementByPoint(d, e)),
                            (l.style.display = o),
                            z.win.opera && (m ? n.insertBefore(l, m) : n.appendChild(l)),
                            k && a("raphael.drag.over." + c.el.id, c.el, k),
                            (d += g),
                            (e += f),
                            a("raphael.drag.move." + c.el.id, c.move_scope || c.el, d - c.el._drag.x, e - c.el._drag.y, d, e, b);
                    }
                },
                Wa = function(c) {
                    b.unmousemove(Va).unmouseup(Wa);
                    for (var d, e = Ua.length; e--; ) (d = Ua[e]), (d.el._drag = {}), a("raphael.drag.end." + d.el.id, d.end_scope || d.start_scope || d.move_scope || d.el, c);
                    Ua = [];
                },
                Xa = (b.el = {}),
                Ya = J.length;
            Ya--;

        )
            !(function(a) {
                (b[a] = Xa[a] = function(c, d) {
                    return (
                        b.is(c, "function") &&
                            ((this.events = this.events || []), this.events.push({ name: a, f: c, unbind: Ta(this.shape || this.node || z.doc, a, c, d || this) })),
                        this
                    );
                }),
                    (b["un" + a] = Xa["un" + a] = function(c) {
                        for (var d = this.events || [], e = d.length; e--; )
                            d[e].name != a || (!b.is(c, "undefined") && d[e].f != c) || (d[e].unbind(), d.splice(e, 1), !d.length && delete this.events);
                        return this;
                    });
            })(J[Ya]);
        (Xa.data = function(c, d) {
            var e = (ja[this.id] = ja[this.id] || {});
            if (0 == arguments.length) return e;
            if (1 == arguments.length) {
                if (b.is(c, "object")) {
                    for (var f in c) c[y](f) && this.data(f, c[f]);
                    return this;
                }
                return a("raphael.data.get." + this.id, this, e[c], c), e[c];
            }
            return (e[c] = d), a("raphael.data.set." + this.id, this, d, c), this;
        }),
            (Xa.removeData = function(a) {
                return null == a ? (ja[this.id] = {}) : ja[this.id] && delete ja[this.id][a], this;
            }),
            (Xa.getData = function() {
                return c(ja[this.id] || {});
            }),
            (Xa.hover = function(a, b, c, d) {
                return this.mouseover(a, c).mouseout(b, d || c);
            }),
            (Xa.unhover = function(a, b) {
                return this.unmouseover(a).unmouseout(b);
            });
        var Za = [];
        (Xa.drag = function(c, d, e, f, g, h) {
            function i(i) {
                (i.originalEvent || i).preventDefault();
                var j = i.clientX,
                    k = i.clientY,
                    l = z.doc.documentElement.scrollTop || z.doc.body.scrollTop,
                    m = z.doc.documentElement.scrollLeft || z.doc.body.scrollLeft;
                if (((this._drag.id = i.identifier), E && i.touches))
                    for (var n, o = i.touches.length; o--; )
                        if (((n = i.touches[o]), (this._drag.id = n.identifier), n.identifier == this._drag.id)) {
                            (j = n.clientX), (k = n.clientY);
                            break;
                        }
                (this._drag.x = j + m),
                    (this._drag.y = k + l),
                    !Ua.length && b.mousemove(Va).mouseup(Wa),
                    Ua.push({ el: this, move_scope: f, start_scope: g, end_scope: h }),
                    d && a.on("raphael.drag.start." + this.id, d),
                    c && a.on("raphael.drag.move." + this.id, c),
                    e && a.on("raphael.drag.end." + this.id, e),
                    a("raphael.drag.start." + this.id, g || f || this, i.clientX + m, i.clientY + l, i);
            }
            return (this._drag = {}), Za.push({ el: this, start: i }), this.mousedown(i), this;
        }),
            (Xa.onDragOver = function(b) {
                b ? a.on("raphael.drag.over." + this.id, b) : a.unbind("raphael.drag.over." + this.id);
            }),
            (Xa.undrag = function() {
                for (var c = Za.length; c--; ) Za[c].el == this && (this.unmousedown(Za[c].start), Za.splice(c, 1), a.unbind("raphael.drag.*." + this.id));
                !Za.length && b.unmousemove(Va).unmouseup(Wa), (Ua = []);
            }),
            (u.circle = function(a, c, d) {
                var e = b._engine.circle(this, a || 0, c || 0, d || 0);
                return this.__set__ && this.__set__.push(e), e;
            }),
            (u.rect = function(a, c, d, e, f) {
                var g = b._engine.rect(this, a || 0, c || 0, d || 0, e || 0, f || 0);
                return this.__set__ && this.__set__.push(g), g;
            }),
            (u.ellipse = function(a, c, d, e) {
                var f = b._engine.ellipse(this, a || 0, c || 0, d || 0, e || 0);
                return this.__set__ && this.__set__.push(f), f;
            }),
            (u.path = function(a) {
                a && !b.is(a, T) && !b.is(a[0], U) && (a += F);
                var c = b._engine.path(b.format[C](b, arguments), this);
                return this.__set__ && this.__set__.push(c), c;
            }),
            (u.image = function(a, c, d, e, f) {
                var g = b._engine.image(this, a || "about:blank", c || 0, d || 0, e || 0, f || 0);
                return this.__set__ && this.__set__.push(g), g;
            }),
            (u.text = function(a, c, d) {
                var e = b._engine.text(this, a || 0, c || 0, H(d));
                return this.__set__ && this.__set__.push(e), e;
            }),
            (u.set = function(a) {
                !b.is(a, "array") && (a = Array.prototype.splice.call(arguments, 0, arguments.length));
                var c = new jb(a);
                return this.__set__ && this.__set__.push(c), (c.paper = this), (c.type = "set"), c;
            }),
            (u.setStart = function(a) {
                this.__set__ = a || this.set();
            }),
            (u.setFinish = function(a) {
                var b = this.__set__;
                return delete this.__set__, b;
            }),
            (u.getSize = function() {
                var a = this.canvas.parentNode;
                return { width: a.offsetWidth, height: a.offsetHeight };
            }),
            (u.setSize = function(a, c) {
                return b._engine.setSize.call(this, a, c);
            }),
            (u.setViewBox = function(a, c, d, e, f) {
                return b._engine.setViewBox.call(this, a, c, d, e, f);
            }),
            (u.top = u.bottom = null),
            (u.raphael = b);
        var $a = function(a) {
            var b = a.getBoundingClientRect(),
                c = a.ownerDocument,
                d = c.body,
                e = c.documentElement,
                f = e.clientTop || d.clientTop || 0,
                g = e.clientLeft || d.clientLeft || 0,
                h = b.top + (z.win.pageYOffset || e.scrollTop || d.scrollTop) - f,
                i = b.left + (z.win.pageXOffset || e.scrollLeft || d.scrollLeft) - g;
            return { y: h, x: i };
        };
        (u.getElementByPoint = function(a, b) {
            var c = this,
                d = c.canvas,
                e = z.doc.elementFromPoint(a, b);
            if (z.win.opera && "svg" == e.tagName) {
                var f = $a(d),
                    g = d.createSVGRect();
                (g.x = a - f.x), (g.y = b - f.y), (g.width = g.height = 1);
                var h = d.getIntersectionList(g, null);
                h.length && (e = h[h.length - 1]);
            }
            if (!e) return null;
            for (; e.parentNode && e != d.parentNode && !e.raphael; ) e = e.parentNode;
            return e == c.canvas.parentNode && (e = d), (e = e && e.raphael ? c.getById(e.raphaelid) : null);
        }),
            (u.getElementsByBBox = function(a) {
                var c = this.set();
                return (
                    this.forEach(function(d) {
                        b.isBBoxIntersect(d.getBBox(), a) && c.push(d);
                    }),
                    c
                );
            }),
            (u.getById = function(a) {
                for (var b = this.bottom; b; ) {
                    if (b.id == a) return b;
                    b = b.next;
                }
                return null;
            }),
            (u.forEach = function(a, b) {
                for (var c = this.bottom; c; ) {
                    if (a.call(b, c) === !1) return this;
                    c = c.next;
                }
                return this;
            }),
            (u.getElementsByPoint = function(a, b) {
                var c = this.set();
                return (
                    this.forEach(function(d) {
                        d.isPointInside(a, b) && c.push(d);
                    }),
                    c
                );
            }),
            (Xa.isPointInside = function(a, c) {
                var d = (this.realPath = oa[this.type](this));
                return this.attr("transform") && this.attr("transform").length && (d = b.transformPath(d, this.attr("transform"))), b.isPointInsidePath(d, a, c);
            }),
            (Xa.getBBox = function(a) {
                if (this.removed) return {};
                var b = this._;
                return a
                    ? ((b.dirty || !b.bboxwt) && ((this.realPath = oa[this.type](this)), (b.bboxwt = za(this.realPath)), (b.bboxwt.toString = o), (b.dirty = 0)), b.bboxwt)
                    : ((b.dirty || b.dirtyT || !b.bbox) &&
                          ((b.dirty || !this.realPath) && ((b.bboxwt = 0), (this.realPath = oa[this.type](this))),
                          (b.bbox = za(pa(this.realPath, this.matrix))),
                          (b.bbox.toString = o),
                          (b.dirty = b.dirtyT = 0)),
                      b.bbox);
            }),
            (Xa.clone = function() {
                if (this.removed) return null;
                var a = this.paper[this.type]().attr(this.attr());
                return this.__set__ && this.__set__.push(a), a;
            }),
            (Xa.glow = function(a) {
                if ("text" == this.type) return null;
                a = a || {};
                var b = {
                        width: (a.width || 10) + (+this.attr("stroke-width") || 1),
                        fill: a.fill || !1,
                        opacity: null == a.opacity ? 0.5 : a.opacity,
                        offsetx: a.offsetx || 0,
                        offsety: a.offsety || 0,
                        color: a.color || "#000"
                    },
                    c = b.width / 2,
                    d = this.paper,
                    e = d.set(),
                    f = this.realPath || oa[this.type](this);
                f = this.matrix ? pa(f, this.matrix) : f;
                for (var g = 1; c + 1 > g; g++)
                    e.push(
                        d.path(f).attr({
                            stroke: b.color,
                            fill: b.fill ? b.color : "none",
                            "stroke-linejoin": "round",
                            "stroke-linecap": "round",
                            "stroke-width": +((b.width / c) * g).toFixed(3),
                            opacity: +(b.opacity / c).toFixed(3)
                        })
                    );
                return e.insertBefore(this).translate(b.offsetx, b.offsety);
            });
        var _a = function(a, c, d, e, f, g, h, k, l) {
                return null == l ? i(a, c, d, e, f, g, h, k) : b.findDotsAtSegment(a, c, d, e, f, g, h, k, j(a, c, d, e, f, g, h, k, l));
            },
            ab = function(a, c) {
                return function(d, e, f) {
                    d = Ia(d);
                    for (var g, h, i, j, k, l = "", m = {}, n = 0, o = 0, p = d.length; p > o; o++) {
                        if (((i = d[o]), "M" == i[0])) (g = +i[1]), (h = +i[2]);
                        else {
                            if (((j = _a(g, h, i[1], i[2], i[3], i[4], i[5], i[6])), n + j > e)) {
                                if (c && !m.start) {
                                    if (((k = _a(g, h, i[1], i[2], i[3], i[4], i[5], i[6], e - n)), (l += ["C" + k.start.x, k.start.y, k.m.x, k.m.y, k.x, k.y]), f)) return l;
                                    (m.start = l), (l = ["M" + k.x, k.y + "C" + k.n.x, k.n.y, k.end.x, k.end.y, i[5], i[6]].join()), (n += j), (g = +i[5]), (h = +i[6]);
                                    continue;
                                }
                                if (!a && !c) return (k = _a(g, h, i[1], i[2], i[3], i[4], i[5], i[6], e - n)), { x: k.x, y: k.y, alpha: k.alpha };
                            }
                            (n += j), (g = +i[5]), (h = +i[6]);
                        }
                        l += i.shift() + i;
                    }
                    return (
                        (m.end = l), (k = a ? n : c ? m : b.findDotsAtSegment(g, h, i[0], i[1], i[2], i[3], i[4], i[5], 1)), k.alpha && (k = { x: k.x, y: k.y, alpha: k.alpha }), k
                    );
                };
            },
            bb = ab(1),
            cb = ab(),
            db = ab(0, 1);
        (b.getTotalLength = bb),
            (b.getPointAtLength = cb),
            (b.getSubpath = function(a, b, c) {
                if (this.getTotalLength(a) - c < 1e-6) return db(a, b).end;
                var d = db(a, c, 1);
                return b ? db(d, b).end : d;
            }),
            (Xa.getTotalLength = function() {
                var a = this.getPath();
                if (a) return this.node.getTotalLength ? this.node.getTotalLength() : bb(a);
            }),
            (Xa.getPointAtLength = function(a) {
                var b = this.getPath();
                if (b) return cb(b, a);
            }),
            (Xa.getPath = function() {
                var a,
                    c = b._getPath[this.type];
                if ("text" != this.type && "set" != this.type) return c && (a = c(this)), a;
            }),
            (Xa.getSubpath = function(a, c) {
                var d = this.getPath();
                if (d) return b.getSubpath(d, a, c);
            });
        var eb = (b.easing_formulas = {
            linear: function(a) {
                return a;
            },
            "<": function(a) {
                return Q(a, 1.7);
            },
            ">": function(a) {
                return Q(a, 0.48);
            },
            "<>": function(a) {
                var b = 0.48 - a / 1.04,
                    c = M.sqrt(0.1734 + b * b),
                    d = c - b,
                    e = Q(P(d), 1 / 3) * (0 > d ? -1 : 1),
                    f = -c - b,
                    g = Q(P(f), 1 / 3) * (0 > f ? -1 : 1),
                    h = e + g + 0.5;
                return 3 * (1 - h) * h * h + h * h * h;
            },
            backIn: function(a) {
                var b = 1.70158;
                return a * a * ((b + 1) * a - b);
            },
            backOut: function(a) {
                a -= 1;
                var b = 1.70158;
                return a * a * ((b + 1) * a + b) + 1;
            },
            elastic: function(a) {
                return a == !!a ? a : Q(2, -10 * a) * M.sin((2 * (a - 0.075) * R) / 0.3) + 1;
            },
            bounce: function(a) {
                var b,
                    c = 7.5625,
                    d = 2.75;
                return (
                    1 / d > a
                        ? (b = c * a * a)
                        : 2 / d > a
                        ? ((a -= 1.5 / d), (b = c * a * a + 0.75))
                        : 2.5 / d > a
                        ? ((a -= 2.25 / d), (b = c * a * a + 0.9375))
                        : ((a -= 2.625 / d), (b = c * a * a + 0.984375)),
                    b
                );
            }
        });
        (eb.easeIn = eb["ease-in"] = eb["<"]),
            (eb.easeOut = eb["ease-out"] = eb[">"]),
            (eb.easeInOut = eb["ease-in-out"] = eb["<>"]),
            (eb["back-in"] = eb.backIn),
            (eb["back-out"] = eb.backOut);
        var fb = [],
            gb =
                window.requestAnimationFrame ||
                window.webkitRequestAnimationFrame ||
                window.mozRequestAnimationFrame ||
                window.oRequestAnimationFrame ||
                window.msRequestAnimationFrame ||
                function(a) {
                    setTimeout(a, 16);
                },
            hb = function() {
                for (var c = +new Date(), d = 0; d < fb.length; d++) {
                    var e = fb[d];
                    if (!e.el.removed && !e.paused) {
                        var f,
                            g,
                            h = c - e.start,
                            i = e.ms,
                            j = e.easing,
                            k = e.from,
                            l = e.diff,
                            m = e.to,
                            n = (e.t, e.el),
                            o = {},
                            p = {};
                        if (
                            (e.initstatus
                                ? ((h = ((e.initstatus * e.anim.top - e.prev) / (e.percent - e.prev)) * i),
                                  (e.status = e.initstatus),
                                  delete e.initstatus,
                                  e.stop && fb.splice(d--, 1))
                                : (e.status = (e.prev + (e.percent - e.prev) * (h / i)) / e.anim.top),
                            !(0 > h))
                        )
                            if (i > h) {
                                var q = j(h / i);
                                for (var s in k)
                                    if (k[y](s)) {
                                        switch (ca[s]) {
                                            case S:
                                                f = +k[s] + q * i * l[s];
                                                break;
                                            case "colour":
                                                f = "rgb(" + [ib(Z(k[s].r + q * i * l[s].r)), ib(Z(k[s].g + q * i * l[s].g)), ib(Z(k[s].b + q * i * l[s].b))].join(",") + ")";
                                                break;
                                            case "path":
                                                f = [];
                                                for (var t = 0, u = k[s].length; u > t; t++) {
                                                    f[t] = [k[s][t][0]];
                                                    for (var v = 1, w = k[s][t].length; w > v; v++) f[t][v] = +k[s][t][v] + q * i * l[s][t][v];
                                                    f[t] = f[t].join(G);
                                                }
                                                f = f.join(G);
                                                break;
                                            case "transform":
                                                if (l[s].real)
                                                    for (f = [], t = 0, u = k[s].length; u > t; t++)
                                                        for (f[t] = [k[s][t][0]], v = 1, w = k[s][t].length; w > v; v++) f[t][v] = k[s][t][v] + q * i * l[s][t][v];
                                                else {
                                                    var x = function(a) {
                                                        return +k[s][a] + q * i * l[s][a];
                                                    };
                                                    f = [["m", x(0), x(1), x(2), x(3), x(4), x(5)]];
                                                }
                                                break;
                                            case "csv":
                                                if ("clip-rect" == s) for (f = [], t = 4; t--; ) f[t] = +k[s][t] + q * i * l[s][t];
                                                break;
                                            default:
                                                var z = [][D](k[s]);
                                                for (f = [], t = n.paper.customAttributes[s].length; t--; ) f[t] = +z[t] + q * i * l[s][t];
                                        }
                                        o[s] = f;
                                    }
                                n.attr(o),
                                    (function(b, c, d) {
                                        setTimeout(function() {
                                            a("raphael.anim.frame." + b, c, d);
                                        });
                                    })(n.id, n, e.anim);
                            } else {
                                if (
                                    ((function(c, d, e) {
                                        setTimeout(function() {
                                            a("raphael.anim.frame." + d.id, d, e), a("raphael.anim.finish." + d.id, d, e), b.is(c, "function") && c.call(d);
                                        });
                                    })(e.callback, n, e.anim),
                                    n.attr(m),
                                    fb.splice(d--, 1),
                                    e.repeat > 1 && !e.next)
                                ) {
                                    for (g in m) m[y](g) && (p[g] = e.totalOrigin[g]);
                                    e.el.attr(p), r(e.anim, e.el, e.anim.percents[0], null, e.totalOrigin, e.repeat - 1);
                                }
                                e.next && !e.stop && r(e.anim, e.el, e.next, null, e.totalOrigin, e.repeat);
                            }
                    }
                }
                fb.length && gb(hb);
            },
            ib = function(a) {
                return a > 255 ? 255 : 0 > a ? 0 : a;
            };
        (Xa.animateWith = function(a, c, d, e, f, g) {
            var h = this;
            if (h.removed) return g && g.call(h), h;
            var i = d instanceof q ? d : b.animation(d, e, f, g);
            r(i, h, i.percents[0], null, h.attr());
            for (var j = 0, k = fb.length; k > j; j++)
                if (fb[j].anim == c && fb[j].el == a) {
                    fb[k - 1].start = fb[j].start;
                    break;
                }
            return h;
        }),
            (Xa.onAnimation = function(b) {
                return b ? a.on("raphael.anim.frame." + this.id, b) : a.unbind("raphael.anim.frame." + this.id), this;
            }),
            (q.prototype.delay = function(a) {
                var b = new q(this.anim, this.ms);
                return (b.times = this.times), (b.del = +a || 0), b;
            }),
            (q.prototype.repeat = function(a) {
                var b = new q(this.anim, this.ms);
                return (b.del = this.del), (b.times = M.floor(N(a, 0)) || 1), b;
            }),
            (b.animation = function(a, c, d, e) {
                if (a instanceof q) return a;
                (b.is(d, "function") || !d) && ((e = e || d || null), (d = null)), (a = Object(a)), (c = +c || 0);
                var f,
                    g,
                    h = {};
                for (g in a) a[y](g) && $(g) != g && $(g) + "%" != g && ((f = !0), (h[g] = a[g]));
                if (f) return d && (h.easing = d), e && (h.callback = e), new q({ 100: h }, c);
                if (e) {
                    var i = 0;
                    for (var j in a) {
                        var k = _(j);
                        a[y](j) && k > i && (i = k);
                    }
                    (i += "%"), !a[i].callback && (a[i].callback = e);
                }
                return new q(a, c);
            }),
            (Xa.animate = function(a, c, d, e) {
                var f = this;
                if (f.removed) return e && e.call(f), f;
                var g = a instanceof q ? a : b.animation(a, c, d, e);
                return r(g, f, g.percents[0], null, f.attr()), f;
            }),
            (Xa.setTime = function(a, b) {
                return a && null != b && this.status(a, O(b, a.ms) / a.ms), this;
            }),
            (Xa.status = function(a, b) {
                var c,
                    d,
                    e = [],
                    f = 0;
                if (null != b) return r(a, this, -1, O(b, 1)), this;
                for (c = fb.length; c > f; f++)
                    if (((d = fb[f]), d.el.id == this.id && (!a || d.anim == a))) {
                        if (a) return d.status;
                        e.push({ anim: d.anim, status: d.status });
                    }
                return a ? 0 : e;
            }),
            (Xa.pause = function(b) {
                for (var c = 0; c < fb.length; c++)
                    fb[c].el.id != this.id || (b && fb[c].anim != b) || (a("raphael.anim.pause." + this.id, this, fb[c].anim) !== !1 && (fb[c].paused = !0));
                return this;
            }),
            (Xa.resume = function(b) {
                for (var c = 0; c < fb.length; c++)
                    if (fb[c].el.id == this.id && (!b || fb[c].anim == b)) {
                        var d = fb[c];
                        a("raphael.anim.resume." + this.id, this, d.anim) !== !1 && (delete d.paused, this.status(d.anim, d.status));
                    }
                return this;
            }),
            (Xa.stop = function(b) {
                for (var c = 0; c < fb.length; c++)
                    fb[c].el.id != this.id || (b && fb[c].anim != b) || (a("raphael.anim.stop." + this.id, this, fb[c].anim) !== !1 && fb.splice(c--, 1));
                return this;
            }),
            a.on("raphael.remove", s),
            a.on("raphael.clear", s),
            (Xa.toString = function() {
                return "Raphaël’s object";
            });
        var jb = function(a) {
                if (((this.items = []), (this.length = 0), (this.type = "set"), a))
                    for (var b = 0, c = a.length; c > b; b++)
                        !a[b] ||
                            (a[b].constructor != Xa.constructor && a[b].constructor != jb) ||
                            ((this[this.items.length] = this.items[this.items.length] = a[b]), this.length++);
            },
            kb = jb.prototype;
        (kb.push = function() {
            for (var a, b, c = 0, d = arguments.length; d > c; c++)
                (a = arguments[c]), !a || (a.constructor != Xa.constructor && a.constructor != jb) || ((b = this.items.length), (this[b] = this.items[b] = a), this.length++);
            return this;
        }),
            (kb.pop = function() {
                return this.length && delete this[this.length--], this.items.pop();
            }),
            (kb.forEach = function(a, b) {
                for (var c = 0, d = this.items.length; d > c; c++) if (a.call(b, this.items[c], c) === !1) return this;
                return this;
            });
        for (var lb in Xa)
            Xa[y](lb) &&
                (kb[lb] = (function(a) {
                    return function() {
                        var b = arguments;
                        return this.forEach(function(c) {
                            c[a][C](c, b);
                        });
                    };
                })(lb));
        return (
            (kb.attr = function(a, c) {
                if (a && b.is(a, U) && b.is(a[0], "object")) for (var d = 0, e = a.length; e > d; d++) this.items[d].attr(a[d]);
                else for (var f = 0, g = this.items.length; g > f; f++) this.items[f].attr(a, c);
                return this;
            }),
            (kb.clear = function() {
                for (; this.length; ) this.pop();
            }),
            (kb.splice = function(a, b, c) {
                (a = 0 > a ? N(this.length + a, 0) : a), (b = N(0, O(this.length - a, b)));
                var d,
                    e = [],
                    f = [],
                    g = [];
                for (d = 2; d < arguments.length; d++) g.push(arguments[d]);
                for (d = 0; b > d; d++) f.push(this[a + d]);
                for (; d < this.length - a; d++) e.push(this[a + d]);
                var h = g.length;
                for (d = 0; d < h + e.length; d++) this.items[a + d] = this[a + d] = h > d ? g[d] : e[d - h];
                for (d = this.items.length = this.length -= b - h; this[d]; ) delete this[d++];
                return new jb(f);
            }),
            (kb.exclude = function(a) {
                for (var b = 0, c = this.length; c > b; b++) if (this[b] == a) return this.splice(b, 1), !0;
            }),
            (kb.animate = function(a, c, d, e) {
                (b.is(d, "function") || !d) && (e = d || null);
                var f,
                    g,
                    h = this.items.length,
                    i = h,
                    j = this;
                if (!h) return this;
                e &&
                    (g = function() {
                        !--h && e.call(j);
                    }),
                    (d = b.is(d, T) ? d : g);
                var k = b.animation(a, c, d, g);
                for (f = this.items[--i].animate(k); i--; )
                    this.items[i] && !this.items[i].removed && this.items[i].animateWith(f, k, k), (this.items[i] && !this.items[i].removed) || h--;
                return this;
            }),
            (kb.insertAfter = function(a) {
                for (var b = this.items.length; b--; ) this.items[b].insertAfter(a);
                return this;
            }),
            (kb.getBBox = function() {
                for (var a = [], b = [], c = [], d = [], e = this.items.length; e--; )
                    if (!this.items[e].removed) {
                        var f = this.items[e].getBBox();
                        a.push(f.x), b.push(f.y), c.push(f.x + f.width), d.push(f.y + f.height);
                    }
                return (a = O[C](0, a)), (b = O[C](0, b)), (c = N[C](0, c)), (d = N[C](0, d)), { x: a, y: b, x2: c, y2: d, width: c - a, height: d - b };
            }),
            (kb.clone = function(a) {
                a = this.paper.set();
                for (var b = 0, c = this.items.length; c > b; b++) a.push(this.items[b].clone());
                return a;
            }),
            (kb.toString = function() {
                return "Raphaël‘s set";
            }),
            (kb.glow = function(a) {
                var b = this.paper.set();
                return (
                    this.forEach(function(c, d) {
                        var e = c.glow(a);
                        null != e &&
                            e.forEach(function(a, c) {
                                b.push(a);
                            });
                    }),
                    b
                );
            }),
            (kb.isPointInside = function(a, b) {
                var c = !1;
                return (
                    this.forEach(function(d) {
                        return d.isPointInside(a, b) ? ((c = !0), !1) : void 0;
                    }),
                    c
                );
            }),
            (b.registerFont = function(a) {
                if (!a.face) return a;
                this.fonts = this.fonts || {};
                var b = { w: a.w, face: {}, glyphs: {} },
                    c = a.face["font-family"];
                for (var d in a.face) a.face[y](d) && (b.face[d] = a.face[d]);
                if ((this.fonts[c] ? this.fonts[c].push(b) : (this.fonts[c] = [b]), !a.svg)) {
                    b.face["units-per-em"] = _(a.face["units-per-em"], 10);
                    for (var e in a.glyphs)
                        if (a.glyphs[y](e)) {
                            var f = a.glyphs[e];
                            if (
                                ((b.glyphs[e] = {
                                    w: f.w,
                                    k: {},
                                    d:
                                        f.d &&
                                        "M" +
                                            f.d.replace(/[mlcxtrv]/g, function(a) {
                                                return { l: "L", c: "C", x: "z", t: "m", r: "l", v: "c" }[a] || "M";
                                            }) +
                                            "z"
                                }),
                                f.k)
                            )
                                for (var g in f.k) f[y](g) && (b.glyphs[e].k[g] = f.k[g]);
                        }
                }
                return a;
            }),
            (u.getFont = function(a, c, d, e) {
                if (((e = e || "normal"), (d = d || "normal"), (c = +c || { normal: 400, bold: 700, lighter: 300, bolder: 800 }[c] || 400), b.fonts)) {
                    var f = b.fonts[a];
                    if (!f) {
                        var g = new RegExp("(^|\\s)" + a.replace(/[^\w\d\s+!~.:_-]/g, F) + "(\\s|$)", "i");
                        for (var h in b.fonts)
                            if (b.fonts[y](h) && g.test(h)) {
                                f = b.fonts[h];
                                break;
                            }
                    }
                    var i;
                    if (f)
                        for (
                            var j = 0, k = f.length;
                            k > j && ((i = f[j]), i.face["font-weight"] != c || (i.face["font-style"] != d && i.face["font-style"]) || i.face["font-stretch"] != e);
                            j++
                        );
                    return i;
                }
            }),
            (u.print = function(a, c, d, e, f, g, h, i) {
                (g = g || "middle"), (h = N(O(h || 0, 1), -1)), (i = N(O(i || 1, 3), 1));
                var j,
                    k = H(d)[I](F),
                    l = 0,
                    m = 0,
                    n = F;
                if ((b.is(e, "string") && (e = this.getFont(e)), e)) {
                    j = (f || 16) / e.face["units-per-em"];
                    for (
                        var o = e.face.bbox[I](v), p = +o[0], q = o[3] - o[1], r = 0, s = +o[1] + ("baseline" == g ? q + +e.face.descent : q / 2), t = 0, u = k.length;
                        u > t;
                        t++
                    ) {
                        if ("\n" == k[t]) (l = 0), (x = 0), (m = 0), (r += q * i);
                        else {
                            var w = (m && e.glyphs[k[t - 1]]) || {},
                                x = e.glyphs[k[t]];
                            (l += m ? (w.w || e.w) + ((w.k && w.k[k[t]]) || 0) + e.w * h : 0), (m = 1);
                        }
                        x && x.d && (n += b.transformPath(x.d, ["t", l * j, r * j, "s", j, j, p, s, "t", (a - p) / j, (c - s) / j]));
                    }
                }
                return this.path(n).attr({ fill: "#000", stroke: "none" });
            }),
            (u.add = function(a) {
                if (b.is(a, "array")) for (var c, d = this.set(), e = 0, f = a.length; f > e; e++) (c = a[e] || {}), w[y](c.type) && d.push(this[c.type]().attr(c));
                return d;
            }),
            (b.format = function(a, c) {
                var d = b.is(c, U) ? [0][D](c) : arguments;
                return (
                    a &&
                        b.is(a, T) &&
                        d.length - 1 &&
                        (a = a.replace(x, function(a, b) {
                            return null == d[++b] ? F : d[b];
                        })),
                    a || F
                );
            }),
            (b.fullfill = (function() {
                var a = /\{([^\}]+)\}/g,
                    b = /(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,
                    c = function(a, c, d) {
                        var e = d;
                        return (
                            c.replace(b, function(a, b, c, d, f) {
                                (b = b || d), e && (b in e && (e = e[b]), "function" == typeof e && f && (e = e()));
                            }),
                            (e = (null == e || e == d ? a : e) + "")
                        );
                    };
                return function(b, d) {
                    return String(b).replace(a, function(a, b) {
                        return c(a, b, d);
                    });
                };
            })()),
            (b.ninja = function() {
                return A.was ? (z.win.Raphael = A.is) : delete Raphael, b;
            }),
            (b.st = kb),
            a.on("raphael.DOMload", function() {
                t = !0;
            }),
            (function(a, c, d) {
                function e() {
                    /in/.test(a.readyState) ? setTimeout(e, 9) : b.eve("raphael.DOMload");
                }
                null == a.readyState &&
                    a.addEventListener &&
                    (a.addEventListener(
                        c,
                        (d = function() {
                            a.removeEventListener(c, d, !1), (a.readyState = "complete");
                        }),
                        !1
                    ),
                    (a.readyState = "loading")),
                    e();
            })(document, "DOMContentLoaded"),
            b
        );
    }),
    (function(a, b) {
        "function" === typeof wwplayer.define && wwplayer.define.amd
            ? wwplayer.define("raphael.svg", ["raphael.core"], function(a) {
                  return b(a);
              })
            : b("object" == typeof exports ? require("./raphael.core") : a.Raphael);
    })(this, function(a) {
        if (!a || a.svg) {
            var b = "hasOwnProperty",
                c = String,
                d = parseFloat,
                e = parseInt,
                f = Math,
                g = f.max,
                h = f.abs,
                i = f.pow,
                j = /[, ]+/,
                k = a.eve,
                l = "",
                m = " ",
                n = "http://www.w3.org/1999/xlink",
                o = {
                    block: "M5,0 0,2.5 5,5z",
                    classic: "M5,0 0,2.5 5,5 3.5,3 3.5,2z",
                    diamond: "M2.5,0 5,2.5 2.5,5 0,2.5z",
                    open: "M6,1 1,3.5 6,6",
                    oval: "M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"
                },
                p = {};
            a.toString = function() {
                return "Your browser supports SVG.\nYou are running Raphaël " + this.version;
            };
            var q = function(d, e) {
                    if (e) {
                        "string" == typeof d && (d = q(d));
                        for (var f in e) e[b](f) && ("xlink:" == f.substring(0, 6) ? d.setAttributeNS(n, f.substring(6), c(e[f])) : d.setAttribute(f, c(e[f])));
                    } else (d = a._g.doc.createElementNS("http://www.w3.org/2000/svg", d)), d.style && (d.style.webkitTapHighlightColor = "rgba(0,0,0,0)");
                    return d;
                },
                r = function(b, e) {
                    var j = "linear",
                        k = b.id + e,
                        m = 0.5,
                        n = 0.5,
                        o = b.node,
                        p = b.paper,
                        r = o.style,
                        s = a._g.doc.getElementById(k);
                    if (!s) {
                        if (
                            ((e = c(e).replace(a._radial_gradient, function(a, b, c) {
                                if (((j = "radial"), b && c)) {
                                    (m = d(b)), (n = d(c));
                                    var e = 2 * (n > 0.5) - 1;
                                    i(m - 0.5, 2) + i(n - 0.5, 2) > 0.25 && (n = f.sqrt(0.25 - i(m - 0.5, 2)) * e + 0.5) && 0.5 != n && (n = n.toFixed(5) - 1e-5 * e);
                                }
                                return l;
                            })),
                            (e = e.split(/\s*\-\s*/)),
                            "linear" == j)
                        ) {
                            var t = e.shift();
                            if (((t = -d(t)), isNaN(t))) return null;
                            var u = [0, 0, f.cos(a.rad(t)), f.sin(a.rad(t))],
                                v = 1 / (g(h(u[2]), h(u[3])) || 1);
                            (u[2] *= v), (u[3] *= v), u[2] < 0 && ((u[0] = -u[2]), (u[2] = 0)), u[3] < 0 && ((u[1] = -u[3]), (u[3] = 0));
                        }
                        var w = a._parseDots(e);
                        if (!w) return null;
                        if (((k = k.replace(/[\(\)\s,\xb0#]/g, "_")), b.gradient && k != b.gradient.id && (p.defs.removeChild(b.gradient), delete b.gradient), !b.gradient)) {
                            (s = q(j + "Gradient", { id: k })),
                                (b.gradient = s),
                                q(s, "radial" == j ? { fx: m, fy: n } : { x1: u[0], y1: u[1], x2: u[2], y2: u[3], gradientTransform: b.matrix.invert() }),
                                p.defs.appendChild(s);
                            for (var x = 0, y = w.length; y > x; x++)
                                s.appendChild(
                                    q("stop", {
                                        offset: w[x].offset ? w[x].offset : x ? "100%" : "0%",
                                        "stop-color": w[x].color || "#fff",
                                        "stop-opacity": isFinite(w[x].opacity) ? w[x].opacity : 1
                                    })
                                );
                        }
                    }
                    return (
                        q(o, { fill: "url('" + document.location.origin + document.location.pathname + "#" + k + "')", opacity: 1, "fill-opacity": 1 }),
                        (r.fill = l),
                        (r.opacity = 1),
                        (r.fillOpacity = 1),
                        1
                    );
                },
                s = function(a) {
                    var b = a.getBBox(1);
                    q(a.pattern, { patternTransform: a.matrix.invert() + " translate(" + b.x + "," + b.y + ")" });
                },
                t = function(d, e, f) {
                    if ("path" == d.type) {
                        for (
                            var g,
                                h,
                                i,
                                j,
                                k,
                                m = c(e)
                                    .toLowerCase()
                                    .split("-"),
                                n = d.paper,
                                r = f ? "end" : "start",
                                s = d.node,
                                t = d.attrs,
                                u = t["stroke-width"],
                                v = m.length,
                                w = "classic",
                                x = 3,
                                y = 3,
                                z = 5;
                            v--;

                        )
                            switch (m[v]) {
                                case "block":
                                case "classic":
                                case "oval":
                                case "diamond":
                                case "open":
                                case "none":
                                    w = m[v];
                                    break;
                                case "wide":
                                    y = 5;
                                    break;
                                case "narrow":
                                    y = 2;
                                    break;
                                case "long":
                                    x = 5;
                                    break;
                                case "short":
                                    x = 2;
                            }
                        if (
                            ("open" == w
                                ? ((x += 2), (y += 2), (z += 2), (i = 1), (j = f ? 4 : 1), (k = { fill: "none", stroke: t.stroke }))
                                : ((j = i = x / 2), (k = { fill: t.stroke, stroke: "none" })),
                            d._.arrows
                                ? f
                                    ? (d._.arrows.endPath && p[d._.arrows.endPath]--, d._.arrows.endMarker && p[d._.arrows.endMarker]--)
                                    : (d._.arrows.startPath && p[d._.arrows.startPath]--, d._.arrows.startMarker && p[d._.arrows.startMarker]--)
                                : (d._.arrows = {}),
                            "none" != w)
                        ) {
                            var A = "raphael-marker-" + w,
                                B = "raphael-marker-" + r + w + x + y + "-obj" + d.id;
                            a._g.doc.getElementById(A) ? p[A]++ : (n.defs.appendChild(q(q("path"), { "stroke-linecap": "round", d: o[w], id: A })), (p[A] = 1));
                            var C,
                                D = a._g.doc.getElementById(B);
                            D
                                ? (p[B]++, (C = D.getElementsByTagName("use")[0]))
                                : ((D = q(q("marker"), { id: B, markerHeight: y, markerWidth: x, orient: "auto", refX: j, refY: y / 2 })),
                                  (C = q(q("use"), {
                                      "xlink:href": "#" + A,
                                      transform: (f ? "rotate(180 " + x / 2 + " " + y / 2 + ") " : l) + "scale(" + x / z + "," + y / z + ")",
                                      "stroke-width": (1 / ((x / z + y / z) / 2)).toFixed(4)
                                  })),
                                  D.appendChild(C),
                                  n.defs.appendChild(D),
                                  (p[B] = 1)),
                                q(C, k);
                            var E = i * ("diamond" != w && "oval" != w);
                            f
                                ? ((g = d._.arrows.startdx * u || 0), (h = a.getTotalLength(t.path) - E * u))
                                : ((g = E * u), (h = a.getTotalLength(t.path) - (d._.arrows.enddx * u || 0))),
                                (k = {}),
                                (k["marker-" + r] = "url(#" + B + ")"),
                                (h || g) && (k.d = a.getSubpath(t.path, g, h)),
                                q(s, k),
                                (d._.arrows[r + "Path"] = A),
                                (d._.arrows[r + "Marker"] = B),
                                (d._.arrows[r + "dx"] = E),
                                (d._.arrows[r + "Type"] = w),
                                (d._.arrows[r + "String"] = e);
                        } else
                            f ? ((g = d._.arrows.startdx * u || 0), (h = a.getTotalLength(t.path) - g)) : ((g = 0), (h = a.getTotalLength(t.path) - (d._.arrows.enddx * u || 0))),
                                d._.arrows[r + "Path"] && q(s, { d: a.getSubpath(t.path, g, h) }),
                                delete d._.arrows[r + "Path"],
                                delete d._.arrows[r + "Marker"],
                                delete d._.arrows[r + "dx"],
                                delete d._.arrows[r + "Type"],
                                delete d._.arrows[r + "String"];
                        for (k in p)
                            if (p[b](k) && !p[k]) {
                                var F = a._g.doc.getElementById(k);
                                F && F.parentNode.removeChild(F);
                            }
                    }
                },
                u = {
                    "-": [3, 1],
                    ".": [1, 1],
                    "-.": [3, 1, 1, 1],
                    "-..": [3, 1, 1, 1, 1, 1],
                    ". ": [1, 3],
                    "- ": [4, 3],
                    "--": [8, 3],
                    "- .": [4, 3, 1, 3],
                    "--.": [8, 3, 1, 3],
                    "--..": [8, 3, 1, 3, 1, 3]
                },
                v = function(a, b, d) {
                    if ((b = u[c(b).toLowerCase()])) {
                        for (
                            var e = a.attrs["stroke-width"] || "1",
                                f = { round: e, square: e, butt: 0 }[a.attrs["stroke-linecap"] || d["stroke-linecap"]] || 0,
                                g = [],
                                h = b.length;
                            h--;

                        )
                            g[h] = b[h] * e + (h % 2 ? 1 : -1) * f;
                        q(a.node, { "stroke-dasharray": g.join(",") });
                    } else q(a.node, { "stroke-dasharray": "none" });
                },
                w = function(d, f) {
                    var i = d.node,
                        k = d.attrs,
                        m = i.style.visibility;
                    i.style.visibility = "hidden";
                    for (var o in f)
                        if (f[b](o)) {
                            if (!a._availableAttrs[b](o)) continue;
                            var p = f[o];
                            switch (((k[o] = p), o)) {
                                case "blur":
                                    d.blur(p);
                                    break;
                                case "title":
                                    var u = i.getElementsByTagName("title");
                                    if (u.length && (u = u[0])) u.firstChild.nodeValue = p;
                                    else {
                                        u = q("title");
                                        var w = a._g.doc.createTextNode(p);
                                        u.appendChild(w), i.appendChild(u);
                                    }
                                    break;
                                case "href":
                                case "target":
                                    var x = i.parentNode;
                                    if ("a" != x.tagName.toLowerCase()) {
                                        var z = q("a");
                                        x.insertBefore(z, i), z.appendChild(i), (x = z);
                                    }
                                    "target" == o ? x.setAttributeNS(n, "show", "blank" == p ? "new" : p) : x.setAttributeNS(n, o, p);
                                    break;
                                case "cursor":
                                    i.style.cursor = p;
                                    break;
                                case "transform":
                                    d.transform(p);
                                    break;
                                case "arrow-start":
                                    t(d, p);
                                    break;
                                case "arrow-end":
                                    t(d, p, 1);
                                    break;
                                case "clip-rect":
                                    var A = c(p).split(j);
                                    if (4 == A.length) {
                                        d.clip && d.clip.parentNode.parentNode.removeChild(d.clip.parentNode);
                                        var B = q("clipPath"),
                                            C = q("rect");
                                        (B.id = a.createUUID()),
                                            q(C, { x: A[0], y: A[1], width: A[2], height: A[3] }),
                                            B.appendChild(C),
                                            d.paper.defs.appendChild(B),
                                            q(i, { "clip-path": "url(#" + B.id + ")" }),
                                            (d.clip = C);
                                    }
                                    if (!p) {
                                        var D = i.getAttribute("clip-path");
                                        if (D) {
                                            var E = a._g.doc.getElementById(D.replace(/(^url\(#|\)$)/g, l));
                                            E && E.parentNode.removeChild(E), q(i, { "clip-path": l }), delete d.clip;
                                        }
                                    }
                                    break;
                                case "path":
                                    "path" == d.type &&
                                        (q(i, { d: p ? (k.path = a._pathToAbsolute(p)) : "M0,0" }),
                                        (d._.dirty = 1),
                                        d._.arrows && ("startString" in d._.arrows && t(d, d._.arrows.startString), "endString" in d._.arrows && t(d, d._.arrows.endString, 1)));
                                    break;
                                case "width":
                                    if ((i.setAttribute(o, p), (d._.dirty = 1), !k.fx)) break;
                                    (o = "x"), (p = k.x);
                                case "x":
                                    k.fx && (p = -k.x - (k.width || 0));
                                case "rx":
                                    if ("rx" == o && "rect" == d.type) break;
                                case "cx":
                                    i.setAttribute(o, p), d.pattern && s(d), (d._.dirty = 1);
                                    break;
                                case "height":
                                    if ((i.setAttribute(o, p), (d._.dirty = 1), !k.fy)) break;
                                    (o = "y"), (p = k.y);
                                case "y":
                                    k.fy && (p = -k.y - (k.height || 0));
                                case "ry":
                                    if ("ry" == o && "rect" == d.type) break;
                                case "cy":
                                    i.setAttribute(o, p), d.pattern && s(d), (d._.dirty = 1);
                                    break;
                                case "r":
                                    "rect" == d.type ? q(i, { rx: p, ry: p }) : i.setAttribute(o, p), (d._.dirty = 1);
                                    break;
                                case "src":
                                    "image" == d.type && i.setAttributeNS(n, "href", p);
                                    break;
                                case "stroke-width":
                                    (1 != d._.sx || 1 != d._.sy) && (p /= g(h(d._.sx), h(d._.sy)) || 1),
                                        i.setAttribute(o, p),
                                        k["stroke-dasharray"] && v(d, k["stroke-dasharray"], f),
                                        d._.arrows && ("startString" in d._.arrows && t(d, d._.arrows.startString), "endString" in d._.arrows && t(d, d._.arrows.endString, 1));
                                    break;
                                case "stroke-dasharray":
                                    v(d, p, f);
                                    break;
                                case "fill":
                                    var F = c(p).match(a._ISURL);
                                    if (F) {
                                        B = q("pattern");
                                        var G = q("image");
                                        (B.id = a.createUUID()),
                                            q(B, { x: 0, y: 0, patternUnits: "userSpaceOnUse", height: 1, width: 1 }),
                                            q(G, { x: 0, y: 0, "xlink:href": F[1] }),
                                            B.appendChild(G),
                                            (function(b) {
                                                a._preload(F[1], function() {
                                                    var a = this.offsetWidth,
                                                        c = this.offsetHeight;
                                                    q(b, { width: a, height: c }), q(G, { width: a, height: c });
                                                });
                                            })(B),
                                            d.paper.defs.appendChild(B),
                                            q(i, { fill: "url(#" + B.id + ")" }),
                                            (d.pattern = B),
                                            d.pattern && s(d);
                                        break;
                                    }
                                    var H = a.getRGB(p);
                                    if (H.error) {
                                        if (("circle" == d.type || "ellipse" == d.type || "r" != c(p).charAt()) && r(d, p)) {
                                            if ("opacity" in k || "fill-opacity" in k) {
                                                var I = a._g.doc.getElementById(i.getAttribute("fill").replace(/^url\(#|\)$/g, l));
                                                if (I) {
                                                    var J = I.getElementsByTagName("stop");
                                                    q(J[J.length - 1], { "stop-opacity": ("opacity" in k ? k.opacity : 1) * ("fill-opacity" in k ? k["fill-opacity"] : 1) });
                                                }
                                            }
                                            (k.gradient = p), (k.fill = "none");
                                            break;
                                        }
                                    } else
                                        delete f.gradient,
                                            delete k.gradient,
                                            !a.is(k.opacity, "undefined") && a.is(f.opacity, "undefined") && q(i, { opacity: k.opacity }),
                                            !a.is(k["fill-opacity"], "undefined") && a.is(f["fill-opacity"], "undefined") && q(i, { "fill-opacity": k["fill-opacity"] });
                                    H[b]("opacity") && q(i, { "fill-opacity": H.opacity > 1 ? H.opacity / 100 : H.opacity });
                                case "stroke":
                                    (H = a.getRGB(p)),
                                        i.setAttribute(o, H.hex),
                                        "stroke" == o && H[b]("opacity") && q(i, { "stroke-opacity": H.opacity > 1 ? H.opacity / 100 : H.opacity }),
                                        "stroke" == o &&
                                            d._.arrows &&
                                            ("startString" in d._.arrows && t(d, d._.arrows.startString), "endString" in d._.arrows && t(d, d._.arrows.endString, 1));
                                    break;
                                case "gradient":
                                    ("circle" == d.type || "ellipse" == d.type || "r" != c(p).charAt()) && r(d, p);

                                    break;
                                case "opacity":
                                    k.gradient && !k[b]("stroke-opacity") && q(i, { "stroke-opacity": p > 1 ? p / 100 : p });
                                case "fill-opacity":
                                    if (k.gradient) {
                                        (I = a._g.doc.getElementById(i.getAttribute("fill").replace(/^url\(#|\)$/g, l))),
                                            I && ((J = I.getElementsByTagName("stop")), q(J[J.length - 1], { "stop-opacity": p }));
                                        break;
                                    }
                                default:
                                    "font-size" == o && (p = e(p, 10) + "px");
                                    var K = o.replace(/(\-.)/g, function(a) {
                                        return a.substring(1).toUpperCase();
                                    });
                                    (i.style[K] = p), (d._.dirty = 1), i.setAttribute(o, p);
                            }
                        }
                    y(d, f), (i.style.visibility = m);
                },
                x = 1.2,
                y = function(d, f) {
                    if ("text" == d.type && (f[b]("text") || f[b]("font") || f[b]("font-size") || f[b]("x") || f[b]("y"))) {
                        var g = d.attrs,
                            h = d.node,
                            i = h.firstChild ? e(a._g.doc.defaultView.getComputedStyle(h.firstChild, l).getPropertyValue("font-size"), 10) : 10;
                        if (f[b]("text")) {
                            for (g.text = f.text; h.firstChild; ) h.removeChild(h.firstChild);
                            for (var j, k = c(f.text).split("\n"), m = [], n = 0, o = k.length; o > n; n++)
                                (j = q("tspan")), n && q(j, { dy: i * x, x: g.x }), j.appendChild(a._g.doc.createTextNode(k[n])), h.appendChild(j), (m[n] = j);
                        } else for (m = h.getElementsByTagName("tspan"), n = 0, o = m.length; o > n; n++) n ? q(m[n], { dy: i * x, x: g.x }) : q(m[0], { dy: 0 });
                        q(h, { x: g.x, y: g.y }), (d._.dirty = 1);
                        var p = d._getBBox(),
                            r = g.y - (p.y + p.height / 2);
                        r && a.is(r, "finite") && q(m[0], { dy: r });
                    }
                },
                z = function(a) {
                    return a.parentNode && "a" === a.parentNode.tagName.toLowerCase() ? a.parentNode : a;
                },
                A = function(b, c) {
                    (this[0] = this.node = b),
                        (b.raphael = !0),
                        (this.id = a._oid++),
                        (b.raphaelid = this.id),
                        (this.matrix = a.matrix()),
                        (this.realPath = null),
                        (this.paper = c),
                        (this.attrs = this.attrs || {}),
                        (this._ = { transform: [], sx: 1, sy: 1, deg: 0, dx: 0, dy: 0, dirty: 1 }),
                        !c.bottom && (c.bottom = this),
                        (this.prev = c.top),
                        c.top && (c.top.next = this),
                        (c.top = this),
                        (this.next = null);
                },
                B = a.el;
            (A.prototype = B),
                (B.constructor = A),
                (a._engine.path = function(a, b) {
                    var c = q("path");
                    b.canvas && b.canvas.appendChild(c);
                    var d = new A(c, b);
                    return (d.type = "path"), w(d, { fill: "none", stroke: "#000", path: a }), d;
                }),
                (B.rotate = function(a, b, e) {
                    if (this.removed) return this;
                    if (((a = c(a).split(j)), a.length - 1 && ((b = d(a[1])), (e = d(a[2]))), (a = d(a[0])), null == e && (b = e), null == b || null == e)) {
                        var f = this.getBBox(1);
                        (b = f.x + f.width / 2), (e = f.y + f.height / 2);
                    }
                    return this.transform(this._.transform.concat([["r", a, b, e]])), this;
                }),
                (B.scale = function(a, b, e, f) {
                    if (this.removed) return this;
                    if (
                        ((a = c(a).split(j)),
                        a.length - 1 && ((b = d(a[1])), (e = d(a[2])), (f = d(a[3]))),
                        (a = d(a[0])),
                        null == b && (b = a),
                        null == f && (e = f),
                        null == e || null == f)
                    )
                        var g = this.getBBox(1);
                    return (e = null == e ? g.x + g.width / 2 : e), (f = null == f ? g.y + g.height / 2 : f), this.transform(this._.transform.concat([["s", a, b, e, f]])), this;
                }),
                (B.translate = function(a, b) {
                    return this.removed
                        ? this
                        : ((a = c(a).split(j)), a.length - 1 && (b = d(a[1])), (a = d(a[0]) || 0), (b = +b || 0), this.transform(this._.transform.concat([["t", a, b]])), this);
                }),
                (B.transform = function(c) {
                    var d = this._;
                    if (null == c) return d.transform;
                    if (
                        (a._extractTransform(this, c),
                        this.clip && q(this.clip, { transform: this.matrix.invert() }),
                        this.pattern && s(this),
                        this.node && q(this.node, { transform: this.matrix }),
                        1 != d.sx || 1 != d.sy)
                    ) {
                        var e = this.attrs[b]("stroke-width") ? this.attrs["stroke-width"] : 1;
                        this.attr({ "stroke-width": e });
                    }
                    return (d.transform = this.matrix.toTransformString()), this;
                }),
                (B.hide = function() {
                    return this.removed || (this.node.style.display = "none"), this;
                }),
                (B.show = function() {
                    return this.removed || (this.node.style.display = ""), this;
                }),
                (B.remove = function() {
                    var b = z(this.node);
                    if (!this.removed && b.parentNode) {
                        var c = this.paper;
                        c.__set__ && c.__set__.exclude(this),
                            k.unbind("raphael.*.*." + this.id),
                            this.gradient && c.defs.removeChild(this.gradient),
                            a._tear(this, c),
                            b.parentNode.removeChild(b),
                            this.removeData();
                        for (var d in this) this[d] = "function" == typeof this[d] ? a._removedFactory(d) : null;
                        this.removed = !0;
                    }
                }),
                (B._getBBox = function() {
                    if ("none" == this.node.style.display) {
                        this.show();
                        var a = !0;
                    }
                    var b,
                        c = !1;
                    this.paper.canvas.parentElement ? (b = this.paper.canvas.parentElement.style) : this.paper.canvas.parentNode && (b = this.paper.canvas.parentNode.style),
                        b && "none" == b.display && ((c = !0), (b.display = ""));
                    var d = {};
                    try {
                        d = this.node.getBBox();
                    } catch (e) {
                        d = { x: this.node.clientLeft, y: this.node.clientTop, width: this.node.clientWidth, height: this.node.clientHeight };
                    } finally {
                        (d = d || {}), c && (b.display = "none");
                    }
                    return a && this.hide(), d;
                }),
                (B.attr = function(c, d) {
                    if (this.removed) return this;
                    if (null == c) {
                        var e = {};
                        for (var f in this.attrs) this.attrs[b](f) && (e[f] = this.attrs[f]);
                        return e.gradient && "none" == e.fill && (e.fill = e.gradient) && delete e.gradient, (e.transform = this._.transform), e;
                    }
                    if (null == d && a.is(c, "string")) {
                        if ("fill" == c && "none" == this.attrs.fill && this.attrs.gradient) return this.attrs.gradient;
                        if ("transform" == c) return this._.transform;
                        for (var g = c.split(j), h = {}, i = 0, l = g.length; l > i; i++)
                            (c = g[i]),
                                c in this.attrs
                                    ? (h[c] = this.attrs[c])
                                    : a.is(this.paper.customAttributes[c], "function")
                                    ? (h[c] = this.paper.customAttributes[c].def)
                                    : (h[c] = a._availableAttrs[c]);
                        return l - 1 ? h : h[g[0]];
                    }
                    if (null == d && a.is(c, "array")) {
                        for (h = {}, i = 0, l = c.length; l > i; i++) h[c[i]] = this.attr(c[i]);
                        return h;
                    }
                    if (null != d) {
                        var m = {};
                        m[c] = d;
                    } else null != c && a.is(c, "object") && (m = c);
                    for (var n in m) k("raphael.attr." + n + "." + this.id, this, m[n]);
                    for (n in this.paper.customAttributes)
                        if (this.paper.customAttributes[b](n) && m[b](n) && a.is(this.paper.customAttributes[n], "function")) {
                            var o = this.paper.customAttributes[n].apply(this, [].concat(m[n]));
                            this.attrs[n] = m[n];
                            for (var p in o) o[b](p) && (m[p] = o[p]);
                        }
                    return w(this, m), this;
                }),
                (B.toFront = function() {
                    if (this.removed) return this;
                    var b = z(this.node);
                    b.parentNode.appendChild(b);
                    var c = this.paper;
                    return c.top != this && a._tofront(this, c), this;
                }),
                (B.toBack = function() {
                    if (this.removed) return this;
                    var b = z(this.node),
                        c = b.parentNode;
                    c.insertBefore(b, c.firstChild), a._toback(this, this.paper);
                    this.paper;
                    return this;
                }),
                (B.insertAfter = function(b) {
                    if (this.removed || !b) return this;
                    var c = z(this.node),
                        d = z(b.node || b[b.length - 1].node);
                    return d.nextSibling ? d.parentNode.insertBefore(c, d.nextSibling) : d.parentNode.appendChild(c), a._insertafter(this, b, this.paper), this;
                }),
                (B.insertBefore = function(b) {
                    if (this.removed || !b) return this;
                    var c = z(this.node),
                        d = z(b.node || b[0].node);
                    return d.parentNode.insertBefore(c, d), a._insertbefore(this, b, this.paper), this;
                }),
                (B.blur = function(b) {
                    var c = this;
                    if (0 !== +b) {
                        var d = q("filter"),
                            e = q("feGaussianBlur");
                        (c.attrs.blur = b),
                            (d.id = a.createUUID()),
                            q(e, { stdDeviation: +b || 1.5 }),
                            d.appendChild(e),
                            c.paper.defs.appendChild(d),
                            (c._blur = d),
                            q(c.node, { filter: "url(#" + d.id + ")" });
                    } else c._blur && (c._blur.parentNode.removeChild(c._blur), delete c._blur, delete c.attrs.blur), c.node.removeAttribute("filter");
                    return c;
                }),
                (a._engine.circle = function(a, b, c, d) {
                    var e = q("circle");
                    a.canvas && a.canvas.appendChild(e);
                    var f = new A(e, a);
                    return (f.attrs = { cx: b, cy: c, r: d, fill: "none", stroke: "#000" }), (f.type = "circle"), q(e, f.attrs), f;
                }),
                (a._engine.rect = function(a, b, c, d, e, f) {
                    var g = q("rect");
                    a.canvas && a.canvas.appendChild(g);
                    var h = new A(g, a);
                    return (h.attrs = { x: b, y: c, width: d, height: e, rx: f || 0, ry: f || 0, fill: "none", stroke: "#000" }), (h.type = "rect"), q(g, h.attrs), h;
                }),
                (a._engine.ellipse = function(a, b, c, d, e) {
                    var f = q("ellipse");
                    a.canvas && a.canvas.appendChild(f);
                    var g = new A(f, a);
                    return (g.attrs = { cx: b, cy: c, rx: d, ry: e, fill: "none", stroke: "#000" }), (g.type = "ellipse"), q(f, g.attrs), g;
                }),
                (a._engine.image = function(a, b, c, d, e, f) {
                    var g = q("image");
                    q(g, { x: c, y: d, width: e, height: f, preserveAspectRatio: "none" }), g.setAttributeNS(n, "href", b), a.canvas && a.canvas.appendChild(g);
                    var h = new A(g, a);
                    return (h.attrs = { x: c, y: d, width: e, height: f, src: b }), (h.type = "image"), h;
                }),
                (a._engine.text = function(b, c, d, e) {
                    var f = q("text");
                    b.canvas && b.canvas.appendChild(f);
                    var g = new A(f, b);
                    return (
                        (g.attrs = {
                            x: c,
                            y: d,
                            "text-anchor": "middle",
                            text: e,
                            "font-family": a._availableAttrs["font-family"],
                            "font-size": a._availableAttrs["font-size"],
                            stroke: "none",
                            fill: "#000"
                        }),
                        (g.type = "text"),
                        w(g, g.attrs),
                        g
                    );
                }),
                (a._engine.setSize = function(a, b) {
                    return (
                        (this.width = a || this.width),
                        (this.height = b || this.height),
                        this.canvas.setAttribute("width", this.width),
                        this.canvas.setAttribute("height", this.height),
                        this._viewBox && this.setViewBox.apply(this, this._viewBox),
                        this
                    );
                }),
                (a._engine.create = function() {
                    var b = a._getContainer.apply(0, arguments),
                        c = b && b.container,
                        d = b.x,
                        e = b.y,
                        f = b.width,
                        g = b.height;
                    if (!c) throw new Error("SVG container not found.");
                    var h,
                        i = q("svg"),
                        j = "overflow:hidden;";
                    return (
                        (d = d || 0),
                        (e = e || 0),
                        (f = f || 512),
                        (g = g || 342),
                        q(i, { height: g, version: 1.1, width: f, xmlns: "http://www.w3.org/2000/svg", "xmlns:xlink": "http://www.w3.org/1999/xlink" }),
                        1 == c
                            ? ((i.style.cssText = j + "position:absolute;left:" + d + "px;top:" + e + "px"), a._g.doc.body.appendChild(i), (h = 1))
                            : ((i.style.cssText = j + "position:relative"), c.firstChild ? c.insertBefore(i, c.firstChild) : c.appendChild(i)),
                        (c = new a._Paper()),
                        (c.width = f),
                        (c.height = g),
                        (c.canvas = i),
                        c.clear(),
                        (c._left = c._top = 0),
                        h && (c.renderfix = function() {}),
                        c.renderfix(),
                        c
                    );
                }),
                (a._engine.setViewBox = function(a, b, c, d, e) {
                    k("raphael.setViewBox", this, this._viewBox, [a, b, c, d, e]);
                    var f,
                        h,
                        i = this.getSize(),
                        j = g(c / i.width, d / i.height),
                        l = this.top,
                        n = e ? "xMidYMid meet" : "xMinYMin";
                    for (
                        null == a
                            ? (this._vbSize && (j = 1), delete this._vbSize, (f = "0 0 " + this.width + m + this.height))
                            : ((this._vbSize = j), (f = a + m + b + m + c + m + d)),
                            q(this.canvas, { viewBox: f, preserveAspectRatio: n });
                        j && l;

                    )
                        (h = "stroke-width" in l.attrs ? l.attrs["stroke-width"] : 1), l.attr({ "stroke-width": h }), (l._.dirty = 1), (l._.dirtyT = 1), (l = l.prev);
                    return (this._viewBox = [a, b, c, d, !!e]), this;
                }),
                (a.prototype.renderfix = function() {
                    var a,
                        b = this.canvas,
                        c = b.style;
                    try {
                        a = b.getScreenCTM() || b.createSVGMatrix();
                    } catch (d) {
                        a = b.createSVGMatrix();
                    }
                    var e = -a.e % 1,
                        f = -a.f % 1;
                    (e || f) && (e && ((this._left = (this._left + e) % 1), (c.left = this._left + "px")), f && ((this._top = (this._top + f) % 1), (c.top = this._top + "px")));
                }),
                (a.prototype.clear = function() {
                    a.eve("raphael.clear", this);
                    for (var b = this.canvas; b.firstChild; ) b.removeChild(b.firstChild);
                    (this.bottom = this.top = null),
                        (this.desc = q("desc")).appendChild(a._g.doc.createTextNode("Created with Raphaël " + a.version)),
                        b.appendChild(this.desc),
                        b.appendChild((this.defs = q("defs")));
                }),
                (a.prototype.remove = function() {
                    k("raphael.remove", this), this.canvas.parentNode && this.canvas.parentNode.removeChild(this.canvas);
                    for (var b in this) this[b] = "function" == typeof this[b] ? a._removedFactory(b) : null;
                });
            var C = a.st;
            for (var D in B)
                B[b](D) &&
                    !C[b](D) &&
                    (C[D] = (function(a) {
                        return function() {
                            var b = arguments;
                            return this.forEach(function(c) {
                                c[a].apply(c, b);
                            });
                        };
                    })(D));
        }
    }),
    (function(a, b) {
        "function" === typeof wwplayer.define && wwplayer.define.amd
            ? wwplayer.define("raphael.vml", ["raphael.core"], function(a) {
                  return b(a);
              })
            : b("object" == typeof exports ? require("./raphael.core") : a.Raphael);
    })(this, function(a) {
        if (!a || a.vml) {
            var b = "hasOwnProperty",
                c = String,
                d = parseFloat,
                e = Math,
                f = e.round,
                g = e.max,
                h = e.min,
                i = e.abs,
                j = "fill",
                k = /[, ]+/,
                l = a.eve,
                m = " progid:DXImageTransform.Microsoft",
                n = " ",
                o = "",
                p = { M: "m", L: "l", C: "c", Z: "x", m: "t", l: "r", c: "v", z: "x" },
                q = /([clmz]),?([^clmz]*)/gi,
                r = / progid:\S+Blur\([^\)]+\)/g,
                s = /-?[^,\s-]+/g,
                t = "position:absolute;left:0;top:0;width:1px;height:1px;behavior:url(#default#VML)",
                u = 21600,
                v = { path: 1, rect: 1, image: 1 },
                w = { circle: 1, ellipse: 1 },
                x = function(b) {
                    var d = /[ahqstv]/gi,
                        e = a._pathToAbsolute;
                    if ((c(b).match(d) && (e = a._path2curve), (d = /[clmz]/g), e == a._pathToAbsolute && !c(b).match(d))) {
                        var g = c(b).replace(q, function(a, b, c) {
                            var d = [],
                                e = "m" == b.toLowerCase(),
                                g = p[b];
                            return (
                                c.replace(s, function(a) {
                                    e && 2 == d.length && ((g += d + p["m" == b ? "l" : "L"]), (d = [])), d.push(f(a * u));
                                }),
                                g + d
                            );
                        });
                        return g;
                    }
                    var h,
                        i,
                        j = e(b);
                    g = [];
                    for (var k = 0, l = j.length; l > k; k++) {
                        (h = j[k]), (i = j[k][0].toLowerCase()), "z" == i && (i = "x");
                        for (var m = 1, r = h.length; r > m; m++) i += f(h[m] * u) + (m != r - 1 ? "," : o);
                        g.push(i);
                    }
                    return g.join(n);
                },
                y = function(b, c, d) {
                    var e = a.matrix();
                    return e.rotate(-b, 0.5, 0.5), { dx: e.x(c, d), dy: e.y(c, d) };
                },
                z = function(a, b, c, d, e, f) {
                    var g = a._,
                        h = a.matrix,
                        k = g.fillpos,
                        l = a.node,
                        m = l.style,
                        o = 1,
                        p = "",
                        q = u / b,
                        r = u / c;
                    if (((m.visibility = "hidden"), b && c)) {
                        if (((l.coordsize = i(q) + n + i(r)), (m.rotation = f * (0 > b * c ? -1 : 1)), f)) {
                            var s = y(f, d, e);
                            (d = s.dx), (e = s.dy);
                        }
                        if ((0 > b && (p += "x"), 0 > c && (p += " y") && (o = -1), (m.flip = p), (l.coordorigin = d * -q + n + e * -r), k || g.fillsize)) {
                            var t = l.getElementsByTagName(j);
                            (t = t && t[0]),
                                l.removeChild(t),
                                k && ((s = y(f, h.x(k[0], k[1]), h.y(k[0], k[1]))), (t.position = s.dx * o + n + s.dy * o)),
                                g.fillsize && (t.size = g.fillsize[0] * i(b) + n + g.fillsize[1] * i(c)),
                                l.appendChild(t);
                        }
                        m.visibility = "visible";
                    }
                };
            a.toString = function() {
                return "Your browser doesn’t support SVG. Falling down to VML.\nYou are running Raphaël " + this.version;
            };
            var A = function(a, b, d) {
                    for (
                        var e = c(b)
                                .toLowerCase()
                                .split("-"),
                            f = d ? "end" : "start",
                            g = e.length,
                            h = "classic",
                            i = "medium",
                            j = "medium";
                        g--;

                    )
                        switch (e[g]) {
                            case "block":
                            case "classic":
                            case "oval":
                            case "diamond":
                            case "open":
                            case "none":
                                h = e[g];
                                break;
                            case "wide":
                            case "narrow":
                                j = e[g];
                                break;
                            case "long":
                            case "short":
                                i = e[g];
                        }
                    var k = a.node.getElementsByTagName("stroke")[0];
                    (k[f + "arrow"] = h), (k[f + "arrowlength"] = i), (k[f + "arrowwidth"] = j);
                },
                B = function(e, i) {
                    e.attrs = e.attrs || {};
                    var l = e.node,
                        m = e.attrs,
                        p = l.style,
                        q =
                            v[e.type] &&
                            (i.x != m.x || i.y != m.y || i.width != m.width || i.height != m.height || i.cx != m.cx || i.cy != m.cy || i.rx != m.rx || i.ry != m.ry || i.r != m.r),
                        r = w[e.type] && (m.cx != i.cx || m.cy != i.cy || m.r != i.r || m.rx != i.rx || m.ry != i.ry),
                        s = e;
                    for (var t in i) i[b](t) && (m[t] = i[t]);
                    if (
                        (q && ((m.path = a._getPath[e.type](e)), (e._.dirty = 1)),
                        i.href && (l.href = i.href),
                        i.title && (l.title = i.title),
                        i.target && (l.target = i.target),
                        i.cursor && (p.cursor = i.cursor),
                        "blur" in i && e.blur(i.blur),
                        ((i.path && "path" == e.type) || q) &&
                            ((l.path = x(
                                ~c(m.path)
                                    .toLowerCase()
                                    .indexOf("r")
                                    ? a._pathToAbsolute(m.path)
                                    : m.path
                            )),
                            (e._.dirty = 1),
                            "image" == e.type && ((e._.fillpos = [m.x, m.y]), (e._.fillsize = [m.width, m.height]), z(e, 1, 1, 0, 0, 0))),
                        "transform" in i && e.transform(i.transform),
                        r)
                    ) {
                        var y = +m.cx,
                            B = +m.cy,
                            D = +m.rx || +m.r || 0,
                            E = +m.ry || +m.r || 0;
                        (l.path = a.format("ar{0},{1},{2},{3},{4},{1},{4},{1}x", f((y - D) * u), f((B - E) * u), f((y + D) * u), f((B + E) * u), f(y * u))), (e._.dirty = 1);
                    }
                    if ("clip-rect" in i) {
                        var G = c(i["clip-rect"]).split(k);
                        if (4 == G.length) {
                            (G[2] = +G[2] + +G[0]), (G[3] = +G[3] + +G[1]);
                            var H = l.clipRect || a._g.doc.createElement("div"),
                                I = H.style;
                            (I.clip = a.format("rect({1}px {2}px {3}px {0}px)", G)),
                                l.clipRect ||
                                    ((I.position = "absolute"),
                                    (I.top = 0),
                                    (I.left = 0),
                                    (I.width = e.paper.width + "px"),
                                    (I.height = e.paper.height + "px"),
                                    l.parentNode.insertBefore(H, l),
                                    H.appendChild(l),
                                    (l.clipRect = H));
                        }
                        i["clip-rect"] || (l.clipRect && (l.clipRect.style.clip = "auto"));
                    }
                    if (e.textpath) {
                        var J = e.textpath.style;
                        i.font && (J.font = i.font),
                            i["font-family"] && (J.fontFamily = '"' + i["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g, o) + '"'),
                            i["font-size"] && (J.fontSize = i["font-size"]),
                            i["font-weight"] && (J.fontWeight = i["font-weight"]),
                            i["font-style"] && (J.fontStyle = i["font-style"]);
                    }
                    if (
                        ("arrow-start" in i && A(s, i["arrow-start"]),
                        "arrow-end" in i && A(s, i["arrow-end"], 1),
                        null != i.opacity ||
                            null != i["stroke-width"] ||
                            null != i.fill ||
                            null != i.src ||
                            null != i.stroke ||
                            null != i["stroke-width"] ||
                            null != i["stroke-opacity"] ||
                            null != i["fill-opacity"] ||
                            null != i["stroke-dasharray"] ||
                            null != i["stroke-miterlimit"] ||
                            null != i["stroke-linejoin"] ||
                            null != i["stroke-linecap"])
                    ) {
                        var K = l.getElementsByTagName(j),
                            L = !1;
                        if (
                            ((K = K && K[0]),
                            !K && (L = K = F(j)),
                            "image" == e.type && i.src && (K.src = i.src),
                            i.fill && (K.on = !0),
                            (null == K.on || "none" == i.fill || null === i.fill) && (K.on = !1),
                            K.on && i.fill)
                        ) {
                            var M = c(i.fill).match(a._ISURL);
                            if (M) {
                                K.parentNode == l && l.removeChild(K), (K.rotate = !0), (K.src = M[1]), (K.type = "tile");
                                var N = e.getBBox(1);
                                (K.position = N.x + n + N.y),
                                    (e._.fillpos = [N.x, N.y]),
                                    a._preload(M[1], function() {
                                        e._.fillsize = [this.offsetWidth, this.offsetHeight];
                                    });
                            } else
                                (K.color = a.getRGB(i.fill).hex),
                                    (K.src = o),
                                    (K.type = "solid"),
                                    a.getRGB(i.fill).error &&
                                        (s.type in { circle: 1, ellipse: 1 } || "r" != c(i.fill).charAt()) &&
                                        C(s, i.fill, K) &&
                                        ((m.fill = "none"), (m.gradient = i.fill), (K.rotate = !1));
                        }
                        if ("fill-opacity" in i || "opacity" in i) {
                            var O = ((+m["fill-opacity"] + 1 || 2) - 1) * ((+m.opacity + 1 || 2) - 1) * ((+a.getRGB(i.fill).o + 1 || 2) - 1);
                            (O = h(g(O, 0), 1)), (K.opacity = O), K.src && (K.color = "none");
                        }
                        l.appendChild(K);
                        var P = l.getElementsByTagName("stroke") && l.getElementsByTagName("stroke")[0],
                            Q = !1;
                        !P && (Q = P = F("stroke")),
                            ((i.stroke && "none" != i.stroke) ||
                                i["stroke-width"] ||
                                null != i["stroke-opacity"] ||
                                i["stroke-dasharray"] ||
                                i["stroke-miterlimit"] ||
                                i["stroke-linejoin"] ||
                                i["stroke-linecap"]) &&
                                (P.on = !0),
                            ("none" == i.stroke || null === i.stroke || null == P.on || 0 == i.stroke || 0 == i["stroke-width"]) && (P.on = !1);
                        var R = a.getRGB(i.stroke);
                        P.on && i.stroke && (P.color = R.hex), (O = ((+m["stroke-opacity"] + 1 || 2) - 1) * ((+m.opacity + 1 || 2) - 1) * ((+R.o + 1 || 2) - 1));
                        var S = 0.75 * (d(i["stroke-width"]) || 1);
                        if (
                            ((O = h(g(O, 0), 1)),
                            null == i["stroke-width"] && (S = m["stroke-width"]),
                            i["stroke-width"] && (P.weight = S),
                            S && 1 > S && (O *= S) && (P.weight = 1),
                            (P.opacity = O),
                            i["stroke-linejoin"] && (P.joinstyle = i["stroke-linejoin"] || "miter"),
                            (P.miterlimit = i["stroke-miterlimit"] || 8),
                            i["stroke-linecap"] && (P.endcap = "butt" == i["stroke-linecap"] ? "flat" : "square" == i["stroke-linecap"] ? "square" : "round"),
                            "stroke-dasharray" in i)
                        ) {
                            var T = {
                                "-": "shortdash",
                                ".": "shortdot",
                                "-.": "shortdashdot",
                                "-..": "shortdashdotdot",
                                ". ": "dot",
                                "- ": "dash",
                                "--": "longdash",
                                "- .": "dashdot",
                                "--.": "longdashdot",
                                "--..": "longdashdotdot"
                            };
                            P.dashstyle = T[b](i["stroke-dasharray"]) ? T[i["stroke-dasharray"]] : o;
                        }
                        Q && l.appendChild(P);
                    }
                    if ("text" == s.type) {
                        s.paper.canvas.style.display = o;
                        var U = s.paper.span,
                            V = 100,
                            W = m.font && m.font.match(/\d+(?:\.\d*)?(?=px)/);
                        (p = U.style),
                            m.font && (p.font = m.font),
                            m["font-family"] && (p.fontFamily = m["font-family"]),
                            m["font-weight"] && (p.fontWeight = m["font-weight"]),
                            m["font-style"] && (p.fontStyle = m["font-style"]),
                            (W = d(m["font-size"] || (W && W[0])) || 10),
                            (p.fontSize = W * V + "px"),
                            s.textpath.string &&
                                (U.innerHTML = c(s.textpath.string)
                                    .replace(/</g, "&#60;")
                                    .replace(/&/g, "&#38;")
                                    .replace(/\n/g, "<br>"));
                        var X = U.getBoundingClientRect();
                        (s.W = m.w = (X.right - X.left) / V),
                            (s.H = m.h = (X.bottom - X.top) / V),
                            (s.X = m.x),
                            (s.Y = m.y + s.H / 2),
                            ("x" in i || "y" in i) && (s.path.v = a.format("m{0},{1}l{2},{1}", f(m.x * u), f(m.y * u), f(m.x * u) + 1));
                        for (var Y = ["x", "y", "text", "font", "font-family", "font-weight", "font-style", "font-size"], Z = 0, $ = Y.length; $ > Z; Z++)
                            if (Y[Z] in i) {
                                s._.dirty = 1;
                                break;
                            }
                        switch (m["text-anchor"]) {
                            case "start":
                                (s.textpath.style["v-text-align"] = "left"), (s.bbx = s.W / 2);
                                break;
                            case "end":
                                (s.textpath.style["v-text-align"] = "right"), (s.bbx = -s.W / 2);
                                break;
                            default:
                                (s.textpath.style["v-text-align"] = "center"), (s.bbx = 0);
                        }
                        s.textpath.style["v-text-kern"] = !0;
                    }
                },
                C = function(b, f, g) {
                    b.attrs = b.attrs || {};
                    var h = (b.attrs, Math.pow),
                        i = "linear",
                        j = ".5 .5";
                    if (
                        ((b.attrs.gradient = f),
                        (f = c(f).replace(a._radial_gradient, function(a, b, c) {
                            return (
                                (i = "radial"),
                                b &&
                                    c &&
                                    ((b = d(b)),
                                    (c = d(c)),
                                    h(b - 0.5, 2) + h(c - 0.5, 2) > 0.25 && (c = e.sqrt(0.25 - h(b - 0.5, 2)) * (2 * (c > 0.5) - 1) + 0.5),
                                    (j = b + n + c)),
                                o
                            );
                        })),
                        (f = f.split(/\s*\-\s*/)),
                        "linear" == i)
                    ) {
                        var k = f.shift();
                        if (((k = -d(k)), isNaN(k))) return null;
                    }
                    var l = a._parseDots(f);
                    if (!l) return null;
                    if (((b = b.shape || b.node), l.length)) {
                        b.removeChild(g), (g.on = !0), (g.method = "none"), (g.color = l[0].color), (g.color2 = l[l.length - 1].color);
                        for (var m = [], p = 0, q = l.length; q > p; p++) l[p].offset && m.push(l[p].offset + n + l[p].color);
                        (g.colors = m.length ? m.join() : "0% " + g.color),
                            "radial" == i
                                ? ((g.type = "gradientTitle"), (g.focus = "100%"), (g.focussize = "0 0"), (g.focusposition = j), (g.angle = 0))
                                : ((g.type = "gradient"), (g.angle = (270 - k) % 360)),
                            b.appendChild(g);
                    }
                    return 1;
                },
                D = function(b, c) {
                    (this[0] = this.node = b),
                        (b.raphael = !0),
                        (this.id = a._oid++),
                        (b.raphaelid = this.id),
                        (this.X = 0),
                        (this.Y = 0),
                        (this.attrs = {}),
                        (this.paper = c),
                        (this.matrix = a.matrix()),
                        (this._ = { transform: [], sx: 1, sy: 1, dx: 0, dy: 0, deg: 0, dirty: 1, dirtyT: 1 }),
                        !c.bottom && (c.bottom = this),
                        (this.prev = c.top),
                        c.top && (c.top.next = this),
                        (c.top = this),
                        (this.next = null);
                },
                E = a.el;
            (D.prototype = E),
                (E.constructor = D),
                (E.transform = function(b) {
                    if (null == b) return this._.transform;
                    var d,
                        e = this.paper._viewBoxShift,
                        f = e ? "s" + [e.scale, e.scale] + "-1-1t" + [e.dx, e.dy] : o;
                    e && (d = b = c(b).replace(/\.{3}|\u2026/g, this._.transform || o)), a._extractTransform(this, f + b);
                    var g,
                        h = this.matrix.clone(),
                        i = this.skew,
                        j = this.node,
                        k = ~c(this.attrs.fill).indexOf("-"),
                        l = !c(this.attrs.fill).indexOf("url(");
                    if ((h.translate(1, 1), l || k || "image" == this.type))
                        if (((i.matrix = "1 0 0 1"), (i.offset = "0 0"), (g = h.split()), (k && g.noRotation) || !g.isSimple)) {
                            j.style.filter = h.toFilter();
                            var m = this.getBBox(),
                                p = this.getBBox(1),
                                q = m.x - p.x,
                                r = m.y - p.y;
                            (j.coordorigin = q * -u + n + r * -u), z(this, 1, 1, q, r, 0);
                        } else (j.style.filter = o), z(this, g.scalex, g.scaley, g.dx, g.dy, g.rotate);
                    else (j.style.filter = o), (i.matrix = c(h)), (i.offset = h.offset());
                    return null !== d && ((this._.transform = d), a._extractTransform(this, d)), this;
                }),
                (E.rotate = function(a, b, e) {
                    if (this.removed) return this;
                    if (null != a) {
                        if (((a = c(a).split(k)), a.length - 1 && ((b = d(a[1])), (e = d(a[2]))), (a = d(a[0])), null == e && (b = e), null == b || null == e)) {
                            var f = this.getBBox(1);
                            (b = f.x + f.width / 2), (e = f.y + f.height / 2);
                        }
                        return (this._.dirtyT = 1), this.transform(this._.transform.concat([["r", a, b, e]])), this;
                    }
                }),
                (E.translate = function(a, b) {
                    return this.removed
                        ? this
                        : ((a = c(a).split(k)),
                          a.length - 1 && (b = d(a[1])),
                          (a = d(a[0]) || 0),
                          (b = +b || 0),
                          this._.bbox && ((this._.bbox.x += a), (this._.bbox.y += b)),
                          this.transform(this._.transform.concat([["t", a, b]])),
                          this);
                }),
                (E.scale = function(a, b, e, f) {
                    if (this.removed) return this;
                    if (
                        ((a = c(a).split(k)),
                        a.length - 1 && ((b = d(a[1])), (e = d(a[2])), (f = d(a[3])), isNaN(e) && (e = null), isNaN(f) && (f = null)),
                        (a = d(a[0])),
                        null == b && (b = a),
                        null == f && (e = f),
                        null == e || null == f)
                    )
                        var g = this.getBBox(1);
                    return (
                        (e = null == e ? g.x + g.width / 2 : e),
                        (f = null == f ? g.y + g.height / 2 : f),
                        this.transform(this._.transform.concat([["s", a, b, e, f]])),
                        (this._.dirtyT = 1),
                        this
                    );
                }),
                (E.hide = function() {
                    return !this.removed && (this.node.style.display = "none"), this;
                }),
                (E.show = function() {
                    return !this.removed && (this.node.style.display = o), this;
                }),
                (E.auxGetBBox = a.el.getBBox),
                (E.getBBox = function() {
                    var a = this.auxGetBBox();
                    if (this.paper && this.paper._viewBoxShift) {
                        var b = {},
                            c = 1 / this.paper._viewBoxShift.scale;
                        return (
                            (b.x = a.x - this.paper._viewBoxShift.dx),
                            (b.x *= c),
                            (b.y = a.y - this.paper._viewBoxShift.dy),
                            (b.y *= c),
                            (b.width = a.width * c),
                            (b.height = a.height * c),
                            (b.x2 = b.x + b.width),
                            (b.y2 = b.y + b.height),
                            b
                        );
                    }
                    return a;
                }),
                (E._getBBox = function() {
                    return this.removed ? {} : { x: this.X + (this.bbx || 0) - this.W / 2, y: this.Y - this.H, width: this.W, height: this.H };
                }),
                (E.remove = function() {
                    if (!this.removed && this.node.parentNode) {
                        this.paper.__set__ && this.paper.__set__.exclude(this),
                            a.eve.unbind("raphael.*.*." + this.id),
                            a._tear(this, this.paper),
                            this.node.parentNode.removeChild(this.node),
                            this.shape && this.shape.parentNode.removeChild(this.shape);
                        for (var b in this) this[b] = "function" == typeof this[b] ? a._removedFactory(b) : null;
                        this.removed = !0;
                    }
                }),
                (E.attr = function(c, d) {
                    if (this.removed) return this;
                    if (null == c) {
                        var e = {};
                        for (var f in this.attrs) this.attrs[b](f) && (e[f] = this.attrs[f]);
                        return e.gradient && "none" == e.fill && (e.fill = e.gradient) && delete e.gradient, (e.transform = this._.transform), e;
                    }
                    if (null == d && a.is(c, "string")) {
                        if (c == j && "none" == this.attrs.fill && this.attrs.gradient) return this.attrs.gradient;
                        for (var g = c.split(k), h = {}, i = 0, m = g.length; m > i; i++)
                            (c = g[i]),
                                c in this.attrs
                                    ? (h[c] = this.attrs[c])
                                    : a.is(this.paper.customAttributes[c], "function")
                                    ? (h[c] = this.paper.customAttributes[c].def)
                                    : (h[c] = a._availableAttrs[c]);
                        return m - 1 ? h : h[g[0]];
                    }
                    if (this.attrs && null == d && a.is(c, "array")) {
                        for (h = {}, i = 0, m = c.length; m > i; i++) h[c[i]] = this.attr(c[i]);
                        return h;
                    }
                    var n;
                    null != d && ((n = {}), (n[c] = d)), null == d && a.is(c, "object") && (n = c);
                    for (var o in n) l("raphael.attr." + o + "." + this.id, this, n[o]);
                    if (n) {
                        for (o in this.paper.customAttributes)
                            if (this.paper.customAttributes[b](o) && n[b](o) && a.is(this.paper.customAttributes[o], "function")) {
                                var p = this.paper.customAttributes[o].apply(this, [].concat(n[o]));
                                this.attrs[o] = n[o];
                                for (var q in p) p[b](q) && (n[q] = p[q]);
                            }
                        n.text && "text" == this.type && (this.textpath.string = n.text), B(this, n);
                    }
                    return this;
                }),
                (E.toFront = function() {
                    return !this.removed && this.node.parentNode.appendChild(this.node), this.paper && this.paper.top != this && a._tofront(this, this.paper), this;
                }),
                (E.toBack = function() {
                    return this.removed
                        ? this
                        : (this.node.parentNode.firstChild != this.node &&
                              (this.node.parentNode.insertBefore(this.node, this.node.parentNode.firstChild), a._toback(this, this.paper)),
                          this);
                }),
                (E.insertAfter = function(b) {
                    return this.removed
                        ? this
                        : (b.constructor == a.st.constructor && (b = b[b.length - 1]),
                          b.node.nextSibling ? b.node.parentNode.insertBefore(this.node, b.node.nextSibling) : b.node.parentNode.appendChild(this.node),
                          a._insertafter(this, b, this.paper),
                          this);
                }),
                (E.insertBefore = function(b) {
                    return this.removed
                        ? this
                        : (b.constructor == a.st.constructor && (b = b[0]), b.node.parentNode.insertBefore(this.node, b.node), a._insertbefore(this, b, this.paper), this);
                }),
                (E.blur = function(b) {
                    var c = this.node.runtimeStyle,
                        d = c.filter;
                    return (
                        (d = d.replace(r, o)),
                        0 !== +b
                            ? ((this.attrs.blur = b), (c.filter = d + n + m + ".Blur(pixelradius=" + (+b || 1.5) + ")"), (c.margin = a.format("-{0}px 0 0 -{0}px", f(+b || 1.5))))
                            : ((c.filter = d), (c.margin = 0), delete this.attrs.blur),
                        this
                    );
                }),
                (a._engine.path = function(a, b) {
                    var c = F("shape");
                    (c.style.cssText = t), (c.coordsize = u + n + u), (c.coordorigin = b.coordorigin);
                    var d = new D(c, b),
                        e = { fill: "none", stroke: "#000" };
                    a && (e.path = a), (d.type = "path"), (d.path = []), (d.Path = o), B(d, e), b.canvas.appendChild(c);
                    var f = F("skew");
                    return (f.on = !0), c.appendChild(f), (d.skew = f), d.transform(o), d;
                }),
                (a._engine.rect = function(b, c, d, e, f, g) {
                    var h = a._rectPath(c, d, e, f, g),
                        i = b.path(h),
                        j = i.attrs;
                    return (i.X = j.x = c), (i.Y = j.y = d), (i.W = j.width = e), (i.H = j.height = f), (j.r = g), (j.path = h), (i.type = "rect"), i;
                }),
                (a._engine.ellipse = function(a, b, c, d, e) {
                    {
                        var f = a.path();
                        f.attrs;
                    }
                    return (f.X = b - d), (f.Y = c - e), (f.W = 2 * d), (f.H = 2 * e), (f.type = "ellipse"), B(f, { cx: b, cy: c, rx: d, ry: e }), f;
                }),
                (a._engine.circle = function(a, b, c, d) {
                    {
                        var e = a.path();
                        e.attrs;
                    }
                    return (e.X = b - d), (e.Y = c - d), (e.W = e.H = 2 * d), (e.type = "circle"), B(e, { cx: b, cy: c, r: d }), e;
                }),
                (a._engine.image = function(b, c, d, e, f, g) {
                    var h = a._rectPath(d, e, f, g),
                        i = b.path(h).attr({ stroke: "none" }),
                        k = i.attrs,
                        l = i.node,
                        m = l.getElementsByTagName(j)[0];
                    return (
                        (k.src = c),
                        (i.X = k.x = d),
                        (i.Y = k.y = e),
                        (i.W = k.width = f),
                        (i.H = k.height = g),
                        (k.path = h),
                        (i.type = "image"),
                        m.parentNode == l && l.removeChild(m),
                        (m.rotate = !0),
                        (m.src = c),
                        (m.type = "tile"),
                        (i._.fillpos = [d, e]),
                        (i._.fillsize = [f, g]),
                        l.appendChild(m),
                        z(i, 1, 1, 0, 0, 0),
                        i
                    );
                }),
                (a._engine.text = function(b, d, e, g) {
                    var h = F("shape"),
                        i = F("path"),
                        j = F("textpath");
                    (d = d || 0),
                        (e = e || 0),
                        (g = g || ""),
                        (i.v = a.format("m{0},{1}l{2},{1}", f(d * u), f(e * u), f(d * u) + 1)),
                        (i.textpathok = !0),
                        (j.string = c(g)),
                        (j.on = !0),
                        (h.style.cssText = t),
                        (h.coordsize = u + n + u),
                        (h.coordorigin = "0 0");
                    var k = new D(h, b),
                        l = { fill: "#000", stroke: "none", font: a._availableAttrs.font, text: g };
                    (k.shape = h),
                        (k.path = i),
                        (k.textpath = j),
                        (k.type = "text"),
                        (k.attrs.text = c(g)),
                        (k.attrs.x = d),
                        (k.attrs.y = e),
                        (k.attrs.w = 1),
                        (k.attrs.h = 1),
                        B(k, l),
                        h.appendChild(j),
                        h.appendChild(i),
                        b.canvas.appendChild(h);
                    var m = F("skew");
                    return (m.on = !0), h.appendChild(m), (k.skew = m), k.transform(o), k;
                }),
                (a._engine.setSize = function(b, c) {
                    var d = this.canvas.style;
                    return (
                        (this.width = b),
                        (this.height = c),
                        b == +b && (b += "px"),
                        c == +c && (c += "px"),
                        (d.width = b),
                        (d.height = c),
                        (d.clip = "rect(0 " + b + " " + c + " 0)"),
                        this._viewBox && a._engine.setViewBox.apply(this, this._viewBox),
                        this
                    );
                }),
                (a._engine.setViewBox = function(b, c, d, e, f) {
                    a.eve("raphael.setViewBox", this, this._viewBox, [b, c, d, e, f]);
                    var g,
                        h,
                        i = this.getSize(),
                        j = i.width,
                        k = i.height;
                    return (
                        f && ((g = k / e), (h = j / d), j > d * g && (b -= (j - d * g) / 2 / g), k > e * h && (c -= (k - e * h) / 2 / h)),
                        (this._viewBox = [b, c, d, e, !!f]),
                        (this._viewBoxShift = { dx: -b, dy: -c, scale: i }),
                        this.forEach(function(a) {
                            a.transform("...");
                        }),
                        this
                    );
                });
            var F;
            (a._engine.initWin = function(a) {
                var b = a.document;
                b.styleSheets.length < 31 ? b.createStyleSheet().addRule(".rvml", "behavior:url(#default#VML)") : b.styleSheets[0].addRule(".rvml", "behavior:url(#default#VML)");
                try {
                    !b.namespaces.rvml && b.namespaces.add("rvml", "urn:schemas-microsoft-com:vml"),
                        (F = function(a) {
                            return b.createElement("<rvml:" + a + ' class="rvml">');
                        });
                } catch (c) {
                    F = function(a) {
                        return b.createElement("<" + a + ' xmlns="urn:schemas-microsoft.com:vml" class="rvml">');
                    };
                }
            }),
                a._engine.initWin(a._g.win),
                (a._engine.create = function() {
                    var b = a._getContainer.apply(0, arguments),
                        c = b.container,
                        d = b.height,
                        e = b.width,
                        f = b.x,
                        g = b.y;
                    if (!c) throw new Error("VML container not found.");
                    var h = new a._Paper(),
                        i = (h.canvas = a._g.doc.createElement("div")),
                        j = i.style;
                    return (
                        (f = f || 0),
                        (g = g || 0),
                        (e = e || 512),
                        (d = d || 342),
                        (h.width = e),
                        (h.height = d),
                        e == +e && (e += "px"),
                        d == +d && (d += "px"),
                        (h.coordsize = 1e3 * u + n + 1e3 * u),
                        (h.coordorigin = "0 0"),
                        (h.span = a._g.doc.createElement("span")),
                        (h.span.style.cssText = "position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;"),
                        i.appendChild(h.span),
                        (j.cssText = a.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden", e, d)),
                        1 == c
                            ? (a._g.doc.body.appendChild(i), (j.left = f + "px"), (j.top = g + "px"), (j.position = "absolute"))
                            : c.firstChild
                            ? c.insertBefore(i, c.firstChild)
                            : c.appendChild(i),
                        (h.renderfix = function() {}),
                        h
                    );
                }),
                (a.prototype.clear = function() {
                    a.eve("raphael.clear", this),
                        (this.canvas.innerHTML = o),
                        (this.span = a._g.doc.createElement("span")),
                        (this.span.style.cssText = "position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;"),
                        this.canvas.appendChild(this.span),
                        (this.bottom = this.top = null);
                }),
                (a.prototype.remove = function() {
                    a.eve("raphael.remove", this), this.canvas.parentNode.removeChild(this.canvas);
                    for (var b in this) this[b] = "function" == typeof this[b] ? a._removedFactory(b) : null;
                    return !0;
                });
            var G = a.st;
            for (var H in E)
                E[b](H) &&
                    !G[b](H) &&
                    (G[H] = (function(a) {
                        return function() {
                            var b = arguments;
                            return this.forEach(function(c) {
                                c[a].apply(c, b);
                            });
                        };
                    })(H));
        }
    }),
    (function(a, b) {
        if ("function" === typeof wwplayer.define && wwplayer.define.amd)
            wwplayer.define("raphael", ["raphael.core", "raphael.svg", "raphael.vml"], function(c) {
                return (a.Raphael = b(c));
            });
        else if ("object" == typeof exports) {
            var c = require("raphael.core");
            require("raphael.svg"), require("raphael.vml"), (module.exports = b(c));
        } else a.Raphael = b(a.Raphael);
    })(this, function(a) {
        return a.ninja();
    });

/*
	this function draws two path elements to svg; blurred path element and normal path element (to create shadow effect).
	you can se it like you would use rsr.path since it returns the same object but with a shadow property which contains the shadow path element

	d = path
	x = offset x
	y = offset y
	z = blur amount

	example:
	rsr.pathWithShadow("M2.4,14c-0.1,0-0.2,0-0.3-0.1c0,0,0,0,0,0l0,0l0,0c-0.1-0.1-0.2-0.2-0.2-0.3l-1.2-12c0,0,0,0,0,0 c0-0.2,0.1-0.3,0.2-0.4C1.1,1,1.3,1,1.4,1.1l8,3.2l2.7-3.2c0.1-0.1,0.3-0.2,0.4-0.2c0.2,0,0.3,0.1,0.4,0.3l3.3,6c0,0,0,0,0,0 c0,0.1,0.1,0.1,0.1,0.2c0,0.1,0,0.1,0,0.2c0,0,0,0,0,0c0,0.1-0.1,0.1-0.1,0.2l0,0c0,0,0,0,0,0h0c0,0,0,0,0,0c0,0,0,0,0,0 c0,0,0,0,0,0c0,0-0.1,0-0.1,0.1c0,0,0,0,0,0L2.6,14C2.6,14,2.6,14,2.4,14C2.5,14,2.5,14,2.4,14C2.5,14,2.5,14,2.4,14 C2.5,14,2.5,14,2.4,14C2.5,14,2.5,14,2.4,14C2.5,14,2.5,14,2.4,14C2.5,14,2.5,14,2.4,14C2.5,14,2.5,14.1,2.4,14 C2.5,14,2.4,14,2.4,14z M1.8,2.3l1,10l6-7.2L1.8,2.3z M9.8,5.5l-5.5,6.7l10.3-4.7L9.8,5.5z M10.4,4.7l4.3,1.7l-2.3-4.1L10.4,4.7z",.5,.5,1)
*/
wwplayer.define("raphael-shadow", ["raphael", "jquery"], function(Raphael, $) {
    Raphael.fn.pathWithShadow = function(d, x, y, z) {
        var shadow = this.path(d)
            .attr({
                fill: "#000000",
                "stroke-width": "0",
                "stroke-opacity": "1"
            })
            .blur(z)
            .translate(x, y);
        $(shadow[0]).attr("class", "shadow");
        $(shadow._blur).attr("x", "-20%");
        $(shadow._blur).attr("y", "-20%");
        $(shadow._blur).attr("width", "200%");
        $(shadow._blur).attr("height", "200%");
        var path = this.path(d);
        path.shadow = shadow;
        return path;
    };

    return Raphael;
});
/*!
 * iScroll v4.2.5 ~ Copyright (c) 2012 Matteo Spinelli, http://cubiq.org
 * Released under MIT license, http://cubiq.org/license
 */
(function(window, doc) {
    var m = Math,
        dummyStyle = doc.createElement("div").style,
        vendor = (function() {
            var vendors = "webkitT,MozT,msT,OT,t".split(","), //Quick fix for FF16+ bug
                t,
                i = 0,
                l = vendors.length;

            for (; i < l; i++) {
                t = vendors[i] + "ransform";
                if (t in dummyStyle) {
                    return vendors[i].substr(0, vendors[i].length - 1);
                }
            }

            return false;
        })(),
        cssVendor = vendor ? "-" + vendor.toLowerCase() + "-" : "",
        // Style properties
        transform = prefixStyle("transform"),
        transitionProperty = prefixStyle("transitionProperty"),
        transitionDuration = prefixStyle("transitionDuration"),
        transformOrigin = prefixStyle("transformOrigin"),
        transitionTimingFunction = prefixStyle("transitionTimingFunction"),
        transitionDelay = prefixStyle("transitionDelay"),
        // Browser capabilities
        isAndroid = /android/gi.test(navigator.appVersion),
        isIDevice = /iphone|ipad/gi.test(navigator.appVersion),
        isTouchPad = /hp-tablet/gi.test(navigator.appVersion),
        isMobile = navigator.userAgent.match(/Mobile/i) != null,
        isKindle = navigator.userAgent.match(/Silk/i) != null,
        isWindowsPhone =
            navigator.userAgent.match(/Windows Phone/i) != null ||
            navigator.userAgent.match(/IEMobile/i) != null ||
            navigator.userAgent.match(/WPDesktop/i) != null ||
            (navigator.userAgent.match(/Windows NT/i) != null && navigator.userAgent.match(/Touch/i) != null && navigator.userAgent.match(/Windows Phone/i) != null),
        isBlackberry = navigator.userAgent.match(/Blackberry/i) != null || navigator.userAgent.match(/RIM/i) != null,
        isDesktop = !(isMobile || isKindle || isIDevice || isAndroid || isBlackberry || isWindowsPhone),
        has3d = prefixStyle("perspective") in dummyStyle,
        hasTouch = "ontouchstart" in window && !isTouchPad && !isDesktop,
        hasTransform = vendor !== false,
        hasTransitionEnd = prefixStyle("transition") in dummyStyle,
        RESIZE_EV = "onorientationchange" in window ? "orientationchange" : "resize",
        START_EV = hasTouch ? "touchstart" : "mousedown",
        MOVE_EV = hasTouch ? "touchmove" : "mousemove",
        END_EV = hasTouch ? "touchend" : "mouseup",
        CANCEL_EV = hasTouch ? "touchcancel" : "mouseup",
        TRNEND_EV = (function() {
            if (vendor === false) return false;

            var transitionEnd = {
                "": "transitionend",
                webkit: "webkitTransitionEnd",
                Moz: "transitionend",
                O: "otransitionend",
                ms: "MSTransitionEnd"
            };

            return transitionEnd[vendor];
        })(),
        nextFrame = (function() {
            return (
                window.requestAnimationFrame ||
                window.webkitRequestAnimationFrame ||
                window.mozRequestAnimationFrame ||
                window.oRequestAnimationFrame ||
                window.msRequestAnimationFrame ||
                function(callback) {
                    return setTimeout(callback, 1);
                }
            );
        })(),
        cancelFrame = (function() {
            return (
                window.cancelRequestAnimationFrame ||
                window.webkitCancelAnimationFrame ||
                window.webkitCancelRequestAnimationFrame ||
                window.mozCancelRequestAnimationFrame ||
                window.oCancelRequestAnimationFrame ||
                window.msCancelRequestAnimationFrame ||
                clearTimeout
            );
        })(),
        // Helpers
        translateZ = has3d ? " translateZ(0)" : "",
        // Constructor
        iScroll = function(el, options) {
            var that = this,
                i;

            that.wrapper = typeof el == "object" ? el : doc.getElementById(el);
            that.wrapper.style.overflow = "hidden";
            that.scroller = that.wrapper.children[0];

            // Default options
            that.options = {
                hScroll: true,
                vScroll: true,
                x: 0,
                y: 0,
                bounce: true,
                bounceLock: false,
                momentum: true,
                lockDirection: true,
                useTransform: true,
                useTransition: false,
                topOffset: 0,
                checkDOMChanges: false, // Experimental
                handleClick: true,

                // Scrollbar
                hScrollbar: true,
                vScrollbar: true,
                fixedScrollbar: isAndroid,
                hideScrollbar: isIDevice,
                fadeScrollbar: isIDevice && has3d,
                scrollbarClass: "",
                draggableScrollbars: false,

                // Zoom
                zoom: false,
                zoomMin: 1,
                zoomMax: 4,
                doubleTapZoom: 2,
                wheelAction: "scroll",

                // Snap
                snap: false,
                snapThreshold: 1,

                // Events
                onRefresh: null,
                onBeforeScrollStart: function(e) {
                    e.preventDefault();
                },
                onScrollStart: null,
                onBeforeScrollMove: null,
                onScrollMove: null,
                onBeforeScrollEnd: null,
                onScrollEnd: null,
                onTouchEnd: null,
                onDestroy: null,
                onZoomStart: null,
                onZoom: null,
                onZoomEnd: null
            };

            // User defined options
            for (i in options) that.options[i] = options[i];

            // Set starting position
            that.x = that.options.x;
            that.y = that.options.y;

            // Normalize options
            that.options.useTransform = hasTransform && that.options.useTransform;
            that.options.hScrollbar = that.options.hScroll && that.options.hScrollbar;
            that.options.vScrollbar = that.options.vScroll && that.options.vScrollbar;
            that.options.zoom = that.options.useTransform && that.options.zoom;
            that.options.useTransition = hasTransitionEnd && that.options.useTransition;

            // Helpers FIX ANDROID BUG!
            // translate3d and scale doesn't work together!
            // Ignoring 3d ONLY WHEN YOU SET that.options.zoom
            if (that.options.zoom && isAndroid) {
                translateZ = "";
            }

            // Scrollbar should be functional only on desktop browsers.
            if (that.options.draggableScrollbars && hasTouch) {
                that.options.draggableScrollbars = false;
            }

            // Set some default styles
            that.scroller.style[transitionProperty] = that.options.useTransform ? cssVendor + "transform" : "top left";
            that.scroller.style[transitionDuration] = "0";
            that.scroller.style[transformOrigin] = "0 0";
            if (that.options.useTransition) that.scroller.style[transitionTimingFunction] = "cubic-bezier(0.33,0.66,0.66,1)";

            if (that.options.useTransform) that.scroller.style[transform] = "translate(" + that.x + "px," + that.y + "px)" + translateZ;
            else that.scroller.style.cssText += ";position:absolute;top:" + that.y + "px;left:" + that.x + "px";

            if (that.options.useTransition) that.options.fixedScrollbar = true;

            that.refresh();

            that._bind(RESIZE_EV, window);
            that._bind(START_EV);
            if (!hasTouch) {
                if (that.options.wheelAction != "none") {
                    that._bind("DOMMouseScroll");
                    that._bind("mousewheel");
                }
            }

            if (that.options.checkDOMChanges)
                that.checkDOMTime = setInterval(function() {
                    that._checkDOMChanges();
                }, 500);
        };

    // Prototype
    iScroll.prototype = {
        enabled: true,
        x: 0,
        y: 0,
        steps: [],
        scale: 1,
        currPageX: 0,
        currPageY: 0,
        pagesX: [],
        pagesY: [],
        aniTime: null,
        wheelZoomCount: 0,
        isScrollbarDragged: false,

        handleEvent: function(e) {
            var that = this;
            switch (e.type) {
                case START_EV:
                    if (!hasTouch && e.button !== 0) return;
                    that._start(e);
                    break;
                case MOVE_EV:
                    that._move(e);
                    break;
                case END_EV:
                case CANCEL_EV:
                    that._end(e);
                    break;
                case RESIZE_EV:
                    that._resize();
                    break;
                case "DOMMouseScroll":
                case "mousewheel":
                    that._wheel(e);
                    break;
                case TRNEND_EV:
                    that._transitionEnd(e);
                    break;
            }
        },

        _checkDOMChanges: function() {
            if (
                this.moved ||
                this.zoomed ||
                this.animating ||
                (this.scrollerW == this.scroller.offsetWidth * this.scale && this.scrollerH == this.scroller.offsetHeight * this.scale)
            )
                return;

            this.refresh();
        },

        _scrollbar: function(dir) {
            var that = this,
                bar;

            if (!that[dir + "Scrollbar"]) {
                if (that[dir + "ScrollbarWrapper"]) {
                    if (hasTransform) that[dir + "ScrollbarIndicator"].style[transform] = "";
                    that[dir + "ScrollbarWrapper"].parentNode.removeChild(that[dir + "ScrollbarWrapper"]);
                    that[dir + "ScrollbarWrapper"] = null;
                    that[dir + "ScrollbarIndicator"] = null;
                }

                return;
            }

            if (!that[dir + "ScrollbarWrapper"]) {
                // Create the scrollbar wrapper
                bar = doc.createElement("div");

                if (that.options.scrollbarClass) bar.className = that.options.scrollbarClass + dir.toUpperCase();
                else
                    bar.style.cssText =
                        "position:absolute;z-index:100;" +
                        (dir == "h"
                            ? "height:7px;bottom:1px;left:2px;right:" + (that.vScrollbar ? "7" : "2") + "px"
                            : "width:7px;bottom:" + (that.hScrollbar ? "7" : "2") + "px;top:2px;right:1px");

                bar.style.cssText +=
                    ";" +
                    (that.options.draggableScrollbars ? "" : "pointer-events:none;") +
                    cssVendor +
                    "transition-property:opacity;" +
                    cssVendor +
                    "transition-duration:" +
                    (that.options.fadeScrollbar ? "350ms" : "0") +
                    ";overflow:hidden;opacity:" +
                    (that.options.hideScrollbar ? "0" : "1");

                that.wrapper.appendChild(bar);
                that[dir + "ScrollbarWrapper"] = bar;

                // Create the scrollbar indicator
                bar = doc.createElement("div");
                if (!that.options.scrollbarClass) {
                    bar.style.cssText =
                        "position:absolute;z-index:100;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);" +
                        cssVendor +
                        "background-clip:padding-box;" +
                        cssVendor +
                        "box-sizing:border-box;" +
                        (dir == "h" ? "height:100%" : "width:100%") +
                        ";" +
                        cssVendor +
                        "border-radius:3px;border-radius:3px";
                }
                bar.style.cssText +=
                    ";" +
                    (that.options.draggableScrollbars ? "" : "pointer-events:none;") +
                    cssVendor +
                    "transition-property:" +
                    cssVendor +
                    "transform;" +
                    cssVendor +
                    "transition-timing-function:cubic-bezier(0.33,0.66,0.66,1);" +
                    cssVendor +
                    "transition-duration:0;" +
                    cssVendor +
                    "transform: translate(0,0)" +
                    translateZ;
                if (that.options.useTransition) bar.style.cssText += ";" + cssVendor + "transition-timing-function:cubic-bezier(0.33,0.66,0.66,1)";

                // Helper attribute so that we can easily tell if current target is scrollbar or not.
                bar.setAttribute("data-scrollbarindicator", true);

                that[dir + "ScrollbarWrapper"].appendChild(bar);
                that[dir + "ScrollbarIndicator"] = bar;

                //Add scrollbar event listeners
                if (that.options.draggableScrollbars) {
                    if (that.vScrollbar) that._bind(START_EV, that.vScrollbarIndicator);
                    if (that.hScrollbar) that._bind(START_EV, that.hScrollbarIndicator);
                }
            }

            if (dir == "h") {
                that.hScrollbarSize = that.hScrollbarWrapper.clientWidth;
                that.hScrollbarIndicatorSize = m.max(m.round((that.hScrollbarSize * that.hScrollbarSize) / that.scrollerW), 8);
                that.hScrollbarIndicator.style.width = that.hScrollbarIndicatorSize + "px";
                that.hScrollbarMaxScroll = that.hScrollbarSize - that.hScrollbarIndicatorSize;
                that.hScrollbarProp = that.hScrollbarMaxScroll / that.maxScrollX;
            } else {
                that.vScrollbarSize = that.vScrollbarWrapper.clientHeight;
                that.vScrollbarIndicatorSize = m.max(m.round((that.vScrollbarSize * that.vScrollbarSize) / that.scrollerH), 8);
                that.vScrollbarIndicator.style.height = that.vScrollbarIndicatorSize + "px";
                that.vScrollbarMaxScroll = that.vScrollbarSize - that.vScrollbarIndicatorSize;
                that.vScrollbarProp = that.vScrollbarMaxScroll / that.maxScrollY;
            }

            // Reset position
            that._scrollbarPos(dir, true);
        },

        _resize: function() {
            var that = this;
            setTimeout(
                function() {
                    that.refresh();
                },
                isAndroid ? 200 : 0
            );
        },

        _pos: function(x, y) {
            if (this.zoomed) return;

            x = this.hScroll ? x : 0;
            y = this.vScroll ? y : 0;

            if (this.options.useTransform) {
                this.scroller.style[transform] = "translate(" + x + "px," + y + "px) scale(" + this.scale + ")" + translateZ;
            } else {
                x = m.round(x);
                y = m.round(y);
                this.scroller.style.left = x + "px";
                this.scroller.style.top = y + "px";
            }

            this.x = x;
            this.y = y;

            this._scrollbarPos("h");
            this._scrollbarPos("v");
        },

        _scrollbarPos: function(dir, hidden) {
            var that = this,
                pos = dir == "h" ? that.x : that.y,
                size;

            if (!that[dir + "Scrollbar"]) return;

            pos = that[dir + "ScrollbarProp"] * pos;

            if (pos < 0) {
                if (!that.options.fixedScrollbar) {
                    size = that[dir + "ScrollbarIndicatorSize"] + m.round(pos * 3);
                    if (size < 8) size = 8;
                    that[dir + "ScrollbarIndicator"].style[dir == "h" ? "width" : "height"] = size + "px";
                }
                pos = 0;
            } else if (pos > that[dir + "ScrollbarMaxScroll"]) {
                if (!that.options.fixedScrollbar) {
                    size = that[dir + "ScrollbarIndicatorSize"] - m.round((pos - that[dir + "ScrollbarMaxScroll"]) * 3);
                    if (size < 8) size = 8;
                    that[dir + "ScrollbarIndicator"].style[dir == "h" ? "width" : "height"] = size + "px";
                    pos = that[dir + "ScrollbarMaxScroll"] + (that[dir + "ScrollbarIndicatorSize"] - size);
                } else {
                    pos = that[dir + "ScrollbarMaxScroll"];
                }
            }

            that[dir + "ScrollbarWrapper"].style[transitionDelay] = "0";
            that[dir + "ScrollbarWrapper"].style.opacity = hidden && that.options.hideScrollbar ? "0" : "1";
            that[dir + "ScrollbarIndicator"].style[transform] = "translate(" + (dir == "h" ? pos + "px,0)" : "0," + pos + "px)") + translateZ;
        },

        _start: function(e) {
            var that = this,
                point = hasTouch ? e.touches[0] : e,
                matrix,
                x,
                y,
                c1,
                c2;

            if (!that.enabled) return;

            if (that.options.onBeforeScrollStart) that.options.onBeforeScrollStart.call(that, e);

            if (that.options.useTransition || that.options.zoom) that._transitionTime(0);

            // If scrollbar is dragged, we need to handle events differently.
            if (that.options.draggableScrollbars) {
                that.isScrollbarDragged = point.target.getAttribute("data-scrollbarindicator") ? true : false;
            }

            that.moved = false;
            that.animating = false;
            that.zoomed = false;
            that.distX = 0;
            that.distY = 0;
            that.absDistX = 0;
            that.absDistY = 0;
            that.dirX = 0;
            that.dirY = 0;

            // Gesture start
            if (that.options.zoom && hasTouch && e.touches.length > 1) {
                c1 = m.abs(e.touches[0].pageX - e.touches[1].pageX);
                c2 = m.abs(e.touches[0].pageY - e.touches[1].pageY);
                that.touchesDistStart = m.sqrt(c1 * c1 + c2 * c2);

                that.originX = m.abs(e.touches[0].pageX + e.touches[1].pageX - that.wrapperOffsetLeft * 2) / 2 - that.x;
                that.originY = m.abs(e.touches[0].pageY + e.touches[1].pageY - that.wrapperOffsetTop * 2) / 2 - that.y;

                if (that.options.onZoomStart) that.options.onZoomStart.call(that, e);
            }

            if (that.options.momentum) {
                if (that.options.useTransform) {
                    // Very lame general purpose alternative to CSSMatrix
                    matrix = getComputedStyle(that.scroller, null)
                        [transform].replace(/[^0-9\-.,]/g, "")
                        .split(",");
                    x = +(matrix[12] || matrix[4]);
                    y = +(matrix[13] || matrix[5]);
                } else {
                    x = +getComputedStyle(that.scroller, null).left.replace(/[^0-9-]/g, "");
                    y = +getComputedStyle(that.scroller, null).top.replace(/[^0-9-]/g, "");
                }

                if (x != that.x || y != that.y) {
                    if (that.options.useTransition) that._unbind(TRNEND_EV);
                    else cancelFrame(that.aniTime);
                    that.steps = [];
                    that._pos(x, y);
                    if (that.options.onScrollEnd) that.options.onScrollEnd.call(that);
                }
            }

            that.absStartX = that.x; // Needed by snap threshold
            that.absStartY = that.y;

            that.startX = that.x;
            that.startY = that.y;
            that.pointX = point.pageX;
            that.pointY = point.pageY;

            that.startTime = e.timeStamp || Date.now();

            if (that.options.onScrollStart) that.options.onScrollStart.call(that, e);

            that._bind(MOVE_EV, window);
            that._bind(END_EV, window);
            that._bind(CANCEL_EV, window);
        },

        _move: function(e) {
            var that = this,
                point = hasTouch ? e.touches[0] : e,
                // If we're dragging a scrollbar and if draggableScrollbars is set to true, we need to reverse the direction
                // and speed up the scroll to be in sync with the scrollbar/wrapper size ratio.
                deltaX = that.isScrollbarDragged ? -(point.pageX - that.pointX) * (that.scrollerW / that.wrapperW) : point.pageX - that.pointX,
                deltaY = that.isScrollbarDragged ? -(point.pageY - that.pointY) * (that.scrollerH / that.wrapperH) : point.pageY - that.pointY,
                newX = that.x + deltaX,
                newY = that.y + deltaY,
                c1,
                c2,
                scale,
                timestamp = e.timeStamp || Date.now();

            if (that.options.onBeforeScrollMove) that.options.onBeforeScrollMove.call(that, e);

            // Zoom
            if (that.options.zoom && hasTouch && e.touches.length > 1) {
                c1 = m.abs(e.touches[0].pageX - e.touches[1].pageX);
                c2 = m.abs(e.touches[0].pageY - e.touches[1].pageY);
                that.touchesDist = m.sqrt(c1 * c1 + c2 * c2);

                that.zoomed = true;

                scale = (1 / that.touchesDistStart) * that.touchesDist * this.scale;

                if (scale < that.options.zoomMin) scale = 0.5 * that.options.zoomMin * Math.pow(2.0, scale / that.options.zoomMin);
                else if (scale > that.options.zoomMax) scale = 2.0 * that.options.zoomMax * Math.pow(0.5, that.options.zoomMax / scale);

                that.lastScale = scale / this.scale;

                (newX = this.originX - this.originX * that.lastScale + this.x), (newY = this.originY - this.originY * that.lastScale + this.y);

                this.scroller.style[transform] = "translate(" + newX + "px," + newY + "px) scale(" + scale + ")" + translateZ;

                if (that.options.onZoom) that.options.onZoom.call(that, e);
                return;
            }

            that.pointX = point.pageX;
            that.pointY = point.pageY;

            // Slow down if outside of the boundaries
            if (newX > 0 || newX < that.maxScrollX) {
                newX = that.options.bounce ? that.x + deltaX / 2 : newX >= 0 || that.maxScrollX >= 0 ? 0 : that.maxScrollX;
            }
            if (newY > that.minScrollY || newY < that.maxScrollY) {
                newY = that.options.bounce ? that.y + deltaY / 2 : newY >= that.minScrollY || that.maxScrollY >= 0 ? that.minScrollY : that.maxScrollY;
            }

            that.distX += deltaX;
            that.distY += deltaY;
            that.absDistX = m.abs(that.distX);
            that.absDistY = m.abs(that.distY);

            if (that.absDistX < 6 && that.absDistY < 6) {
                return;
            }

            // Lock direction
            if (that.options.lockDirection) {
                if (that.absDistX > that.absDistY + 5) {
                    newY = that.y;
                    deltaY = 0;
                } else if (that.absDistY > that.absDistX + 5) {
                    newX = that.x;
                    deltaX = 0;
                }
            }

            that.moved = true;
            that._pos(newX, newY);
            that.dirX = deltaX > 0 ? -1 : deltaX < 0 ? 1 : 0;
            that.dirY = deltaY > 0 ? -1 : deltaY < 0 ? 1 : 0;

            if (timestamp - that.startTime > 300) {
                that.startTime = timestamp;
                that.startX = that.x;
                that.startY = that.y;
            }

            if (that.options.onScrollMove) that.options.onScrollMove.call(that, e);
        },

        _end: function(e) {
            if (hasTouch && e.touches.length !== 0) return;

            var that = this,
                point = hasTouch ? e.changedTouches[0] : e,
                target,
                ev,
                momentumX = { dist: 0, time: 0 },
                momentumY = { dist: 0, time: 0 },
                duration = (e.timeStamp || Date.now()) - that.startTime,
                newPosX = that.x,
                newPosY = that.y,
                distX,
                distY,
                newDuration,
                snap,
                scale;

            that._unbind(MOVE_EV, window);
            that._unbind(END_EV, window);
            that._unbind(CANCEL_EV, window);

            if (that.options.onBeforeScrollEnd) that.options.onBeforeScrollEnd.call(that, e);

            if (that.zoomed) {
                scale = that.scale * that.lastScale;
                scale = Math.max(that.options.zoomMin, scale);
                scale = Math.min(that.options.zoomMax, scale);
                that.lastScale = scale / that.scale;
                that.scale = scale;

                that.x = that.originX - that.originX * that.lastScale + that.x;
                that.y = that.originY - that.originY * that.lastScale + that.y;

                that.scroller.style[transitionDuration] = "200ms";
                that.scroller.style[transform] = "translate(" + that.x + "px," + that.y + "px) scale(" + that.scale + ")" + translateZ;

                that.zoomed = false;
                that.refresh();

                if (that.options.onZoomEnd) that.options.onZoomEnd.call(that, e);
                return;
            }

            if (!that.moved) {
                if (hasTouch) {
                    if (that.doubleTapTimer && that.options.zoom) {
                        // Double tapped
                        clearTimeout(that.doubleTapTimer);
                        that.doubleTapTimer = null;
                        if (that.options.onZoomStart) that.options.onZoomStart.call(that, e);
                        that.zoom(that.pointX, that.pointY, that.scale == 1 ? that.options.doubleTapZoom : 1);
                        if (that.options.onZoomEnd) {
                            setTimeout(function() {
                                that.options.onZoomEnd.call(that, e);
                            }, 200); // 200 is default zoom duration
                        }
                    } else if (this.options.handleClick) {
                        that.doubleTapTimer = setTimeout(
                            function() {
                                that.doubleTapTimer = null;

                                // Find the last touched element
                                target = point.target;
                                while (target.nodeType != 1) target = target.parentNode;

                                if (target.tagName != "SELECT" && target.tagName != "INPUT" && target.tagName != "TEXTAREA") {
                                    ev = doc.createEvent("MouseEvents");
                                    ev.initMouseEvent(
                                        "click",
                                        true,
                                        true,
                                        e.view,
                                        1,
                                        point.screenX,
                                        point.screenY,
                                        point.clientX,
                                        point.clientY,
                                        e.ctrlKey,
                                        e.altKey,
                                        e.shiftKey,
                                        e.metaKey,
                                        0,
                                        null
                                    );
                                    ev._fake = true;
                                    target.dispatchEvent(ev);
                                }
                            },
                            that.options.zoom ? 250 : 0
                        );
                    }
                }

                that._resetPos(400);

                if (that.options.onTouchEnd) that.options.onTouchEnd.call(that, e);
                return;
            }

            if (duration < 300 && that.options.momentum) {
                momentumX = newPosX
                    ? that._momentum(newPosX - that.startX, duration, -that.x, that.scrollerW - that.wrapperW + that.x, that.options.bounce ? that.wrapperW : 0)
                    : momentumX;
                momentumY = newPosY
                    ? that._momentum(
                          newPosY - that.startY,
                          duration,
                          -that.y,
                          that.maxScrollY < 0 ? that.scrollerH - that.wrapperH + that.y - that.minScrollY : 0,
                          that.options.bounce ? that.wrapperH : 0
                      )
                    : momentumY;

                newPosX = that.x + momentumX.dist;
                newPosY = that.y + momentumY.dist;

                if ((that.x > 0 && newPosX > 0) || (that.x < that.maxScrollX && newPosX < that.maxScrollX)) momentumX = { dist: 0, time: 0 };
                if ((that.y > that.minScrollY && newPosY > that.minScrollY) || (that.y < that.maxScrollY && newPosY < that.maxScrollY)) momentumY = { dist: 0, time: 0 };
            }

            if (momentumX.dist || momentumY.dist) {
                newDuration = m.max(m.max(momentumX.time, momentumY.time), 10);

                // Do we need to snap?
                if (that.options.snap) {
                    distX = newPosX - that.absStartX;
                    distY = newPosY - that.absStartY;
                    if (m.abs(distX) < that.options.snapThreshold && m.abs(distY) < that.options.snapThreshold) {
                        that.scrollTo(that.absStartX, that.absStartY, 200);
                    } else {
                        snap = that._snap(newPosX, newPosY);
                        newPosX = snap.x;
                        newPosY = snap.y;
                        newDuration = m.max(snap.time, newDuration);
                    }
                }

                that.scrollTo(m.round(newPosX), m.round(newPosY), newDuration);

                if (that.options.onTouchEnd) that.options.onTouchEnd.call(that, e);
                return;
            }

            // Do we need to snap?
            if (that.options.snap) {
                distX = newPosX - that.absStartX;
                distY = newPosY - that.absStartY;
                if (m.abs(distX) < that.options.snapThreshold && m.abs(distY) < that.options.snapThreshold) that.scrollTo(that.absStartX, that.absStartY, 200);
                else {
                    snap = that._snap(that.x, that.y);
                    if (snap.x != that.x || snap.y != that.y) that.scrollTo(snap.x, snap.y, snap.time);
                }

                if (that.options.onTouchEnd) that.options.onTouchEnd.call(that, e);
                return;
            }

            that._resetPos(200);
            if (that.options.onTouchEnd) that.options.onTouchEnd.call(that, e);
        },

        _resetPos: function(time) {
            var that = this,
                resetX = that.x >= 0 ? 0 : that.x < that.maxScrollX ? that.maxScrollX : that.x,
                resetY = that.y >= that.minScrollY || that.maxScrollY > 0 ? that.minScrollY : that.y < that.maxScrollY ? that.maxScrollY : that.y;

            if (resetX == that.x && resetY == that.y) {
                if (that.moved) {
                    that.moved = false;
                    if (that.options.onScrollEnd) that.options.onScrollEnd.call(that); // Execute custom code on scroll end
                }

                if (that.hScrollbar && that.options.hideScrollbar) {
                    if (vendor == "webkit") that.hScrollbarWrapper.style[transitionDelay] = "300ms";
                    that.hScrollbarWrapper.style.opacity = "0";
                }
                if (that.vScrollbar && that.options.hideScrollbar) {
                    if (vendor == "webkit") that.vScrollbarWrapper.style[transitionDelay] = "300ms";
                    that.vScrollbarWrapper.style.opacity = "0";
                }

                return;
            }

            that.scrollTo(resetX, resetY, time || 0);
        },

        _wheel: function(e) {
            var that = this,
                wheelDeltaX,
                wheelDeltaY,
                deltaX,
                deltaY,
                deltaScale;

            if ("wheelDeltaX" in e) {
                wheelDeltaX = e.wheelDeltaX / 12;
                wheelDeltaY = e.wheelDeltaY / 12;
            } else if ("wheelDelta" in e) {
                wheelDeltaX = wheelDeltaY = e.wheelDelta / 12;
            } else if ("detail" in e) {
                wheelDeltaX = wheelDeltaY = -e.detail * 3;
            } else {
                return;
            }

            if (that.options.wheelAction == "zoom") {
                deltaScale = that.scale * Math.pow(2, (1 / 3) * (wheelDeltaY ? wheelDeltaY / Math.abs(wheelDeltaY) : 0));
                if (deltaScale < that.options.zoomMin) deltaScale = that.options.zoomMin;
                if (deltaScale > that.options.zoomMax) deltaScale = that.options.zoomMax;

                if (deltaScale != that.scale) {
                    if (!that.wheelZoomCount && that.options.onZoomStart) that.options.onZoomStart.call(that, e);
                    that.wheelZoomCount++;

                    that.zoom(e.pageX, e.pageY, deltaScale, 400);

                    setTimeout(function() {
                        that.wheelZoomCount--;
                        if (!that.wheelZoomCount && that.options.onZoomEnd) that.options.onZoomEnd.call(that, e);
                    }, 400);
                }

                return;
            }

            deltaX = that.x + wheelDeltaX;
            deltaY = that.y + wheelDeltaY;

            if (deltaX > 0) deltaX = 0;
            else if (deltaX < that.maxScrollX) deltaX = that.maxScrollX;

            if (deltaY > that.minScrollY) deltaY = that.minScrollY;
            else if (deltaY < that.maxScrollY) deltaY = that.maxScrollY;

            if (that.maxScrollY < 0) {
                that.scrollTo(deltaX, deltaY, 0);
            }
        },

        _transitionEnd: function(e) {
            var that = this;

            if (e.target != that.scroller) return;

            that._unbind(TRNEND_EV);

            that._startAni();
        },

        /**
         *
         * Utilities
         *
         */
        _startAni: function() {
            var that = this,
                startX = that.x,
                startY = that.y,
                startTime = Date.now(),
                step,
                easeOut,
                animate;

            if (that.animating) return;

            if (!that.steps.length) {
                that._resetPos(400);
                return;
            }

            step = that.steps.shift();

            if (step.x == startX && step.y == startY) step.time = 0;

            that.animating = true;
            that.moved = true;

            if (that.options.useTransition) {
                that._transitionTime(step.time);
                that._pos(step.x, step.y);
                that.animating = false;
                if (step.time) that._bind(TRNEND_EV);
                else that._resetPos(0);
                return;
            }

            animate = function() {
                var now = Date.now(),
                    newX,
                    newY;

                if (now >= startTime + step.time) {
                    that._pos(step.x, step.y);
                    that.animating = false;
                    if (that.options.onAnimationEnd) that.options.onAnimationEnd.call(that); // Execute custom code on animation end
                    that._startAni();
                    return;
                }

                now = (now - startTime) / step.time - 1;
                easeOut = m.sqrt(1 - now * now);
                newX = (step.x - startX) * easeOut + startX;
                newY = (step.y - startY) * easeOut + startY;
                that._pos(newX, newY);
                if (that.animating) that.aniTime = nextFrame(animate);
            };

            animate();
        },

        _transitionTime: function(time) {
            time += "ms";
            this.scroller.style[transitionDuration] = time;
            if (this.hScrollbar) this.hScrollbarIndicator.style[transitionDuration] = time;
            if (this.vScrollbar) this.vScrollbarIndicator.style[transitionDuration] = time;
        },

        _momentum: function(dist, time, maxDistUpper, maxDistLower, size) {
            var deceleration = 0.0006,
                speed = m.abs(dist) / time,
                newDist = (speed * speed) / (2 * deceleration),
                newTime = 0,
                outsideDist = 0;

            // Proportinally reduce speed if we are outside of the boundaries
            if (dist > 0 && newDist > maxDistUpper) {
                outsideDist = size / (6 / ((newDist / speed) * deceleration));
                maxDistUpper = maxDistUpper + outsideDist;
                speed = (speed * maxDistUpper) / newDist;
                newDist = maxDistUpper;
            } else if (dist < 0 && newDist > maxDistLower) {
                outsideDist = size / (6 / ((newDist / speed) * deceleration));
                maxDistLower = maxDistLower + outsideDist;
                speed = (speed * maxDistLower) / newDist;
                newDist = maxDistLower;
            }

            newDist = newDist * (dist < 0 ? -1 : 1);
            newTime = speed / deceleration;

            return { dist: newDist, time: m.round(newTime) };
        },

        _offset: function(el) {
            var left = -el.offsetLeft,
                top = -el.offsetTop;

            while ((el = el.offsetParent)) {
                left -= el.offsetLeft;
                top -= el.offsetTop;
            }

            if (el != this.wrapper) {
                left *= this.scale;
                top *= this.scale;
            }

            return { left: left, top: top };
        },

        _snap: function(x, y) {
            var that = this,
                i,
                l,
                page,
                time,
                sizeX,
                sizeY;

            // Check page X
            page = that.pagesX.length - 1;
            for (i = 0, l = that.pagesX.length; i < l; i++) {
                if (x >= that.pagesX[i]) {
                    page = i;
                    break;
                }
            }
            if (page == that.currPageX && page > 0 && that.dirX < 0) page--;
            x = that.pagesX[page];
            sizeX = m.abs(x - that.pagesX[that.currPageX]);
            sizeX = sizeX ? (m.abs(that.x - x) / sizeX) * 500 : 0;
            that.currPageX = page;

            // Check page Y
            page = that.pagesY.length - 1;
            for (i = 0; i < page; i++) {
                if (y >= that.pagesY[i]) {
                    page = i;
                    break;
                }
            }
            if (page == that.currPageY && page > 0 && that.dirY < 0) page--;
            y = that.pagesY[page];
            sizeY = m.abs(y - that.pagesY[that.currPageY]);
            sizeY = sizeY ? (m.abs(that.y - y) / sizeY) * 500 : 0;
            that.currPageY = page;

            // Snap with constant speed (proportional duration)
            time = m.round(m.max(sizeX, sizeY)) || 200;

            return { x: x, y: y, time: time };
        },

        _bind: function(type, el, bubble) {
            (el || this.scroller).addEventListener(type, this, !!bubble);
        },

        _unbind: function(type, el, bubble) {
            (el || this.scroller).removeEventListener(type, this, !!bubble);
        },

        /**
         *
         * Public methods
         *
         */
        destroy: function() {
            var that = this;

            that.scroller.style[transform] = "";

            // Remove the event listeners
            that._unbind(RESIZE_EV, window);
            that._unbind(START_EV);
            that._unbind(MOVE_EV, window);
            that._unbind(END_EV, window);
            that._unbind(CANCEL_EV, window);

            if (!that.options.hasTouch) {
                that._unbind("DOMMouseScroll");
                that._unbind("mousewheel");
            }

            if (that.options.useTransition) that._unbind(TRNEND_EV);

            if (that.options.draggableScrollbars) {
                if (that.hScrollbar) that._unbind(START_EV, that.hScrollbarIndicator);
                if (that.vScrollbar) that._unbind(START_EV, that.vScrollbarIndicator);
            }

            if (that.options.checkDOMChanges) clearInterval(that.checkDOMTime);

            if (that.options.onDestroy) that.options.onDestroy.call(that);

            // Remove the scrollbars
            that.hScrollbar = false;
            that.vScrollbar = false;
            that._scrollbar("h");
            that._scrollbar("v");
        },

        refresh: function() {
            var that = this,
                offset,
                i,
                l,
                els,
                pos = 0,
                page = 0;

            if (that.scale < that.options.zoomMin) that.scale = that.options.zoomMin;
            that.wrapperW = that.wrapper.clientWidth || 1;
            that.wrapperH = that.wrapper.clientHeight || 1;

            that.minScrollY = -that.options.topOffset || 0;
            that.scrollerW = m.round(that.scroller.offsetWidth * that.scale);
            that.scrollerH = m.round((that.scroller.offsetHeight + that.minScrollY) * that.scale);
            that.maxScrollX = that.wrapperW - that.scrollerW;
            that.maxScrollY = that.wrapperH - that.scrollerH + that.minScrollY;
            that.dirX = 0;
            that.dirY = 0;

            if (that.options.onRefresh) that.options.onRefresh.call(that);

            that.hScroll = that.options.hScroll && that.maxScrollX < 0;
            that.vScroll = that.options.vScroll && ((!that.options.bounceLock && !that.hScroll) || that.scrollerH > that.wrapperH);

            that.hScrollbar = that.hScroll && that.options.hScrollbar;
            that.vScrollbar = that.vScroll && that.options.vScrollbar && that.scrollerH > that.wrapperH;

            offset = that._offset(that.wrapper);
            that.wrapperOffsetLeft = -offset.left;
            that.wrapperOffsetTop = -offset.top;

            // Prepare snap
            if (typeof that.options.snap == "string") {
                that.pagesX = [];
                that.pagesY = [];
                els = that.scroller.querySelectorAll(that.options.snap);
                for (i = 0, l = els.length; i < l; i++) {
                    pos = that._offset(els[i]);
                    pos.left += that.wrapperOffsetLeft;
                    pos.top += that.wrapperOffsetTop;
                    that.pagesX[i] = pos.left < that.maxScrollX ? that.maxScrollX : pos.left * that.scale;
                    that.pagesY[i] = pos.top < that.maxScrollY ? that.maxScrollY : pos.top * that.scale;
                }
            } else if (that.options.snap) {
                that.pagesX = [];
                while (pos >= that.maxScrollX) {
                    that.pagesX[page] = pos;
                    pos = pos - that.wrapperW;
                    page++;
                }
                if (that.maxScrollX % that.wrapperW) that.pagesX[that.pagesX.length] = that.maxScrollX - that.pagesX[that.pagesX.length - 1] + that.pagesX[that.pagesX.length - 1];

                pos = 0;
                page = 0;
                that.pagesY = [];
                while (pos >= that.maxScrollY) {
                    that.pagesY[page] = pos;
                    pos = pos - that.wrapperH;
                    page++;
                }
                if (that.maxScrollY % that.wrapperH) that.pagesY[that.pagesY.length] = that.maxScrollY - that.pagesY[that.pagesY.length - 1] + that.pagesY[that.pagesY.length - 1];
            }

            // Prepare the scrollbars
            that._scrollbar("h");
            that._scrollbar("v");

            if (!that.zoomed) {
                that.scroller.style[transitionDuration] = "0";
                that._resetPos(400);
            }
        },

        scrollTo: function(x, y, time, relative) {
            var that = this,
                step = x,
                i,
                l;

            that.stop();

            if (!step.length) step = [{ x: x, y: y, time: time, relative: relative }];

            for (i = 0, l = step.length; i < l; i++) {
                if (step[i].relative) {
                    step[i].x = that.x - step[i].x;
                    step[i].y = that.y - step[i].y;
                }
                that.steps.push({ x: step[i].x, y: step[i].y, time: step[i].time || 0 });
            }

            that._startAni();
        },

        getScrollY: function() {
            var that = this;
            return that.y;
        },

        getScrollX: function() {
            var that = this;
            return that.x;
        },

        scrollToElement: function(el, time) {
            var that = this,
                pos;
            el = el.nodeType ? el : that.scroller.querySelector(el);
            if (!el) return;

            pos = that._offset(el);
            pos.left += that.wrapperOffsetLeft;
            pos.top += that.wrapperOffsetTop;

            pos.left = pos.left > 0 ? 0 : pos.left < that.maxScrollX ? that.maxScrollX : pos.left;
            pos.top = pos.top > that.minScrollY ? that.minScrollY : pos.top < that.maxScrollY ? that.maxScrollY : pos.top;
            time = time === undefined ? m.max(m.abs(pos.left) * 2, m.abs(pos.top) * 2) : time;

            that.scrollTo(pos.left, pos.top, time);
        },

        scrollToPage: function(pageX, pageY, time) {
            var that = this,
                x,
                y;

            time = time === undefined ? 400 : time;

            if (that.options.onScrollStart) that.options.onScrollStart.call(that);

            if (that.options.snap) {
                pageX = pageX == "next" ? that.currPageX + 1 : pageX == "prev" ? that.currPageX - 1 : pageX;
                pageY = pageY == "next" ? that.currPageY + 1 : pageY == "prev" ? that.currPageY - 1 : pageY;

                pageX = pageX < 0 ? 0 : pageX > that.pagesX.length - 1 ? that.pagesX.length - 1 : pageX;
                pageY = pageY < 0 ? 0 : pageY > that.pagesY.length - 1 ? that.pagesY.length - 1 : pageY;

                that.currPageX = pageX;
                that.currPageY = pageY;
                x = that.pagesX[pageX];
                y = that.pagesY[pageY];
            } else {
                x = -that.wrapperW * pageX;
                y = -that.wrapperH * pageY;
                if (x < that.maxScrollX) x = that.maxScrollX;
                if (y < that.maxScrollY) y = that.maxScrollY;
            }

            that.scrollTo(x, y, time);
        },

        disable: function() {
            this.stop();
            this._resetPos(0);
            this.enabled = false;

            // If disabled after touchstart we make sure that there are no left over events
            this._unbind(MOVE_EV, window);
            this._unbind(END_EV, window);
            this._unbind(CANCEL_EV, window);
        },

        enable: function() {
            this.enabled = true;
        },

        stop: function() {
            if (this.options.useTransition) this._unbind(TRNEND_EV);
            else cancelFrame(this.aniTime);
            this.steps = [];
            this.moved = false;
            this.animating = false;
        },

        zoom: function(x, y, scale, time) {
            var that = this,
                relScale = scale / that.scale;

            if (!that.options.useTransform) return;

            that.zoomed = true;
            time = time === undefined ? 200 : time;
            x = x - that.wrapperOffsetLeft - that.x;
            y = y - that.wrapperOffsetTop - that.y;
            that.x = x - x * relScale + that.x;
            that.y = y - y * relScale + that.y;

            that.scale = scale;
            that.refresh();

            that.x = that.x > 0 ? 0 : that.x < that.maxScrollX ? that.maxScrollX : that.x;
            that.y = that.y > that.minScrollY ? that.minScrollY : that.y < that.maxScrollY ? that.maxScrollY : that.y;

            that.scroller.style[transitionDuration] = time + "ms";
            that.scroller.style[transform] = "translate(" + that.x + "px," + that.y + "px) scale(" + scale + ")" + translateZ;
            that.zoomed = false;
        },

        isReady: function() {
            return !this.moved && !this.zoomed && !this.animating;
        }
    };

    function prefixStyle(style) {
        if (vendor === "") return style;

        style = style.charAt(0).toUpperCase() + style.substr(1);
        return vendor + style;
    }

    dummyStyle = null; // for the sake of it

    if (typeof exports !== "undefined") exports.iScroll = iScroll;
    else window.iScroll = iScroll;
})(window, document);

wwplayer.define(
    "iscroll",
    (function(global) {
        return function() {
            var ret, fn;
            return ret || global.iScroll;
        };
    })(this)
);

/* Web Font Loader v1.5.2 - (c) Adobe Systems, Google. License: Apache 2.0 */
(function(window, document, undefined) {
    var j = !0,
        l = null,
        m = !1;
    function n(a) {
        return function() {
            return this[a];
        };
    }
    var q = this;
    function r(a, b) {
        var c = a.split("."),
            d = q;
        !(c[0] in d) && d.execScript && d.execScript("var " + c[0]);
        for (var e; c.length && (e = c.shift()); ) !c.length && void 0 !== b ? (d[e] = b) : (d = d[e] ? d[e] : (d[e] = {}));
    }
    function aa(a, b, c) {
        return a.call.apply(a.bind, arguments);
    }
    function ba(a, b, c) {
        if (!a) throw Error();
        if (2 < arguments.length) {
            var d = Array.prototype.slice.call(arguments, 2);
            return function() {
                var c = Array.prototype.slice.call(arguments);
                Array.prototype.unshift.apply(c, d);
                return a.apply(b, c);
            };
        }
        return function() {
            return a.apply(b, arguments);
        };
    }
    function t(a, b, c) {
        t = Function.prototype.bind && -1 != Function.prototype.bind.toString().indexOf("native code") ? aa : ba;
        return t.apply(l, arguments);
    }
    var u =
        Date.now ||
        function() {
            return +new Date();
        };
    function ca(a, b) {
        this.G = a;
        this.v = b || a;
        this.z = this.v.document;
    }
    ca.prototype.createElement = function(a, b, c) {
        a = this.z.createElement(a);
        if (b) for (var d in b) b.hasOwnProperty(d) && ("style" == d ? (a.style.cssText = b[d]) : a.setAttribute(d, b[d]));
        c && a.appendChild(this.z.createTextNode(c));
        return a;
    };
    function v(a, b, c) {
        a = a.z.getElementsByTagName(b)[0];
        a || (a = document.documentElement);
        a && a.lastChild && a.insertBefore(c, a.lastChild);
    }
    function w(a, b) {
        for (var c = a.className.split(/\s+/), d = 0, e = c.length; d < e; d++) if (c[d] == b) return;
        c.push(b);
        a.className = c
            .join(" ")
            .replace(/\s+/g, " ")
            .replace(/^\s+|\s+$/, "");
    }
    function x(a, b) {
        for (var c = a.className.split(/\s+/), d = [], e = 0, g = c.length; e < g; e++) c[e] != b && d.push(c[e]);
        a.className = d
            .join(" ")
            .replace(/\s+/g, " ")
            .replace(/^\s+|\s+$/, "");
    }
    function da(a, b) {
        for (var c = a.className.split(/\s+/), d = 0, e = c.length; d < e; d++) if (c[d] == b) return j;
        return m;
    }
    function y(a) {
        var b = a.v.location.protocol;
        "about:" == b && (b = a.G.location.protocol);
        return "https:" == b ? "https:" : "http:";
    }
    function ea(a, b) {
        var c = a.createElement("link", { rel: "stylesheet", href: b }),
            d = m;
        c.onload = function() {
            d || (d = j);
        };
        c.onerror = function() {
            d || (d = j);
        };
        v(a, "head", c);
    }
    function z(a, b, c, d) {
        var e = a.z.getElementsByTagName("head")[0];
        if (e) {
            var g = a.createElement("script", { src: b }),
                f = m;
            g.onload = g.onreadystatechange = function() {
                if (!f && (!this.readyState || "loaded" == this.readyState || "complete" == this.readyState))
                    (f = j), c && c(l), (g.onload = g.onreadystatechange = l), "HEAD" == g.parentNode.tagName && e.removeChild(g);
            };
            e.appendChild(g);
            window.setTimeout(function() {
                f || ((f = j), c && c(Error("Script load timeout")));
            }, d || 5e3);
            return g;
        }
        return l;
    }
    function A(a, b, c) {
        this.M = a;
        this.U = b;
        this.Aa = c;
    }
    r("webfont.BrowserInfo", A);
    A.prototype.pa = n("M");
    A.prototype.hasWebFontSupport = A.prototype.pa;
    A.prototype.qa = n("U");
    A.prototype.hasWebKitFallbackBug = A.prototype.qa;
    A.prototype.ra = n("Aa");
    A.prototype.hasWebKitMetricsBug = A.prototype.ra;
    function B(a, b, c, d) {
        this.d = a != l ? a : l;
        this.o = b != l ? b : l;
        this.aa = c != l ? c : l;
        this.f = d != l ? d : l;
    }
    var fa = /^([0-9]+)(?:[\._-]([0-9]+))?(?:[\._-]([0-9]+))?(?:[\._+-]?(.*))?$/;
    B.prototype.toString = function() {
        return [this.d, this.o || "", this.aa || "", this.f || ""].join("");
    };
    function C(a) {
        a = fa.exec(a);
        var b = l,
            c = l,
            d = l,
            e = l;
        a &&
            (a[1] !== l && a[1] && (b = parseInt(a[1], 10)),
            a[2] !== l && a[2] && (c = parseInt(a[2], 10)),
            a[3] !== l && a[3] && (d = parseInt(a[3], 10)),
            a[4] !== l && a[4] && (e = /^[0-9]+$/.test(a[4]) ? parseInt(a[4], 10) : a[4]));
        return new B(b, c, d, e);
    }
    function D(a, b, c, d, e, g, f, h, k, p, s) {
        this.K = a;
        this.Ga = b;
        this.za = c;
        this.fa = d;
        this.Ea = e;
        this.ea = g;
        this.wa = f;
        this.Fa = h;
        this.va = k;
        this.da = p;
        this.k = s;
    }
    r("webfont.UserAgent", D);
    D.prototype.getName = n("K");
    D.prototype.getName = D.prototype.getName;
    D.prototype.oa = n("za");
    D.prototype.getVersion = D.prototype.oa;
    D.prototype.ka = n("fa");
    D.prototype.getEngine = D.prototype.ka;
    D.prototype.la = n("ea");
    D.prototype.getEngineVersion = D.prototype.la;
    D.prototype.ma = n("wa");
    D.prototype.getPlatform = D.prototype.ma;
    D.prototype.na = n("va");
    D.prototype.getPlatformVersion = D.prototype.na;
    D.prototype.ja = n("da");
    D.prototype.getDocumentMode = D.prototype.ja;
    D.prototype.ia = n("k");
    D.prototype.getBrowserInfo = D.prototype.ia;
    function E(a, b) {
        this.a = a;
        this.I = b;
    }
    var ga = new D("Unknown", new B(), "Unknown", "Unknown", new B(), "Unknown", "Unknown", new B(), "Unknown", void 0, new A(m, m, m));
    E.prototype.parse = function() {
        var a;
        if (-1 != this.a.indexOf("MSIE") || -1 != this.a.indexOf("Trident/")) {
            a = F(this);
            var b = G(this),
                c = C(b),
                d = l,
                e = l,
                g = l,
                f = l,
                h = H(this.a, /Trident\/([\d\w\.]+)/, 1),
                k = I(this.I),
                d = -1 != this.a.indexOf("MSIE") ? H(this.a, /MSIE ([\d\w\.]+)/, 1) : H(this.a, /rv:([\d\w\.]+)/, 1),
                e = C(d);
            "" != h ? ((g = "Trident"), (f = C(h))) : ((g = "Unknown"), (f = new B()), (h = "Unknown"));
            a = new D("MSIE", e, d, g, f, h, a, c, b, k, new A(("Windows" == a && 6 <= e.d) || ("Windows Phone" == a && 8 <= c.d), m, m));
        } else if (-1 != this.a.indexOf("Opera"))
            a: if (
                ((a = "Unknown"),
                (b = H(this.a, /Presto\/([\d\w\.]+)/, 1)),
                (c = C(b)),
                (d = G(this)),
                (e = C(d)),
                (g = I(this.I)),
                c.d !== l ? (a = "Presto") : (-1 != this.a.indexOf("Gecko") && (a = "Gecko"), (b = H(this.a, /rv:([^\)]+)/, 1)), (c = C(b))),
                -1 != this.a.indexOf("Opera Mini/"))
            )
                (f = H(this.a, /Opera Mini\/([\d\.]+)/, 1)), (h = C(f)), (a = new D("OperaMini", h, f, a, c, b, F(this), e, d, g, new A(m, m, m)));
            else {
                if (-1 != this.a.indexOf("Version/") && ((f = H(this.a, /Version\/([\d\.]+)/, 1)), (h = C(f)), h.d !== l)) {
                    a = new D("Opera", h, f, a, c, b, F(this), e, d, g, new A(10 <= h.d, m, m));
                    break a;
                }
                f = H(this.a, /Opera[\/ ]([\d\.]+)/, 1);
                h = C(f);
                a =
                    h.d !== l
                        ? new D("Opera", h, f, a, c, b, F(this), e, d, g, new A(10 <= h.d, m, m))
                        : new D("Opera", new B(), "Unknown", a, c, b, F(this), e, d, g, new A(m, m, m));
            }
        else
            /OPR\/[\d.]+/.test(this.a)
                ? (a = ha(this))
                : /AppleWeb(K|k)it/.test(this.a)
                ? (a = ha(this))
                : -1 != this.a.indexOf("Gecko")
                ? ((a = "Unknown"),
                  (b = new B()),
                  (c = "Unknown"),
                  (d = G(this)),
                  (e = C(d)),
                  (g = m),
                  -1 != this.a.indexOf("Firefox")
                      ? ((a = "Firefox"), (c = H(this.a, /Firefox\/([\d\w\.]+)/, 1)), (b = C(c)), (g = 3 <= b.d && 5 <= b.o))
                      : -1 != this.a.indexOf("Mozilla") && (a = "Mozilla"),
                  (f = H(this.a, /rv:([^\)]+)/, 1)),
                  (h = C(f)),
                  g || (g = 1 < h.d || (1 == h.d && 9 < h.o) || (1 == h.d && 9 == h.o && 2 <= h.aa) || f.match(/1\.9\.1b[123]/) != l || f.match(/1\.9\.1\.[\d\.]+/) != l),
                  (a = new D(a, b, c, "Gecko", h, f, F(this), e, d, I(this.I), new A(g, m, m))))
                : (a = ga);
        return a;
    };
    function F(a) {
        var b = H(a.a, /(iPod|iPad|iPhone|Android|Windows Phone|BB\d{2}|BlackBerry)/, 1);
        if ("" != b) return /BB\d{2}/.test(b) && (b = "BlackBerry"), b;
        a = H(a.a, /(Linux|Mac_PowerPC|Macintosh|Windows|CrOS)/, 1);
        return "" != a ? ("Mac_PowerPC" == a && (a = "Macintosh"), a) : "Unknown";
    }
    function G(a) {
        var b = H(a.a, /(OS X|Windows NT|Android) ([^;)]+)/, 2);
        if (b || (b = H(a.a, /Windows Phone( OS)? ([^;)]+)/, 2)) || (b = H(a.a, /(iPhone )?OS ([\d_]+)/, 2))) return b;
        if ((b = H(a.a, /(?:Linux|CrOS) ([^;)]+)/, 1))) for (var b = b.split(/\s/), c = 0; c < b.length; c += 1) if (/^[\d\._]+$/.test(b[c])) return b[c];
        return (a = H(a.a, /(BB\d{2}|BlackBerry).*?Version\/([^\s]*)/, 2)) ? a : "Unknown";
    }
    function ha(a) {
        var b = F(a),
            c = G(a),
            d = C(c),
            e = H(a.a, /AppleWeb(?:K|k)it\/([\d\.\+]+)/, 1),
            g = C(e),
            f = "Unknown",
            h = new B(),
            k = "Unknown",
            p = m;
        /OPR\/[\d.]+/.test(a.a)
            ? (f = "Opera")
            : -1 != a.a.indexOf("Chrome") || -1 != a.a.indexOf("CrMo") || -1 != a.a.indexOf("CriOS")
            ? (f = "Chrome")
            : /Silk\/\d/.test(a.a)
            ? (f = "Silk")
            : "BlackBerry" == b || "Android" == b
            ? (f = "BuiltinBrowser")
            : -1 != a.a.indexOf("PhantomJS")
            ? (f = "PhantomJS")
            : -1 != a.a.indexOf("Safari")
            ? (f = "Safari")
            : -1 != a.a.indexOf("AdobeAIR") && (f = "AdobeAIR");
        "BuiltinBrowser" == f
            ? (k = "Unknown")
            : "Silk" == f
            ? (k = H(a.a, /Silk\/([\d\._]+)/, 1))
            : "Chrome" == f
            ? (k = H(a.a, /(Chrome|CrMo|CriOS)\/([\d\.]+)/, 2))
            : -1 != a.a.indexOf("Version/")
            ? (k = H(a.a, /Version\/([\d\.\w]+)/, 1))
            : "AdobeAIR" == f
            ? (k = H(a.a, /AdobeAIR\/([\d\.]+)/, 1))
            : "Opera" == f
            ? (k = H(a.a, /OPR\/([\d.]+)/, 1))
            : "PhantomJS" == f && (k = H(a.a, /PhantomJS\/([\d.]+)/, 1));
        h = C(k);
        p =
            "AdobeAIR" == f
                ? 2 < h.d || (2 == h.d && 5 <= h.o)
                : "BlackBerry" == b
                ? 10 <= d.d
                : "Android" == b
                ? 2 < d.d || (2 == d.d && 1 < d.o)
                : 526 <= g.d || (525 <= g.d && 13 <= g.o);
        return new D(
            f,
            h,
            k,
            "AppleWebKit",
            g,
            e,
            b,
            d,
            c,
            I(a.I),
            new A(p, 536 > g.d || (536 == g.d && 11 > g.o), "iPhone" == b || "iPad" == b || "iPod" == b || "Macintosh" == b)
        );
    }
    function H(a, b, c) {
        return (a = a.match(b)) && a[c] ? a[c] : "";
    }
    function I(a) {
        if (a.documentMode) return a.documentMode;
    }
    function ia(a) {
        this.ua = a || "-";
    }
    ia.prototype.f = function(a) {
        for (var b = [], c = 0; c < arguments.length; c++) b.push(arguments[c].replace(/[\W_]+/g, "").toLowerCase());
        return b.join(this.ua);
    };
    function J(a, b) {
        this.K = a;
        this.V = 4;
        this.L = "n";
        var c = (b || "n4").match(/^([nio])([1-9])$/i);
        c && ((this.L = c[1]), (this.V = parseInt(c[2], 10)));
    }
    J.prototype.getName = n("K");
    function K(a) {
        return a.L + a.V;
    }
    function ja(a) {
        var b = 4,
            c = "n",
            d = l;
        a &&
            ((d = a.match(/(normal|oblique|italic)/i)) && d[1] && (c = d[1].substr(0, 1).toLowerCase()),
            (d = a.match(/([1-9]00|normal|bold)/i)) && d[1] && (/bold/i.test(d[1]) ? (b = 7) : /[1-9]00/.test(d[1]) && (b = parseInt(d[1].substr(0, 1), 10))));
        return c + b;
    }
    function ka(a, b, c) {
        this.c = a;
        this.h = b;
        this.O = c;
        this.j = "wf";
        this.g = new ia("-");
    }
    function L(a) {
        x(a.h, a.g.f(a.j, "loading"));
        da(a.h, a.g.f(a.j, "active")) || w(a.h, a.g.f(a.j, "inactive"));
        M(a, "inactive");
    }
    function M(a, b, c) {
        if (a.O[b])
            if (c) a.O[b](c.getName(), K(c));
            else a.O[b]();
    }
    function la() {
        this.w = {};
    }
    function O(a, b) {
        this.c = a;
        this.C = b;
        this.s = this.c.createElement("span", { "aria-hidden": "true" }, this.C);
    }
    function P(a, b) {
        var c;
        c = [];
        for (var d = b.K.split(/,\s*/), e = 0; e < d.length; e++) {
            var g = d[e].replace(/['"]/g, "");
            -1 == g.indexOf(" ") ? c.push(g) : c.push("'" + g + "'");
        }
        c = c.join(",");
        d = "normal";
        e = b.V + "00";
        "o" === b.L ? (d = "oblique") : "i" === b.L && (d = "italic");
        a.s.style.cssText =
            "position:absolute;top:-999px;left:-999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:" +
            c +
            ";" +
            ("font-style:" + d + ";font-weight:" + e + ";");
    }
    function Q(a) {
        v(a.c, "body", a.s);
    }
    O.prototype.remove = function() {
        var a = this.s;
        a.parentNode && a.parentNode.removeChild(a);
    };
    function ma(a, b, c, d, e, g, f, h) {
        this.W = a;
        this.sa = b;
        this.c = c;
        this.q = d;
        this.C = h || "BESbswy";
        this.k = e;
        this.F = {};
        this.T = g || 5e3;
        this.Z = f || l;
        this.B = this.A = l;
        a = new O(this.c, this.C);
        Q(a);
        for (var k in R) R.hasOwnProperty(k) && (P(a, new J(R[k], K(this.q))), (this.F[R[k]] = a.s.offsetWidth));
        a.remove();
    }
    var R = { Da: "serif", Ca: "sans-serif", Ba: "monospace" };
    ma.prototype.start = function() {
        this.A = new O(this.c, this.C);
        Q(this.A);
        this.B = new O(this.c, this.C);
        Q(this.B);
        this.xa = u();
        P(this.A, new J(this.q.getName() + ",serif", K(this.q)));
        P(this.B, new J(this.q.getName() + ",sans-serif", K(this.q)));
        oa(this);
    };
    function pa(a, b, c) {
        for (var d in R) if (R.hasOwnProperty(d) && b === a.F[R[d]] && c === a.F[R[d]]) return j;
        return m;
    }
    function oa(a) {
        var b = a.A.s.offsetWidth,
            c = a.B.s.offsetWidth;
        (b === a.F.serif && c === a.F["sans-serif"]) || (a.k.U && pa(a, b, c))
            ? u() - a.xa >= a.T
                ? a.k.U && pa(a, b, c) && (a.Z === l || a.Z.hasOwnProperty(a.q.getName()))
                    ? S(a, a.W)
                    : S(a, a.sa)
                : setTimeout(
                      t(function() {
                          oa(this);
                      }, a),
                      25
                  )
            : S(a, a.W);
    }
    function S(a, b) {
        a.A.remove();
        a.B.remove();
        b(a.q);
    }
    function T(a, b, c, d) {
        this.c = b;
        this.t = c;
        this.P = 0;
        this.ba = this.Y = m;
        this.T = d;
        this.k = a.k;
    }
    function qa(a, b, c, d, e) {
        if (0 === b.length && e) L(a.t);
        else {
            a.P += b.length;
            e && (a.Y = e);
            for (e = 0; e < b.length; e++) {
                var g = b[e],
                    f = c[g.getName()],
                    h = a.t,
                    k = g;
                w(h.h, h.g.f(h.j, k.getName(), K(k).toString(), "loading"));
                M(h, "fontloading", k);
                new ma(t(a.ga, a), t(a.ha, a), a.c, g, a.k, a.T, d, f).start();
            }
        }
    }
    T.prototype.ga = function(a) {
        var b = this.t;
        x(b.h, b.g.f(b.j, a.getName(), K(a).toString(), "loading"));
        x(b.h, b.g.f(b.j, a.getName(), K(a).toString(), "inactive"));
        w(b.h, b.g.f(b.j, a.getName(), K(a).toString(), "active"));
        M(b, "fontactive", a);
        this.ba = j;
        ra(this);
    };
    T.prototype.ha = function(a) {
        var b = this.t;
        x(b.h, b.g.f(b.j, a.getName(), K(a).toString(), "loading"));
        da(b.h, b.g.f(b.j, a.getName(), K(a).toString(), "active")) || w(b.h, b.g.f(b.j, a.getName(), K(a).toString(), "inactive"));
        M(b, "fontinactive", a);
        ra(this);
    };
    function ra(a) {
        0 == --a.P && a.Y && (a.ba ? ((a = a.t), x(a.h, a.g.f(a.j, "loading")), x(a.h, a.g.f(a.j, "inactive")), w(a.h, a.g.f(a.j, "active")), M(a, "active")) : L(a.t));
    }
    function U(a) {
        this.G = a;
        this.u = new la();
        this.ya = new E(a.navigator.userAgent, a.document);
        this.a = this.ya.parse();
        this.Q = this.R = 0;
    }
    U.prototype.load = function(a) {
        var b = a.context || this.G;
        this.c = new ca(this.G, b);
        var b = new ka(this.c, b.document.documentElement, a),
            c = [],
            d = a.timeout;
        w(b.h, b.g.f(b.j, "loading"));
        M(b, "loading");
        var c = this.u,
            e = this.c,
            g = [],
            f;
        for (f in a)
            if (a.hasOwnProperty(f)) {
                var h = c.w[f];
                h && g.push(h(a[f], e));
            }
        c = g;
        this.Q = this.R = c.length;
        a = new T(this.a, this.c, b, d);
        f = 0;
        for (d = c.length; f < d; f++) (e = c[f]), e.H(this.a, t(this.ta, this, e, b, a));
    };
    U.prototype.ta = function(a, b, c, d) {
        var e = this;
        d
            ? a.load(function(a, b, d) {
                  var k = 0 == --e.R;
                  setTimeout(function() {
                      qa(c, a, b || {}, d || l, k);
                  }, 0);
              })
            : ((a = 0 == --this.R), this.Q--, a && 0 == this.Q && L(b), qa(c, [], {}, l, a));
    };
    function sa(a, b, c) {
        this.N = a ? a : b + ta;
        this.p = [];
        this.S = [];
        this.ca = c || "";
    }
    var ta = "//fonts.googleapis.com/css";
    sa.prototype.f = function() {
        if (0 == this.p.length) throw Error("No fonts to load!");
        if (-1 != this.N.indexOf("kit=")) return this.N;
        for (var a = this.p.length, b = [], c = 0; c < a; c++) b.push(this.p[c].replace(/ /g, "+"));
        a = this.N + "?family=" + b.join("%7C");
        0 < this.S.length && (a += "&subset=" + this.S.join(","));
        0 < this.ca.length && (a += "&text=" + encodeURIComponent(this.ca));
        return a;
    };
    function ua(a) {
        this.p = a;
        this.$ = [];
        this.J = {};
    }
    var va = { latin: "BESbswy", cyrillic: "&#1081;&#1103;&#1046;", greek: "&#945;&#946;&#931;", khmer: "&#x1780;&#x1781;&#x1782;", Hanuman: "&#x1780;&#x1781;&#x1782;" },
        wa = {
            thin: "1",
            extralight: "2",
            "extra-light": "2",
            ultralight: "2",
            "ultra-light": "2",
            light: "3",
            regular: "4",
            book: "4",
            medium: "5",
            "semi-bold": "6",
            semibold: "6",
            "demi-bold": "6",
            demibold: "6",
            bold: "7",
            "extra-bold": "8",
            extrabold: "8",
            "ultra-bold": "8",
            ultrabold: "8",
            black: "9",
            heavy: "9",
            l: "3",
            r: "4",
            b: "7"
        },
        xa = { i: "i", italic: "i", n: "n", normal: "n" },
        ya = RegExp("^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$");
    ua.prototype.parse = function() {
        for (var a = this.p.length, b = 0; b < a; b++) {
            var c = this.p[b].split(":"),
                d = c[0].replace(/\+/g, " "),
                e = ["n4"];
            if (2 <= c.length) {
                var g;
                var f = c[1];
                g = [];
                if (f)
                    for (var f = f.split(","), h = f.length, k = 0; k < h; k++) {
                        var p;
                        p = f[k];
                        if (p.match(/^[\w-]+$/)) {
                            p = ya.exec(p.toLowerCase());
                            var s = void 0;
                            if (p == l) s = "";
                            else {
                                s = void 0;
                                s = p[1];
                                if (s == l || "" == s) s = "4";
                                else
                                    var na = wa[s],
                                        s = na ? na : isNaN(s) ? "4" : s.substr(0, 1);
                                s = [p[2] == l || "" == p[2] ? "n" : xa[p[2]], s].join("");
                            }
                            p = s;
                        } else p = "";
                        p && g.push(p);
                    }
                0 < g.length && (e = g);
                3 == c.length && ((c = c[2]), (g = []), (c = !c ? g : c.split(",")), 0 < c.length && (c = va[c[0]]) && (this.J[d] = c));
            }
            this.J[d] || ((c = va[d]) && (this.J[d] = c));
            for (c = 0; c < e.length; c += 1) this.$.push(new J(d, e[c]));
        }
    };
    function V(a, b) {
        this.a = new E(navigator.userAgent, document).parse();
        this.c = a;
        this.e = b;
    }
    var za = { Arimo: j, Cousine: j, Tinos: j };
    V.prototype.H = function(a, b) {
        b(a.k.M);
    };
    V.prototype.load = function(a) {
        var b = this.c;
        if ("MSIE" == this.a.getName() && this.e.blocking != j) {
            var c = t(this.X, this, a),
                d = function() {
                    b.z.body ? c() : setTimeout(d, 0);
                };
            d();
        } else this.X(a);
    };
    V.prototype.X = function(a) {
        for (var b = this.c, c = new sa(this.e.api, y(b), this.e.text), d = this.e.families, e = d.length, g = 0; g < e; g++) {
            var f = d[g].split(":");
            3 == f.length && c.S.push(f.pop());
            var h = "";
            2 == f.length && "" != f[1] && (h = ":");
            c.p.push(f.join(h));
        }
        d = new ua(d);
        d.parse();
        ea(b, c.f());
        a(d.$, d.J, za);
    };
    function W(a, b) {
        this.c = a;
        this.e = b;
        this.m = [];
    }
    W.prototype.D = function(a) {
        return y(this.c) + (this.e.api || "//f.fontdeck.com/s/css/js/") + (this.c.v.location.hostname || this.c.G.location.hostname) + "/" + a + ".js";
    };
    W.prototype.H = function(a, b) {
        var c = this.e.id,
            d = this.c.v,
            e = this;
        c
            ? (d.__webfontfontdeckmodule__ || (d.__webfontfontdeckmodule__ = {}),
              (d.__webfontfontdeckmodule__[c] = function(a, c) {
                  for (var d = 0, k = c.fonts.length; d < k; ++d) {
                      var p = c.fonts[d];
                      e.m.push(new J(p.name, ja("font-weight:" + p.weight + ";font-style:" + p.style)));
                  }
                  b(a);
              }),
              z(this.c, this.D(c), function(a) {
                  a && b(m);
              }))
            : b(m);
    };
    W.prototype.load = function(a) {
        a(this.m);
    };
    function X(a, b) {
        this.c = a;
        this.e = b;
        this.m = [];
    }
    X.prototype.D = function(a) {
        var b = y(this.c);
        return (this.e.api || b + "//use.typekit.net") + "/" + a + ".js";
    };
    X.prototype.H = function(a, b) {
        var c = this.e.id,
            d = this.e,
            e = this.c.v,
            g = this;
        c
            ? (e.__webfonttypekitmodule__ || (e.__webfonttypekitmodule__ = {}),
              (e.__webfonttypekitmodule__[c] = function(c) {
                  c(a, d, function(a, c, d) {
                      for (var e = 0; e < c.length; e += 1) {
                          var f = d[c[e]];
                          if (f) for (var N = 0; N < f.length; N += 1) g.m.push(new J(c[e], f[N]));
                          else g.m.push(new J(c[e]));
                      }
                      b(a);
                  });
              }),
              z(
                  this.c,
                  this.D(c),
                  function(a) {
                      a && b(m);
                  },
                  2e3
              ))
            : b(m);
    };
    X.prototype.load = function(a) {
        a(this.m);
    };
    function Y(a, b) {
        this.c = a;
        this.e = b;
        this.m = [];
    }
    Y.prototype.H = function(a, b) {
        var c = this,
            d = c.e.projectId,
            e = c.e.version;
        if (d) {
            var g = c.c.v;
            z(this.c, c.D(d, e), function(e) {
                if (e) b(m);
                else {
                    if (g["__mti_fntLst" + d] && (e = g["__mti_fntLst" + d]())) for (var h = 0; h < e.length; h++) c.m.push(new J(e[h].fontfamily));
                    b(a.k.M);
                }
            }).id = "__MonotypeAPIScript__" + d;
        } else b(m);
    };
    Y.prototype.D = function(a, b) {
        var c = y(this.c),
            d = (this.e.api || "fast.fonts.net/jsapi").replace(/^.*http(s?):(\/\/)?/, "");
        return c + "//" + d + "/" + a + ".js" + (b ? "?v=" + b : "");
    };
    Y.prototype.load = function(a) {
        a(this.m);
    };
    function Z(a, b) {
        this.c = a;
        this.e = b;
    }
    Z.prototype.load = function(a) {
        var b,
            c,
            d = this.e.urls || [],
            e = this.e.families || [],
            g = this.e.testStrings || {};
        b = 0;
        for (c = d.length; b < c; b++) d[b].tagName ? v(this.c, "head", d[b]) : ea(this.c, d[b]);
        d = [];
        b = 0;
        for (c = e.length; b < c; b++) {
            var f = e[b].split(":");
            if (f[1]) for (var h = f[1].split(","), k = 0; k < h.length; k += 1) d.push(new J(f[0], h[k]));
            else d.push(new J(f[0]));
        }
        a(d, g);
    };
    Z.prototype.H = function(a, b) {
        return b(a.k.M);
    };
    var $ = new U(q);
    $.u.w.custom = function(a, b) {
        return new Z(b, a);
    };
    $.u.w.fontdeck = function(a, b) {
        return new W(b, a);
    };
    $.u.w.monotype = function(a, b) {
        return new Y(b, a);
    };
    $.u.w.typekit = function(a, b) {
        return new X(b, a);
    };
    $.u.w.google = function(a, b) {
        return new V(b, a);
    };
    q.WebFont || ((q.WebFont = {}), (q.WebFont.load = t($.load, $)), q.WebFontConfig && $.load(q.WebFontConfig));
})(this, document);

wwplayer.define(
    "WebFontLoader",
    (function(global) {
        return function() {
            var ret, fn;
            return ret || global.WebFont;
        };
    })(this)
);

/**
 * @license RequireJS text 2.0.10 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */
/*jslint regexp: true */
/*global require, XMLHttpRequest, ActiveXObject,
 define, window, process, Packages,
 java, location, Components, FileUtils */

wwplayer.define("text", ["module"], function(module) {
    "use strict";

    var text,
        fs,
        Cc,
        Ci,
        xpcIsWindows,
        progIds = ["Msxml2.XMLHTTP", "Microsoft.XMLHTTP", "Msxml2.XMLHTTP.4.0"],
        xmlRegExp = /^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,
        bodyRegExp = /<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,
        hasLocation = typeof location !== "undefined" && location.href,
        defaultProtocol = hasLocation && location.protocol && location.protocol.replace(/\:/, ""),
        defaultHostName = hasLocation && location.hostname,
        defaultPort = hasLocation && (location.port || undefined),
        buildMap = {},
        masterConfig = (module.config && module.config()) || {};

    text = {
        version: "2.0.10",

        strip: function(content) {
            //Strips <?xml ...?> declarations so that external SVG and XML
            //documents can be added to a document without worry. Also, if the string
            //is an HTML document, only the part inside the body tag is returned.
            if (content) {
                content = content.replace(xmlRegExp, "");
                var matches = content.match(bodyRegExp);
                if (matches) {
                    content = matches[1];
                }
            } else {
                content = "";
            }
            return content;
        },

        jsEscape: function(content) {
            return content
                .replace(/(['\\])/g, "\\$1")
                .replace(/[\f]/g, "\\f")
                .replace(/[\b]/g, "\\b")
                .replace(/[\n]/g, "\\n")
                .replace(/[\t]/g, "\\t")
                .replace(/[\r]/g, "\\r")
                .replace(/[\u2028]/g, "\\u2028")
                .replace(/[\u2029]/g, "\\u2029");
        },

        createXhr:
            masterConfig.createXhr ||
            function() {
                //Would love to dump the ActiveX crap in here. Need IE 6 to die first.
                var xhr, i, progId;

                if (typeof ActiveXObject !== "undefined") {
                    for (i = 0; i < 3; i += 1) {
                        progId = progIds[i];
                        try {
                            xhr = new ActiveXObject(progId);
                        } catch (e) {}

                        if (xhr) {
                            progIds = [progId]; // so faster next time
                            break;
                        }
                    }
                } else if (typeof XMLHttpRequest !== "undefined") {
                    return new XMLHttpRequest();
                }

                return xhr;
            },

        /**
         * Parses a resource name into its component parts. Resource names
         * look like: module/name.ext!strip, where the !strip part is
         * optional.
         * @param {String} name the resource name
         * @returns {Object} with properties "moduleName", "ext" and "strip"
         * where strip is a boolean.
         */
        parseName: function(name) {
            var modName,
                ext,
                temp,
                strip = false,
                index = name.indexOf("."),
                isRelative = name.indexOf("./") === 0 || name.indexOf("../") === 0;

            if (index !== -1 && (!isRelative || index > 1)) {
                modName = name.substring(0, index);
                ext = name.substring(index + 1, name.length);
            } else {
                modName = name;
            }

            temp = ext || modName;
            index = temp.indexOf("!");
            if (index !== -1) {
                //Pull off the strip arg.
                strip = temp.substring(index + 1) === "strip";
                temp = temp.substring(0, index);
                if (ext) {
                    ext = temp;
                } else {
                    modName = temp;
                }
            }

            return {
                moduleName: modName,
                ext: ext,
                strip: strip
            };
        },

        xdRegExp: /^((\w+)\:)?\/\/([^\/\\]+)/,

        /**
         * Is an URL on another domain. Only works for browser use, returns
         * false in non-browser environments. Only used to know if an
         * optimized .js version of a text resource should be loaded
         * instead.
         * @param {String} url
         * @returns Boolean
         */
        useXhr: function(url, protocol, hostname, port) {
            return true;
            // var uProtocol, uHostName, uPort,
            //     match = text.xdRegExp.exec(url);
            // if (!match) {
            //     return true;
            // }
            // uProtocol = match[2];
            // uHostName = match[3];

            // uHostName = uHostName.split(':');
            // uPort = uHostName[1];
            // uHostName = uHostName[0];

            // return (!uProtocol || uProtocol === protocol) &&
            //        (!uHostName || uHostName.toLowerCase() === hostname.toLowerCase()) &&
            //        ((!uPort && !uHostName) || uPort === port);
        },

        finishLoad: function(name, strip, content, onLoad) {
            content = strip ? text.strip(content) : content;
            if (masterConfig.isBuild) {
                buildMap[name] = content;
            }
            onLoad(content);
        },

        load: function(name, req, onLoad, config) {
            //Name has format: some.module.filext!strip
            //The strip part is optional.
            //if strip is present, then that means only get the string contents
            //inside a body tag in an HTML string. For XML/SVG content it means
            //removing the <?xml ...?> declarations so the content can be inserted
            //into the current doc without problems.

            // Do not bother with the work if a build and text will
            // not be inlined.
            if (config.isBuild && !config.inlineText) {
                onLoad();
                return;
            }

            masterConfig.isBuild = config.isBuild;

            var parsed = text.parseName(name),
                nonStripName = parsed.moduleName + (parsed.ext ? "." + parsed.ext : ""),
                url = req.toUrl(nonStripName),
                useXhr = masterConfig.useXhr || text.useXhr;

            // Do not load if it is an empty: url
            if (url.indexOf("empty:") === 0) {
                onLoad();
                return;
            }

            //Load the text. Use XHR if possible and in a browser.
            if (!hasLocation || useXhr(url, defaultProtocol, defaultHostName, defaultPort)) {
                text.get(
                    url,
                    function(content) {
                        text.finishLoad(name, parsed.strip, content, onLoad);
                    },
                    function(err) {
                        if (onLoad.error) {
                            onLoad.error(err);
                        }
                    }
                );
            } else {
                //Need to fetch the resource across domains. Assume
                //the resource has been optimized into a JS module. Fetch
                //by the module name + extension, but do not include the
                //!strip part to avoid file system issues.
                req([nonStripName], function(content) {
                    text.finishLoad(parsed.moduleName + "." + parsed.ext, parsed.strip, content, onLoad);
                });
            }
        },

        write: function(pluginName, moduleName, write, config) {
            if (buildMap.hasOwnProperty(moduleName)) {
                var content = text.jsEscape(buildMap[moduleName]);
                write.asModule(pluginName + "!" + moduleName, "define(function () { return '" + content + "';});\n");
            }
        },

        writeFile: function(pluginName, moduleName, req, write, config) {
            var parsed = text.parseName(moduleName),
                extPart = parsed.ext ? "." + parsed.ext : "",
                nonStripName = parsed.moduleName + extPart,
                //Use a '.js' file name so that it indicates it is a
                //script that can be loaded across domains.
                fileName = req.toUrl(parsed.moduleName + extPart) + ".js";

            //Leverage own load() method to load plugin value, but only
            //write out values that do not have the strip argument,
            //to avoid any potential issues with ! in file names.
            text.load(
                nonStripName,
                req,
                function(value) {
                    //Use own write() method to construct full module value.
                    //But need to create shell that translates writeFile's
                    //write() to the right interface.
                    var textWrite = function(contents) {
                        return write(fileName, contents);
                    };
                    textWrite.asModule = function(moduleName, contents) {
                        return write.asModule(moduleName, fileName, contents);
                    };

                    text.write(pluginName, nonStripName, textWrite, config);
                },
                config
            );
        }
    };

    if (masterConfig.env === "node" || (!masterConfig.env && typeof process !== "undefined" && process.versions && !!process.versions.node && !process.versions["node-webkit"])) {
        //Using special require.nodeRequire, something added by r.js.
        fs = require.nodeRequire("fs");

        text.get = function(url, callback, errback) {
            try {
                var file = fs.readFileSync(url, "utf8");
                //Remove BOM (Byte Mark Order) from utf8 files if it is there.
                if (file.indexOf("\uFEFF") === 0) {
                    file = file.substring(1);
                }
                callback(file);
            } catch (e) {
                errback(e);
            }
        };
    } else if (masterConfig.env === "xhr" || (!masterConfig.env && text.createXhr())) {
        text.get = function(url, callback, errback, headers) {
            var xhr = text.createXhr(),
                header;
            xhr.open("GET", url, true);

            //Allow plugins direct access to xhr headers
            if (headers) {
                for (header in headers) {
                    if (headers.hasOwnProperty(header)) {
                        xhr.setRequestHeader(header.toLowerCase(), headers[header]);
                    }
                }
            }

            //Allow overrides specified in config
            if (masterConfig.onXhr) {
                masterConfig.onXhr(xhr, url);
            }

            xhr.onreadystatechange = function(evt) {
                var status, err;
                //Do not explicitly handle errors, those should be
                //visible via console output in the browser.
                if (xhr.readyState === 4) {
                    status = xhr.status;
                    if (status > 399 && status < 600) {
                        //An http 4xx or 5xx error. Signal an error.
                        err = new Error(url + " HTTP status: " + status);
                        err.xhr = xhr;
                        errback(err);
                    } else {
                        callback(xhr.responseText);
                    }

                    if (masterConfig.onXhrComplete) {
                        masterConfig.onXhrComplete(xhr, url);
                    }
                }
            };
            xhr.send(null);
        };
    } else if (masterConfig.env === "rhino" || (!masterConfig.env && typeof Packages !== "undefined" && typeof java !== "undefined")) {
        //Why Java, why is this so awkward?
        text.get = function(url, callback) {
            var stringBuffer,
                line,
                encoding = "utf-8",
                file = new java.io.File(url),
                lineSeparator = java.lang.System.getProperty("line.separator"),
                input = new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(file), encoding)),
                content = "";
            try {
                stringBuffer = new java.lang.StringBuffer();
                line = input.readLine();

                // Byte Order Mark (BOM) - The Unicode Standard, version 3.0, page 324
                // http://www.unicode.org/faq/utf_bom.html

                // Note that when we use utf-8, the BOM should appear as "EF BB BF", but it doesn't due to this bug in the JDK:
                // http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4508058
                if (line && line.length() && line.charAt(0) === 0xfeff) {
                    // Eat the BOM, since we've already found the encoding on this file,
                    // and we plan to concatenating this buffer with others; the BOM should
                    // only appear at the top of a file.
                    line = line.substring(1);
                }

                if (line !== null) {
                    stringBuffer.append(line);
                }

                while ((line = input.readLine()) !== null) {
                    stringBuffer.append(lineSeparator);
                    stringBuffer.append(line);
                }
                //Make sure we return a JavaScript string and not a Java string.
                content = String(stringBuffer.toString()); //String
            } finally {
                input.close();
            }
            callback(content);
        };
    } else if (masterConfig.env === "xpconnect" || (!masterConfig.env && typeof Components !== "undefined" && Components.classes && Components.interfaces)) {
        //Avert your gaze!
        (Cc = Components.classes), (Ci = Components.interfaces);
        Components.utils["import"]("resource://gre/modules/FileUtils.jsm");
        xpcIsWindows = "@mozilla.org/windows-registry-key;1" in Cc;

        text.get = function(url, callback) {
            var inStream,
                convertStream,
                fileObj,
                readData = {};

            if (xpcIsWindows) {
                url = url.replace(/\//g, "\\");
            }

            fileObj = new FileUtils.File(url);

            //XPCOM, you so crazy
            try {
                inStream = Cc["@mozilla.org/network/file-input-stream;1"].createInstance(Ci.nsIFileInputStream);
                inStream.init(fileObj, 1, 0, false);

                convertStream = Cc["@mozilla.org/intl/converter-input-stream;1"].createInstance(Ci.nsIConverterInputStream);
                convertStream.init(inStream, "utf-8", inStream.available(), Ci.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER);

                convertStream.readString(inStream.available(), readData);
                convertStream.close();
                inStream.close();
                callback(readData.value);
            } catch (e) {
                throw new Error(((fileObj && fileObj.path) || "") + ": " + e);
            }
        };
    }
    return text;
});

wwplayer.define("text!templates/templates.html", [], function() {
    return '<div id="ad-marker-template">\n\t<span class="ad-marker tooltip">\n\t\t<span class="tooltip-container"></span>\n\t</span>\n</div>\n\n<div id="forwards-backwards-slick-template">\n    <div id="forwards-backwards-control">\n        <div id="backwards-control">\n            <div class="innerSvg slick-button-hover"></div>\n        </div>\n        <div id="forwards-control">\n            <div class="innerSvg slick-button-hover"></div>\n        </div>\n    </div>\n</div>\n\n<div id="logo-template">\n    <div id="wirewax-logo"></div>\n</div>\n\n<div id="logo-slick-template">\n    <div id="wirewax-logo" class="logo-slick">\n        <div class="innerSvg slick-button-hover"></div>\n    </div>\n</div>\n\n<div id="logo-slick-template-with-banner">\n    <div class="wirewax-banner_with_logo">\n        <div id="wirewax-logo_with_logo">\n            <div class="innerSvg_with_logo"></div>\n        </div>\n        <div class="wirewax-studio-button-outer_with_logo">\n            <div class="join-wirewax-message_with_logo"></div>\n            <div class="wirewax-studio-button_with_logo"></div>\n        </div>\n    </div>\n</div>\n\n<div id="scrubber-template">\n    <div id="bottom-button-bar">\n        <div class="buffer"></div>\n        <div class="inner-bar">\n            <div class="scrubber hover-colorable">\n                <div class="scrubber-cover">\n                    <p class="scrubText"></p>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n\n<div id="scrubber-slick-template">\n    <div id="bottom-button-bar">\n        <div class="buffer"></div>\n        <div class="backing-gradient"></div>\n        <div class="inner-bar">\n            <div class="scrubber hover-colorable">\n                <div class="video-frame">\n                    <span class="video-playtime"></span>\n                    <span class="video-duration"></span>\n                </div>\n                <div class="scrubber-cover">\n                    <div class="scrubber-hover-area"></div>\n                </div>\n            </div>\n            <div class="scrubber-line"></div>\n        </div>\n    </div>\n</div>\n\n\n<div id="volume-controller-slick-template">\n    <div class="volume-control background-colorable">\n        <div id="volume-bar" class="colorable">\n            <div id="volume-bar-ball"></div>\n            <div id="volume-bar-active"></div>\n        </div>\n\n        <div id="volume-bar-icon" class="volumeControllerSvg inactive">\n            <div id="speaker" class="slick-button-hover"></div>\n        </div>\n    </div>\n</div>\n\n<div id="play-button-template">\n    <div id="play-button" class="center-button">\n        <div class="innerSvg"></div>\n    </div>\n</div>\n\n<div id="ad-play-button-template">\n    <div id="ad-play-button" class="center-button">\n        <div class="innerSvg"></div>\n    </div>\n</div>\n\n<div id="pause-button-template">\n    <div id="pause-button" class="center-button" style="">\n        <div class="innerSvg"></div>\n    </div>\n</div>\n\n<div id="bottom-bar-play-button-template">\n    <div id="bottom-bar-play-button" class="button hover-colorable">\n        <div class="innerSvg slick-button-hover"></div>\n    </div>\n</div>\n\n<div id="bottom-bar-pause-button-template">\n    <div id="bottom-bar-pause-button" class="button hover-colorable">\n        <div class="innerSvg slick-button-hover"></div>\n    </div>\n</div>\n\n<div id="bottom-bar-fullscreen-button-slick-template">\n    <div id="bottom-bar-fullscreen-button" class="button-big hover-colorable tooltip">\n        <div class="innerSvg slick-button-hover"></div>\n    </div>\n</div>\n\n<div id="bottom-bar-fullscreen-button-template">\n    <div id="bottom-bar-fullscreen-button" class="button-big hover-colorable tooltip">\n        <div class="innerSvg"></div>\n        <span class="tooltip-container"></span>\n    </div>\n</div>\n\n<div id="tag-display-controller-template">\n    <div id="tag-display-control">\n\t\t<span class="tag-display-option option-1 unselected tooltip">\n\t\t\t<div class="innerSvg showNoneSvg"></div>\n\t\t\t<span class="tooltip-container"></span>\n\t\t</span>\n\t\t<span class="tag-display-option option-2 unselected tooltip">\n\t\t\t<div class="innerSvg showHoverSvg"></div>\n\t\t\t<span class="tooltip-container"></span>\n\t\t</span>\n\t\t<span class="tag-display-option option-3 selected tooltip">\n\t\t\t<div class="innerSvg showAllSvg"></div>\n\t\t\t<span class="tooltip-container"></span>\n\t\t</span>\n    </div>\n</div>\n\n<div id="volume-controller-template">\n    <div class="volume-control background-colorable">\n        <div id="volume-bar" class="colorable"></div>\n        <div id="volume-bar-icon" class="volumeControllerSvg inactive">\n            <div id="speaker"></div>\n            <div id="mute"></div>\n        </div>\n    </div>\n</div>\n\n<div id="bottom-bar-rendition-controller-template">\n    <div class="rendition-control background-colorable">\n        <div class="main-icon hover-colorable hover-icon" rend="main"></div>\n    </div>\n</div>\n\n<div id="bottom-bar-rendition-controller-slick-template">\n    <div class="main-icon rendition-control background-colorable">\n        <div class="innerSvg slick-button-hover"></div>\n    </div>\n</div>\n\n<div id="bottom-bar-settings-controller-template">\n    <div id="bottom-bar-settings">\n        <!--<div id="bottom-bar-settings-button" class="button-big hover-colorable">-->\n            <!--<div class="innerSvg slick-button-hover"></div>-->\n        <!--</div>-->\n    </div>\n</div>\n\n<div id="bottom-bar-subtitle-controller-template">\n    <div class="subtitle-control background-colorable">\n        <a class="main-icon hover-colorable hover-icon">\n            <div class="innerSvg slick-button-hover"></div>\n        </a>\n    </div>\n</div>\n\n<div id="bottom-bar-subtitle-controller-slick-template">\n    <div class="main-icon subtitle-control background-colorable">\n        <div class="innerSvg slick-button-hover"></div>\n    </div>\n</div>\n\n<div id="user-message-template">\n    <div id="user-message">\n        <div class="message-text"></div>\n        <div class="close-button"> back</div>\n        <div class="error-code-text"> back</div>\n        <div class="reload-button"> reload? </div>\n    </div>\n</div>\n\n<div id="wax-console-template">\n    <div id="waxConsole">\n\n        <div class="header">\n            <div class="header-tab tab-meta">Metadata</div>\n            <div class="header-tab tab-hotspots">Hotspots</div>\n            <div class="header-tab tab-metrics">Metrics</div>\n            <div class="header-tab tab-events">API events</div>\n        </div>\n        <div class="body-wrap">\n            <div class="body-content body-meta">\n                <div class="details-list lists">\n                    <h3>Video Details</h3>\n                    <p class="vid-id">Vid ID <span></span></p>\n                    <p class="vid-title">Video Title <span></span></p>\n                    <p class="rendition-text">Rendition <span></span></p>\n                    <p class="duration-text">Duration <span></span></p>\n                    <p class="fps">FPS <span></span></p>\n                    <p class="tag-id">Tag ID <span></span></p>\n                    <p class="clips-count">Total Clips <span>0</span></p>\n                    <p class="static-tags-count">Total Static Tags <span>0</span></p>\n                    <p class="tags-count">Total Moving Tags <span>0</span></p>\n                    <p class="subtitle-languages">Subtitle Languages </p>\n                    <p class="all-renditions">All Renditions <span></span></p>\n                </div>\n                <div class="playback-list lists">\n                    <h3>Playback</h3>\n                    <p class="player-frame">Player Frame <span>0</span></p>\n                    <p class="ptc-frame">PTC Frame <span>0</span></p>\n                    <p class="player-timestamp">Player Timestamp <span>0</span></p>\n                    <p class="clip-frame">Clip Frame <span>0</span></p>\n                    <p class="clip-number">Clip Number <span>1</span></p>\n                    <p class="clip-start-frame">Clip Start Frame <span>0</span></p>\n                    <p class="clip-duration">Clip Duration <span>0</span></p>\n                    <p class="tags-in-clip">Tags In Clip <span>0</span></p>\n                </div>\n            </div>\n            <div class="body-content body-hotspots">\n                <div class="hotspot-list tag-sprites">\n                    <div class="hotspot-headers"><span class="name-header headers">Name</span><span class="static-header headers">Type</span><span class="id-header headers">Widget Id</span><span class="sprite-header headers">Sprite Id</span><span class="clickout-header headers">Clickout Url</span><span class="widget-header headers">Open Widget</span><span class="tag-type-header headers">Tag Type</span></div>\n                </div>\n            </div>\n            <div class="body-content body-metrics">\n                <div class="metric-header"><div class="metrics-clear-button clear-buttons">Clear</div><div class="metrics-show-all">Show all</div><form><input id="metrics-search-box" type="search"><button class="metrics-search-submit">Search</button></form></div>\n                <div class="metrics-list"></div>\n            </div>\n            <div class="body-content body-events">\n                <div class="event-header"><div class="events-clear-button clear-buttons">Clear</div><div class="events-show-all">Show all</div><form><input id="events-search-box" type="search"><button class="events-search-submit">Search</button></form></div>\n                <div class="api-events-list"></div>\n            </div>\n        </div>\n        <div class="video-console-hide-button"><span class="arrows left-arrow"> < </span><span class="arrows right-arrow"> > </span></div>\n    </div>\n</div>\n\n<div id="share-controller-template">\n    <div id="shares">\n        <div id="bottom-bar-share-button" class="button-big hover-colorable">\n            <div class="innerSvg"></div>\n        </div>\n        <a id="fb-share" class="share-icon" target="_blank">\n            <img class="icon"/>\n            <img class="invert-icon"/>\n        </a>\n        <a id="tw-share" class="share-icon" target="_blank">\n            <img class="icon"/>\n            <img class="invert-icon"/>\n        </a>\n        <a id="gp-share" class="share-icon" target="_blank">\n            <img class="icon"/>\n            <img class="invert-icon"/>\n        </a>\n        <a id="more-share" class="share-icon" target="_blank">\n            <div class="icon"></div>\n            <div class="invert-icon"></div>\n        </a>\n    </div>\n</div>\n\n<div id="share-controller-slick-template">\n    <div id="shares">\n        <div id="bottom-bar-share-button" class="button-big hover-colorable">\n            <div class="innerSvg slick-button-hover"></div>\n        </div>\n        <a id="fb-share" class="share-icon" target="_blank">\n            <div class="innerSvg slick-button-hover"></div>\n        </a>\n        <a id="tw-share" class="share-icon" target="_blank">\n            <div class="innerSvg slick-button-hover"></div>\n        </a>\n        <a id="more-share" class="share-icon" target="_blank">\n            <div class="innerSvg slick-button-hover"></div>\n        </a>\n    </div>\n</div>\n\n<div id="ad-info-bar-template">\n    <div id="ad-info-bar" class="clearfix">\n        <div class="message-container clearfix">\n            <span class="skip-button"> SKIP > </span>\n            <span class="seconds"> seconds</span>\n            <span class="remaining-time">00</span>\n            <span class="sponsor-message"></span>\n        </div>\n    </div>\n</div>\n\n<div id="loader-template">\n    <div id="loader" class="wwx-loader">\n        <div id="loader-img"></div>\n        <div class="infinite-throbber-message"> This video might have stalled </div>\n        <span class="ww4-button reload-button">\n            <span class="text"> Reload </span>\n        </span>\n    </div>\n</div>\n\n<div id="loader-slick-template">\n    <div id="loader-slick" class="wwx-loader">\n        <div class="loader-bar">\n            <div class="loader-inner-bar"></div>\n        </div>\n        <div class="infinite-throbber-message"> This video might have stalled </div>\n        <span class="ww4-button reload-button">\n            <span class="text"> Reload </span>\n        </span>\n    </div>\n</div>\n\n<div id="general-loader-template">\n    <div class="general-loader-img"></div>\n</div>\n\n<div id="share-screen-template">\n    <div id="share-screen">\n        <div class="close-button"></div>\n        <div class="left col link">\n            <div class="icon"></div>\n            <textarea id="left-col-link" class="textarea" spellcheck="false"></textarea>\n\n            <div class="copy-button link" data-clipboard-target="#left-col-link"><span class="text">Copy</span> <span class="check-mark"><span class="cross-mark"></span></span></div>\n        </div>\n        <div class="right col embed">\n            <div class="icon"></div>\n            <div class="embed-size">\n                <input type="text" class="resolution-width" maxlength="4" value="768"/>\n                <span class="separator"></span>\n                <input type="text" class="resolution-height" maxlength="4" value="432"/>\n            </div>\n            <textarea id="right-col-link" class="textarea" spellcheck="false"></textarea>\n\n            <div class="copy-button embed" data-clipboard-target="#right-col-link"><span class="text">Copy</span> <span class="check-mark"></span><span class="cross-mark"></span></div>\n        </div>\n    </div>\n</div>\n\n<div id="viewer-overlay">\n    <div id="front-overlay" class="gone">\n        <div class="main-screen screen active">\n            <div class="ww-logo"></div>\n            <p class="vid-title"></p>\n\n            <div class="controls">\n                <div class="control">\n                    <div class="icon i-button"></div>\n                </div>\n                <div class="control big">\n                    <div class="icon play-button"></div>\n                </div>\n                <div class="control">\n                    <div class="icon share-button"></div>\n                </div>\n            </div>\n            <div class="info">\n                <p class="vid-desc"></p>\n\n                <div class="stats-container">\n                    <div class="views-container metric-cont">\n                        <div class="views number">###</div>\n                        <div class="views-title title">Views</div>\n                    </div>\n                    <div class="interactions-container metric-cont">\n                        <div class="interactions number">###</div>\n                        <div class="interactions-title title">Interactions</div>\n                    </div>\n                </div>\n            </div>\n            <div class="share">\n                <div class="share-row">\n                    <div class="sharer">\n                        <div class="icon twitter-button"></div>\n                    </div>\n                    <div class="sharer">\n                        <div class="icon fb-button"></div>\n                    </div>\n                    <div class="sharer">\n                        <div class="icon gp-button"></div>\n                    </div>\n                    <div class="sharer">\n                        <div class="icon iframe-button"></div>\n                    </div>\n                </div>\n                <div class="link">\n                    <div class="inner">\n                        <div class="icon link-icon"></div>\n                        <p class="link-text"></p>\n                    </div>\n                </div>\n            </div>\n            <p class="cta">Tap the tags to interact</p>\n        </div>\n    </div>\n</div>\n\n<div id="disabled-audio-template">\n    <div id="disabled-audio">\n        <div class="innerSvg slick-button-hover"></div>\n        <div class="un-mute-symbol"></div>\n    </div>\n</div>\n';
});

wwplayer.define("Loader", ["jquery", "text!templates/templates.html", "globals"], function($, Templates, globals) {
    var Loader = function(element) {
        var self = this;
        self.element = element;
        self.img = element.find("#loader-img");
        self.shown = false;
        self.loaderTimeout = null;

        var loaderInterval = 75;
        var loaderWidth = 40;

        self.element.find(".reload-button").bind(globals.CLICK_EVENT, function() {
            $(this).unbind(globals.CLICK_EVENT);
            if (window.wirewax.reload) {
                window.wirewax.reload(window.wirewax.vidId);
            }
        });

        self.placeLoader = function(darkMode) {
            var resourceUrl = window.wirewax.cdnUrl + "resourceData";
            var imageUrl;
            if (darkMode) {
                imageUrl = resourceUrl + "/newplayericons/throbber_sprite_40_30_dark.png";
            } else {
                imageUrl = resourceUrl + "/newplayericons/throbber_sprite_40_30_light.png";
            }
            var loaderElement = $(
                $(Templates)
                    .filter("#general-loader-template")
                    .html()
            );
            loaderElement.css("background", 'url("' + imageUrl + '")');
            self.element.replaceWith(loaderElement);
            self.element = loaderElement;
            self.img = loaderElement;
        };

        self.show = function(transparent) {
            self.shown = true;

            window.clearTimeout(self.loaderTimeout);

            if (globals.ENABLE_STALL_MESSAGES && globals.ALLOW_LOADER_VIDEO_RELOAD) {
                self.loaderTimeout = window.setTimeout(function() {
                    if (!globals.ALLOW_LOADER_VIDEO_RELOAD) {
                        return;
                    }
                    self.element.find(".infinite-throbber-message").fadeIn();
                    self.element.find(".reload-button").fadeIn();
                }, 25000);
            }

            if (transparent) {
                self.element.css("opacity", 0);
                self.element.fadeIn("fast");
            } else {
                self.element.fadeIn("fast");
                self.loaderPos = 0;
                if (!self.interval) {
                    self.interval = window.setInterval(function() {
                        var newOffset = self.loaderPos * loaderWidth;
                        self.img.css({ "background-position": -1 * newOffset + "px 0px" });
                        self.loaderPos = self.loaderPos === 7 ? 0 : self.loaderPos + 1;
                    }, loaderInterval);
                }
            }
        };

        self.hide = function() {
            self.shown = false;
            window.clearInterval(self.interval);
            window.clearTimeout(self.loaderTimeout);
            self.interval = null;
            self.element.find(".infinite-throbber-message").hide();
            self.element.find(".reload-button").hide();
            self.element.fadeOut("fast");
        };
    };

    return Loader;
});
wwplayer.define("AbstractPlayer", ["jquery", "underscore", "Class", "pubsub", "globals", "LogEvent", "apiService"], function($, _, Class, PubSub, globals, LogEvent, apiService) {
    var self;
    /**
     * @module
     * @requires jquery, underscore, Class, PubSub, globals, LogEvent
     */

    var AbstractPlayer = Class.extend(
        /** @lends AbstractPlayer.prototype */ {
            /**
         @constructs AbstractPlayer
         @extends Class
         @param {HTMLElement} videoElementContainer the players containing element
         @param {Function} updateScrubFn function to update the scrubber bar during playback
         @param {Object} playerOptions
         @param {Function} readyCallback
         @param {Function} errorCallback
         @param {Object} videoData
         **/
            init: function(videoElementContainer, updateScrubFn, playerOptions, readyCallback, errorCallback, videoData) {
                self = this;
                self.lastRecordedCurrentTime = -1;
                self.lastRecordedCurrentTimeTS = -1;
                self.clipData = {};
                self.videoData = {};
                self.frameSubscriptions = [];
                self.frameSubscriptionsHit = [];
                self.subtitles = {};
                self.lastSeekedTo = 0; //frame that was previously seeked to, var to stop frame subscriptions hitting from a seek
                self.timeSubscriptions = [];
                self.curClip = -1;
                self.startedPlaying = false;
                self.loops = 0;
                self.updateScrubBarFn = updateScrubFn;
                self.updateScrubberAtLoopCount = 1;
                self.ended = false;
                window.wirewax.getCurrentTime = self.getCurrentTime;

                self.loopFunction =
                    window.requestAnimationFrame ||
                    window.webkitRequestAnimationFrame ||
                    window.mozRequestAnimationFrame ||
                    window.oRequestAnimationFrame ||
                    window.msRequestAnimationFrame;
                self.cdnURL = window.wirewax.vidCdnUrl;

                globals.PLAY_FUNCTION = this.play;
                globals.PLAY_PAUSE_FUNCTION = this.videoClicked;
                globals.SUBSCRIBE_TO_FRAME = self.subscribeToFrame;
                globals.GET_CURRENT_PLAYING_TIME = self.getCurrentTime;
                globals.GET_CURRENT_FRAME = self.getFrame;
                globals.IS_PLAYING = self.playing;

                PubSub.subscribe(globals.DO_PAUSE, this.pause);
                PubSub.subscribe(globals.DO_SEEK, this.setCurrentTime);
                // PubSub.subscribe(globals.HAS_SEEKED, this.resetSubs);
                PubSub.subscribe(globals.DO_PLAY, function() {
                    //to fix iPhone decoupling of play etc
                    console.err("Warning: do not bind to globals.DO_PLAY. Use globals.PLAY_FUNCTION instead");
                });
                PubSub.subscribe(globals.TOGGLE_PLAY, function() {
                    //to fix iPhone decoupling of play etc
                    console.error("Warning: do not bind to globals.TOGGLE_PLAY. Use globals.PLAY_PAUSE_FUNCTION instead");
                });
                //TODO: JOSE: legacy stuff delete me pls
                PubSub.subscribe(globals.VIDEO_CLICK, function() {
                    //to fix iPhone decoupling of play etc
                    console.error("Warning: do not bind to globals.VIDEO_CLICK. Use globals.PLAY_PAUSE_FUNCTION instead");
                });
                PubSub.subscribe(globals.MUTE_VOLUME, function() {
                    self.setVolume(0);
                });
                PubSub.subscribe(globals.CHANGE_VOLUME, function(eventName, volume) {
                    self.setVolume(volume);
                });
                PubSub.subscribe(globals.UNMUTE_VOLUME, function() {
                    self.setVolume(1);
                });
                PubSub.subscribe(globals.GET_CURRENT_TIME, function() {
                    PubSub.publish(globals.RETURN_CURRENT_TIME, self.getCurrentTime());
                });
                PubSub.subscribe(globals.CHANGE_RENDITION, self.switchRendition);
                PubSub.subscribe(globals.TOGGLE_SUBTITLES, function() {
                    if (globals.SUBTITLES_ON) {
                        $(videoElementContainer)
                            .find(".subtitle-cc")
                            .css("display", "none");
                        globals.SUBTITLES_ON = false;
                    } else {
                        $(videoElementContainer)
                            .find(".subtitle-cc")
                            .css("display", "block");
                        globals.SUBTITLES_ON = true;
                    }
                });
                PubSub.subscribe(globals.GO_TO_NEXT_CLIP, self.goToNextClip);
                PubSub.subscribe(globals.GO_TO_PREV_CLIP, self.goToPrevClip);

                self.videoElementContainer = videoElementContainer;

                if (!_.isEmpty(videoData.subtitles)) {
                    if (globals.STYLED_SUBTITLES) {
                        self.loadCustomSubtitles(videoData);
                    } else {
                        self.setSubtitles(videoData);
                    }
                }
            },
            _nextLoop: function() {
                // RECURSIVE CALL
                if (!this.loopFunction) {
                    window.setTimeout(self.actualMainLoop, 1 / self.videoData.fps);
                } else {
                    this.loopFunction.call(window, self.actualMainLoop);
                }
            },
            /**
         The main animation loop thats triggered every frame
         Handles buffering / readystate, triggering clips and updating the scrubber
         **/
            actualMainLoop: function() {
                if (!self.startedPlaying) {
                    return;
                }

                if (self.playing() && !self.videoLoadStarted) {
                    self.videoLoadStarted = true;
                    self.videoLoadTimeout = window.setTimeout(function() {
                        globals.LOG("show loader after 3s waiting for videoLoadStarted");
                        PubSub.publish(globals.SHOW_LOADER);
                        self.videoLoadTimeout = null;
                    }, 3000);
                } else if (self.playing() && self.getCurrentTime() > 0.04 && !self.videoLoadEnded) {
                    self.videoLoadEnded = true;
                    if (self.videoLoadTimeout) {
                        window.clearTimeout(self.videoLoadTimeout);
                    } else {
                        PubSub.publish(globals.HIDE_LOADER);
                    }
                }

                // IF PLAYING | NOT ENOUGH DATA | NOT BUFFERING | NOT SEEKING | HAVEN'T STARTED BUFFERING
                // THEN START BUFFER
                if (self.startedPlaying && self.getReadyState() < 4 && !self.buffering && !self.seeking() && !self.paused() && !self.startedBuffering) {
                    globals.LOG("detected readystate " + self.getReadyState() + " so buffering");
                    self.buffering = true;
                    self.startedBuffering = true;
                    PubSub.publish(globals.VIDEO_BUFFERING);
                }
                // PLAYING | HAVE ENOUGH DATA | BUFFERING
                // STOP BUFFER AND PLAY
                else if (self.startedPlaying && self.getReadyState() === 4 && self.buffering) {
                    PubSub.publish(globals.VIDEO_READY);
                    self.play();
                    self.buffering = false;
                }
                // HAVENT STARTED PLAYING | BUFFERING
                // CHECK IF WE'VE BUFFERED OVER 3 SECONDS AND PLAY
                else if (self.buffering) {
                    if (self.getBuffered() > 3) {
                        self.play();
                        PubSub.publish(globals.VIDEO_READY);
                        self.buffering = false;
                    }
                }

                var frame, curTime;
                curTime = self.getCurrentTime();
                frame = parseInt(curTime * self.videoData.fps);

                if (!self.lastFrame) {
                    self.lastFrame = frame;
                }

                // FRAME / TIME SUBSCRIPTIONS
                if (self.frameSubscriptions.length || self.timeSubscriptions.length || self.activeSub) {
                    if (curTime > 0 && !self.ended) {
                        self.oldFrame = frame;
                        var mostRelevantPersistantFrameSub = null;
                        _.each(self.frameSubscriptions, function(frameSub) {
                            if (frameSub.persistent && frame === frameSub.frame) {
                                mostRelevantPersistantFrameSub = frameSub;
                                return false;
                            }

                            if (!frameSub.persistent && frame >= frameSub.frame) {
                                self.frameSubscriptions.splice(self.frameSubscriptions.indexOf(frameSub), 1);
                                frameSub.callback();
                                return false;
                            }
                        });

                        if (mostRelevantPersistantFrameSub) {
                            if (!_.contains(self.frameSubscriptionsHit, mostRelevantPersistantFrameSub)) {
                                self.frameSubscriptionsHit.push(mostRelevantPersistantFrameSub);
                                mostRelevantPersistantFrameSub.callback();
                                mostRelevantPersistantFrameSub = null;
                            }
                        }

                        _.each(self.timeSubscriptions, function(timeSub) {
                            try {
                                timeSub["time"] = parseFloat(timeSub["time"]);
                            } catch (err) {
                                // IE8 doesn't like parseFloat
                            }

                            if (timeSub && timeSub.persistent && curTime >= timeSub["time"] && curTime < timeSub["time"] + 0.1) {
                                timeSub.callback();
                                return false;
                            }

                            if (timeSub && !timeSub.persistent && curTime >= timeSub["time"]) {
                                self.timeSubscriptions.splice(self.timeSubscriptions.indexOf(timeSub), 1);
                                timeSub.callback();
                                return false;
                            }
                        });

                        self.updateSubtitles(curTime);
                    }
                }

                // TRIGGER THE NEXT CLIP
                if (frame > 1) {
                    if (self.curClip === -1 || frame >= self.clipData[self.curClip]["out"] || frame < self.clipData[self.curClip]["in"]) {
                        if (!self.seeking()) {
                            self.transmitClip();
                        }
                    }
                }

                // UPDATE THE SCRUBBER
                if (self.loops % self.updateScrubberAtLoopCount === 0) {
                    self.updateScrubBarFn(curTime, self.getBuffered());
                }
                self.loops++;

                if (globals.ENABLE_STALL_DETECTION) {
                    self.checkForStall();
                }

                if (self.playing()) {
                    self.onLoopUpdate();
                    self._nextLoop();
                    self.updateTimecodeCover();
                }
            },
            updateSubtitles: function(t) {
                if (self.curSubtitle) {
                    if (t >= self.curSubtitle.out || t < self.curSubtitle["in"]) {
                        $(self.curSubtitle.element).remove();
                        self.curSubtitle = null;
                    }
                }
                if (self.activeSub && globals.SUBTITLES_ON) {
                    _.each(self.subtitles[self.activeSub], function(subtitle) {
                        if (subtitle["in"] <= t && subtitle.out > t && !self.curSubtitle) {
                            self.curSubtitle = subtitle;
                            if (subtitle.text) {
                                self.curSubtitle.element = self.appendSubtitleElement(subtitle);
                            }
                        }
                    });
                }
            },
            appendSubtitleElement: function(subtitle) {
                var element = $('<div class="subtitle-cc" style="z-index: 1;"><p>' + subtitle.text.replace(/\n/g, "<br>") + "</p></div>");
                $(self.videoElementContainer)
                    .find("#control-overlay")
                    .append(element);
                return element;
            },
            updateTimecodeCover: function() {
                if (globals.ENABLE_TIME_CODE_COVER) {
                    var timecodeSize = 15;
                    if (!self.timecodeCoverCanvas) {
                        self.timecodeCoverCanvas = $('<canvas id="timecode-cover" width="' + timecodeSize + '" height="' + timecodeSize + '"></canvas>');
                        $("#timecode-cover-overlay").append(self.timecodeCoverCanvas);
                        self.updateTimecodeCoverSize();
                        PubSub.subscribe(globals.RENDITION_CHANGED, function() {
                            self.updateTimecodeCoverSize();
                        });
                    }
                    var coverCanvasContext = self.timecodeCoverCanvas[0].getContext("2d");
                    var xClipStart = self.videoElement.videoWidth - timecodeSize;
                    var yClipStart = 7;
                    coverCanvasContext.drawImage(self.videoElement, xClipStart, yClipStart, timecodeSize, timecodeSize, 0, 0, timecodeSize, timecodeSize);
                }
            },
            updateTimecodeCoverSize: function() {
                if (self.timecodeCoverCanvas) {
                    var newTimecodeSize =
                        (globals.RENDITION === "360"
                            ? 7 / 360
                            : globals.RENDITION === "540" || globals.RENDITION === "ipad"
                            ? 7 / 540
                            : globals.RENDITION === "720"
                            ? 7 / 720
                            : 7 / 1080) * globals.OVERLAY_HEIGHT;
                    self.timecodeCoverCanvas.css({
                        width: newTimecodeSize,
                        height: newTimecodeSize
                    });
                }
            },
            onLoopUpdate: function() {},
            mainLoop: function() {
                if (!self.ready) {
                    self.ready = true;
                    self.buffering = false;
                    globals.LOG("VIDEO READY");
                    PubSub.publish(globals.VIDEO_READY);
                }

                self.actualMainLoop();
            },
            checkForStall: function() {},
            /**
            Trigger the next clip
        **/
            transmitClip: function() {
                var frame = self.getFrame();
                for (var clipIndex in this.clipData) {
                    if (frame >= self.clipData[clipIndex]["in"] && frame < self.clipData[clipIndex]["out"]) {
                        self.curClip = clipIndex;
                        self.publishNextClip(clipIndex);
                        break;
                    }
                }
            },
            /**
            Returns true if the player is seeking, false otherwise
            @returns {Boolean} seeking
        **/
            seeking: function() {
                return false;
            },
            /**
            Registers a callback when the player hits a certain frame
            @param {Number} frame the frame to subscribe
            @param {Function} the function to trigger
            @return a method to unregister the frame subscribtion
        **/
            subscribeToFrame: function(frame, callback, persistent, spriteId) {
                var frameSub = { frame: parseInt(frame), callback: callback, persistent: persistent, spriteId: spriteId };
                self.frameSubscriptions.push(frameSub);

                return function() {
                    self.frameSubscriptions = _.without(self.frameSubscriptions, frameSub);
                };
            },
            subscribeToTime: function(time, callback, persistent, spriteId) {
                if (!globals.IS_IE_8) {
                    self.timeSubscriptions.push({ time: time, callback: callback, persistent: persistent, spriteId: spriteId });
                }
            },
            /**
            Returns the current volume of the player
            @returns {Number} volume
        **/
            getVolume: function() {},
            /**
            Sets the current volume of the player
            @param {Number} volume
        **/
            setVolume: function(volume) {
                globals.VOLUME = volume;
                PubSub.publish(globals.VOLUME_CHANGE, volume);
                PubSub.publish(globals.UI_EVENT, { eventName: "adjustVolume", eventId: 7 });
            },
            /**
            Triggers a new clip by clip number
            @param {Number} nextClipNo the number of the clip
        **/
            publishNextClip: function(nextClipNo) {
                PubSub.publish(globals.NEW_CLIP, nextClipNo);
            },
            goToPrevClip: function() {
                var currentClipIn = self.clipData[parseInt(self.getCurrentClip())]["in"];
                var clip = self.clipData[parseInt(self.getCurrentClip()) - 1];

                if (self.getCurrentTime() > currentClipIn / self.videoData.fps + 1) {
                    clip = self.clipData[parseInt(self.getCurrentClip())];
                }

                var clipIn = clip ? clip["in"] : 0;
                self.setCurrentTime("junk", clipIn / self.videoData.fps + 0.04);
            },
            goToNextClip: function() {
                var clip = self.clipData[parseInt(self.getCurrentClip()) + 1];
                var clipIn = clip ? clip["in"] : self.videoData["duration"] * self.videoData.fps;
                self.setCurrentTime("junk", clipIn / self.videoData.fps + 0.04);
            },

            /**
            Triggers the play event
        **/
            play: function(hideIcon) {
                if (!self.startedPlaying) {
                    self.startedPlaying = true;
                    self.mainLoop();
                    PubSub.publish(globals.DO_HANDSHAKE);
                } else {
                    self._nextLoop();
                }

                if (self.ended) {
                    PubSub.publish(globals.DO_SEEK, 0.04);
                    self.ended = false;
                }

                PubSub.publish(globals.HAS_PLAYED, { hideIcon: hideIcon });
                PubSub.publish(globals.UI_EVENT, { eventName: "play", eventId: 1 });
            },
            /**
            Returns the readystate of the player based on the HTML5 Video spec
         **/
            getReadyState: function() {
                return 4;
            },
            /**
            Pauses the player
        **/
            pause: function(hideIcon) {
                PubSub.publish(globals.HAS_PAUSED, { hideIcon: hideIcon });
                PubSub.publish(globals.UI_EVENT, { eventName: "pause", eventId: 2 });
            },
            /**
            Gets the current playback time of the player
            @returns {Number} currentTime the current playback time
        **/
            getCurrentTime: function() {},
            /**
            Get the current frame the video is on
            @returns {Number} frame the current frame number
        **/
            getFrame: function() {},

            getCurrentClip: function() {
                if (self.curClip === -1) {
                    return 0;
                }

                return self.curClip;
            },
            /**
            Sets the current playback time of the player
            @param {String} eventName the name of the event that triggered the playback time change
            @param {Number} currentTime the time to set to
        **/
            setCurrentTime: function(eventName, currentTime) {
                var seekedToFrame = Math.ceil(currentTime * self.videoData.fps);
                globals.LOG("Seeking to frame ", seekedToFrame);
                self.lastSeekedTo = seekedToFrame;

                self.ended = false;

                PubSub.publish(globals.CURRENT_TIME_SET, self.getCurrentTime());
                self.updateScrubBarFn(currentTime, self.getBuffered());
                self.updateSubtitles(currentTime);
                self.resetSubs(eventName, currentTime);
            },
            resetSubs: function(eventName, currentTime) {
                var seekedToFrame = Math.ceil(currentTime * self.videoData.fps);
                var potentialSubsHit = _.filter(self.frameSubscriptions, function(frameSub) {
                    return frameSub.frame < seekedToFrame;
                });
                var groupedBySprites = _.groupBy(potentialSubsHit, function(frameSub) {
                    return frameSub.spriteId;
                });
                var actualFrameSubs = [];
                _.each(groupedBySprites, function(frameSubList, spriteId) {
                    if (spriteId === "undefined") {
                        actualFrameSubs = _.union(frameSubList, actualFrameSubs);
                    } else {
                        if (frameSubList.length === 2) {
                            actualFrameSubs = _.union(frameSubList, actualFrameSubs);
                        }
                    }
                });

                self.frameSubscriptionsHit = actualFrameSubs;
            },
            /**
            Function called after seeking
         **/
            seeked: function() {
                self.transmitClip();
                PubSub.publish(globals.HAS_SEEKED, self.getCurrentTime());
            },
            /**
            Returns the current state of the buffer
            @returns {Number} buffered the percentage of the video buffered
        **/
            getBuffered: function() {},
            /**
            Returns the current play state of the player
            @returns {Boolean} playing the current play state
        **/
            playing: function() {},
            /**
            Returns the current paused state of the player
            @returns {Boolean} paused the current paused state of the player
        **/
            paused: function() {},
            recordMetrics: function() {
                return self.playing();
            },
            /**
            Sets the tag data for all clips
            @param {Object} clipData
        **/
            setClipData: function(clipData) {
                self.clipData = clipData;
            },
            /**
            Sets the video data
            @param {Object} videoData
        **/
            setVideoData: function(videoData) {
                self.videoData = videoData;
            },
            /**
            Sets the tag data for all static tags
            @param {Object} staticData object to set
        **/
            setStaticData: function(staticData) {
                self.staticData = staticData;
            },
            videoClicked: function() {
                self.playPause();
                PubSub.publish(globals.HAS_VIDEO_CLICKED);
            },
            /**
            Toggles playing and pausing
         **/
            playPause: function() {},
            getAvailableSubtitles: function() {},
            switchSubtitles: function(trackLabel) {
                self.activeSub = trackLabel;
            },
            /**
            Called when playback ends
         **/
            onEnd: function() {
                if (globals.LOOP) {
                    PubSub.publish(globals.DO_SEEK, 0);
                    globals.PLAY_FUNCTION();
                } else {
                    PubSub.publish(globals.VIDEO_END);
                }

                self.ended = true;
            },
            /**
            Called when the player is resized
            @param {Number} width the new widget
            @param {Number} height the new height
        **/
            onResize: function(width, height) {
                self.updateTimecodeCoverSize();
            },
            /**
            Returns the network state of the player based on the HTML5 Video spec
            @returns {Number} networkState
        **/
            getNetworkState: function() {
                return 2;
            },
            /**
            Sets the current time to the start time of the tag and opens the tag
         @param {Tag} tag
         **/
            goToTag: function(tag, skipWidget) {
                if (tag) {
                    if (!skipWidget) {
                        globals.PLAY_FUNCTION();
                    }

                    window.setTimeout(function() {
                        PubSub.publish(globals.HIDE_LOADER);
                        PubSub.publish(globals.DO_SEEK, tag.tagStartTime);

                        if (!skipWidget) {
                            tag.tagClick();
                        }
                    }, 1000);
                }
            },
            onError: function() {},
            loadCustomSubtitles: function(videoData) {
                self.hasSubtitles = true;
                self.customSubtitles = true;
                var allSubtitleLanguages = [];
                var defaultSub = videoData.subtitles[0].language || videoData.subtitles[0].label;

                _.each(videoData.subtitles, function(subtitleObj) {
                    // index subtitles by their language, failing that their label
                    if (subtitleObj.deleted) {
                        return;
                    }
                    allSubtitleLanguages.push(subtitleObj.language);
                    var label = subtitleObj.language || subtitleObj.label;
                    var file = subtitleObj.file;
                    var isDefaultSub = subtitleObj["default"];

                    if (isDefaultSub) {
                        defaultSub = label;
                    }
                    apiService.getSubtitles({ file: file, external: subtitleObj["external"], label: label }, function(subObect) {
                        self.subtitles[subObect.label] = subObect.subtitles;
                    });
                });

                PubSub.subscribe(globals.CHOSEN_SUBTITLES, function(event, language) {
                    if (allSubtitleLanguages.indexOf(language) >= 0) {
                        self.activeSub = language;
                    }
                });

                //if we dont have a subtitle for the user lang, set the default
                if (!self.activeSub) {
                    if (defaultSub && !window.wirewax.lang) {
                        self.activeSub = defaultSub;
                    } else {
                        self.activeSub = globals.LANG;
                    }
                }
            },
            setSubtitles: function(videoData) {
                self.hasSubtitles = true;

                _.each(videoData.subtitles, function(subtitleObj) {
                    var trackElem = $(
                        '<track kind="subtitles" srclang="' +
                            (subtitleObj.language || "en") +
                            '" id="track-' +
                            subtitleObj.label +
                            '" label="' +
                            subtitleObj.label +
                            '" src="//embed.wirewax.com' +
                            subtitleObj.file +
                            '"></track>'
                    );

                    if (subtitleObj["default"]) {
                        trackElem.attr("default", "true");
                    }

                    $(self.videoElement).append(trackElem);
                });
            },
            /**
            Initialises the player
        **/
            initialise: function() {
                globals.LOG("Initialising player");
                if (_.isEmpty(self.clipData)) {
                    PubSub.publish(globals.ERROR, new LogEvent(globals.ERROR, globals.ERRORS["5006"]));
                    return;
                }

                if (_.isEmpty(self.videoData)) {
                    PubSub.publish(globals.ERROR, new LogEvent(globals.ERROR, globals.ERRORS["5007"]));
                    return;
                }

                if (self.videoData["duration"]) {
                    self.subscribeToTime(
                        self.videoData["duration"] / 4.0,
                        function() {
                            PubSub.publish(globals.VIDEO_FIRST_QUARTILE);
                        },
                        false
                    );

                    self.subscribeToTime(
                        (self.videoData["duration"] / 4.0) * 3,
                        function() {
                            PubSub.publish(globals.VIDEO_THIRD_QUARTILE);
                        },
                        false
                    );

                    self.subscribeToTime(
                        self.videoData["duration"] / 2.0,
                        function() {
                            PubSub.publish(globals.VIDEO_MIDPOINT);
                        },
                        false
                    );
                }

                if (window.wirewax.muted) {
                    // this will set the volume to 0 if muted=true,
                    // window.wirewax.muted is set in index.html
                    // globals.VOLUME is set in dependencies.js
                    // comment out line 142 in wirewax.js to test this
                    self.setVolume(globals.VOLUME);
                }

                if (!globals.AUTOPLAY_MUTED) {
                    // set the volume on video load unless it's on mobile, Safari 11 or Chrome 66+
                    self.setVolume(globals.VOLUME);
                }

                PubSub.subscribe(globals.REFRESH_PLAYER, function() {
                    self.setCurrentTime("junk", self.getCurrentTime());
                });

                // KEEPS TAGS ON SCREEN AFTER THE VIDEO HAS ENDED
                // NOTE: THe LAST 0.5 SECONDS OF THE VIDEO SHOULD BE THE END FRAME
                var endSub = PubSub.subscribe(globals.VIDEO_END, function() {
                    if (globals.TAGS_ON_END_FRAME) {
                        self.setCurrentTime("junk", self.getCurrentTime() - 0.5);
                        PubSub.publish(globals.DO_PAUSE);
                        $("#bottom-button-bar").css("visibility", "hidden");

                        var playSub = PubSub.subscribe(globals.HAS_VIDEO_CLICKED, function() {
                            PubSub.unsubscribe(playSub);
                            self.setCurrentTime("junk", 0);
                            $("#bottom-button-bar").css("visibility", "visible");
                        });
                        var tagSub = PubSub.subscribe(globals.TAG_CLICK, function() {
                            PubSub.unsubscribe(playSub);
                            PubSub.unsubscribe(tagSub);
                            $("#bottom-button-bar").css("visibility", "visible");
                        });
                    }
                });

                // PAUSES THE PLAYER AFTER WIDGET CLOSING IF SET
                PubSub.subscribe(globals.WIDGET_CLOSED, function() {
                    if (globals.PLAY_ON_WIDGET_CLOSE) {
                        self.play(true);
                    }
                });
            }
        }
    );

    return AbstractPlayer;
});

wwplayer.define("crumpetAudioController", ["jquery", "AbstractPlayer", "globals", "pubsub", "underscore", "apiService"], function(
    $,
    AbstractPlayer,
    globals,
    PubSub,
    _,
    apiService
) {
    "use strict";
    var AudioController = function(options) {
        var self = this;
        this.audioElement = options.audioElem[0];
        self.fps = options.fps;
        $(this.audioElement).attr("src", options.audioSrc);
        if (options.ended) {
            this.audioElement.onended = options.ended;
        }

        this.pause = function() {
            globals.LOG("paused audio");
            this.audioElement.pause();
        };
        this.play = function() {
            this.audioElement.play();
            globals.LOG("Playing audio");
        };
        this.getFrame = function() {
            return Math.round(self.audioElement.currentTime * self.fps);
        };
        this.setFrame = function(frame) {
            self.audioElement.currentTime = frame / self.fps;
        };
        this.setVolume = function(volume) {
            self.audioElement.volume = volume;
        };
    };
    return AudioController;
});
wwplayer.define("crumpetFrameImageController", ["jquery", "AbstractPlayer", "globals", "pubsub", "underscore", "apiService"], function(
    $,
    AbstractPlayer,
    globals,
    PubSub,
    _,
    apiService
) {
    "use strict";
    var FrameImageController = function(imageDir, numImages, imageElementContainer, framesPerFile, duration, player) {
        var IMAGES_TO_PRELOAD = 1; //this is the min, will go to more if it takes too long to download each file...
        var MAX_IMAGES_TO_PRELOAD = 3;
        var PRELOAD_MOVING_AVG = 3;
        var self = this;
        self.images = {};
        self.loadedImages = [];
        self.preppedImages = [];
        self.numImages = numImages;
        self.framesPerFile = framesPerFile;
        self.duration = duration;
        self.player = player;
        self.imagesDownloaded = [];

        self.downloadSecondsPerFile = 0;

        this.init = function() {
            for (var i = 0; i < numImages; i++) {
                self.images[i] = imageDir + "/iphoneSprite" + i + "_2D.jpg";
            }
        };

        this.checkReady = function(index) {
            return self.loadedImages.indexOf(index) !== -1;
        };
        this.getImage = function(index) {
            return self.images[index];
        };

        this.setTotalFrames = function(frames) {
            for (var i = self.numImages - 1; i < frames; i++) {
                self.images[i] = imageDir + "/iphoneSprite" + i + "_2D.jpg";
            }
            self.numImages = frames;
            self.readyFromIndex(1);
        };

        this.readyFromIndex = function(index, allReadyCallback, indCallback) {
            //fixme: end buffering event when loaded a waited for image
            var imageToPrep = index;
            var imagesToPreloadNow = IMAGES_TO_PRELOAD - _.difference(self.preppedImages, self.loadedImages).length;
            for (var imageToPrep = index; imageToPrep < index + imagesToPreloadNow && imageToPrep < self.numImages; imageToPrep++) {
                if (self.loadedImages.indexOf(imageToPrep) === -1 && self.preppedImages.indexOf(imageToPrep) === -1) {
                    self._prepImage(imageToPrep, function(idxLoaded) {
                        self.loadedImages.push(idxLoaded);
                        //FIXME: buffering shit here
                        var allReady = true;
                        for (var i = 0; i < index + IMAGES_TO_PRELOAD && i < self.numImages; i++) {
                            if (self.loadedImages.indexOf(i) === -1) {
                                allReady = false;
                            }
                        }
                        if (indCallback) {
                            indCallback(idxLoaded);
                        }
                        if (allReady && allReadyCallback) {
                            allReadyCallback();
                        }
                    });
                }
            }
        };

        this.getBuffered = function() {
            return (_.max(self.loadedImages) + 1) * (framesPerFile / 15);
        };

        this._prepImage = function(imageIndex, readyCallback) {
            var startTime = new Date().getTime();
            var thisPrepImage = $("<img></img>");
            globals.LOG("preparing image ", imageIndex);
            thisPrepImage.on("load", function() {
                var finishedTime = new Date().getTime();
                var secondsDownloading = (finishedTime - startTime) / 1000;
                self.imagesDownloaded[imageIndex % PRELOAD_MOVING_AVG] = secondsDownloading;
                var totalTime = 0;
                var totalDownloaded = 0;
                _.each(self.imagesDownloaded, function(downloadTime) {
                    if (downloadTime) {
                        totalTime += downloadTime;
                        totalDownloaded++;
                    }
                });
                var secondsPerFile = totalTime / totalDownloaded;
                globals.LOG("Finished loading " + imageIndex + " in " + secondsDownloading + " seconds, new avg " + secondsPerFile);
                var expectedBufferTime = secondsPerFile * self.numImages;
                globals.LOG("Total downloading time: " + expectedBufferTime + " for duration " + self.duration);
                if (expectedBufferTime > self.duration - player.getCurrentTime()) {
                    var preLoadImages = Math.min(MAX_IMAGES_TO_PRELOAD, self.numImages - Math.floor((self.duration - player.getCurrentTime()) / secondsPerFile));
                    globals.LOG("Greater than remaining video duration so changing preload images to " + preLoadImages);
                    IMAGES_TO_PRELOAD = preLoadImages;
                }
                thisPrepImage.off("load", this);
                thisPrepImage.remove();
                thisPrepImage = null;
                readyCallback(imageIndex);
            });
            thisPrepImage.attr("src", self.images[imageIndex]);
            self.preppedImages.push(imageIndex);
            imageElementContainer.append(thisPrepImage);
        };
        self.init();
    };
    return FrameImageController;
});

wwplayer.define("DiscreteBufferingService", ["Class", "globals", "underscore"], function(Class, globals, _) {
    /**
     * @module
     * @requires Class, globals
     */
    var DiscreteBufferingService = Class.extend(
        /** @lends DiscreteBufferingService.prototype */ {
            /**
         @constructs DiscreteBufferingService
         @author Legacy devs
         @extends Class
         @deprecated
         @description This is used by Crumpet player to request and preload the next sprites. Like crumpet this is deprecated
         **/
            init: function(deps) {
                var self = this;
                self.clusters = deps.clusters;
                self.getCurTime = deps.getCurrentTime;
                self.buffering = deps.buffering;
                self.unbuffered = deps.unbuffered;
                self.settings = {
                    SIMUL_DOWNLOADS: deps.simulDownloads || 1, //how many clusters to download at once
                    BUFFER_AHEAD: deps.bufferAhead || 30, //how many secodns ahead to buffer
                    UNBUFFERED_AHEAD: deps.unbufferedAhead || 10 //how mayny seconds ahead to finish buffering
                };
            },

            buffer: function() {
                var self = this;
                globals.LOG("discrete buffering service buffer");
                //check if we should be downloading any more clusters
                var currentCluster = _.find(self.clusters, function(cluster) {
                    return cluster.start <= self.getCurTime() && cluster.end >= self.getCurTime();
                });
                if (currentCluster && !currentCluster.buffered) {
                    self.buffering();
                }
                var downloadingClusters = _.filter(self.clusters, function(cluster) {
                    return cluster.requested === true && cluster.queued === false && cluster.buffered === false;
                });
                globals.LOG("currently downloading " + downloadingClusters.length + "/" + self.settings.SIMUL_DOWNLOADS);
                var toDownload = self.settings.SIMUL_DOWNLOADS - downloadingClusters.length;
                if (!currentCluster.requested) {
                    currentCluster.request(function() {
                        self.buffer.call(self);
                    });
                    toDownload--;
                }

                if (toDownload < 1) {
                    return;
                }

                //check if we've buffered data for our current ts, if not go download it and then continue

                var nextClusters = _.chain(self.clusters)
                    .filter(function(cluster) {
                        return cluster.requested === false && cluster.start >= self.getCurTime() && cluster.start <= self.getCurTime() + self.settings.BUFFER_AHEAD;
                    })
                    .sortBy(function(cluster) {
                        return cluster.start;
                    })
                    .first(toDownload)
                    .value();
                globals.LOG("got " + nextClusters.length + " to download");
                if (nextClusters.length) {
                    _.each(nextClusters, function(nextCluster) {
                        nextCluster.request(function() {
                            self.buffer.call(self);
                        });
                    });
                }

                var unBuffered = _.chain(self.clusters)
                    .filter(function(cluster) {
                        return cluster.buffered === false && cluster.start >= self.getCurTime() && cluster.start <= self.getCurTime() + self.settings.UNBUFFERED_AHEAD;
                    })
                    .value();
                if (unBuffered.length === 0) {
                    self.unbuffered();
                }
            },
            getBuffered: function() {
                var self = this;
                return _.chain(self.clusters)
                    .filter(function(cluster) {
                        return cluster.buffered === true;
                    })
                    .max(function(cluster) {
                        return cluster.end;
                    })
                    .value().end;
            }
        }
    );
    return DiscreteBufferingService;
});

wwplayer.define(
    "crumpetVideoController",
    ["jquery", "AbstractPlayer", "globals", "pubsub", "underscore", "apiService", "crumpetFrameImageController", "DiscreteBufferingService", "b64"],
    function($, AbstractPlayer, globals, PubSub, _, apiService, FrameImageController, DiscreteBufferingService, Base64) {
        "use strict";

        var VideoController = function(options) {
            var videoElementContainer = options.videoElem,
                imageDir = options.frameSrc,
                finishedCallback = options.finishedFn,
                getFrameAudio = options.getFrame,
                fps = options.fps,
                totalFrames = options.frames,
                player = options.player,
                readyFn = options.readyFn;

            var self = this;

            self.buffering = options.buffering;

            var FRAME_WIDTH;
            var FRAME_HEIGHT;
            var CAKE_COLUMNS;
            var CAKE_ROWS;
            var TOTAL_FRAMES_PER_FILE;
            var DURATION;
            var FPS = fps;
            var LOOP_FUNCTION =
                window.requestAnimationFrame ||
                window.webkitRequestAnimationFrame ||
                window.mozRequestAnimationFrame ||
                window.oRequestAnimationFrame ||
                window.msRequestAnimationFrame;
            self.totalFiles;

            readyFn();

            var FPSK = fps / 1000;

            var frameContainer = $('<div style="opacity:0; height: 0px; width: 0px; overflow: hidden;"></div>');

            function makeid(len) {
                var text = "";
                var possible = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
                for (var i = 0; i < len; i++) text += possible.charAt(Math.floor(Math.random() * possible.length));
                return text;
            }

            //FIXME: put this somewhere better
            var LOAD_TIMEOUT = 20000;
            var ImgCluster = function(constructs) {
                var cluster = this;
                _.each(constructs, function(val, idx) {
                    //THIS IS A FUCKING LAZY
                    cluster[idx] = val;
                });
                cluster.buffered = false;
                cluster.queued = false;
                cluster.requested = false;
            };
            ImgCluster.prototype.request = function(callback, retryCount) {
                if (!retryCount) {
                    retryCount = 0;
                }
                globals.LOG("request attempt " + retryCount + " on ", this);
                var cluster = this;
                this.prepImage = $("<img></img>");
                var self = this;
                this.loadTimeout = window.setTimeout(function() {
                    self.removeRef();
                    if (retryCount < 2) {
                        if (self.src.indexOf("?") == -1) {
                            self.src = self.src + "?rand=" + makeid(6);
                        } else {
                            self.src = self.src.substr(0, self.src.indexOf("?")) + "?rand=" + makeid(6);
                        }
                        self.request(callback, ++retryCount);
                    } else {
                        globals.LOG("failed to request ", cluster);
                    }
                }, LOAD_TIMEOUT);
                this.prepImage.on("load", function() {
                    globals.LOG("successfully requested ", cluster);
                    window.clearTimeout(cluster.loadTimeout);
                    cluster.queued = true;
                    cluster.buffered = true;
                    cluster.prepImage.off("load", this);
                    self.removeRef();
                    //thisPrepImage.remove();
                    //thisPrepImage = null;
                    callback();
                });
                this.prepImage.attr("src", this.src);
                this.requested = true;
                frameContainer.append(this.prepImage);
            };
            ImgCluster.prototype.removeRef = function() {
                if (this.prepImage) {
                    this.prepImage.remove();
                    this.prepImage = null;
                }
            };
            videoElementContainer.append(frameContainer);

            self.readyState = 0;
            self.waitingForFrame = -1;
            self.frameNo = 0;
            self.audioFrameGet = getFrameAudio;
            self.finishedBuffering = options.finishedBuffering;

            this.videoElementContainer = videoElementContainer;

            this.init = function() {
                //self.frameController = new FrameImageController(imageDir, self.totalFiles, frameContainer, TOTAL_FRAMES_PER_FILE, DURATION, player);
                var posterUrl = window.wirewax.cdnUrl + "vidData/" + vidId + "/poster/posterMedium.jpg";

                if (window.wirewax.posterUrl) {
                    posterUrl = window.wirewax.posterUrl;
                }
                this.posterFrame = $('<div class="poster-frame" style="background-image: url(\'' + posterUrl + "')\"></div>");
                this.videoElement = $('<div class="wireWaxVideo"></div>');
                this.videoElementContainer.append(this.posterFrame);
                this.videoElementContainer.append(this.videoElement);
                this.videoElementAlternate = $(' <div class="wireWaxVideo"></div>');
                this.videoElementContainer.append(this.videoElementAlternate);
                var xPerc = CAKE_COLUMNS * 100 + "%";
                var yPerc = CAKE_ROWS * 100 + "%";

                self.clusters = [];
                for (var i = 0; i < self.totalFiles; i++) {
                    self.clusters.push(
                        new ImgCluster({
                            src: imageDir + "/iphoneSprite" + i + "_2D.jpg",
                            start: (i * TOTAL_FRAMES_PER_FILE) / FPS,
                            end: ((i + 1) * TOTAL_FRAMES_PER_FILE) / FPS
                        })
                    );
                }

                self.bufferingService = new DiscreteBufferingService({
                    clusters: self.clusters,
                    getCurrentTime: function() {
                        return getFrameAudio() / FPS;
                    },
                    buffering: function() {
                        if (getFrameAudio() > 0) {
                            PubSub.publish(globals.VIDEO_BUFFERING);
                            self.isBuffering = true;
                            self.buffering();
                        }
                    },
                    unbuffered: function() {
                        if (self.isBuffering) {
                            self.isBuffering = false;
                            if (player.getCurrentTime() + 1 < player.videoData.duration) {
                                PubSub.publish(globals.VIDEO_READY);
                            }
                            self.finishedBuffering();
                        }
                        PubSub.publish(globals.HIDE_LOADER);
                    }
                });
                self.bufferingService.buffer.call(self.bufferingService);

                this.videoElement.css({
                    position: "absolute",
                    left: "0px",
                    top: "0px",
                    "background-size": xPerc + " " + yPerc,
                    "background-position": "0px 0px",
                    height: "0%",
                    width: "100%",
                    "padding-bottom": "56.25%"
                });
                this.videoElementAlternate.css({
                    position: "absolute",
                    left: "0px",
                    top: "0px",
                    "background-size": xPerc + " " + yPerc,
                    "background-position": "0px 0px",
                    height: "0%",
                    width: "100%",
                    opacity: 0,
                    "padding-bottom": "56.25%",
                    "background-image": "url(" + self.clusters[0].src + ")"
                });
                //self.frameController.readyFromIndex(0, function (indices) {
                //    self.readyState = 4;
                //}, function (indIndexLoaded) {
                //    self.buffer();
                //});

                $(window).resize(self.resize);
            };

            this.setMetaData = function(data) {
                var crumpetData = data["iPhoneSpriteMeta"];
                FPS = crumpetData["fps"];
                FRAME_HEIGHT = crumpetData["h"];
                FRAME_WIDTH = crumpetData["w"];
                CAKE_COLUMNS = crumpetData["nCols"];
                CAKE_ROWS = crumpetData["nPerSheet"] / crumpetData["nCols"];
                TOTAL_FRAMES_PER_FILE = crumpetData["nPerSheet"];
                DURATION = data["duration"];
                self.totalFiles = Math.ceil((crumpetData["fps"] * data["duration"]) / TOTAL_FRAMES_PER_FILE);
                globals.LOG("INITTING CRUMPET VIDEO CONTROLLER");
                self.init();
            };

            this.getBuffered = function() {
                return self.bufferingService.getBuffered.call(self.bufferingService);
            };

            this.seekToFrame = function(frame, readyCallback) {
                //            if (!this.width) {
                //                this.resize(frame);
                //            }
                var rowToSeek = Math.floor(frame / CAKE_COLUMNS);
                var columnToSeek = frame % CAKE_COLUMNS;
                this.videoElement.css({
                    "background-position": columnToSeek * -1 * 100 + "% " + rowToSeek * -1 * 100 + "%"
                });
            };

            //        this.resize = function (frame) {
            //            self.width = self.videoElementContainer.width();
            //            self.height = self.videoElementContainer.height();
            //            window.setTimeout(function () {
            //                self.width = self.videoElementContainer.width();
            //                self.height = self.videoElementContainer.height();
            //                alert("got dims " + self.width + " : " + self.height);
            //            }, 2000 / FPS);
            //        }

            this.getReadyState = function() {
                return self.readyState;
            };

            this._mainLoop = function() {
                var wantedFrame = self.audioFrameGet();
                if (wantedFrame !== self.frameNo) {
                    self.frameNo = wantedFrame;
                    var frameIndex = Math.floor(self.frameNo / TOTAL_FRAMES_PER_FILE);
                    if (frameIndex !== self.frameIndex) {
                        self.setFrameIndex(frameIndex);
                    }
                    self.seekToFrame(self.frameNo % TOTAL_FRAMES_PER_FILE);
                }
                if (self.frameNo + 1 < TOTAL_FRAMES_PER_FILE * self.totalFiles) {
                    if (self.playing) {
                        LOOP_FUNCTION(self._mainLoop);
                    }
                } else {
                    finishedCallback();
                }
            };

            this.setFrameIndex = function(index) {
                if (!self.clusters[index].buffered) {
                    self.buffering();
                    self.readyState = 0;

                    self.isBuffering = true;
                    PubSub.publish(globals.VIDEO_BUFFERING);
                    self.bufferingService.buffer();
                    return;
                }

                var oldPrimary = this.videoElement;
                var newPrimary = this.videoElementAlternate;

                if (self.frameIndex + 1 !== index) {
                    newPrimary.css({
                        "background-image": "url(" + self.clusters[index].src + ")"
                    });
                }

                newPrimary.css({ opacity: 1 });
                self.clusters[index].removeRef();
                oldPrimary.css({ opacity: 0 });

                if (self.clusters[index + 1] !== undefined && self.clusters[index + 1].buffered) {
                    oldPrimary.css({
                        "background-image": "url(" + self.clusters[index + 1].src + ")"
                    });
                }

                this.videoElement = newPrimary;
                this.videoElementAlternate = oldPrimary;
                self.frameIndex = index;
                self.bufferingService.buffer.call(self.bufferingService);
            };

            this.play = function() {
                if (!self.playing) {
                    self.posterFrame.remove();
                    self.originalTime = new Date().getTime();
                    self.frameOffset = self.frameNo;
                    self.playing = true;
                    self._mainLoop();
                    globals.LOG("playing crumpet");
                }
            };

            this.pause = function() {
                self.playing = false;
            };
        };

        return VideoController;
    }
);

wwplayer.define("iphone-inline-video", [], function() {
    function _interopDefault(ex) {
        return ex && typeof ex === "object" && "default" in ex ? ex["default"] : ex;
    }

    var Symbol =
        typeof Symbol === "undefined"
            ? function(description) {
                  return "@" + (description || "@") + Math.random();
              }
            : Symbol;

    function Intervalometer(cb, refreshRate) {
        var rafId;
        var previousLoopTime = 0;
        function loop(now) {
            // must be requested before cb() because that might call .stop()
            rafId = requestAnimationFrame(loop);
            // limit the fps to 5/3
            if (now - previousLoopTime >= refreshRate) {
                cb(now - (previousLoopTime || now)); // ms since last call. 0 on start()
                previousLoopTime = now;
            }
        }
        this.start = function() {
            if (!rafId) {
                // prevent double starts
                loop(0);
            }
        };
        this.stop = function() {
            cancelAnimationFrame(rafId);
            rafId = null;
            previousLoopTime = 0;
        };
    }

    function preventEvent(element, eventName, toggleProperty, preventWithProperty) {
        function handler(e) {
            if (Boolean(element[toggleProperty]) === Boolean(preventWithProperty)) {
                e.stopImmediatePropagation();
                // console.log(eventName, 'prevented on', element);
            }
            delete element[toggleProperty];
        }
        element.addEventListener(eventName, handler, false);

        // Return handler to allow to disable the prevention. Usage:
        // const preventionHandler = preventEvent(el, 'click');
        // el.removeEventHandler('click', preventionHandler);
        return handler;
    }

    function proxyProperty(object, propertyName, sourceObject, copyFirst) {
        function get() {
            return sourceObject[propertyName];
        }
        function set(value) {
            sourceObject[propertyName] = value;
        }

        if (copyFirst) {
            set(object[propertyName]);
        }

        Object.defineProperty(object, propertyName, { get: get, set: set });
    }

    function proxyEvent(object, eventName, sourceObject) {
        sourceObject.addEventListener(eventName, function() {
            return object.dispatchEvent(new Event(eventName));
        });
    }

    function dispatchEventAsync(element, type) {
        Promise.resolve().then(function() {
            element.dispatchEvent(new Event(type));
        });
    }

    // iOS 10 adds support for native inline playback + silent autoplay
    // Also adds unprefixed css-grid. This check essentially excludes
    //var isWhitelisted = /iPhone|iPod/i.test(navigator.userAgent) && document.head.style.grid === undefined;

    var X = Symbol();
    var Xevent = Symbol();
    var Xplay = Symbol("nativeplay");
    var Xpause = Symbol("nativepause");

    /**
     * UTILS
     */

    function getAudioFromVideo(video) {
        var audio = new Audio();
        proxyEvent(video, "play", audio);
        proxyEvent(video, "playing", audio);
        proxyEvent(video, "pause", audio);
        audio.crossOrigin = video.crossOrigin;

        // 'data:' causes audio.networkState > 0
        // which then allows to keep <audio> in a resumable playing state
        // i.e. once you set a real src it will keep playing if it was if .play() was called
        audio.src = video.src || video.currentSrc || "data:";

        // if (audio.src === 'data:') {
        //   TODO: wait for video to be selected
        // }
        return audio;
    }

    var lastRequests = [];
    var requestIndex = 0;
    var lastTimeupdateEvent;

    function setTime(time, skip, rememberOnly) {
        var player = this;
        time = time || player.driver.currentTime;
        var video = player.video;
        // allow one timeupdate event every 200+ ms
        if ((lastTimeupdateEvent || 200) + 0 < Date.now()) {
            video[Xevent] = true;
            lastTimeupdateEvent = Date.now();
        }
        lastRequests[++requestIndex % 3] = (time * 100) | (0 / 100);
        if (rememberOnly) return;

        if (skip) {
            // update the audio
            player.driver.currentTime = time;
        }
        // rerender the video
        video.currentTime = time;
    }

    function isPlayerEnded(player) {
        return player.driver.currentTime >= player.video.duration;
    }

    function update(timeDiff) {
        var player = this;
        // console.log('update', player.video.readyState, player.video.networkState, player.driver.readyState, player.driver.networkState, player.driver.paused);
        if (player.video.readyState >= player.video.HAVE_FUTURE_DATA) {
            if (!player.hasAudio) {
                player.driver.currentTime = player.video.currentTime + (timeDiff * player.video.playbackRate) / 1000;
                if (player.video.loop && isPlayerEnded(player)) {
                    player.driver.currentTime = 0;
                }
            }
            setTime.call(player);
        } else if (player.video.networkState === player.video.NETWORK_IDLE && !player.video.buffered.length) {
            // this should happen when the source is available but:
            // - it's potentially playing (.paused === false)
            // - it's not ready to play
            // - it's not loading
            // If it hasAudio, that will be loaded in the 'emptied' handler below
            player.video.load();
            // console.log('Will load');
        }

        // console.assert(player.video.currentTime === player.driver.currentTime, 'Video not updating!');

        if (player.video.ended) {
            delete player.video[Xevent]; // allow timeupdate event
            player.video.pause(true);
        }
    }

    /**
     * METHODS
     */

    function play() {
        var video = this;
        var player = video[X];

        // if it's fullscreen, use the native player
        if (video.webkitDisplayingFullscreen) {
            video[Xplay]();
            return;
        }

        if (player.driver.src !== "data:" && player.driver.src !== video.src) {
            // console.log('src changed on play', video.src);
            setTime.call(player, 0, false, true);
            player.driver.src = video.src;
        }

        if (!video.paused) {
            return;
        }
        player.paused = false;

        if (!video.buffered.length) {
            // .load() causes the emptied event
            // the alternative is .play()+.pause() but that triggers play/pause events, even worse
            // possibly the alternative is preventing this event only once
            video.load();
        }

        player.driver.play();
        player.updater.start();

        if (!player.hasAudio) {
            dispatchEventAsync(video, "play");
            if (player.video.readyState >= player.video.HAVE_ENOUGH_DATA) {
                // console.log('onplay');
                dispatchEventAsync(video, "playing");
            }
        }
    }
    function pause(forceEvents) {
        // console.log('pause');
        var video = this;
        var player = video[X];

        player.driver.pause();
        player.updater.stop();

        // if it's fullscreen, the developer the native player.pause()
        // This is at the end of pause() because it also
        // needs to make sure that the simulation is paused
        if (video.webkitDisplayingFullscreen) {
            video[Xpause]();
        }

        if (player.paused && !forceEvents) {
            return;
        }

        player.paused = true;
        if (!player.hasAudio) {
            dispatchEventAsync(video, "pause");
        }
        if (video.ended) {
            video[Xevent] = true;
            dispatchEventAsync(video, "ended");
        }
    }

    /**
     * SETUP
     */

    function addPlayer(video, hasAudio, refreshRate) {
        var player = (video[X] = {});
        player.paused = true; // track whether 'pause' events have been fired
        player.hasAudio = hasAudio;
        player.video = video;
        player.updater = new Intervalometer(update.bind(player), refreshRate);
        player.setTime = setTime;
        if (hasAudio) {
            player.driver = getAudioFromVideo(video);
        } else {
            video.addEventListener("canplay", function() {
                if (!video.paused) {
                    // console.log('oncanplay');
                    dispatchEventAsync(video, "playing");
                }
            });
            player.driver = {
                src: video.src || video.currentSrc || "data:",
                muted: true,
                paused: true,
                pause: function() {
                    player.driver.paused = true;
                },
                play: function() {
                    player.driver.paused = false;
                    // media automatically goes to 0 if .play() is called when it's done
                    if (isPlayerEnded(player)) {
                        setTime.call(player, 0, true, false);
                    }
                },
                ended: function() {
                    return isPlayerEnded(player);
                }
            };
            console.log(player);
        }

        // .load() causes the emptied event
        video.addEventListener(
            "emptied",
            function() {
                // console.log('driver src is', player.driver.src);
                var wasEmpty = !player.driver.src || player.driver.src === "data:";
                if (player.driver.src && player.driver.src !== video.src) {
                    // console.log('src changed to', video.src);
                    setTime.call(player, 0, false, true);
                    player.driver.src = video.src;
                    // playing videos will only keep playing if no src was present when .play()’ed
                    if (wasEmpty) {
                        player.driver.play();
                    } else {
                        player.updater.stop();
                    }
                }
            },
            false
        );

        // stop programmatic player when OS takes over
        video.addEventListener("webkitbeginfullscreen", function() {
            if (!video.paused) {
                // make sure that the <audio> and the syncer/updater are stopped
                video.pause();

                // play video natively
                video[Xplay]();
            } else if (hasAudio && !player.driver.buffered.length) {
                // if the first play is native,
                // the <audio> needs to be buffered manually
                // so when the fullscreen ends, it can be set to the same current time
                player.driver.load();
            }
        });
        if (hasAudio) {
            video.addEventListener("webkitendfullscreen", function() {
                // sync audio to new video position
                player.driver.currentTime = video.currentTime;
                // console.assert(player.driver.currentTime === video.currentTime, 'Audio not synced');
            });

            // allow seeking
            video.addEventListener("seeking", function() {
                if (lastRequests.indexOf((video.currentTime * 100) | (0 / 100)) < 0) {
                    // console.log('User-requested seeking');
                    player.driver.currentTime = video.currentTime;
                }
            });
        }

        return player;
    }

    function overloadAPI(video) {
        var player = video[X];
        video[Xplay] = video.play;
        video[Xpause] = video.pause;
        video.play = play;
        video.pause = pause;
        proxyProperty(video, "paused", player.driver);
        proxyProperty(video, "muted", player.driver, true);
        proxyProperty(video, "playbackRate", player.driver, true);
        proxyProperty(video, "ended", player.driver);
        proxyProperty(video, "loop", player.driver, true);
        preventEvent(video, "seeking");
        preventEvent(video, "seeked");
        preventEvent(video, "timeupdate", Xevent, false);
        preventEvent(video, "ended", Xevent, false); // prevent occasional native ended events
    }

    function enableInlineVideo(video, refreshRate, hasAudio) {
        if (hasAudio === void 0) hasAudio = true;

        var player = addPlayer(video, hasAudio, refreshRate);
        overloadAPI(video);
        video.classList.add("IIV");
        if (!hasAudio && video.autoplay) {
            video.play();
        }

        return player;
    }

    return enableInlineVideo;
});

wwplayer.define("videoInVideoPlayer", ["jquery", "underscore", "globals", "Class", "modernizr", "pubsub", "iphone-inline-video", "apiService"], function(
    $,
    _,
    globals,
    Class,
    Modernizr,
    PubSub,
    makeVideoPlayableInline,
    apiService
) {
    "use strict";

    var VideoInVideoPlayer = Class.extend(
        /** @lends VideoInVideoPlayer.prototype */ {
            /**
         @constructs VideoInVideoPlayer
         @extends Class
         @param {HTMLElement} element video in video container element
         @param {Number} vidId video Id
         @param {Object} options video in video options
         @param {Boolean} options.autoPlay autoPlay
         @param {Boolean} options.hidePosterFrame default is false, set to true to hide the poster frame
         @param {String} options.forceRendition forceRendition rendition that we want to force to
         @param {Boolean} options.loop loop loop video
         @param {Boolean} options.togglePlayOnClick togglePlayOnClick
         @param {String} options.posterFrame posterFrame posterFrame that we want to force to
         @param {Boolean} options.muted video is muted
         @param {Boolean} options.controls enables browser's default controls
         @param {Boolean} options.customControls enables custom styled Wirewax controls
         @param {Boolean} options.disableplayButton for customControls - hides the play/pause button
         @param {Boolean} options.disableVolumeButton for customControls - hides the volume slider and mute button
         @param {Boolean} options.disableScrubberBar for customControls - hides the scrubber bar
         @param {Boolean} options.disablefullScreenButton for customControls - hides the fullscreen button
         @param {String} options.subtitlesUrl URL for subtitles file
         @param {Boolean} options.externalSubtitles true if subtitle file is hosted elsewhere
         **/
            init: function(element, vidId, options) {
                var self = this;
                self.setDefaultValues(vidId);
                self.processVars(options);
                self.createElements(element);
            },

            /**
             * @description sets the initial and default values for the player
             * @param {Number} vidId video id
             **/
            setDefaultValues: function(vidId) {
                var self = this;
                self.vidId = vidId;
                self.isVideoInVideoAllowed = true;
                self.hidePosterFrame = false;
                self.showVideo = true;
                self.rendition = self.getDefaultRendition();
                self.fallbackRendition = self.getFallbackRendition();
                self.posterFrame = window.wirewax.cdnUrl + "vidData/" + self.vidId + "/" + self.vidId + "_still.jpg";
                self.loop = false;
                self.autoPlay = false;
                self.tryToPlayCount = 0;
                self.tryToPlayShowLoaderCount = 3;
                self.tryToPlayCountLimit = 50;
                self.tryToPlayInterval = 300;
                self.checkSubtitlesInterval = 100;
                self.togglePlayOnClick = false;
                self.muted = false;
                self.controls = false;
                self.customControls = false;
                self.disableplayButton = false;
                self.disableVolumeButton = false;
                self.disableScrubberBar = false;
                self.disableFullScreenButton = false;
                self.subtitles = null;
                self.externalSubtitles = false;
            },

            getDefaultRendition: function() {
                if (globals.MEDIA_TYPE == globals.MEDIA_TYPES.IMAGE) {
                    // If is image, adjust the renditions!
                    var rendition = null;
                    switch (globals.RENDITION) {
                        case "2160image":
                        case "1080image":
                            rendition = "720";
                            break;
                        case "540image":
                            rendition = "540";
                            break;
                        default:
                            rendition = "540";
                    }
                    return rendition;
                } else {
                    return globals.RENDITION;
                }
            },

            getFallbackRendition: function() {
                var self = this;
                if (self.rendition == "540" || self.rendition == "360") {
                    return "360";
                } else {
                    return "540";
                }
            },

            /**
             * @description defines and assigns values to variables for the player
             * @param {Object} options processVars options (optional)
             * @param {Boolean} options.autoplay autoPlay
             * @params {String} options.forceRendition forceRendition that we want to force
             * @params {Boolean} options.loop plays the video on loop
             * @params {String} options.posterFrame posterFrame URL that we want to force
             * @params {Boolean} options.togglePlayOnClick toggle play on click
             * @param {Boolean} options.controls enables browser's default controls
             * @param {String} options.subtitlesUrl URL for subtitles file
             * @param {Boolean} options.externalSubtitles true if subtitle file is not hosted on our server
             **/
            processVars: function(options) {
                var self = this;
                options = options || {};

                if (window.wirewax.embedLoc.indexOf("sizecalculator") !== -1) {
                    self.isVideoInVideoAllowed = false;
                }
                if (options.autoPlay) {
                    self.autoPlay = true;
                }
                if (self.autoPlay && self.isVideoInVideoAllowed) {
                    self.hidePosterFrame = true;
                }
                if (options.hidePosterFrame) {
                    self.hidePosterFrame = true;
                }
                if (!self.isVideoInVideoAllowed) {
                    self.showVideo = false;
                }
                if (globals.IS_IPHONE || globals.ANDROID) {
                    self.rendition = "540";
                }
                if (options.forceRendition) {
                    self.rendition = options.forceRendition;
                }
                if (options.loop) {
                    self.loop = true;
                }
                if (options.posterFrame) {
                    self.posterFrame = options.posterFrame;
                }
                if (options.togglePlayOnClick) {
                    self.togglePlayOnClick = true;
                }
                if (options.muted) {
                    self.muted = true;
                }
                if (options.controls) {
                    self.controls = true;
                }
                if (options.customControls) {
                    self.customControls = true;
                }
                if (options.disableplayButton) {
                    self.disableplayButton = true;
                }
                if (options.disableVolumeButton) {
                    self.disableVolumeButton = true;
                }
                if (options.disableScrubberBar) {
                    self.disableScrubberBar = true;
                }
                if (options.disableFullScreenButton) {
                    self.disableFullScreenButton = true;
                }
                if (options.subtitlesUrl) {
                    self.subtitles = options.subtitlesUrl;
                }
                if (options.externalSubtitles) {
                    self.externalSubtitles = options.externalSubtitles;
                }
            },

            /**
             * @description appends video in video wrapper to the element passed in the function
             * @param {String} element element we want to append video wrapper to
             */
            createElements: function(element) {
                var self = this;
                self.$videoWrapper = $('<div class="video-in-video-wrapper" style="height:100%; width: 100%; position: relative;"></div>');
                self.checkLoader(); // show a loader as soon as possible
                if (!self.hidePosterFrame) {
                    self.createPosterFrame();
                }

                if (self.showVideo) {
                    self.createVideo();
                    self.setVideoEvents();
                }

                $(element).append(self.$videoWrapper);
            },

            /**
             * @description creates poster frame for video
             */
            createPosterFrame: function() {
                var self = this;
                self.$posterFrame = $(
                    '<img  class="video-in-video-poster"  src="' +
                        self.posterFrame +
                        '" style="cursor:pointer; height:100%; width: 100%; position: absolute; top: 0; left: 0; z-index: 1;" />'
                );
                self.$posterFrame.bind(globals.CLICK_EVENT, self.onPosterFrameClick());
                self.$videoWrapper.append(self.$posterFrame);
            },

            /**
             * @description function that defines what happens on poster click
             * @returns {Function}
             */
            onPosterFrameClick: function() {
                var self = this;
                return function(e) {
                    if (!self.isVideoInVideoAllowed) {
                        window.open("http://embed.wirewax.com/" + self.vidId + "?autoStart=true");
                        e.preventDefault();
                    } else {
                        //remove poster frame and play video;
                        self.$posterFrame.remove();
                        self.playWhenPossible();
                    }
                };
            },

            /**
             * @description creates HTML video element with fallback sources and separate case for iPhone as `playsinline` attribute is not supported on iOS 10 and lower (video goes fullscreen when played)
             */
            createVideo: function(autoplayMuted) {
                var self = this;
                var videoSrcMp4, videoSrcWebm;
                self.$videoElement = null;
                var videoSrc = window.wirewax.vidCdnUrl + "vidData/" + self.vidId + "/" + self.vidId + "_" + self.rendition;
                var videoFallbackSrc = window.wirewax.vidCdnUrl + "vidData/" + self.vidId + "/" + self.vidId + "_" + self.fallbackRendition;

                if (self.rendition === "360" || self.rendition === "540") {
                    videoSrcMp4 = videoSrc + "NoPixel.mp4?dz=" + window.location.hostname;
                    videoSrcWebm = videoSrc + "webmNoPixel.webm?dz=" + window.location.hostname;
                } else {
                    videoSrcMp4 = videoSrc + ".mp4?dz=" + window.location.hostname;
                    videoSrcWebm = videoSrc + ".webm?dz=" + window.location.hostname;
                }
                self.mp4Fallback = videoFallbackSrc + ".mp4?dz=" + window.location.hostname;
                self.webmFallback = videoFallbackSrc + ".webm?dz=" + window.location.hostname;

                if (globals.IS_IPHONE) {
                    self.$videoElement = $(
                        '<video class="video-in-video" style="height:100%; width: 100%;" preload="auto" src="' +
                            videoSrcMp4 +
                            '" crossorigin="anonymous" webkit-playsinline playsinline></video>'
                    );
                    if (globals.IOS_VERSION < 10) {
                        makeVideoPlayableInline(self.$videoElement[0], 60);
                    }
                }
                // 2017-09-22: Safari new version (11) throws an error if webm is one of the possible sources.
                else if ((globals.IS_SAFARI && globals.IS_DESKTOP) || globals.IS_IPAD) {
                    self.$videoElement = $(
                        '<video  class="video-in-video" style="height:100%; width: 100%;" preload="auto" src="' +
                            videoSrcMp4 +
                            '" crossorigin="anonymous" webkit-playsinline playsinline></video>'
                    );
                } else {
                    window.wirewax.videoInVideoError = function() {
                        self.processError(arguments);
                    };
                    self.$videoElement = $(
                        '<video webkit-playsinline class="video-in-video" preload="auto" style="height:100%; width: 100%;">' +
                            '<source src="' +
                            videoSrcWebm +
                            '" type="video/webm" >' +
                            '<source src="' +
                            videoSrcMp4 +
                            '" type="video/mp4" >' +
                            '<source src="' +
                            self.mp4Fallback +
                            '" type="video/mp4" >' +
                            '<source src="' +
                            self.webmFallback +
                            '" type="video/webm" onerror="window.wirewax.videoInVideoError(parentNode)">' +
                            "</video>"
                    );
                }

                globals.VOLUME = globals.VOLUME || 1;
                if (self.muted || globals.VOLUME === 0) {
                    self.$videoElement[0].volume = globals.VOLUME;
                    self.$videoElement[0].muted = true;
                } else {
                    self.$videoElement[0].volume = globals.VOLUME;
                    self.$videoElement[0].muted = false;
                }

                if (self.loop) {
                    self.$videoElement.attr("loop", true);
                }
                if (self.subtitles) {
                    self.createSubtitles();
                }
                self.$videoWrapper.append(self.$videoElement);

                if (self.autoPlay) {
                    if (autoplayMuted) {
                        self.$videoElement[0].muted = true;
                    }
                }
                if (self.controls) {
                    self.$videoElement.attr("controls", true);
                } else if (self.customControls) {
                    self.addCustomControls();
                }

                if (self.autoPlay) {
                    self.playWhenPossible();
                }

                self.checkLoader();
            },
            addCustomControls: function() {
                /**    Probably best to not show custom controls on screens below 600px wide     */
                var self = this;
                self.$controlButtons = $('<div class="video-controls"></div>');

                if (!self.disableScrubberBar) {
                    self.buildCustomScrubber();
                } else {
                    // no scrubber bar
                    self.$controlButtons.addClass("no-scrubber");
                }

                if (!self.disableplayButton) {
                    self.buildCustomPlayPauseButton();
                }

                if (!self.disableVolumeButton) {
                    self.buildCustomVolumeButton();
                }

                if (!self.disableFullScreenButton) {
                    self.buildCustomFullScreenButton();
                }

                self.$videoWrapper.addClass("custom-controls").append(self.$controlButtons);
                if (globals.IS_MOBILE_USERAGENT) {
                    self.$videoWrapper.addClass("mobile-controls");
                }
            },
            buildCustomFullScreenButton: function() {
                var self = this;
                var $fullScreenButton, $fullScreenIcon;

                $fullScreenButton = $('<div class="full-screen"></div>');
                $fullScreenIcon = $('<div class="full-screen-icon"></div>');
                $fullScreenButton.append($fullScreenIcon);
                self.$controlButtons.append($fullScreenButton);

                self.drawFullScreenButton($fullScreenIcon[0]);

                $fullScreenButton.on(globals.CLICK_EVENT, function() {
                    if (self.$videoElement[0].requestFullscreen) {
                        self.$videoElement[0].requestFullscreen();
                    } else if (self.$videoElement[0].mozRequestFullScreen) {
                        self.$videoElement[0].mozRequestFullScreen(); // Firefox
                    } else if (self.$videoElement[0].webkitRequestFullscreen) {
                        self.$videoElement[0].webkitRequestFullscreen(); // Chrome and Safari
                    }
                });
            },
            buildCustomVolumeButton: function() {
                var self = this;
                var $volumeWrap, $volumeIconWrap, $volumeRangeWrap, $volumeScrubber, $volumeBackground, $volumeIcons;
                $volumeWrap = $('<div class="volumeWrap"></div>');

                $volumeIconWrap = $('<div class="icon-wrap"></div>');
                self.$speakerButton = $('<div class="speaker-icon volume-icon"></div>');
                self.$muteButton = $('<div class="mute-icon volume-icon"></div>');
                $volumeIconWrap.append(self.$speakerButton, self.$muteButton);

                $volumeRangeWrap = $('<div class="volume-range-wrap"></div>');
                $volumeBackground = $('<div class="volume-background"></div>');
                $volumeScrubber = $('<div class="volume-scrubber"></div>');
                $volumeRangeWrap.append($volumeBackground, $volumeScrubber);

                $volumeWrap.append($volumeIconWrap, $volumeRangeWrap);
                self.$controlButtons.append($volumeWrap);

                $volumeIcons = $volumeWrap.find(".volume-icon");

                self.previousVolume = 1;
                $volumeIcons.on(globals.CLICK_EVENT, function() {
                    if (self.$videoElement[0].muted == false) {
                        // Mute the video
                        self.$videoElement[0].muted = true;
                        self.showMute();
                        $volumeScrubber[0].value = 0;
                    } else {
                        // Unmute the video
                        self.$videoElement[0].muted = false;
                        self.hideMute();
                        $volumeScrubber[0].value = self.previousVolume;
                    }
                });

                $volumeScrubber.on("mousedown touchstart", function(event) {
                    var newLeft;
                    self.volumeIsMoving = true;
                    // set left position of scrubber based on cursor position
                    var elementLeft = $volumeRangeWrap.offset().left;
                    self.$controlButtons.on("mousemove touchmove", function(event) {
                        newLeft = event.clientX - elementLeft;
                        if (event.originalEvent.touches) {
                            newLeft = event.originalEvent.touches[0].clientX - elementLeft;
                        }
                        if (newLeft >= $volumeRangeWrap.position().left - $volumeRangeWrap.width() && newLeft <= $volumeRangeWrap.width() && newLeft >= 0) {
                            $volumeScrubber.css({ left: newLeft });

                            var totalWidth = $volumeRangeWrap.width();
                            var volumePercent = newLeft / totalWidth;
                            volumePercent < 0 ? (volumePercent = 0) : (volumePercent = volumePercent);
                            self.$videoElement[0].volume = volumePercent;
                        }
                    });

                    // mouseup on whole button wrapper so they can finish clicking in any location, not just over the scrubber bar
                    self.$controlButtons.on("mouseup touchend", function(event) {
                        self.$controlButtons.off("mousemove touchmove");

                        if (newLeft <= 1) {
                            self.showMute();
                        } else {
                            self.hideMute();
                        }

                        if (self.$videoElement[0].muted && self.volumeIsMoving) {
                            self.volumeIsMoving = false;
                            self.$videoElement[0].muted = false;
                            self.hideMute();
                        }
                        // unsubscribe so it doesn't fire when just clicking on the video
                        self.$controlButtons.off("mouseup touchend");
                    });
                });

                var drawMuteAndSpeakerButtons = function(callback) {
                    self.drawSpeakerButton(self.$speakerButton[0]);
                    self.drawMuteButton(self.$muteButton[0]);
                    callback();
                };
                drawMuteAndSpeakerButtons(function() {
                    if (self.$videoElement[0].muted) {
                        $volumeScrubber.css({ left: "0" });
                    } else {
                        $volumeScrubber.css({ left: "95%" });
                        self.hideMute();
                    }
                });
            },
            showMute: function() {
                var self = this;
                $(self.$speakerButton).hide();
                $(self.$muteButton).show();
            },
            hideMute: function() {
                var self = this;
                $(self.$speakerButton).show();
                $(self.$muteButton).hide();
            },
            buildCustomPlayPauseButton: function() {
                var self = this;
                var $playPauseButton;
                $playPauseButton = $('<div class="play-pause"></div>');
                self.$playButton = $('<div class="play-button"></div>');
                self.$pauseButton = $('<div class="pause-button"></div>');
                $playPauseButton.append(self.$playButton, self.$pauseButton);
                self.$controlButtons.append($playPauseButton);

                self.drawPlayIcon(self.$playButton[0]);
                self.drawPauseIcon(self.$pauseButton[0]);

                var doPlay = function(autoplay) {
                    if (!autoplay) {
                        self.$videoElement[0].play();
                        apiService.recordUiMetric(self.vidId, null, 0, "", "", globals.WIDGET_METRIC_TYPES["MEDIA_PLAY"]);
                    }
                    $(self.$playButton).hide();
                    $(self.$pauseButton).show();
                };
                var doPause = function(autoplay) {
                    if (!autoplay) {
                        self.$videoElement[0].pause();
                        apiService.recordUiMetric(self.vidId, null, 0, "", "", globals.WIDGET_METRIC_TYPES["MEDIA_PAUSE"]);
                    }
                    $(self.$pauseButton).hide();
                    $(self.$playButton).show();
                };

                if (this.autoPlay) {
                    doPlay(true);
                } else {
                    doPause(true);
                }

                $playPauseButton.on(globals.CLICK_EVENT, function() {
                    if (self.$videoElement[0].paused == true) {
                        doPlay(false);
                    } else {
                        doPause(false);
                    }
                });

                self.$videoElement.on(globals.CLICK_EVENT, function() {
                    if (self.$videoElement[0].paused == true) {
                        doPlay(false);
                    } else {
                        doPause(false);
                    }
                });
            },
            buildCustomScrubber: function() {
                var self = this;
                var $seekBarWrap = $('<div class="seek-bar-wrap"><div class="seek-background"></div><div class="seek-scrubber"></div></div>');
                var $seekScrubber = $seekBarWrap.find(".seek-scrubber");
                self.$controlButtons.append($seekBarWrap);

                $seekScrubber.on("mousedown", function(event) {
                    self.$videoElement[0].pause();
                    $(self.$pauseButton).hide();
                    $(self.$playButton).show();

                    // set left position of scrubber based on cursor position
                    self.$videoWrapper.on("mousemove", function(event) {
                        $seekScrubber.css({ left: event.offsetX });
                        self.mouseLeft = event.clientX;
                    });

                    // mouseup on whole video wrapper so they can finish clicking in any location, not just over the scrubber bar
                    self.$videoWrapper.on("mouseup", function(event) {
                        self.$videoWrapper.off("mousemove");

                        var totalWidth = $seekBarWrap.width();
                        var positionPercent = (self.mouseLeft / totalWidth) * 100;
                        var newTime = self.$videoElement[0].duration * positionPercent * 0.01;
                        self.$videoElement[0].currentTime = newTime;

                        self.$videoElement[0].play();
                        $(self.$playButton).hide();
                        $(self.$pauseButton).show();

                        // unsubscribe so it doesn't fire when just clicking on the video
                        self.$videoWrapper.off("mouseup");
                    });
                });

                $seekBarWrap.on(globals.CLICK_EVENT, function(event) {
                    var totalWidth = $seekBarWrap.width();
                    var positionPercent = (event.offsetX / totalWidth) * 100;
                    var newTime = self.$videoElement[0].duration * positionPercent * 0.01;
                    self.$videoElement[0].currentTime = newTime;
                    $seekScrubber.css({ left: event.offsetX });
                });

                self.$videoElement.on("timeupdate", function() {
                    // Calculate the slider value
                    var value = (self.$videoElement[0].currentTime / self.$videoElement[0].duration) * 100 + "%";

                    // Update the slider value
                    $seekScrubber.css({ left: value });
                });
            },
            drawPlayIcon: function(element) {
                var playIcon = Raphael(element, "100%", "100%");
                playIcon.setViewBox(0, 0, 100, 100, true);
                var buttonSvg = playIcon.path("M18.7,1L18.8,1L81.2,49.5L18.8,99z");
                buttonSvg.attr({
                    fill: "transparent",
                    stroke: "#ffffff",
                    "stroke-width": 3,
                    "stroke-linejoin": "round"
                });
            },
            drawPauseIcon: function(element) {
                var pauseIcon = Raphael(element, "100%", "100%");
                pauseIcon.setViewBox(5, 5, 20, 28, true);
                var path_a = pauseIcon.path("M10.5,24.6V6.4 M20.5,24.6V6.4");
                path_a.attr({
                    fill: "transparent",
                    stroke: "#ffffff",
                    "stroke-width": 1,
                    "stroke-linejoin": "round"
                });
            },
            drawSpeakerButton: function(element) {
                var rsr = Raphael(element, "100%", "100%");
                rsr.setViewBox(0, 0, 100, 100, true);
                var regularPath = "M82.6,0.5V50v49.5L32.3,68.9l0,0H6.8v-38h25.5l0,0L82.6,0.5z";

                var buttonSvg = rsr.path(regularPath);
                buttonSvg.attr({
                    fill: "transparent",
                    stroke: "#ffffff",
                    "stroke-width": 3,
                    "stroke-linejoin": "round"
                });
            },
            drawMuteButton: function(element) {
                var rsr = Raphael(element, "100%", "100%");
                rsr.setViewBox(0, 0, 100, 100, true);
                var mutePath = "M82.6,78.4v21.1L32.3,68.9l0,0H6.8v-38h25.5l0,0L82.6,0.5v22.9 M69.3,36.2l26.9,27.5 M69,63.4l27.5-26.9";

                var buttonSvg = rsr.path(mutePath);
                buttonSvg.attr({
                    fill: "transparent",
                    stroke: "#ffffff",
                    "stroke-width": 3,
                    "stroke-linejoin": "round"
                });
            },
            drawFullScreenButton: function(element) {
                var canvas = Raphael(element, "100%", "100%");
                canvas.setViewBox(5, 5, 40, 40, true);
                var path1 = canvas.rect(11.327, 15.733, 1.6, 6.467).attr({
                    stroke: "none",
                    fill: "#ffffff",
                    "stroke-width": 1
                });
                var path2 = canvas.rect(11.331, 15.729, 6.468, 1.6).attr({
                    stroke: "none",
                    fill: "#ffffff",
                    "stroke-width": 1
                });
                var path3 = canvas.rect(32.244, 15.729, 6.467, 1.6).attr({
                    stroke: "none",
                    fill: "#ffffff",
                    "stroke-width": 1
                });
                var path4 = canvas.rect(37.115, 15.733, 1.6, 6.468).attr({
                    stroke: "none",
                    fill: "#ffffff",
                    "stroke-width": 1
                });
                var path5 = canvas.rect(37.115, 27.062, 1.6, 6.467).attr({
                    stroke: "none",
                    fill: "#ffffff",
                    "stroke-width": 1
                });
                var path6 = canvas.rect(32.243, 31.934, 6.468, 1.6).attr({
                    stroke: "none",
                    fill: "#ffffff",
                    "stroke-width": 1
                });
                var path7 = canvas.rect(11.331, 31.935, 6.467, 1.6).attr({
                    stroke: "none",
                    fill: "#ffffff",
                    "stroke-width": 1
                });
                var path8 = canvas.rect(11.327, 27.062, 1.6, 6.467).attr({
                    stroke: "none",
                    fill: "#ffffff",
                    "stroke-width": 1
                });
            },
            /**
             * @description starts playing the video
             */
            play: function() {
                var self = this;
                if (!self.startedPlaying) {
                    self.startedPlaying = true;
                    self.onStartPlay();
                }
                self.$videoElement[0].play();
                self.checkLoader();
            },

            /**
             * @description pauses the video
             */
            pause: function() {
                var self = this;
                if (self.isPlaying()) {
                    self.$videoElement[0].pause();
                }
            },

            /**
             * @description starts playing video after it stops buffering or goes to self.onError() if the number of tries surpassed limit
             */
            playWhenPossible: function() {
                var self = this;
                if (!self.showingError) {
                    if (globals.IS_IPHONE || globals.IS_IPAD || globals.IS_ANDROID) {
                        // We need to trigger play on iPhones and iPads so that the readyState changes from 1. Also user input required etc
                        self.play();
                    }
                    self.checkBufferState();
                    if (self.buffering) {
                        self.tryToPlayCount++;
                        if (self.tryToPlayCount < self.tryToPlayCountLimit) {
                            if (self.tryToPlayCount > self.tryToPlayShowLoaderCount) {
                                self.checkLoader();
                            }
                            window.setTimeout(function() {
                                self.playWhenPossible();
                            }, self.tryToPlayInterval);
                        } else {
                            self.tryToPlayCount = 0;
                            self.onError();
                        }
                    } else {
                        self.tryToPlayCount = 0;
                        self.checkLoader();

                        var promise = self.$videoElement[0].play();
                        if (promise !== undefined) {
                            promise
                                .then(function() {
                                    // Autoplay started!
                                    self.onStartPlay();
                                    if (self.customControls) {
                                        $(self.$playButton).hide();
                                        $(self.$pauseButton).show();
                                    }
                                })
                                .catch(function(error) {
                                    // Autoplay was prevented.
                                    var autoplayMuted = true;
                                    $(".video-in-video-wrapper").empty();
                                    self.createVideo(autoplayMuted);
                                });
                        }
                    }
                }
            },

            /**
             * @description sets boolean value for self.buffering based on readyState code
             */
            checkBufferState: function() {
                var self = this;

                if (self.showingError) {
                    self.buffering = false;
                }
                // NOT ENOUGH DATA | NOT BUFFERING
                // THEN START BUFFER
                else if (self.getReadyState() < 2 && !self.buffering) {
                    self.buffering = true;
                }
                // HAVE ENOUGH DATA | BUFFERING
                // STOP BUFFER AND PLAY
                else if (self.getReadyState() >= 2 && self.buffering) {
                    self.buffering = false;
                }
            },

            /**
             * @decription returns readyState code 0 (UNSENT), 2 (HEADERS_RECEIVED) or 4 (DONE)
             * @returns {number} readyState
             */
            getReadyState: function() {
                var self = this;
                var state = self.$videoElement[0].readyState;
                if (state < 2) {
                    return 0;
                }
                if (state >= 2 && state < 4) {
                    return 2;
                }
                if (state >= 4) {
                    return 4;
                }
            },

            /**
             * @description appends/removes loader if video is loading/playing
             */
            checkLoader: function() {
                var self = this;

                self.$loaderElement =
                    self.$loaderElement ||
                    $('<div id="loader-slick" class="video-in-video-loader">' + '<div class="loader-bar"><div class="loader-inner-bar"></div></div>' + "</div>");
                if (!self.$videoElement || !self.$videoElement[0] || (!self.isPlaying() && self.buffering && !self.isLoaderOn)) {
                    self.isLoaderOn = true;
                    self.$videoWrapper.append(self.$loaderElement);
                } else if (!self.buffering) {
                    self.isLoaderOn = false;
                    self.$loaderElement.remove();
                }
            },

            /**
             * @description process player error
             */
            processError: function() {
                var self = this;
                self.buffering = false;
                self.checkLoader();
                if (self.$posterFrame) {
                    self.$posterFrame.remove();
                }
                self.showErrorMessage();
                self.onError();
            },

            /**
             * @description creates error message
             */
            showErrorMessage: function() {
                var self = this;
                self.showingError = true;
                self.$errorElement =
                    self.$errorElement ||
                    $(
                        '<div class="video-in-video-fallback-error" style="height: 100%;width: 100%;background: black;position:absolute;top:0;left:0">' +
                            '<div class="error-message" style="position: absolute;top: 50%;left: 50%;transform: translate(-50%,-50%);">' +
                            '<p style="color:white;font-family: wireWAX;font-size: 2em;">This video is unavailable</p></div>' +
                            "</div>"
                    );
                self.$videoWrapper.append(self.$errorElement);
            },
            /**
             * @description removes error message
             */
            removeErrorMessage: function() {
                var self = this;
                self.showingError = false;
                if (self.$errorElement) {
                    self.$errorElement.remove();
                }
            },

            /**
             * @description click event listener on video element that pauses/restarts video and volume settings
             */
            setVideoEvents: function() {
                var self = this;
                if (!self.muted) {
                    PubSub.subscribe(globals.MUTE_VOLUME, function() {
                        self.$videoElement[0].volume = 0;
                        self.$videoElement[0].muted = true;
                    });

                    PubSub.subscribe(globals.UNMUTE_VOLUME, function() {
                        self.$videoElement[0].volume = 1;
                        self.$videoElement[0].muted = false;
                    });

                    PubSub.subscribe(globals.VOLUME_CHANGE, function() {
                        self.$videoElement[0].volume = globals.VOLUME;
                    });
                }

                self.$videoElement.bind("error", function() {
                    // iphone, ipad and safari need this fallback system since they can't handle multiple source tags
                    if ((globals.IS_IPHONE || (globals.IS_SAFARI && globals.IS_DESKTOP) || globals.IS_IPAD) && !self.triedIphoneFallbackRendition) {
                        self.triedIphoneFallbackRendition = true;
                        self.$videoElement[0].src = self.mp4Fallback;
                    } else {
                        self.processError();
                    }
                });

                self.$videoElement.bind("ended", function() {
                    self.onEnd();
                });

                if (self.togglePlayOnClick) {
                    self.$videoElement.on(globals.CLICK_EVENT, function() {
                        if (!self.isPaused()) {
                            self.play();
                        } else {
                            self.pause();
                        }
                    });
                } else if (!self.autoPlay) {
                    self.$videoElement.on(globals.CLICK_EVENT, function() {
                        self.play();
                        $(this).off(globals.CLICK_EVENT);
                    });
                }
            },

            /**
             * @returns {boolean} returns boolean
             */
            isPlaying: function() {
                var self = this;
                if (self.$videoElement[0].paused) {
                    return false;
                } else {
                    return self.startedPlaying;
                }
            },

            isPaused: function() {
                var self = this;
                return self.$videoElement[0].paused;
            },
            /**
             * @description function that is called on video end
             * @example videoInVideo.onEnd = function() {
             *      // do something after video ends
             * }
             */
            onEnd: function() {
                //console.log("end")
                apiService.recordUiMetric(self.vidId, null, 0, "", "", globals.WIDGET_METRIC_TYPES["MEDIA_ENDED"]);
            },
            /**
             * @description function that is called when video starts playing
             * @example videoInVideo.onStartPlay = function() {
             *      // do something when video starts playing
             * }
             */
            onStartPlay: function() {
                //console.log("startplay")
                if (self.$posterFrame) {
                    self.$posterFrame.remove();
                }
            },
            /**
             * @description function that is called when error
             * @example videoInVideo.onError = function() {
             *      // what happens on error
             * }
             */
            onError: function() {
                //console.log("error")
            },
            /**
             * @description function that gets, creates and adds subtitles to the video
             */
            createSubtitles: function() {
                var self = this;

                apiService.getSubtitles({ file: self.subtitles, external: self.externalSubtitles }, function(subObect) {
                    var currentSubtitle = null;

                    var subinterval = window.setInterval(function() {
                        if (!self.$videoElement[0].paused) {
                            var currentTime = self.$videoElement[0].currentTime;
                            if (currentSubtitle) {
                                if (currentTime > currentSubtitle.out || currentTime < currentSubtitle["in"]) {
                                    self.$videoWrapper.find(".subtitle-cc").remove();
                                    currentSubtitle = null;
                                }
                            }
                            _.each(subObect.subtitles, function(subtitle) {
                                if (subtitle["in"] <= currentTime && subtitle.out >= currentTime && !currentSubtitle) {
                                    currentSubtitle = subtitle;
                                    if (subtitle.text) {
                                        currentSubtitle.element = $('<div class="subtitle-cc" style="z-index: 100;"><p>' + subtitle.text.replace("\n", "<br>") + "</p></div>");
                                    }

                                    self.$videoWrapper.append(currentSubtitle.element);
                                }
                            });
                        }

                        if (!$("#waxxer").find(self.$videoWrapper).length) window.clearInterval(subinterval);
                    }, self.checkSubtitlesInterval);
                });
            }
        }
    );

    return VideoInVideoPlayer;
});

/*!
 * VERSION: 1.20.3
 * DATE: 2017-10-02
 * UPDATES AND DOCS AT: http://greensock.com
 *
 * @license Copyright (c) 2008-2017, GreenSock. All rights reserved.
 * This work is subject to the terms at http://greensock.com/standard-license or for
 * Club GreenSock members, the software agreement that was issued with your membership.
 *
 * @author: Jack Doyle, jack@greensock.com
 */
!(function(a, b) {
    "use strict";
    var c = {},
        d = a.document,
        e = (a.GreenSockGlobals = a.GreenSockGlobals || a);
    if (!e.TweenLite) {
        var f,
            g,
            h,
            i,
            j,
            k = function(a) {
                var b,
                    c = a.split("."),
                    d = e;
                for (b = 0; b < c.length; b++) d[c[b]] = d = d[c[b]] || {};
                return d;
            },
            l = k("com.greensock"),
            m = 1e-10,
            n = function(a) {
                var b,
                    c = [],
                    d = a.length;
                for (b = 0; b !== d; c.push(a[b++]));
                return c;
            },
            o = function() {},
            p = (function() {
                var a = Object.prototype.toString,
                    b = a.call([]);
                return function(c) {
                    return null != c && (c instanceof Array || ("object" == typeof c && !!c.push && a.call(c) === b));
                };
            })(),
            q = {},
            r = function(d, f, g, h) {
                (this.sc = q[d] ? q[d].sc : []), (q[d] = this), (this.gsClass = null), (this.func = g);
                var i = [];
                (this.check = function(j) {
                    for (var l, m, n, o, p = f.length, s = p; --p > -1; ) (l = q[f[p]] || new r(f[p], [])).gsClass ? ((i[p] = l.gsClass), s--) : j && l.sc.push(this);
                    if (0 === s && g) {
                        if (((m = ("com.greensock." + d).split(".")), (n = m.pop()), (o = k(m.join("."))[n] = this.gsClass = g.apply(g, i)), h))
                            if (((e[n] = c[n] = o), "undefined" != typeof module && module.exports))
                                if (d === b) {
                                    module.exports = c[b] = o;
                                    for (p in c) o[p] = c[p];
                                } else c[b] && (c[b][n] = o);
                            else
                                "function" === typeof wwplayer.define &&
                                    wwplayer.define.amd &&
                                    wwplayer.define((a.GreenSockAMDPath ? a.GreenSockAMDPath + "/" : "") + d.split(".").pop(), [], function() {
                                        return o;
                                    });
                        for (p = 0; p < this.sc.length; p++) this.sc[p].check();
                    }
                }),
                    this.check(!0);
            },
            s = (a._gsDefine = function(a, b, c, d) {
                return new r(a, b, c, d);
            }),
            t = (l._class = function(a, b, c) {
                return (
                    (b = b || function() {}),
                    s(
                        a,
                        [],
                        function() {
                            return b;
                        },
                        c
                    ),
                    b
                );
            });
        s.globals = e;
        var u = [0, 0, 1, 1],
            v = t(
                "easing.Ease",
                function(a, b, c, d) {
                    (this._func = a), (this._type = c || 0), (this._power = d || 0), (this._params = b ? u.concat(b) : u);
                },
                !0
            ),
            w = (v.map = {}),
            x = (v.register = function(a, b, c, d) {
                for (var e, f, g, h, i = b.split(","), j = i.length, k = (c || "easeIn,easeOut,easeInOut").split(","); --j > -1; )
                    for (f = i[j], e = d ? t("easing." + f, null, !0) : l.easing[f] || {}, g = k.length; --g > -1; )
                        (h = k[g]), (w[f + "." + h] = w[h + f] = e[h] = a.getRatio ? a : a[h] || new a());
            });
        for (
            h = v.prototype,
                h._calcEnd = !1,
                h.getRatio = function(a) {
                    if (this._func) return (this._params[0] = a), this._func.apply(null, this._params);
                    var b = this._type,
                        c = this._power,
                        d = 1 === b ? 1 - a : 2 === b ? a : 0.5 > a ? 2 * a : 2 * (1 - a);
                    return (
                        1 === c ? (d *= d) : 2 === c ? (d *= d * d) : 3 === c ? (d *= d * d * d) : 4 === c && (d *= d * d * d * d),
                        1 === b ? 1 - d : 2 === b ? d : 0.5 > a ? d / 2 : 1 - d / 2
                    );
                },
                f = ["Linear", "Quad", "Cubic", "Quart", "Quint,Strong"],
                g = f.length;
            --g > -1;

        )
            (h = f[g] + ",Power" + g),
                x(new v(null, null, 1, g), h, "easeOut", !0),
                x(new v(null, null, 2, g), h, "easeIn" + (0 === g ? ",easeNone" : "")),
                x(new v(null, null, 3, g), h, "easeInOut");
        (w.linear = l.easing.Linear.easeIn), (w.swing = l.easing.Quad.easeInOut);
        var y = t("events.EventDispatcher", function(a) {
            (this._listeners = {}), (this._eventTarget = a || this);
        });
        (h = y.prototype),
            (h.addEventListener = function(a, b, c, d, e) {
                e = e || 0;
                var f,
                    g,
                    h = this._listeners[a],
                    k = 0;
                for (this !== i || j || i.wake(), null == h && (this._listeners[a] = h = []), g = h.length; --g > -1; )
                    (f = h[g]), f.c === b && f.s === c ? h.splice(g, 1) : 0 === k && f.pr < e && (k = g + 1);
                h.splice(k, 0, { c: b, s: c, up: d, pr: e });
            }),
            (h.removeEventListener = function(a, b) {
                var c,
                    d = this._listeners[a];
                if (d) for (c = d.length; --c > -1; ) if (d[c].c === b) return void d.splice(c, 1);
            }),
            (h.dispatchEvent = function(a) {
                var b,
                    c,
                    d,
                    e = this._listeners[a];
                if (e)
                    for (b = e.length, b > 1 && (e = e.slice(0)), c = this._eventTarget; --b > -1; )
                        (d = e[b]), d && (d.up ? d.c.call(d.s || c, { type: a, target: c }) : d.c.call(d.s || c));
            });
        var z = a.requestAnimationFrame,
            A = a.cancelAnimationFrame,
            B =
                Date.now ||
                function() {
                    return new Date().getTime();
                },
            C = B();
        for (f = ["ms", "moz", "webkit", "o"], g = f.length; --g > -1 && !z; )
            (z = a[f[g] + "RequestAnimationFrame"]), (A = a[f[g] + "CancelAnimationFrame"] || a[f[g] + "CancelRequestAnimationFrame"]);
        t("Ticker", function(a, b) {
            var c,
                e,
                f,
                g,
                h,
                k = this,
                l = B(),
                n = b !== !1 && z ? "auto" : !1,
                p = 500,
                q = 33,
                r = "tick",
                s = function(a) {
                    var b,
                        d,
                        i = B() - C;
                    i > p && (l += i - q),
                        (C += i),
                        (k.time = (C - l) / 1e3),
                        (b = k.time - h),
                        (!c || b > 0 || a === !0) && (k.frame++, (h += b + (b >= g ? 0.004 : g - b)), (d = !0)),
                        a !== !0 && (f = e(s)),
                        d && k.dispatchEvent(r);
                };
            y.call(k),
                (k.time = k.frame = 0),
                (k.tick = function() {
                    s(!0);
                }),
                (k.lagSmoothing = function(a, b) {
                    return arguments.length ? ((p = a || 1 / m), void (q = Math.min(b, p, 0))) : 1 / m > p;
                }),
                (k.sleep = function() {
                    null != f && (n && A ? A(f) : clearTimeout(f), (e = o), (f = null), k === i && (j = !1));
                }),
                (k.wake = function(a) {
                    null !== f ? k.sleep() : a ? (l += -C + (C = B())) : k.frame > 10 && (C = B() - p + 5),
                        (e =
                            0 === c
                                ? o
                                : n && z
                                ? z
                                : function(a) {
                                      return setTimeout(a, (1e3 * (h - k.time) + 1) | 0);
                                  }),
                        k === i && (j = !0),
                        s(2);
                }),
                (k.fps = function(a) {
                    return arguments.length ? ((c = a), (g = 1 / (c || 60)), (h = this.time + g), void k.wake()) : c;
                }),
                (k.useRAF = function(a) {
                    return arguments.length ? (k.sleep(), (n = a), void k.fps(c)) : n;
                }),
                k.fps(a),
                setTimeout(function() {
                    "auto" === n && k.frame < 5 && "hidden" !== d.visibilityState && k.useRAF(!1);
                }, 1500);
        }),
            (h = l.Ticker.prototype = new l.events.EventDispatcher()),
            (h.constructor = l.Ticker);
        var D = t("core.Animation", function(a, b) {
            if (
                ((this.vars = b = b || {}),
                (this._duration = this._totalDuration = a || 0),
                (this._delay = Number(b.delay) || 0),
                (this._timeScale = 1),
                (this._active = b.immediateRender === !0),
                (this.data = b.data),
                (this._reversed = b.reversed === !0),
                X)
            ) {
                j || i.wake();
                var c = this.vars.useFrames ? W : X;
                c.add(this, c._time), this.vars.paused && this.paused(!0);
            }
        });
        (i = D.ticker = new l.Ticker()),
            (h = D.prototype),
            (h._dirty = h._gc = h._initted = h._paused = !1),
            (h._totalTime = h._time = 0),
            (h._rawPrevTime = -1),
            (h._next = h._last = h._onUpdate = h._timeline = h.timeline = null),
            (h._paused = !1);
        var E = function() {
            j && B() - C > 2e3 && ("hidden" !== d.visibilityState || !i.lagSmoothing()) && i.wake();
            var a = setTimeout(E, 2e3);
            a.unref && a.unref();
        };
        E(),
            (h.play = function(a, b) {
                return null != a && this.seek(a, b), this.reversed(!1).paused(!1);
            }),
            (h.pause = function(a, b) {
                return null != a && this.seek(a, b), this.paused(!0);
            }),
            (h.resume = function(a, b) {
                return null != a && this.seek(a, b), this.paused(!1);
            }),
            (h.seek = function(a, b) {
                return this.totalTime(Number(a), b !== !1);
            }),
            (h.restart = function(a, b) {
                return this.reversed(!1)
                    .paused(!1)
                    .totalTime(a ? -this._delay : 0, b !== !1, !0);
            }),
            (h.reverse = function(a, b) {
                return null != a && this.seek(a || this.totalDuration(), b), this.reversed(!0).paused(!1);
            }),
            (h.render = function(a, b, c) {}),
            (h.invalidate = function() {
                return (this._time = this._totalTime = 0), (this._initted = this._gc = !1), (this._rawPrevTime = -1), (this._gc || !this.timeline) && this._enabled(!0), this;
            }),
            (h.isActive = function() {
                var a,
                    b = this._timeline,
                    c = this._startTime;
                return !b || (!this._gc && !this._paused && b.isActive() && (a = b.rawTime(!0)) >= c && a < c + this.totalDuration() / this._timeScale - 1e-7);
            }),
            (h._enabled = function(a, b) {
                return (
                    j || i.wake(),
                    (this._gc = !a),
                    (this._active = this.isActive()),
                    b !== !0 && (a && !this.timeline ? this._timeline.add(this, this._startTime - this._delay) : !a && this.timeline && this._timeline._remove(this, !0)),
                    !1
                );
            }),
            (h._kill = function(a, b) {
                return this._enabled(!1, !1);
            }),
            (h.kill = function(a, b) {
                return this._kill(a, b), this;
            }),
            (h._uncache = function(a) {
                for (var b = a ? this : this.timeline; b; ) (b._dirty = !0), (b = b.timeline);
                return this;
            }),
            (h._swapSelfInParams = function(a) {
                for (var b = a.length, c = a.concat(); --b > -1; ) "{self}" === a[b] && (c[b] = this);
                return c;
            }),
            (h._callback = function(a) {
                var b = this.vars,
                    c = b[a],
                    d = b[a + "Params"],
                    e = b[a + "Scope"] || b.callbackScope || this,
                    f = d ? d.length : 0;
                switch (f) {
                    case 0:
                        c.call(e);
                        break;
                    case 1:
                        c.call(e, d[0]);
                        break;
                    case 2:
                        c.call(e, d[0], d[1]);
                        break;
                    default:
                        c.apply(e, d);
                }
            }),
            (h.eventCallback = function(a, b, c, d) {
                if ("on" === (a || "").substr(0, 2)) {
                    var e = this.vars;
                    if (1 === arguments.length) return e[a];
                    null == b ? delete e[a] : ((e[a] = b), (e[a + "Params"] = p(c) && -1 !== c.join("").indexOf("{self}") ? this._swapSelfInParams(c) : c), (e[a + "Scope"] = d)),
                        "onUpdate" === a && (this._onUpdate = b);
                }
                return this;
            }),
            (h.delay = function(a) {
                return arguments.length ? (this._timeline.smoothChildTiming && this.startTime(this._startTime + a - this._delay), (this._delay = a), this) : this._delay;
            }),
            (h.duration = function(a) {
                return arguments.length
                    ? ((this._duration = this._totalDuration = a),
                      this._uncache(!0),
                      this._timeline.smoothChildTiming && this._time > 0 && this._time < this._duration && 0 !== a && this.totalTime(this._totalTime * (a / this._duration), !0),
                      this)
                    : ((this._dirty = !1), this._duration);
            }),
            (h.totalDuration = function(a) {
                return (this._dirty = !1), arguments.length ? this.duration(a) : this._totalDuration;
            }),
            (h.time = function(a, b) {
                return arguments.length ? (this._dirty && this.totalDuration(), this.totalTime(a > this._duration ? this._duration : a, b)) : this._time;
            }),
            (h.totalTime = function(a, b, c) {
                if ((j || i.wake(), !arguments.length)) return this._totalTime;
                if (this._timeline) {
                    if ((0 > a && !c && (a += this.totalDuration()), this._timeline.smoothChildTiming)) {
                        this._dirty && this.totalDuration();
                        var d = this._totalDuration,
                            e = this._timeline;
                        if (
                            (a > d && !c && (a = d),
                            (this._startTime = (this._paused ? this._pauseTime : e._time) - (this._reversed ? d - a : a) / this._timeScale),
                            e._dirty || this._uncache(!1),
                            e._timeline)
                        )
                            for (; e._timeline; ) e._timeline._time !== (e._startTime + e._totalTime) / e._timeScale && e.totalTime(e._totalTime, !0), (e = e._timeline);
                    }
                    this._gc && this._enabled(!0, !1), (this._totalTime !== a || 0 === this._duration) && (J.length && Z(), this.render(a, b, !1), J.length && Z());
                }
                return this;
            }),
            (h.progress = h.totalProgress = function(a, b) {
                var c = this.duration();
                return arguments.length ? this.totalTime(c * a, b) : c ? this._time / c : this.ratio;
            }),
            (h.startTime = function(a) {
                return arguments.length
                    ? (a !== this._startTime && ((this._startTime = a), this.timeline && this.timeline._sortChildren && this.timeline.add(this, a - this._delay)), this)
                    : this._startTime;
            }),
            (h.endTime = function(a) {
                return this._startTime + (0 != a ? this.totalDuration() : this.duration()) / this._timeScale;
            }),
            (h.timeScale = function(a) {
                if (!arguments.length) return this._timeScale;
                var b, c;
                for (
                    a = a || m,
                        this._timeline &&
                            this._timeline.smoothChildTiming &&
                            ((b = this._pauseTime), (c = b || 0 === b ? b : this._timeline.totalTime()), (this._startTime = c - ((c - this._startTime) * this._timeScale) / a)),
                        this._timeScale = a,
                        c = this.timeline;
                    c && c.timeline;

                )
                    (c._dirty = !0), c.totalDuration(), (c = c.timeline);
                return this;
            }),
            (h.reversed = function(a) {
                return arguments.length
                    ? (a != this._reversed &&
                          ((this._reversed = a),
                          this.totalTime(this._timeline && !this._timeline.smoothChildTiming ? this.totalDuration() - this._totalTime : this._totalTime, !0)),
                      this)
                    : this._reversed;
            }),
            (h.paused = function(a) {
                if (!arguments.length) return this._paused;
                var b,
                    c,
                    d = this._timeline;
                return (
                    a != this._paused &&
                        d &&
                        (j || a || i.wake(),
                        (b = d.rawTime()),
                        (c = b - this._pauseTime),
                        !a && d.smoothChildTiming && ((this._startTime += c), this._uncache(!1)),
                        (this._pauseTime = a ? b : null),
                        (this._paused = a),
                        (this._active = this.isActive()),
                        !a &&
                            0 !== c &&
                            this._initted &&
                            this.duration() &&
                            ((b = d.smoothChildTiming ? this._totalTime : (b - this._startTime) / this._timeScale), this.render(b, b === this._totalTime, !0))),
                    this._gc && !a && this._enabled(!0, !1),
                    this
                );
            });
        var F = t("core.SimpleTimeline", function(a) {
            D.call(this, 0, a), (this.autoRemoveChildren = this.smoothChildTiming = !0);
        });
        (h = F.prototype = new D()),
            (h.constructor = F),
            (h.kill()._gc = !1),
            (h._first = h._last = h._recent = null),
            (h._sortChildren = !1),
            (h.add = h.insert = function(a, b, c, d) {
                var e, f;
                if (
                    ((a._startTime = Number(b || 0) + a._delay),
                    a._paused && this !== a._timeline && (a._pauseTime = a._startTime + (this.rawTime() - a._startTime) / a._timeScale),
                    a.timeline && a.timeline._remove(a, !0),
                    (a.timeline = a._timeline = this),
                    a._gc && a._enabled(!0, !0),
                    (e = this._last),
                    this._sortChildren)
                )
                    for (f = a._startTime; e && e._startTime > f; ) e = e._prev;
                return (
                    e ? ((a._next = e._next), (e._next = a)) : ((a._next = this._first), (this._first = a)),
                    a._next ? (a._next._prev = a) : (this._last = a),
                    (a._prev = e),
                    (this._recent = a),
                    this._timeline && this._uncache(!0),
                    this
                );
            }),
            (h._remove = function(a, b) {
                return (
                    a.timeline === this &&
                        (b || a._enabled(!1, !0),
                        a._prev ? (a._prev._next = a._next) : this._first === a && (this._first = a._next),
                        a._next ? (a._next._prev = a._prev) : this._last === a && (this._last = a._prev),
                        (a._next = a._prev = a.timeline = null),
                        a === this._recent && (this._recent = this._last),
                        this._timeline && this._uncache(!0)),
                    this
                );
            }),
            (h.render = function(a, b, c) {
                var d,
                    e = this._first;
                for (this._totalTime = this._time = this._rawPrevTime = a; e; )
                    (d = e._next),
                        (e._active || (a >= e._startTime && !e._paused && !e._gc)) &&
                            (e._reversed
                                ? e.render((e._dirty ? e.totalDuration() : e._totalDuration) - (a - e._startTime) * e._timeScale, b, c)
                                : e.render((a - e._startTime) * e._timeScale, b, c)),
                        (e = d);
            }),
            (h.rawTime = function() {
                return j || i.wake(), this._totalTime;
            });
        var G = t(
                "TweenLite",
                function(b, c, d) {
                    if ((D.call(this, c, d), (this.render = G.prototype.render), null == b)) throw "Cannot tween a null target.";
                    this.target = b = "string" != typeof b ? b : G.selector(b) || b;
                    var e,
                        f,
                        g,
                        h = b.jquery || (b.length && b !== a && b[0] && (b[0] === a || (b[0].nodeType && b[0].style && !b.nodeType))),
                        i = this.vars.overwrite;
                    if (
                        ((this._overwrite = i = null == i ? V[G.defaultOverwrite] : "number" == typeof i ? i >> 0 : V[i]),
                        (h || b instanceof Array || (b.push && p(b))) && "number" != typeof b[0])
                    )
                        for (this._targets = g = n(b), this._propLookup = [], this._siblings = [], e = 0; e < g.length; e++)
                            (f = g[e]),
                                f
                                    ? "string" != typeof f
                                        ? f.length && f !== a && f[0] && (f[0] === a || (f[0].nodeType && f[0].style && !f.nodeType))
                                            ? (g.splice(e--, 1), (this._targets = g = g.concat(n(f))))
                                            : ((this._siblings[e] = $(f, this, !1)), 1 === i && this._siblings[e].length > 1 && aa(f, this, null, 1, this._siblings[e]))
                                        : ((f = g[e--] = G.selector(f)), "string" == typeof f && g.splice(e + 1, 1))
                                    : g.splice(e--, 1);
                    else (this._propLookup = {}), (this._siblings = $(b, this, !1)), 1 === i && this._siblings.length > 1 && aa(b, this, null, 1, this._siblings);
                    (this.vars.immediateRender || (0 === c && 0 === this._delay && this.vars.immediateRender !== !1)) &&
                        ((this._time = -m), this.render(Math.min(0, -this._delay)));
                },
                !0
            ),
            H = function(b) {
                return b && b.length && b !== a && b[0] && (b[0] === a || (b[0].nodeType && b[0].style && !b.nodeType));
            },
            I = function(a, b) {
                var c,
                    d = {};
                for (c in a)
                    U[c] ||
                        (c in b && "transform" !== c && "x" !== c && "y" !== c && "width" !== c && "height" !== c && "className" !== c && "border" !== c) ||
                        !(!R[c] || (R[c] && R[c]._autoCSS)) ||
                        ((d[c] = a[c]), delete a[c]);
                a.css = d;
            };
        (h = G.prototype = new D()),
            (h.constructor = G),
            (h.kill()._gc = !1),
            (h.ratio = 0),
            (h._firstPT = h._targets = h._overwrittenProps = h._startAt = null),
            (h._notifyPluginsOfEnabled = h._lazy = !1),
            (G.version = "1.20.3"),
            (G.defaultEase = h._ease = new v(null, null, 1, 1)),
            (G.defaultOverwrite = "auto"),
            (G.ticker = i),
            (G.autoSleep = 120),
            (G.lagSmoothing = function(a, b) {
                i.lagSmoothing(a, b);
            }),
            (G.selector =
                a.$ ||
                a.jQuery ||
                function(b) {
                    var c = a.$ || a.jQuery;
                    return c
                        ? ((G.selector = c), c(b))
                        : "undefined" == typeof d
                        ? b
                        : d.querySelectorAll
                        ? d.querySelectorAll(b)
                        : d.getElementById("#" === b.charAt(0) ? b.substr(1) : b);
                });
        var J = [],
            K = {},
            L = /(?:(-|-=|\+=)?\d*\.?\d*(?:e[\-+]?\d+)?)[0-9]/gi,
            M = /[\+-]=-?[\.\d]/,
            N = function(a) {
                for (var b, c = this._firstPT, d = 1e-6; c; )
                    (b = c.blob ? (1 === a && null != this.end ? this.end : a ? this.join("") : this.start) : c.c * a + c.s),
                        c.m ? (b = c.m(b, this._target || c.t)) : d > b && b > -d && !c.blob && (b = 0),
                        c.f ? (c.fp ? c.t[c.p](c.fp, b) : c.t[c.p](b)) : (c.t[c.p] = b),
                        (c = c._next);
            },
            O = function(a, b, c, d) {
                var e,
                    f,
                    g,
                    h,
                    i,
                    j,
                    k,
                    l = [],
                    m = 0,
                    n = "",
                    o = 0;
                for (
                    l.start = a,
                        l.end = b,
                        a = l[0] = a + "",
                        b = l[1] = b + "",
                        c && (c(l), (a = l[0]), (b = l[1])),
                        l.length = 0,
                        e = a.match(L) || [],
                        f = b.match(L) || [],
                        d && ((d._next = null), (d.blob = 1), (l._firstPT = l._applyPT = d)),
                        i = f.length,
                        h = 0;
                    i > h;
                    h++
                )
                    (k = f[h]),
                        (j = b.substr(m, b.indexOf(k, m) - m)),
                        (n += j || !h ? j : ","),
                        (m += j.length),
                        o ? (o = (o + 1) % 5) : "rgba(" === j.substr(-5) && (o = 1),
                        k === e[h] || e.length <= h
                            ? (n += k)
                            : (n && (l.push(n), (n = "")),
                              (g = parseFloat(e[h])),
                              l.push(g),
                              (l._firstPT = {
                                  _next: l._firstPT,
                                  t: l,
                                  p: l.length - 1,
                                  s: g,
                                  c: ("=" === k.charAt(1) ? parseInt(k.charAt(0) + "1", 10) * parseFloat(k.substr(2)) : parseFloat(k) - g) || 0,
                                  f: 0,
                                  m: o && 4 > o ? Math.round : 0
                              })),
                        (m += k.length);
                return (n += b.substr(m)), n && l.push(n), (l.setRatio = N), M.test(b) && (l.end = null), l;
            },
            P = function(a, b, c, d, e, f, g, h, i) {
                "function" == typeof d && (d = d(i || 0, a));
                var j,
                    k = typeof a[b],
                    l = "function" !== k ? "" : b.indexOf("set") || "function" != typeof a["get" + b.substr(3)] ? b : "get" + b.substr(3),
                    m = "get" !== c ? c : l ? (g ? a[l](g) : a[l]()) : a[b],
                    n = "string" == typeof d && "=" === d.charAt(1),
                    o = {
                        t: a,
                        p: b,
                        s: m,
                        f: "function" === k,
                        pg: 0,
                        n: e || b,
                        m: f ? ("function" == typeof f ? f : Math.round) : 0,
                        pr: 0,
                        c: n ? parseInt(d.charAt(0) + "1", 10) * parseFloat(d.substr(2)) : parseFloat(d) - m || 0
                    };
                return (
                    ("number" != typeof m || ("number" != typeof d && !n)) &&
                        (g || isNaN(m) || (!n && isNaN(d)) || "boolean" == typeof m || "boolean" == typeof d
                            ? ((o.fp = g),
                              (j = O(m, n ? parseFloat(o.s) + o.c : d, h || G.defaultStringFilter, o)),
                              (o = { t: j, p: "setRatio", s: 0, c: 1, f: 2, pg: 0, n: e || b, pr: 0, m: 0 }))
                            : ((o.s = parseFloat(m)), n || (o.c = parseFloat(d) - o.s || 0))),
                    o.c ? ((o._next = this._firstPT) && (o._next._prev = o), (this._firstPT = o), o) : void 0
                );
            },
            Q = (G._internals = { isArray: p, isSelector: H, lazyTweens: J, blobDif: O }),
            R = (G._plugins = {}),
            S = (Q.tweenLookup = {}),
            T = 0,
            U = (Q.reservedProps = {
                ease: 1,
                delay: 1,
                overwrite: 1,
                onComplete: 1,
                onCompleteParams: 1,
                onCompleteScope: 1,
                useFrames: 1,
                runBackwards: 1,
                startAt: 1,
                onUpdate: 1,
                onUpdateParams: 1,
                onUpdateScope: 1,
                onStart: 1,
                onStartParams: 1,
                onStartScope: 1,
                onReverseComplete: 1,
                onReverseCompleteParams: 1,
                onReverseCompleteScope: 1,
                onRepeat: 1,
                onRepeatParams: 1,
                onRepeatScope: 1,
                easeParams: 1,
                yoyo: 1,
                immediateRender: 1,
                repeat: 1,
                repeatDelay: 1,
                data: 1,
                paused: 1,
                reversed: 1,
                autoCSS: 1,
                lazy: 1,
                onOverwrite: 1,
                callbackScope: 1,
                stringFilter: 1,
                id: 1,
                yoyoEase: 1
            }),
            V = { none: 0, all: 1, auto: 2, concurrent: 3, allOnStart: 4, preexisting: 5, true: 1, false: 0 },
            W = (D._rootFramesTimeline = new F()),
            X = (D._rootTimeline = new F()),
            Y = 30,
            Z = (Q.lazyRender = function() {
                var a,
                    b = J.length;
                for (K = {}; --b > -1; ) (a = J[b]), a && a._lazy !== !1 && (a.render(a._lazy[0], a._lazy[1], !0), (a._lazy = !1));
                J.length = 0;
            });
        (X._startTime = i.time),
            (W._startTime = i.frame),
            (X._active = W._active = !0),
            setTimeout(Z, 1),
            (D._updateRoot = G.render = function() {
                var a, b, c;
                if (
                    (J.length && Z(),
                    X.render((i.time - X._startTime) * X._timeScale, !1, !1),
                    W.render((i.frame - W._startTime) * W._timeScale, !1, !1),
                    J.length && Z(),
                    i.frame >= Y)
                ) {
                    Y = i.frame + (parseInt(G.autoSleep, 10) || 120);
                    for (c in S) {
                        for (b = S[c].tweens, a = b.length; --a > -1; ) b[a]._gc && b.splice(a, 1);
                        0 === b.length && delete S[c];
                    }
                    if (((c = X._first), (!c || c._paused) && G.autoSleep && !W._first && 1 === i._listeners.tick.length)) {
                        for (; c && c._paused; ) c = c._next;
                        c || i.sleep();
                    }
                }
            }),
            i.addEventListener("tick", D._updateRoot);
        var $ = function(a, b, c) {
                var d,
                    e,
                    f = a._gsTweenID;
                if ((S[f || (a._gsTweenID = f = "t" + T++)] || (S[f] = { target: a, tweens: [] }), b && ((d = S[f].tweens), (d[(e = d.length)] = b), c)))
                    for (; --e > -1; ) d[e] === b && d.splice(e, 1);
                return S[f].tweens;
            },
            _ = function(a, b, c, d) {
                var e,
                    f,
                    g = a.vars.onOverwrite;
                return g && (e = g(a, b, c, d)), (g = G.onOverwrite), g && (f = g(a, b, c, d)), e !== !1 && f !== !1;
            },
            aa = function(a, b, c, d, e) {
                var f, g, h, i;
                if (1 === d || d >= 4) {
                    for (i = e.length, f = 0; i > f; f++)
                        if ((h = e[f]) !== b) h._gc || (h._kill(null, a, b) && (g = !0));
                        else if (5 === d) break;
                    return g;
                }
                var j,
                    k = b._startTime + m,
                    l = [],
                    n = 0,
                    o = 0 === b._duration;
                for (f = e.length; --f > -1; )
                    (h = e[f]) === b ||
                        h._gc ||
                        h._paused ||
                        (h._timeline !== b._timeline
                            ? ((j = j || ba(b, 0, o)), 0 === ba(h, j, o) && (l[n++] = h))
                            : h._startTime <= k && h._startTime + h.totalDuration() / h._timeScale > k && (((o || !h._initted) && k - h._startTime <= 2e-10) || (l[n++] = h)));
                for (f = n; --f > -1; )
                    if (((h = l[f]), 2 === d && h._kill(c, a, b) && (g = !0), 2 !== d || (!h._firstPT && h._initted))) {
                        if (2 !== d && !_(h, b)) continue;
                        h._enabled(!1, !1) && (g = !0);
                    }
                return g;
            },
            ba = function(a, b, c) {
                for (var d = a._timeline, e = d._timeScale, f = a._startTime; d._timeline; ) {
                    if (((f += d._startTime), (e *= d._timeScale), d._paused)) return -100;
                    d = d._timeline;
                }
                return (f /= e), f > b ? f - b : (c && f === b) || (!a._initted && 2 * m > f - b) ? m : (f += a.totalDuration() / a._timeScale / e) > b + m ? 0 : f - b - m;
            };
        (h._init = function() {
            var a,
                b,
                c,
                d,
                e,
                f,
                g = this.vars,
                h = this._overwrittenProps,
                i = this._duration,
                j = !!g.immediateRender,
                k = g.ease;
            if (g.startAt) {
                this._startAt && (this._startAt.render(-1, !0), this._startAt.kill()), (e = {});
                for (d in g.startAt) e[d] = g.startAt[d];
                if (
                    ((e.data = "isStart"),
                    (e.overwrite = !1),
                    (e.immediateRender = !0),
                    (e.lazy = j && g.lazy !== !1),
                    (e.startAt = e.delay = null),
                    (e.onUpdate = g.onUpdate),
                    (e.onUpdateParams = g.onUpdateParams),
                    (e.onUpdateScope = g.onUpdateScope || g.callbackScope || this),
                    (this._startAt = G.to(this.target, 0, e)),
                    j)
                )
                    if (this._time > 0) this._startAt = null;
                    else if (0 !== i) return;
            } else if (g.runBackwards && 0 !== i)
                if (this._startAt) this._startAt.render(-1, !0), this._startAt.kill(), (this._startAt = null);
                else {
                    0 !== this._time && (j = !1), (c = {});
                    for (d in g) (U[d] && "autoCSS" !== d) || (c[d] = g[d]);
                    if (((c.overwrite = 0), (c.data = "isFromStart"), (c.lazy = j && g.lazy !== !1), (c.immediateRender = j), (this._startAt = G.to(this.target, 0, c)), j)) {
                        if (0 === this._time) return;
                    } else this._startAt._init(), this._startAt._enabled(!1), this.vars.immediateRender && (this._startAt = null);
                }
            if (
                ((this._ease = k = k ? (k instanceof v ? k : "function" == typeof k ? new v(k, g.easeParams) : w[k] || G.defaultEase) : G.defaultEase),
                g.easeParams instanceof Array && k.config && (this._ease = k.config.apply(k, g.easeParams)),
                (this._easeType = this._ease._type),
                (this._easePower = this._ease._power),
                (this._firstPT = null),
                this._targets)
            )
                for (f = this._targets.length, a = 0; f > a; a++) this._initProps(this._targets[a], (this._propLookup[a] = {}), this._siblings[a], h ? h[a] : null, a) && (b = !0);
            else b = this._initProps(this.target, this._propLookup, this._siblings, h, 0);
            if ((b && G._onPluginEvent("_onInitAllProps", this), h && (this._firstPT || ("function" != typeof this.target && this._enabled(!1, !1))), g.runBackwards))
                for (c = this._firstPT; c; ) (c.s += c.c), (c.c = -c.c), (c = c._next);
            (this._onUpdate = g.onUpdate), (this._initted = !0);
        }),
            (h._initProps = function(b, c, d, e, f) {
                var g, h, i, j, k, l;
                if (null == b) return !1;
                K[b._gsTweenID] && Z(), this.vars.css || (b.style && b !== a && b.nodeType && R.css && this.vars.autoCSS !== !1 && I(this.vars, b));
                for (g in this.vars)
                    if (((l = this.vars[g]), U[g]))
                        l && (l instanceof Array || (l.push && p(l))) && -1 !== l.join("").indexOf("{self}") && (this.vars[g] = l = this._swapSelfInParams(l, this));
                    else if (R[g] && (j = new R[g]())._onInitTween(b, this.vars[g], this, f)) {
                        for (
                            this._firstPT = k = { _next: this._firstPT, t: j, p: "setRatio", s: 0, c: 1, f: 1, n: g, pg: 1, pr: j._priority, m: 0 }, h = j._overwriteProps.length;
                            --h > -1;

                        )
                            c[j._overwriteProps[h]] = this._firstPT;
                        (j._priority || j._onInitAllProps) && (i = !0), (j._onDisable || j._onEnable) && (this._notifyPluginsOfEnabled = !0), k._next && (k._next._prev = k);
                    } else c[g] = P.call(this, b, g, "get", l, g, 0, null, this.vars.stringFilter, f);
                return e && this._kill(e, b)
                    ? this._initProps(b, c, d, e, f)
                    : this._overwrite > 1 && this._firstPT && d.length > 1 && aa(b, this, c, this._overwrite, d)
                    ? (this._kill(c, b), this._initProps(b, c, d, e, f))
                    : (this._firstPT && ((this.vars.lazy !== !1 && this._duration) || (this.vars.lazy && !this._duration)) && (K[b._gsTweenID] = !0), i);
            }),
            (h.render = function(a, b, c) {
                var d,
                    e,
                    f,
                    g,
                    h = this._time,
                    i = this._duration,
                    j = this._rawPrevTime;
                if (a >= i - 1e-7 && a >= 0)
                    (this._totalTime = this._time = i),
                        (this.ratio = this._ease._calcEnd ? this._ease.getRatio(1) : 1),
                        this._reversed || ((d = !0), (e = "onComplete"), (c = c || this._timeline.autoRemoveChildren)),
                        0 === i &&
                            (this._initted || !this.vars.lazy || c) &&
                            (this._startTime === this._timeline._duration && (a = 0),
                            (0 > j || (0 >= a && a >= -1e-7) || (j === m && "isPause" !== this.data)) && j !== a && ((c = !0), j > m && (e = "onReverseComplete")),
                            (this._rawPrevTime = g = !b || a || j === a ? a : m));
                else if (1e-7 > a)
                    (this._totalTime = this._time = 0),
                        (this.ratio = this._ease._calcEnd ? this._ease.getRatio(0) : 0),
                        (0 !== h || (0 === i && j > 0)) && ((e = "onReverseComplete"), (d = this._reversed)),
                        0 > a &&
                            ((this._active = !1),
                            0 === i &&
                                (this._initted || !this.vars.lazy || c) &&
                                (j >= 0 && (j !== m || "isPause" !== this.data) && (c = !0), (this._rawPrevTime = g = !b || a || j === a ? a : m))),
                        (!this._initted || (this._startAt && this._startAt.progress())) && (c = !0);
                else if (((this._totalTime = this._time = a), this._easeType)) {
                    var k = a / i,
                        l = this._easeType,
                        n = this._easePower;
                    (1 === l || (3 === l && k >= 0.5)) && (k = 1 - k),
                        3 === l && (k *= 2),
                        1 === n ? (k *= k) : 2 === n ? (k *= k * k) : 3 === n ? (k *= k * k * k) : 4 === n && (k *= k * k * k * k),
                        1 === l ? (this.ratio = 1 - k) : 2 === l ? (this.ratio = k) : 0.5 > a / i ? (this.ratio = k / 2) : (this.ratio = 1 - k / 2);
                } else this.ratio = this._ease.getRatio(a / i);
                if (this._time !== h || c) {
                    if (!this._initted) {
                        if ((this._init(), !this._initted || this._gc)) return;
                        if (!c && this._firstPT && ((this.vars.lazy !== !1 && this._duration) || (this.vars.lazy && !this._duration)))
                            return (this._time = this._totalTime = h), (this._rawPrevTime = j), J.push(this), void (this._lazy = [a, b]);
                        this._time && !d
                            ? (this.ratio = this._ease.getRatio(this._time / i))
                            : d && this._ease._calcEnd && (this.ratio = this._ease.getRatio(0 === this._time ? 0 : 1));
                    }
                    for (
                        this._lazy !== !1 && (this._lazy = !1),
                            this._active || (!this._paused && this._time !== h && a >= 0 && (this._active = !0)),
                            0 === h &&
                                (this._startAt && (a >= 0 ? this._startAt.render(a, !0, c) : e || (e = "_dummyGS")),
                                this.vars.onStart && (0 !== this._time || 0 === i) && (b || this._callback("onStart"))),
                            f = this._firstPT;
                        f;

                    )
                        f.f ? f.t[f.p](f.c * this.ratio + f.s) : (f.t[f.p] = f.c * this.ratio + f.s), (f = f._next);
                    this._onUpdate && (0 > a && this._startAt && a !== -1e-4 && this._startAt.render(a, !0, c), b || ((this._time !== h || d || c) && this._callback("onUpdate"))),
                        e &&
                            (!this._gc || c) &&
                            (0 > a && this._startAt && !this._onUpdate && a !== -1e-4 && this._startAt.render(a, !0, c),
                            d && (this._timeline.autoRemoveChildren && this._enabled(!1, !1), (this._active = !1)),
                            !b && this.vars[e] && this._callback(e),
                            0 === i && this._rawPrevTime === m && g !== m && (this._rawPrevTime = 0));
                }
            }),
            (h._kill = function(a, b, c) {
                if (("all" === a && (a = null), null == a && (null == b || b === this.target))) return (this._lazy = !1), this._enabled(!1, !1);
                b = "string" != typeof b ? b || this._targets || this.target : G.selector(b) || b;
                var d,
                    e,
                    f,
                    g,
                    h,
                    i,
                    j,
                    k,
                    l,
                    m = c && this._time && c._startTime === this._startTime && this._timeline === c._timeline;
                if ((p(b) || H(b)) && "number" != typeof b[0]) for (d = b.length; --d > -1; ) this._kill(a, b[d], c) && (i = !0);
                else {
                    if (this._targets) {
                        for (d = this._targets.length; --d > -1; )
                            if (b === this._targets[d]) {
                                (h = this._propLookup[d] || {}),
                                    (this._overwrittenProps = this._overwrittenProps || []),
                                    (e = this._overwrittenProps[d] = a ? this._overwrittenProps[d] || {} : "all");
                                break;
                            }
                    } else {
                        if (b !== this.target) return !1;
                        (h = this._propLookup), (e = this._overwrittenProps = a ? this._overwrittenProps || {} : "all");
                    }
                    if (h) {
                        if (((j = a || h), (k = a !== e && "all" !== e && a !== h && ("object" != typeof a || !a._tempKill)), c && (G.onOverwrite || this.vars.onOverwrite))) {
                            for (f in j) h[f] && (l || (l = []), l.push(f));
                            if ((l || !a) && !_(this, c, b, l)) return !1;
                        }
                        for (f in j)
                            (g = h[f]) &&
                                (m && (g.f ? g.t[g.p](g.s) : (g.t[g.p] = g.s), (i = !0)),
                                g.pg && g.t._kill(j) && (i = !0),
                                (g.pg && 0 !== g.t._overwriteProps.length) ||
                                    (g._prev ? (g._prev._next = g._next) : g === this._firstPT && (this._firstPT = g._next),
                                    g._next && (g._next._prev = g._prev),
                                    (g._next = g._prev = null)),
                                delete h[f]),
                                k && (e[f] = 1);
                        !this._firstPT && this._initted && this._enabled(!1, !1);
                    }
                }
                return i;
            }),
            (h.invalidate = function() {
                return (
                    this._notifyPluginsOfEnabled && G._onPluginEvent("_onDisable", this),
                    (this._firstPT = this._overwrittenProps = this._startAt = this._onUpdate = null),
                    (this._notifyPluginsOfEnabled = this._active = this._lazy = !1),
                    (this._propLookup = this._targets ? {} : []),
                    D.prototype.invalidate.call(this),
                    this.vars.immediateRender && ((this._time = -m), this.render(Math.min(0, -this._delay))),
                    this
                );
            }),
            (h._enabled = function(a, b) {
                if ((j || i.wake(), a && this._gc)) {
                    var c,
                        d = this._targets;
                    if (d) for (c = d.length; --c > -1; ) this._siblings[c] = $(d[c], this, !0);
                    else this._siblings = $(this.target, this, !0);
                }
                return D.prototype._enabled.call(this, a, b), this._notifyPluginsOfEnabled && this._firstPT ? G._onPluginEvent(a ? "_onEnable" : "_onDisable", this) : !1;
            }),
            (G.to = function(a, b, c) {
                return new G(a, b, c);
            }),
            (G.from = function(a, b, c) {
                return (c.runBackwards = !0), (c.immediateRender = 0 != c.immediateRender), new G(a, b, c);
            }),
            (G.fromTo = function(a, b, c, d) {
                return (d.startAt = c), (d.immediateRender = 0 != d.immediateRender && 0 != c.immediateRender), new G(a, b, d);
            }),
            (G.delayedCall = function(a, b, c, d, e) {
                return new G(b, 0, {
                    delay: a,
                    onComplete: b,
                    onCompleteParams: c,
                    callbackScope: d,
                    onReverseComplete: b,
                    onReverseCompleteParams: c,
                    immediateRender: !1,
                    lazy: !1,
                    useFrames: e,
                    overwrite: 0
                });
            }),
            (G.set = function(a, b) {
                return new G(a, 0, b);
            }),
            (G.getTweensOf = function(a, b) {
                if (null == a) return [];
                a = "string" != typeof a ? a : G.selector(a) || a;
                var c, d, e, f;
                if ((p(a) || H(a)) && "number" != typeof a[0]) {
                    for (c = a.length, d = []; --c > -1; ) d = d.concat(G.getTweensOf(a[c], b));
                    for (c = d.length; --c > -1; ) for (f = d[c], e = c; --e > -1; ) f === d[e] && d.splice(c, 1);
                } else if (a._gsTweenID) for (d = $(a).concat(), c = d.length; --c > -1; ) (d[c]._gc || (b && !d[c].isActive())) && d.splice(c, 1);
                return d || [];
            }),
            (G.killTweensOf = G.killDelayedCallsTo = function(a, b, c) {
                "object" == typeof b && ((c = b), (b = !1));
                for (var d = G.getTweensOf(a, b), e = d.length; --e > -1; ) d[e]._kill(c, a);
            });
        var ca = t(
            "plugins.TweenPlugin",
            function(a, b) {
                (this._overwriteProps = (a || "").split(",")), (this._propName = this._overwriteProps[0]), (this._priority = b || 0), (this._super = ca.prototype);
            },
            !0
        );
        if (
            ((h = ca.prototype),
            (ca.version = "1.19.0"),
            (ca.API = 2),
            (h._firstPT = null),
            (h._addTween = P),
            (h.setRatio = N),
            (h._kill = function(a) {
                var b,
                    c = this._overwriteProps,
                    d = this._firstPT;
                if (null != a[this._propName]) this._overwriteProps = [];
                else for (b = c.length; --b > -1; ) null != a[c[b]] && c.splice(b, 1);
                for (; d; )
                    null != a[d.n] &&
                        (d._next && (d._next._prev = d._prev), d._prev ? ((d._prev._next = d._next), (d._prev = null)) : this._firstPT === d && (this._firstPT = d._next)),
                        (d = d._next);
                return !1;
            }),
            (h._mod = h._roundProps = function(a) {
                for (var b, c = this._firstPT; c; )
                    (b = a[this._propName] || (null != c.n && a[c.n.split(this._propName + "_").join("")])),
                        b && "function" == typeof b && (2 === c.f ? (c.t._applyPT.m = b) : (c.m = b)),
                        (c = c._next);
            }),
            (G._onPluginEvent = function(a, b) {
                var c,
                    d,
                    e,
                    f,
                    g,
                    h = b._firstPT;
                if ("_onInitAllProps" === a) {
                    for (; h; ) {
                        for (g = h._next, d = e; d && d.pr > h.pr; ) d = d._next;
                        (h._prev = d ? d._prev : f) ? (h._prev._next = h) : (e = h), (h._next = d) ? (d._prev = h) : (f = h), (h = g);
                    }
                    h = b._firstPT = e;
                }
                for (; h; ) h.pg && "function" == typeof h.t[a] && h.t[a]() && (c = !0), (h = h._next);
                return c;
            }),
            (ca.activate = function(a) {
                for (var b = a.length; --b > -1; ) a[b].API === ca.API && (R[new a[b]()._propName] = a[b]);
                return !0;
            }),
            (s.plugin = function(a) {
                if (!(a && a.propName && a.init && a.API)) throw "illegal plugin definition.";
                var b,
                    c = a.propName,
                    d = a.priority || 0,
                    e = a.overwriteProps,
                    f = { init: "_onInitTween", set: "setRatio", kill: "_kill", round: "_mod", mod: "_mod", initAll: "_onInitAllProps" },
                    g = t(
                        "plugins." + c.charAt(0).toUpperCase() + c.substr(1) + "Plugin",
                        function() {
                            ca.call(this, c, d), (this._overwriteProps = e || []);
                        },
                        a.global === !0
                    ),
                    h = (g.prototype = new ca(c));
                (h.constructor = g), (g.API = a.API);
                for (b in f) "function" == typeof a[b] && (h[f[b]] = a[b]);
                return (g.version = a.version), ca.activate([g]), g;
            }),
            (f = a._gsQueue))
        ) {
            for (g = 0; g < f.length; g++) f[g]();
            for (h in q) q[h].func || a.console.log("GSAP encountered missing dependency: " + h);
        }
        j = !1;
    }
})("undefined" != typeof module && module.exports && "undefined" != typeof global ? global : this || window, "TweenLite");
wwplayer.define(
    "TweenLite",
    (function(global) {
        return function() {
            var ret, fn;
            return ret || global.TweenLite;
        };
    })(this)
);

/*!
 * VERSION: 1.20.3
 * DATE: 2017-10-02
 * UPDATES AND DOCS AT: http://greensock.com
 *
 * @license Copyright (c) 2008-2017, GreenSock. All rights reserved.
 * This work is subject to the terms at http://greensock.com/standard-license or for
 * Club GreenSock members, the software agreement that was issued with your membership.
 *
 * @author: Jack Doyle, jack@greensock.com
 */
var _gsScope = "undefined" != typeof module && module.exports && "undefined" != typeof global ? global : this || window;
(_gsScope._gsQueue || (_gsScope._gsQueue = [])).push(function() {
    "use strict";
    _gsScope._gsDefine(
        "TimelineLite",
        ["core.Animation", "core.SimpleTimeline", "TweenLite"],
        function(a, b, c) {
            var d = function(a) {
                    b.call(this, a),
                        (this._labels = {}),
                        (this.autoRemoveChildren = this.vars.autoRemoveChildren === !0),
                        (this.smoothChildTiming = this.vars.smoothChildTiming === !0),
                        (this._sortChildren = !0),
                        (this._onUpdate = this.vars.onUpdate);
                    var c,
                        d,
                        e = this.vars;
                    for (d in e) (c = e[d]), i(c) && -1 !== c.join("").indexOf("{self}") && (e[d] = this._swapSelfInParams(c));
                    i(e.tweens) && this.add(e.tweens, 0, e.align, e.stagger);
                },
                e = 1e-10,
                f = c._internals,
                g = (d._internals = {}),
                h = f.isSelector,
                i = f.isArray,
                j = f.lazyTweens,
                k = f.lazyRender,
                l = _gsScope._gsDefine.globals,
                m = function(a) {
                    var b,
                        c = {};
                    for (b in a) c[b] = a[b];
                    return c;
                },
                n = function(a, b, c) {
                    var d,
                        e,
                        f = a.cycle;
                    for (d in f) (e = f[d]), (a[d] = "function" == typeof e ? e(c, b[c]) : e[c % e.length]);
                    delete a.cycle;
                },
                o = (g.pauseCallback = function() {}),
                p = function(a) {
                    var b,
                        c = [],
                        d = a.length;
                    for (b = 0; b !== d; c.push(a[b++]));
                    return c;
                },
                q = (d.prototype = new b());
            return (
                (d.version = "1.20.3"),
                (q.constructor = d),
                (q.kill()._gc = q._forcingPlayhead = q._hasPause = !1),
                (q.to = function(a, b, d, e) {
                    var f = (d.repeat && l.TweenMax) || c;
                    return b ? this.add(new f(a, b, d), e) : this.set(a, d, e);
                }),
                (q.from = function(a, b, d, e) {
                    return this.add(((d.repeat && l.TweenMax) || c).from(a, b, d), e);
                }),
                (q.fromTo = function(a, b, d, e, f) {
                    var g = (e.repeat && l.TweenMax) || c;
                    return b ? this.add(g.fromTo(a, b, d, e), f) : this.set(a, e, f);
                }),
                (q.staggerTo = function(a, b, e, f, g, i, j, k) {
                    var l,
                        o,
                        q = new d({ onComplete: i, onCompleteParams: j, callbackScope: k, smoothChildTiming: this.smoothChildTiming }),
                        r = e.cycle;
                    for (
                        "string" == typeof a && (a = c.selector(a) || a), a = a || [], h(a) && (a = p(a)), f = f || 0, 0 > f && ((a = p(a)), a.reverse(), (f *= -1)), o = 0;
                        o < a.length;
                        o++
                    )
                        (l = m(e)),
                            l.startAt && ((l.startAt = m(l.startAt)), l.startAt.cycle && n(l.startAt, a, o)),
                            r && (n(l, a, o), null != l.duration && ((b = l.duration), delete l.duration)),
                            q.to(a[o], b, l, o * f);
                    return this.add(q, g);
                }),
                (q.staggerFrom = function(a, b, c, d, e, f, g, h) {
                    return (c.immediateRender = 0 != c.immediateRender), (c.runBackwards = !0), this.staggerTo(a, b, c, d, e, f, g, h);
                }),
                (q.staggerFromTo = function(a, b, c, d, e, f, g, h, i) {
                    return (d.startAt = c), (d.immediateRender = 0 != d.immediateRender && 0 != c.immediateRender), this.staggerTo(a, b, d, e, f, g, h, i);
                }),
                (q.call = function(a, b, d, e) {
                    return this.add(c.delayedCall(0, a, b, d), e);
                }),
                (q.set = function(a, b, d) {
                    return (
                        (d = this._parseTimeOrLabel(d, 0, !0)), null == b.immediateRender && (b.immediateRender = d === this._time && !this._paused), this.add(new c(a, 0, b), d)
                    );
                }),
                (d.exportRoot = function(a, b) {
                    (a = a || {}), null == a.smoothChildTiming && (a.smoothChildTiming = !0);
                    var e,
                        f,
                        g,
                        h,
                        i = new d(a),
                        j = i._timeline;
                    for (null == b && (b = !0), j._remove(i, !0), i._startTime = 0, i._rawPrevTime = i._time = i._totalTime = j._time, g = j._first; g; )
                        (h = g._next), (b && g instanceof c && g.target === g.vars.onComplete) || ((f = g._startTime - g._delay), 0 > f && (e = 1), i.add(g, f)), (g = h);
                    return j.add(i, 0), e && i.totalDuration(), i;
                }),
                (q.add = function(e, f, g, h) {
                    var j, k, l, m, n, o;
                    if (("number" != typeof f && (f = this._parseTimeOrLabel(f, 0, !0, e)), !(e instanceof a))) {
                        if (e instanceof Array || (e && e.push && i(e))) {
                            for (g = g || "normal", h = h || 0, j = f, k = e.length, l = 0; k > l; l++)
                                i((m = e[l])) && (m = new d({ tweens: m })),
                                    this.add(m, j),
                                    "string" != typeof m &&
                                        "function" != typeof m &&
                                        ("sequence" === g ? (j = m._startTime + m.totalDuration() / m._timeScale) : "start" === g && (m._startTime -= m.delay())),
                                    (j += h);
                            return this._uncache(!0);
                        }
                        if ("string" == typeof e) return this.addLabel(e, f);
                        if ("function" != typeof e) throw "Cannot add " + e + " into the timeline; it is not a tween, timeline, function, or string.";
                        e = c.delayedCall(0, e);
                    }
                    if (
                        (b.prototype.add.call(this, e, f),
                        e._time && e.render((this.rawTime() - e._startTime) * e._timeScale, !1, !1),
                        (this._gc || this._time === this._duration) && !this._paused && this._duration < this.duration())
                    )
                        for (n = this, o = n.rawTime() > e._startTime; n._timeline; )
                            o && n._timeline.smoothChildTiming ? n.totalTime(n._totalTime, !0) : n._gc && n._enabled(!0, !1), (n = n._timeline);
                    return this;
                }),
                (q.remove = function(b) {
                    if (b instanceof a) {
                        this._remove(b, !1);
                        var c = (b._timeline = b.vars.useFrames ? a._rootFramesTimeline : a._rootTimeline);
                        return (b._startTime = (b._paused ? b._pauseTime : c._time) - (b._reversed ? b.totalDuration() - b._totalTime : b._totalTime) / b._timeScale), this;
                    }
                    if (b instanceof Array || (b && b.push && i(b))) {
                        for (var d = b.length; --d > -1; ) this.remove(b[d]);
                        return this;
                    }
                    return "string" == typeof b ? this.removeLabel(b) : this.kill(null, b);
                }),
                (q._remove = function(a, c) {
                    b.prototype._remove.call(this, a, c);
                    var d = this._last;
                    return (
                        d
                            ? this._time > this.duration() && ((this._time = this._duration), (this._totalTime = this._totalDuration))
                            : (this._time = this._totalTime = this._duration = this._totalDuration = 0),
                        this
                    );
                }),
                (q.append = function(a, b) {
                    return this.add(a, this._parseTimeOrLabel(null, b, !0, a));
                }),
                (q.insert = q.insertMultiple = function(a, b, c, d) {
                    return this.add(a, b || 0, c, d);
                }),
                (q.appendMultiple = function(a, b, c, d) {
                    return this.add(a, this._parseTimeOrLabel(null, b, !0, a), c, d);
                }),
                (q.addLabel = function(a, b) {
                    return (this._labels[a] = this._parseTimeOrLabel(b)), this;
                }),
                (q.addPause = function(a, b, d, e) {
                    var f = c.delayedCall(0, o, d, e || this);
                    return (f.vars.onComplete = f.vars.onReverseComplete = b), (f.data = "isPause"), (this._hasPause = !0), this.add(f, a);
                }),
                (q.removeLabel = function(a) {
                    return delete this._labels[a], this;
                }),
                (q.getLabelTime = function(a) {
                    return null != this._labels[a] ? this._labels[a] : -1;
                }),
                (q._parseTimeOrLabel = function(b, c, d, e) {
                    var f, g;
                    if (e instanceof a && e.timeline === this) this.remove(e);
                    else if (e && (e instanceof Array || (e.push && i(e)))) for (g = e.length; --g > -1; ) e[g] instanceof a && e[g].timeline === this && this.remove(e[g]);
                    if (((f = "number" != typeof b || c ? (this.duration() > 99999999999 ? this.recent().endTime(!1) : this._duration) : 0), "string" == typeof c))
                        return this._parseTimeOrLabel(c, d && "number" == typeof b && null == this._labels[c] ? b - f : 0, d);
                    if (((c = c || 0), "string" != typeof b || (!isNaN(b) && null == this._labels[b]))) null == b && (b = f);
                    else {
                        if (((g = b.indexOf("=")), -1 === g)) return null == this._labels[b] ? (d ? (this._labels[b] = f + c) : c) : this._labels[b] + c;
                        (c = parseInt(b.charAt(g - 1) + "1", 10) * Number(b.substr(g + 1))), (b = g > 1 ? this._parseTimeOrLabel(b.substr(0, g - 1), 0, d) : f);
                    }
                    return Number(b) + c;
                }),
                (q.seek = function(a, b) {
                    return this.totalTime("number" == typeof a ? a : this._parseTimeOrLabel(a), b !== !1);
                }),
                (q.stop = function() {
                    return this.paused(!0);
                }),
                (q.gotoAndPlay = function(a, b) {
                    return this.play(a, b);
                }),
                (q.gotoAndStop = function(a, b) {
                    return this.pause(a, b);
                }),
                (q.render = function(a, b, c) {
                    this._gc && this._enabled(!0, !1);
                    var d,
                        f,
                        g,
                        h,
                        i,
                        l,
                        m,
                        n = this._time,
                        o = this._dirty ? this.totalDuration() : this._totalDuration,
                        p = this._startTime,
                        q = this._timeScale,
                        r = this._paused;
                    if ((n !== this._time && (a += this._time - n), a >= o - 1e-7 && a >= 0))
                        (this._totalTime = this._time = o),
                            this._reversed ||
                                this._hasPausedChild() ||
                                ((f = !0),
                                (h = "onComplete"),
                                (i = !!this._timeline.autoRemoveChildren),
                                0 === this._duration &&
                                    ((0 >= a && a >= -1e-7) || this._rawPrevTime < 0 || this._rawPrevTime === e) &&
                                    this._rawPrevTime !== a &&
                                    this._first &&
                                    ((i = !0), this._rawPrevTime > e && (h = "onReverseComplete"))),
                            (this._rawPrevTime = this._duration || !b || a || this._rawPrevTime === a ? a : e),
                            (a = o + 1e-4);
                    else if (1e-7 > a)
                        if (
                            ((this._totalTime = this._time = 0),
                            (0 !== n || (0 === this._duration && this._rawPrevTime !== e && (this._rawPrevTime > 0 || (0 > a && this._rawPrevTime >= 0)))) &&
                                ((h = "onReverseComplete"), (f = this._reversed)),
                            0 > a)
                        )
                            (this._active = !1),
                                this._timeline.autoRemoveChildren && this._reversed ? ((i = f = !0), (h = "onReverseComplete")) : this._rawPrevTime >= 0 && this._first && (i = !0),
                                (this._rawPrevTime = a);
                        else {
                            if (((this._rawPrevTime = this._duration || !b || a || this._rawPrevTime === a ? a : e), 0 === a && f))
                                for (d = this._first; d && 0 === d._startTime; ) d._duration || (f = !1), (d = d._next);
                            (a = 0), this._initted || (i = !0);
                        }
                    else {
                        if (this._hasPause && !this._forcingPlayhead && !b) {
                            if (a >= n)
                                for (d = this._first; d && d._startTime <= a && !l; )
                                    d._duration || "isPause" !== d.data || d.ratio || (0 === d._startTime && 0 === this._rawPrevTime) || (l = d), (d = d._next);
                            else for (d = this._last; d && d._startTime >= a && !l; ) d._duration || ("isPause" === d.data && d._rawPrevTime > 0 && (l = d)), (d = d._prev);
                            l && ((this._time = a = l._startTime), (this._totalTime = a + this._cycle * (this._totalDuration + this._repeatDelay)));
                        }
                        this._totalTime = this._time = this._rawPrevTime = a;
                    }
                    if ((this._time !== n && this._first) || c || i || l) {
                        if (
                            (this._initted || (this._initted = !0),
                            this._active || (!this._paused && this._time !== n && a > 0 && (this._active = !0)),
                            0 === n && this.vars.onStart && ((0 === this._time && this._duration) || b || this._callback("onStart")),
                            (m = this._time),
                            m >= n)
                        )
                            for (d = this._first; d && ((g = d._next), m === this._time && (!this._paused || r)); )
                                (d._active || (d._startTime <= m && !d._paused && !d._gc)) &&
                                    (l === d && this.pause(),
                                    d._reversed
                                        ? d.render((d._dirty ? d.totalDuration() : d._totalDuration) - (a - d._startTime) * d._timeScale, b, c)
                                        : d.render((a - d._startTime) * d._timeScale, b, c)),
                                    (d = g);
                        else
                            for (d = this._last; d && ((g = d._prev), m === this._time && (!this._paused || r)); ) {
                                if (d._active || (d._startTime <= n && !d._paused && !d._gc)) {
                                    if (l === d) {
                                        for (l = d._prev; l && l.endTime() > this._time; )
                                            l.render(l._reversed ? l.totalDuration() - (a - l._startTime) * l._timeScale : (a - l._startTime) * l._timeScale, b, c), (l = l._prev);
                                        (l = null), this.pause();
                                    }
                                    d._reversed
                                        ? d.render((d._dirty ? d.totalDuration() : d._totalDuration) - (a - d._startTime) * d._timeScale, b, c)
                                        : d.render((a - d._startTime) * d._timeScale, b, c);
                                }
                                d = g;
                            }
                        this._onUpdate && (b || (j.length && k(), this._callback("onUpdate"))),
                            h &&
                                (this._gc ||
                                    ((p === this._startTime || q !== this._timeScale) &&
                                        (0 === this._time || o >= this.totalDuration()) &&
                                        (f && (j.length && k(), this._timeline.autoRemoveChildren && this._enabled(!1, !1), (this._active = !1)),
                                        !b && this.vars[h] && this._callback(h))));
                    }
                }),
                (q._hasPausedChild = function() {
                    for (var a = this._first; a; ) {
                        if (a._paused || (a instanceof d && a._hasPausedChild())) return !0;
                        a = a._next;
                    }
                    return !1;
                }),
                (q.getChildren = function(a, b, d, e) {
                    e = e || -9999999999;
                    for (var f = [], g = this._first, h = 0; g; )
                        g._startTime < e ||
                            (g instanceof c ? b !== !1 && (f[h++] = g) : (d !== !1 && (f[h++] = g), a !== !1 && ((f = f.concat(g.getChildren(!0, b, d))), (h = f.length)))),
                            (g = g._next);
                    return f;
                }),
                (q.getTweensOf = function(a, b) {
                    var d,
                        e,
                        f = this._gc,
                        g = [],
                        h = 0;
                    for (f && this._enabled(!0, !0), d = c.getTweensOf(a), e = d.length; --e > -1; ) (d[e].timeline === this || (b && this._contains(d[e]))) && (g[h++] = d[e]);
                    return f && this._enabled(!1, !0), g;
                }),
                (q.recent = function() {
                    return this._recent;
                }),
                (q._contains = function(a) {
                    for (var b = a.timeline; b; ) {
                        if (b === this) return !0;
                        b = b.timeline;
                    }
                    return !1;
                }),
                (q.shiftChildren = function(a, b, c) {
                    c = c || 0;
                    for (var d, e = this._first, f = this._labels; e; ) e._startTime >= c && (e._startTime += a), (e = e._next);
                    if (b) for (d in f) f[d] >= c && (f[d] += a);
                    return this._uncache(!0);
                }),
                (q._kill = function(a, b) {
                    if (!a && !b) return this._enabled(!1, !1);
                    for (var c = b ? this.getTweensOf(b) : this.getChildren(!0, !0, !1), d = c.length, e = !1; --d > -1; ) c[d]._kill(a, b) && (e = !0);
                    return e;
                }),
                (q.clear = function(a) {
                    var b = this.getChildren(!1, !0, !0),
                        c = b.length;
                    for (this._time = this._totalTime = 0; --c > -1; ) b[c]._enabled(!1, !1);
                    return a !== !1 && (this._labels = {}), this._uncache(!0);
                }),
                (q.invalidate = function() {
                    for (var b = this._first; b; ) b.invalidate(), (b = b._next);
                    return a.prototype.invalidate.call(this);
                }),
                (q._enabled = function(a, c) {
                    if (a === this._gc) for (var d = this._first; d; ) d._enabled(a, !0), (d = d._next);
                    return b.prototype._enabled.call(this, a, c);
                }),
                (q.totalTime = function(b, c, d) {
                    this._forcingPlayhead = !0;
                    var e = a.prototype.totalTime.apply(this, arguments);
                    return (this._forcingPlayhead = !1), e;
                }),
                (q.duration = function(a) {
                    return arguments.length
                        ? (0 !== this.duration() && 0 !== a && this.timeScale(this._duration / a), this)
                        : (this._dirty && this.totalDuration(), this._duration);
                }),
                (q.totalDuration = function(a) {
                    if (!arguments.length) {
                        if (this._dirty) {
                            for (var b, c, d = 0, e = this._last, f = 999999999999; e; )
                                (b = e._prev),
                                    e._dirty && e.totalDuration(),
                                    e._startTime > f && this._sortChildren && !e._paused && !this._calculatingDuration
                                        ? ((this._calculatingDuration = 1), this.add(e, e._startTime - e._delay), (this._calculatingDuration = 0))
                                        : (f = e._startTime),
                                    e._startTime < 0 &&
                                        !e._paused &&
                                        ((d -= e._startTime),
                                        this._timeline.smoothChildTiming &&
                                            ((this._startTime += e._startTime / this._timeScale),
                                            (this._time -= e._startTime),
                                            (this._totalTime -= e._startTime),
                                            (this._rawPrevTime -= e._startTime)),
                                        this.shiftChildren(-e._startTime, !1, -9999999999),
                                        (f = 0)),
                                    (c = e._startTime + e._totalDuration / e._timeScale),
                                    c > d && (d = c),
                                    (e = b);
                            (this._duration = this._totalDuration = d), (this._dirty = !1);
                        }
                        return this._totalDuration;
                    }
                    return a && this.totalDuration() ? this.timeScale(this._totalDuration / a) : this;
                }),
                (q.paused = function(b) {
                    if (!b) for (var c = this._first, d = this._time; c; ) c._startTime === d && "isPause" === c.data && (c._rawPrevTime = 0), (c = c._next);
                    return a.prototype.paused.apply(this, arguments);
                }),
                (q.usesFrames = function() {
                    for (var b = this._timeline; b._timeline; ) b = b._timeline;
                    return b === a._rootFramesTimeline;
                }),
                (q.rawTime = function(a) {
                    return a && (this._paused || (this._repeat && this.time() > 0 && this.totalProgress() < 1))
                        ? this._totalTime % (this._duration + this._repeatDelay)
                        : this._paused
                        ? this._totalTime
                        : (this._timeline.rawTime(a) - this._startTime) * this._timeScale;
                }),
                d
            );
        },
        !0
    );
}),
    _gsScope._gsDefine && _gsScope._gsQueue.pop()(),
    (function(a) {
        "use strict";
        var b = function() {
            return (_gsScope.GreenSockGlobals || _gsScope)[a];
        };
        "undefined" != typeof module && module.exports
            ? (require("./TweenLite.min.js"), (module.exports = b()))
            : "function" === typeof wwplayer.define && wwplayer.define.amd && wwplayer.define("TimelineLite", ["TweenLite"], b);
    })("TimelineLite");
/*!
 * VERSION: 1.20.3
 * DATE: 2017-10-02
 * UPDATES AND DOCS AT: http://greensock.com
 *
 * @license Copyright (c) 2008-2017, GreenSock. All rights reserved.
 * This work is subject to the terms at http://greensock.com/standard-license or for
 * Club GreenSock members, the software agreement that was issued with your membership.
 *
 * @author: Jack Doyle, jack@greensock.com
 */
var _gsScope = "undefined" != typeof module && module.exports && "undefined" != typeof global ? global : this || window;
(_gsScope._gsQueue || (_gsScope._gsQueue = [])).push(function() {
    "use strict";
    _gsScope._gsDefine(
        "TimelineMax",
        ["TimelineLite", "TweenLite", "easing.Ease"],
        function(a, b, c) {
            var d = function(b) {
                    a.call(this, b),
                        (this._repeat = this.vars.repeat || 0),
                        (this._repeatDelay = this.vars.repeatDelay || 0),
                        (this._cycle = 0),
                        (this._yoyo = this.vars.yoyo === !0),
                        (this._dirty = !0);
                },
                e = 1e-10,
                f = b._internals,
                g = f.lazyTweens,
                h = f.lazyRender,
                i = _gsScope._gsDefine.globals,
                j = new c(null, null, 1, 0),
                k = (d.prototype = new a());
            return (
                (k.constructor = d),
                (k.kill()._gc = !1),
                (d.version = "1.20.3"),
                (k.invalidate = function() {
                    return (
                        (this._yoyo = this.vars.yoyo === !0),
                        (this._repeat = this.vars.repeat || 0),
                        (this._repeatDelay = this.vars.repeatDelay || 0),
                        this._uncache(!0),
                        a.prototype.invalidate.call(this)
                    );
                }),
                (k.addCallback = function(a, c, d, e) {
                    return this.add(b.delayedCall(0, a, d, e), c);
                }),
                (k.removeCallback = function(a, b) {
                    if (a)
                        if (null == b) this._kill(null, a);
                        else for (var c = this.getTweensOf(a, !1), d = c.length, e = this._parseTimeOrLabel(b); --d > -1; ) c[d]._startTime === e && c[d]._enabled(!1, !1);
                    return this;
                }),
                (k.removePause = function(b) {
                    return this.removeCallback(a._internals.pauseCallback, b);
                }),
                (k.tweenTo = function(a, c) {
                    c = c || {};
                    var d,
                        e,
                        f,
                        g = { ease: j, useFrames: this.usesFrames(), immediateRender: !1 },
                        h = (c.repeat && i.TweenMax) || b;
                    for (e in c) g[e] = c[e];
                    return (
                        (g.time = this._parseTimeOrLabel(a)),
                        (d = Math.abs(Number(g.time) - this._time) / this._timeScale || 0.001),
                        (f = new h(this, d, g)),
                        (g.onStart = function() {
                            f.target.paused(!0),
                                f.vars.time !== f.target.time() && d === f.duration() && f.duration(Math.abs(f.vars.time - f.target.time()) / f.target._timeScale),
                                c.onStart && c.onStart.apply(c.onStartScope || c.callbackScope || f, c.onStartParams || []);
                        }),
                        f
                    );
                }),
                (k.tweenFromTo = function(a, b, c) {
                    (c = c || {}),
                        (a = this._parseTimeOrLabel(a)),
                        (c.startAt = { onComplete: this.seek, onCompleteParams: [a], callbackScope: this }),
                        (c.immediateRender = c.immediateRender !== !1);
                    var d = this.tweenTo(b, c);
                    return d.duration(Math.abs(d.vars.time - a) / this._timeScale || 0.001);
                }),
                (k.render = function(a, b, c) {
                    this._gc && this._enabled(!0, !1);
                    var d,
                        f,
                        i,
                        j,
                        k,
                        l,
                        m,
                        n,
                        o = this._time,
                        p = this._dirty ? this.totalDuration() : this._totalDuration,
                        q = this._duration,
                        r = this._totalTime,
                        s = this._startTime,
                        t = this._timeScale,
                        u = this._rawPrevTime,
                        v = this._paused,
                        w = this._cycle;
                    if ((o !== this._time && (a += this._time - o), a >= p - 1e-7 && a >= 0))
                        this._locked || ((this._totalTime = p), (this._cycle = this._repeat)),
                            this._reversed ||
                                this._hasPausedChild() ||
                                ((f = !0),
                                (j = "onComplete"),
                                (k = !!this._timeline.autoRemoveChildren),
                                0 === this._duration && ((0 >= a && a >= -1e-7) || 0 > u || u === e) && u !== a && this._first && ((k = !0), u > e && (j = "onReverseComplete"))),
                            (this._rawPrevTime = this._duration || !b || a || this._rawPrevTime === a ? a : e),
                            this._yoyo && 0 !== (1 & this._cycle) ? (this._time = a = 0) : ((this._time = q), (a = q + 1e-4));
                    else if (1e-7 > a)
                        if (
                            (this._locked || (this._totalTime = this._cycle = 0),
                            (this._time = 0),
                            (0 !== o || (0 === q && u !== e && (u > 0 || (0 > a && u >= 0)) && !this._locked)) && ((j = "onReverseComplete"), (f = this._reversed)),
                            0 > a)
                        )
                            (this._active = !1),
                                this._timeline.autoRemoveChildren && this._reversed ? ((k = f = !0), (j = "onReverseComplete")) : u >= 0 && this._first && (k = !0),
                                (this._rawPrevTime = a);
                        else {
                            if (((this._rawPrevTime = q || !b || a || this._rawPrevTime === a ? a : e), 0 === a && f))
                                for (d = this._first; d && 0 === d._startTime; ) d._duration || (f = !1), (d = d._next);
                            (a = 0), this._initted || (k = !0);
                        }
                    else if (
                        (0 === q && 0 > u && (k = !0),
                        (this._time = this._rawPrevTime = a),
                        this._locked ||
                            ((this._totalTime = a),
                            0 !== this._repeat &&
                                ((l = q + this._repeatDelay),
                                (this._cycle = (this._totalTime / l) >> 0),
                                0 !== this._cycle && this._cycle === this._totalTime / l && a >= r && this._cycle--,
                                (this._time = this._totalTime - this._cycle * l),
                                this._yoyo && 0 !== (1 & this._cycle) && (this._time = q - this._time),
                                this._time > q ? ((this._time = q), (a = q + 1e-4)) : this._time < 0 ? (this._time = a = 0) : (a = this._time))),
                        this._hasPause && !this._forcingPlayhead && !b)
                    ) {
                        if (((a = this._time), a >= o || (this._repeat && w !== this._cycle)))
                            for (d = this._first; d && d._startTime <= a && !m; )
                                d._duration || "isPause" !== d.data || d.ratio || (0 === d._startTime && 0 === this._rawPrevTime) || (m = d), (d = d._next);
                        else for (d = this._last; d && d._startTime >= a && !m; ) d._duration || ("isPause" === d.data && d._rawPrevTime > 0 && (m = d)), (d = d._prev);
                        m && m._startTime < q && ((this._time = a = m._startTime), (this._totalTime = a + this._cycle * (this._totalDuration + this._repeatDelay)));
                    }
                    if (this._cycle !== w && !this._locked) {
                        var x = this._yoyo && 0 !== (1 & w),
                            y = x === (this._yoyo && 0 !== (1 & this._cycle)),
                            z = this._totalTime,
                            A = this._cycle,
                            B = this._rawPrevTime,
                            C = this._time;
                        if (
                            ((this._totalTime = w * q),
                            this._cycle < w ? (x = !x) : (this._totalTime += q),
                            (this._time = o),
                            (this._rawPrevTime = 0 === q ? u - 1e-4 : u),
                            (this._cycle = w),
                            (this._locked = !0),
                            (o = x ? 0 : q),
                            this.render(o, b, 0 === q),
                            b || this._gc || (this.vars.onRepeat && ((this._cycle = A), (this._locked = !1), this._callback("onRepeat"))),
                            o !== this._time)
                        )
                            return;
                        if ((y && ((this._cycle = w), (this._locked = !0), (o = x ? q + 1e-4 : -1e-4), this.render(o, !0, !1)), (this._locked = !1), this._paused && !v)) return;
                        (this._time = C), (this._totalTime = z), (this._cycle = A), (this._rawPrevTime = B);
                    }
                    if (!((this._time !== o && this._first) || c || k || m)) return void (r !== this._totalTime && this._onUpdate && (b || this._callback("onUpdate")));
                    if (
                        (this._initted || (this._initted = !0),
                        this._active || (!this._paused && this._totalTime !== r && a > 0 && (this._active = !0)),
                        0 === r && this.vars.onStart && ((0 === this._totalTime && this._totalDuration) || b || this._callback("onStart")),
                        (n = this._time),
                        n >= o)
                    )
                        for (d = this._first; d && ((i = d._next), n === this._time && (!this._paused || v)); )
                            (d._active || (d._startTime <= this._time && !d._paused && !d._gc)) &&
                                (m === d && this.pause(),
                                d._reversed
                                    ? d.render((d._dirty ? d.totalDuration() : d._totalDuration) - (a - d._startTime) * d._timeScale, b, c)
                                    : d.render((a - d._startTime) * d._timeScale, b, c)),
                                (d = i);
                    else
                        for (d = this._last; d && ((i = d._prev), n === this._time && (!this._paused || v)); ) {
                            if (d._active || (d._startTime <= o && !d._paused && !d._gc)) {
                                if (m === d) {
                                    for (m = d._prev; m && m.endTime() > this._time; )
                                        m.render(m._reversed ? m.totalDuration() - (a - m._startTime) * m._timeScale : (a - m._startTime) * m._timeScale, b, c), (m = m._prev);
                                    (m = null), this.pause();
                                }
                                d._reversed
                                    ? d.render((d._dirty ? d.totalDuration() : d._totalDuration) - (a - d._startTime) * d._timeScale, b, c)
                                    : d.render((a - d._startTime) * d._timeScale, b, c);
                            }
                            d = i;
                        }
                    this._onUpdate && (b || (g.length && h(), this._callback("onUpdate"))),
                        j &&
                            (this._locked ||
                                this._gc ||
                                ((s === this._startTime || t !== this._timeScale) &&
                                    (0 === this._time || p >= this.totalDuration()) &&
                                    (f && (g.length && h(), this._timeline.autoRemoveChildren && this._enabled(!1, !1), (this._active = !1)),
                                    !b && this.vars[j] && this._callback(j))));
                }),
                (k.getActive = function(a, b, c) {
                    null == a && (a = !0), null == b && (b = !0), null == c && (c = !1);
                    var d,
                        e,
                        f = [],
                        g = this.getChildren(a, b, c),
                        h = 0,
                        i = g.length;
                    for (d = 0; i > d; d++) (e = g[d]), e.isActive() && (f[h++] = e);
                    return f;
                }),
                (k.getLabelAfter = function(a) {
                    a || (0 !== a && (a = this._time));
                    var b,
                        c = this.getLabelsArray(),
                        d = c.length;
                    for (b = 0; d > b; b++) if (c[b].time > a) return c[b].name;
                    return null;
                }),
                (k.getLabelBefore = function(a) {
                    null == a && (a = this._time);
                    for (var b = this.getLabelsArray(), c = b.length; --c > -1; ) if (b[c].time < a) return b[c].name;
                    return null;
                }),
                (k.getLabelsArray = function() {
                    var a,
                        b = [],
                        c = 0;
                    for (a in this._labels) b[c++] = { time: this._labels[a], name: a };
                    return (
                        b.sort(function(a, b) {
                            return a.time - b.time;
                        }),
                        b
                    );
                }),
                (k.invalidate = function() {
                    return (this._locked = !1), a.prototype.invalidate.call(this);
                }),
                (k.progress = function(a, b) {
                    return arguments.length
                        ? this.totalTime(this.duration() * (this._yoyo && 0 !== (1 & this._cycle) ? 1 - a : a) + this._cycle * (this._duration + this._repeatDelay), b)
                        : this._time / this.duration() || 0;
                }),
                (k.totalProgress = function(a, b) {
                    return arguments.length ? this.totalTime(this.totalDuration() * a, b) : this._totalTime / this.totalDuration() || 0;
                }),
                (k.totalDuration = function(b) {
                    return arguments.length
                        ? -1 !== this._repeat && b
                            ? this.timeScale(this.totalDuration() / b)
                            : this
                        : (this._dirty &&
                              (a.prototype.totalDuration.call(this),
                              (this._totalDuration = -1 === this._repeat ? 999999999999 : this._duration * (this._repeat + 1) + this._repeatDelay * this._repeat)),
                          this._totalDuration);
                }),
                (k.time = function(a, b) {
                    return arguments.length
                        ? (this._dirty && this.totalDuration(),
                          a > this._duration && (a = this._duration),
                          this._yoyo && 0 !== (1 & this._cycle)
                              ? (a = this._duration - a + this._cycle * (this._duration + this._repeatDelay))
                              : 0 !== this._repeat && (a += this._cycle * (this._duration + this._repeatDelay)),
                          this.totalTime(a, b))
                        : this._time;
                }),
                (k.repeat = function(a) {
                    return arguments.length ? ((this._repeat = a), this._uncache(!0)) : this._repeat;
                }),
                (k.repeatDelay = function(a) {
                    return arguments.length ? ((this._repeatDelay = a), this._uncache(!0)) : this._repeatDelay;
                }),
                (k.yoyo = function(a) {
                    return arguments.length ? ((this._yoyo = a), this) : this._yoyo;
                }),
                (k.currentLabel = function(a) {
                    return arguments.length ? this.seek(a, !0) : this.getLabelBefore(this._time + 1e-8);
                }),
                d
            );
        },
        !0
    ),
        _gsScope._gsDefine(
            "TimelineLite",
            ["core.Animation", "core.SimpleTimeline", "TweenLite"],
            function(a, b, c) {
                var d = function(a) {
                        b.call(this, a),
                            (this._labels = {}),
                            (this.autoRemoveChildren = this.vars.autoRemoveChildren === !0),
                            (this.smoothChildTiming = this.vars.smoothChildTiming === !0),
                            (this._sortChildren = !0),
                            (this._onUpdate = this.vars.onUpdate);
                        var c,
                            d,
                            e = this.vars;
                        for (d in e) (c = e[d]), i(c) && -1 !== c.join("").indexOf("{self}") && (e[d] = this._swapSelfInParams(c));
                        i(e.tweens) && this.add(e.tweens, 0, e.align, e.stagger);
                    },
                    e = 1e-10,
                    f = c._internals,
                    g = (d._internals = {}),
                    h = f.isSelector,
                    i = f.isArray,
                    j = f.lazyTweens,
                    k = f.lazyRender,
                    l = _gsScope._gsDefine.globals,
                    m = function(a) {
                        var b,
                            c = {};
                        for (b in a) c[b] = a[b];
                        return c;
                    },
                    n = function(a, b, c) {
                        var d,
                            e,
                            f = a.cycle;
                        for (d in f) (e = f[d]), (a[d] = "function" == typeof e ? e(c, b[c]) : e[c % e.length]);
                        delete a.cycle;
                    },
                    o = (g.pauseCallback = function() {}),
                    p = function(a) {
                        var b,
                            c = [],
                            d = a.length;
                        for (b = 0; b !== d; c.push(a[b++]));
                        return c;
                    },
                    q = (d.prototype = new b());
                return (
                    (d.version = "1.20.3"),
                    (q.constructor = d),
                    (q.kill()._gc = q._forcingPlayhead = q._hasPause = !1),
                    (q.to = function(a, b, d, e) {
                        var f = (d.repeat && l.TweenMax) || c;
                        return b ? this.add(new f(a, b, d), e) : this.set(a, d, e);
                    }),
                    (q.from = function(a, b, d, e) {
                        return this.add(((d.repeat && l.TweenMax) || c).from(a, b, d), e);
                    }),
                    (q.fromTo = function(a, b, d, e, f) {
                        var g = (e.repeat && l.TweenMax) || c;
                        return b ? this.add(g.fromTo(a, b, d, e), f) : this.set(a, e, f);
                    }),
                    (q.staggerTo = function(a, b, e, f, g, i, j, k) {
                        var l,
                            o,
                            q = new d({ onComplete: i, onCompleteParams: j, callbackScope: k, smoothChildTiming: this.smoothChildTiming }),
                            r = e.cycle;
                        for (
                            "string" == typeof a && (a = c.selector(a) || a), a = a || [], h(a) && (a = p(a)), f = f || 0, 0 > f && ((a = p(a)), a.reverse(), (f *= -1)), o = 0;
                            o < a.length;
                            o++
                        )
                            (l = m(e)),
                                l.startAt && ((l.startAt = m(l.startAt)), l.startAt.cycle && n(l.startAt, a, o)),
                                r && (n(l, a, o), null != l.duration && ((b = l.duration), delete l.duration)),
                                q.to(a[o], b, l, o * f);
                        return this.add(q, g);
                    }),
                    (q.staggerFrom = function(a, b, c, d, e, f, g, h) {
                        return (c.immediateRender = 0 != c.immediateRender), (c.runBackwards = !0), this.staggerTo(a, b, c, d, e, f, g, h);
                    }),
                    (q.staggerFromTo = function(a, b, c, d, e, f, g, h, i) {
                        return (d.startAt = c), (d.immediateRender = 0 != d.immediateRender && 0 != c.immediateRender), this.staggerTo(a, b, d, e, f, g, h, i);
                    }),
                    (q.call = function(a, b, d, e) {
                        return this.add(c.delayedCall(0, a, b, d), e);
                    }),
                    (q.set = function(a, b, d) {
                        return (
                            (d = this._parseTimeOrLabel(d, 0, !0)),
                            null == b.immediateRender && (b.immediateRender = d === this._time && !this._paused),
                            this.add(new c(a, 0, b), d)
                        );
                    }),
                    (d.exportRoot = function(a, b) {
                        (a = a || {}), null == a.smoothChildTiming && (a.smoothChildTiming = !0);
                        var e,
                            f,
                            g,
                            h,
                            i = new d(a),
                            j = i._timeline;
                        for (null == b && (b = !0), j._remove(i, !0), i._startTime = 0, i._rawPrevTime = i._time = i._totalTime = j._time, g = j._first; g; )
                            (h = g._next), (b && g instanceof c && g.target === g.vars.onComplete) || ((f = g._startTime - g._delay), 0 > f && (e = 1), i.add(g, f)), (g = h);
                        return j.add(i, 0), e && i.totalDuration(), i;
                    }),
                    (q.add = function(e, f, g, h) {
                        var j, k, l, m, n, o;
                        if (("number" != typeof f && (f = this._parseTimeOrLabel(f, 0, !0, e)), !(e instanceof a))) {
                            if (e instanceof Array || (e && e.push && i(e))) {
                                for (g = g || "normal", h = h || 0, j = f, k = e.length, l = 0; k > l; l++)
                                    i((m = e[l])) && (m = new d({ tweens: m })),
                                        this.add(m, j),
                                        "string" != typeof m &&
                                            "function" != typeof m &&
                                            ("sequence" === g ? (j = m._startTime + m.totalDuration() / m._timeScale) : "start" === g && (m._startTime -= m.delay())),
                                        (j += h);
                                return this._uncache(!0);
                            }
                            if ("string" == typeof e) return this.addLabel(e, f);
                            if ("function" != typeof e) throw "Cannot add " + e + " into the timeline; it is not a tween, timeline, function, or string.";
                            e = c.delayedCall(0, e);
                        }
                        if (
                            (b.prototype.add.call(this, e, f),
                            e._time && e.render((this.rawTime() - e._startTime) * e._timeScale, !1, !1),
                            (this._gc || this._time === this._duration) && !this._paused && this._duration < this.duration())
                        )
                            for (n = this, o = n.rawTime() > e._startTime; n._timeline; )
                                o && n._timeline.smoothChildTiming ? n.totalTime(n._totalTime, !0) : n._gc && n._enabled(!0, !1), (n = n._timeline);
                        return this;
                    }),
                    (q.remove = function(b) {
                        if (b instanceof a) {
                            this._remove(b, !1);
                            var c = (b._timeline = b.vars.useFrames ? a._rootFramesTimeline : a._rootTimeline);
                            return (b._startTime = (b._paused ? b._pauseTime : c._time) - (b._reversed ? b.totalDuration() - b._totalTime : b._totalTime) / b._timeScale), this;
                        }
                        if (b instanceof Array || (b && b.push && i(b))) {
                            for (var d = b.length; --d > -1; ) this.remove(b[d]);
                            return this;
                        }
                        return "string" == typeof b ? this.removeLabel(b) : this.kill(null, b);
                    }),
                    (q._remove = function(a, c) {
                        b.prototype._remove.call(this, a, c);
                        var d = this._last;
                        return (
                            d
                                ? this._time > this.duration() && ((this._time = this._duration), (this._totalTime = this._totalDuration))
                                : (this._time = this._totalTime = this._duration = this._totalDuration = 0),
                            this
                        );
                    }),
                    (q.append = function(a, b) {
                        return this.add(a, this._parseTimeOrLabel(null, b, !0, a));
                    }),
                    (q.insert = q.insertMultiple = function(a, b, c, d) {
                        return this.add(a, b || 0, c, d);
                    }),
                    (q.appendMultiple = function(a, b, c, d) {
                        return this.add(a, this._parseTimeOrLabel(null, b, !0, a), c, d);
                    }),
                    (q.addLabel = function(a, b) {
                        return (this._labels[a] = this._parseTimeOrLabel(b)), this;
                    }),
                    (q.addPause = function(a, b, d, e) {
                        var f = c.delayedCall(0, o, d, e || this);
                        return (f.vars.onComplete = f.vars.onReverseComplete = b), (f.data = "isPause"), (this._hasPause = !0), this.add(f, a);
                    }),
                    (q.removeLabel = function(a) {
                        return delete this._labels[a], this;
                    }),
                    (q.getLabelTime = function(a) {
                        return null != this._labels[a] ? this._labels[a] : -1;
                    }),
                    (q._parseTimeOrLabel = function(b, c, d, e) {
                        var f, g;
                        if (e instanceof a && e.timeline === this) this.remove(e);
                        else if (e && (e instanceof Array || (e.push && i(e)))) for (g = e.length; --g > -1; ) e[g] instanceof a && e[g].timeline === this && this.remove(e[g]);
                        if (((f = "number" != typeof b || c ? (this.duration() > 99999999999 ? this.recent().endTime(!1) : this._duration) : 0), "string" == typeof c))
                            return this._parseTimeOrLabel(c, d && "number" == typeof b && null == this._labels[c] ? b - f : 0, d);
                        if (((c = c || 0), "string" != typeof b || (!isNaN(b) && null == this._labels[b]))) null == b && (b = f);
                        else {
                            if (((g = b.indexOf("=")), -1 === g)) return null == this._labels[b] ? (d ? (this._labels[b] = f + c) : c) : this._labels[b] + c;
                            (c = parseInt(b.charAt(g - 1) + "1", 10) * Number(b.substr(g + 1))), (b = g > 1 ? this._parseTimeOrLabel(b.substr(0, g - 1), 0, d) : f);
                        }
                        return Number(b) + c;
                    }),
                    (q.seek = function(a, b) {
                        return this.totalTime("number" == typeof a ? a : this._parseTimeOrLabel(a), b !== !1);
                    }),
                    (q.stop = function() {
                        return this.paused(!0);
                    }),
                    (q.gotoAndPlay = function(a, b) {
                        return this.play(a, b);
                    }),
                    (q.gotoAndStop = function(a, b) {
                        return this.pause(a, b);
                    }),
                    (q.render = function(a, b, c) {
                        this._gc && this._enabled(!0, !1);
                        var d,
                            f,
                            g,
                            h,
                            i,
                            l,
                            m,
                            n = this._dirty ? this.totalDuration() : this._totalDuration,
                            o = this._time,
                            p = this._startTime,
                            q = this._timeScale,
                            r = this._paused;
                        if (a >= n - 1e-7 && a >= 0)
                            (this._totalTime = this._time = n),
                                this._reversed ||
                                    this._hasPausedChild() ||
                                    ((f = !0),
                                    (h = "onComplete"),
                                    (i = !!this._timeline.autoRemoveChildren),
                                    0 === this._duration &&
                                        ((0 >= a && a >= -1e-7) || this._rawPrevTime < 0 || this._rawPrevTime === e) &&
                                        this._rawPrevTime !== a &&
                                        this._first &&
                                        ((i = !0), this._rawPrevTime > e && (h = "onReverseComplete"))),
                                (this._rawPrevTime = this._duration || !b || a || this._rawPrevTime === a ? a : e),
                                (a = n + 1e-4);
                        else if (1e-7 > a)
                            if (
                                ((this._totalTime = this._time = 0),
                                (0 !== o || (0 === this._duration && this._rawPrevTime !== e && (this._rawPrevTime > 0 || (0 > a && this._rawPrevTime >= 0)))) &&
                                    ((h = "onReverseComplete"), (f = this._reversed)),
                                0 > a)
                            )
                                (this._active = !1),
                                    this._timeline.autoRemoveChildren && this._reversed
                                        ? ((i = f = !0), (h = "onReverseComplete"))
                                        : this._rawPrevTime >= 0 && this._first && (i = !0),
                                    (this._rawPrevTime = a);
                            else {
                                if (((this._rawPrevTime = this._duration || !b || a || this._rawPrevTime === a ? a : e), 0 === a && f))
                                    for (d = this._first; d && 0 === d._startTime; ) d._duration || (f = !1), (d = d._next);
                                (a = 0), this._initted || (i = !0);
                            }
                        else {
                            if (this._hasPause && !this._forcingPlayhead && !b) {
                                if (a >= o)
                                    for (d = this._first; d && d._startTime <= a && !l; )
                                        d._duration || "isPause" !== d.data || d.ratio || (0 === d._startTime && 0 === this._rawPrevTime) || (l = d), (d = d._next);
                                else for (d = this._last; d && d._startTime >= a && !l; ) d._duration || ("isPause" === d.data && d._rawPrevTime > 0 && (l = d)), (d = d._prev);
                                l && ((this._time = a = l._startTime), (this._totalTime = a + this._cycle * (this._totalDuration + this._repeatDelay)));
                            }
                            this._totalTime = this._time = this._rawPrevTime = a;
                        }
                        if ((this._time !== o && this._first) || c || i || l) {
                            if (
                                (this._initted || (this._initted = !0),
                                this._active || (!this._paused && this._time !== o && a > 0 && (this._active = !0)),
                                0 === o && this.vars.onStart && ((0 === this._time && this._duration) || b || this._callback("onStart")),
                                (m = this._time),
                                m >= o)
                            )
                                for (d = this._first; d && ((g = d._next), m === this._time && (!this._paused || r)); )
                                    (d._active || (d._startTime <= m && !d._paused && !d._gc)) &&
                                        (l === d && this.pause(),
                                        d._reversed
                                            ? d.render((d._dirty ? d.totalDuration() : d._totalDuration) - (a - d._startTime) * d._timeScale, b, c)
                                            : d.render((a - d._startTime) * d._timeScale, b, c)),
                                        (d = g);
                            else
                                for (d = this._last; d && ((g = d._prev), m === this._time && (!this._paused || r)); ) {
                                    if (d._active || (d._startTime <= o && !d._paused && !d._gc)) {
                                        if (l === d) {
                                            for (l = d._prev; l && l.endTime() > this._time; )
                                                l.render(l._reversed ? l.totalDuration() - (a - l._startTime) * l._timeScale : (a - l._startTime) * l._timeScale, b, c),
                                                    (l = l._prev);
                                            (l = null), this.pause();
                                        }
                                        d._reversed
                                            ? d.render((d._dirty ? d.totalDuration() : d._totalDuration) - (a - d._startTime) * d._timeScale, b, c)
                                            : d.render((a - d._startTime) * d._timeScale, b, c);
                                    }
                                    d = g;
                                }
                            this._onUpdate && (b || (j.length && k(), this._callback("onUpdate"))),
                                h &&
                                    (this._gc ||
                                        ((p === this._startTime || q !== this._timeScale) &&
                                            (0 === this._time || n >= this.totalDuration()) &&
                                            (f && (j.length && k(), this._timeline.autoRemoveChildren && this._enabled(!1, !1), (this._active = !1)),
                                            !b && this.vars[h] && this._callback(h))));
                        }
                    }),
                    (q._hasPausedChild = function() {
                        for (var a = this._first; a; ) {
                            if (a._paused || (a instanceof d && a._hasPausedChild())) return !0;
                            a = a._next;
                        }
                        return !1;
                    }),
                    (q.getChildren = function(a, b, d, e) {
                        e = e || -9999999999;
                        for (var f = [], g = this._first, h = 0; g; )
                            g._startTime < e ||
                                (g instanceof c ? b !== !1 && (f[h++] = g) : (d !== !1 && (f[h++] = g), a !== !1 && ((f = f.concat(g.getChildren(!0, b, d))), (h = f.length)))),
                                (g = g._next);
                        return f;
                    }),
                    (q.getTweensOf = function(a, b) {
                        var d,
                            e,
                            f = this._gc,
                            g = [],
                            h = 0;
                        for (f && this._enabled(!0, !0), d = c.getTweensOf(a), e = d.length; --e > -1; ) (d[e].timeline === this || (b && this._contains(d[e]))) && (g[h++] = d[e]);
                        return f && this._enabled(!1, !0), g;
                    }),
                    (q.recent = function() {
                        return this._recent;
                    }),
                    (q._contains = function(a) {
                        for (var b = a.timeline; b; ) {
                            if (b === this) return !0;
                            b = b.timeline;
                        }
                        return !1;
                    }),
                    (q.shiftChildren = function(a, b, c) {
                        c = c || 0;
                        for (var d, e = this._first, f = this._labels; e; ) e._startTime >= c && (e._startTime += a), (e = e._next);
                        if (b) for (d in f) f[d] >= c && (f[d] += a);
                        return this._uncache(!0);
                    }),
                    (q._kill = function(a, b) {
                        if (!a && !b) return this._enabled(!1, !1);
                        for (var c = b ? this.getTweensOf(b) : this.getChildren(!0, !0, !1), d = c.length, e = !1; --d > -1; ) c[d]._kill(a, b) && (e = !0);
                        return e;
                    }),
                    (q.clear = function(a) {
                        var b = this.getChildren(!1, !0, !0),
                            c = b.length;
                        for (this._time = this._totalTime = 0; --c > -1; ) b[c]._enabled(!1, !1);
                        return a !== !1 && (this._labels = {}), this._uncache(!0);
                    }),
                    (q.invalidate = function() {
                        for (var b = this._first; b; ) b.invalidate(), (b = b._next);
                        return a.prototype.invalidate.call(this);
                    }),
                    (q._enabled = function(a, c) {
                        if (a === this._gc) for (var d = this._first; d; ) d._enabled(a, !0), (d = d._next);
                        return b.prototype._enabled.call(this, a, c);
                    }),
                    (q.totalTime = function(b, c, d) {
                        this._forcingPlayhead = !0;
                        var e = a.prototype.totalTime.apply(this, arguments);
                        return (this._forcingPlayhead = !1), e;
                    }),
                    (q.duration = function(a) {
                        return arguments.length
                            ? (0 !== this.duration() && 0 !== a && this.timeScale(this._duration / a), this)
                            : (this._dirty && this.totalDuration(), this._duration);
                    }),
                    (q.totalDuration = function(a) {
                        if (!arguments.length) {
                            if (this._dirty) {
                                for (var b, c, d = 0, e = this._last, f = 999999999999; e; )
                                    (b = e._prev),
                                        e._dirty && e.totalDuration(),
                                        e._startTime > f && this._sortChildren && !e._paused && !this._calculatingDuration
                                            ? ((this._calculatingDuration = 1), this.add(e, e._startTime - e._delay), (this._calculatingDuration = 0))
                                            : (f = e._startTime),
                                        e._startTime < 0 &&
                                            !e._paused &&
                                            ((d -= e._startTime),
                                            this._timeline.smoothChildTiming &&
                                                ((this._startTime += e._startTime / this._timeScale),
                                                (this._time -= e._startTime),
                                                (this._totalTime -= e._startTime),
                                                (this._rawPrevTime -= e._startTime)),
                                            this.shiftChildren(-e._startTime, !1, -9999999999),
                                            (f = 0)),
                                        (c = e._startTime + e._totalDuration / e._timeScale),
                                        c > d && (d = c),
                                        (e = b);
                                (this._duration = this._totalDuration = d), (this._dirty = !1);
                            }
                            return this._totalDuration;
                        }
                        return a && this.totalDuration() ? this.timeScale(this._totalDuration / a) : this;
                    }),
                    (q.paused = function(b) {
                        if (!b) for (var c = this._first, d = this._time; c; ) c._startTime === d && "isPause" === c.data && (c._rawPrevTime = 0), (c = c._next);
                        return a.prototype.paused.apply(this, arguments);
                    }),
                    (q.usesFrames = function() {
                        for (var b = this._timeline; b._timeline; ) b = b._timeline;
                        return b === a._rootFramesTimeline;
                    }),
                    (q.rawTime = function(a) {
                        return a && (this._paused || (this._repeat && this.time() > 0 && this.totalProgress() < 1))
                            ? this._totalTime % (this._duration + this._repeatDelay)
                            : this._paused
                            ? this._totalTime
                            : (this._timeline.rawTime(a) - this._startTime) * this._timeScale;
                    }),
                    d
                );
            },
            !0
        );
}),
    _gsScope._gsDefine && _gsScope._gsQueue.pop()(),
    (function(a) {
        "use strict";
        var b = function() {
            return (_gsScope.GreenSockGlobals || _gsScope)[a];
        };
        "undefined" != typeof module && module.exports
            ? (require("./TweenLite.min.js"), (module.exports = b()))
            : "function" === typeof wwplayer.define && wwplayer.define.amd && wwplayer.define("TimelineMax", ["TweenLite"], b);
    })("TimelineMax");
/*!
 * VERSION: 1.20.3
 * DATE: 2017-10-02
 * UPDATES AND DOCS AT: http://greensock.com
 *
 * Includes all of the following: TweenLite, TweenMax, TimelineLite, TimelineMax, EasePack, CSSPlugin, RoundPropsPlugin, BezierPlugin, AttrPlugin, DirectionalRotationPlugin
 *
 * @license Copyright (c) 2008-2017, GreenSock. All rights reserved.
 * This work is subject to the terms at http://greensock.com/standard-license or for
 * Club GreenSock members, the software agreement that was issued with your membership.
 *
 * @author: Jack Doyle, jack@greensock.com
 **/
var _gsScope = "undefined" != typeof module && module.exports && "undefined" != typeof global ? global : this || window;
(_gsScope._gsQueue || (_gsScope._gsQueue = [])).push(function() {
    "use strict";
    _gsScope._gsDefine(
        "TweenMax",
        ["core.Animation", "core.SimpleTimeline", "TweenLite"],
        function(a, b, c) {
            var d = function(a) {
                    var b,
                        c = [],
                        d = a.length;
                    for (b = 0; b !== d; c.push(a[b++]));
                    return c;
                },
                e = function(a, b, c) {
                    var d,
                        e,
                        f = a.cycle;
                    for (d in f) (e = f[d]), (a[d] = "function" == typeof e ? e(c, b[c]) : e[c % e.length]);
                    delete a.cycle;
                },
                f = function(a, b, d) {
                    c.call(this, a, b, d),
                        (this._cycle = 0),
                        (this._yoyo = this.vars.yoyo === !0 || !!this.vars.yoyoEase),
                        (this._repeat = this.vars.repeat || 0),
                        (this._repeatDelay = this.vars.repeatDelay || 0),
                        this._repeat && this._uncache(!0),
                        (this.render = f.prototype.render);
                },
                g = 1e-10,
                h = c._internals,
                i = h.isSelector,
                j = h.isArray,
                k = (f.prototype = c.to({}, 0.1, {})),
                l = [];
            (f.version = "1.20.3"),
                (k.constructor = f),
                (k.kill()._gc = !1),
                (f.killTweensOf = f.killDelayedCallsTo = c.killTweensOf),
                (f.getTweensOf = c.getTweensOf),
                (f.lagSmoothing = c.lagSmoothing),
                (f.ticker = c.ticker),
                (f.render = c.render),
                (k.invalidate = function() {
                    return (
                        (this._yoyo = this.vars.yoyo === !0 || !!this.vars.yoyoEase),
                        (this._repeat = this.vars.repeat || 0),
                        (this._repeatDelay = this.vars.repeatDelay || 0),
                        (this._yoyoEase = null),
                        this._uncache(!0),
                        c.prototype.invalidate.call(this)
                    );
                }),
                (k.updateTo = function(a, b) {
                    var d,
                        e = this.ratio,
                        f = this.vars.immediateRender || a.immediateRender;
                    b &&
                        this._startTime < this._timeline._time &&
                        ((this._startTime = this._timeline._time),
                        this._uncache(!1),
                        this._gc ? this._enabled(!0, !1) : this._timeline.insert(this, this._startTime - this._delay));
                    for (d in a) this.vars[d] = a[d];
                    if (this._initted || f)
                        if (b) (this._initted = !1), f && this.render(0, !0, !0);
                        else if (
                            (this._gc && this._enabled(!0, !1),
                            this._notifyPluginsOfEnabled && this._firstPT && c._onPluginEvent("_onDisable", this),
                            this._time / this._duration > 0.998)
                        ) {
                            var g = this._totalTime;
                            this.render(0, !0, !1), (this._initted = !1), this.render(g, !0, !1);
                        } else if (((this._initted = !1), this._init(), this._time > 0 || f))
                            for (var h, i = 1 / (1 - e), j = this._firstPT; j; ) (h = j.s + j.c), (j.c *= i), (j.s = h - j.c), (j = j._next);
                    return this;
                }),
                (k.render = function(a, b, d) {
                    this._initted || (0 === this._duration && this.vars.repeat && this.invalidate());
                    var e,
                        f,
                        i,
                        j,
                        k,
                        l,
                        m,
                        n,
                        o,
                        p = this._dirty ? this.totalDuration() : this._totalDuration,
                        q = this._time,
                        r = this._totalTime,
                        s = this._cycle,
                        t = this._duration,
                        u = this._rawPrevTime;
                    if (
                        (a >= p - 1e-7 && a >= 0
                            ? ((this._totalTime = p),
                              (this._cycle = this._repeat),
                              this._yoyo && 0 !== (1 & this._cycle)
                                  ? ((this._time = 0), (this.ratio = this._ease._calcEnd ? this._ease.getRatio(0) : 0))
                                  : ((this._time = t), (this.ratio = this._ease._calcEnd ? this._ease.getRatio(1) : 1)),
                              this._reversed || ((e = !0), (f = "onComplete"), (d = d || this._timeline.autoRemoveChildren)),
                              0 === t &&
                                  (this._initted || !this.vars.lazy || d) &&
                                  (this._startTime === this._timeline._duration && (a = 0),
                                  (0 > u || (0 >= a && a >= -1e-7) || (u === g && "isPause" !== this.data)) && u !== a && ((d = !0), u > g && (f = "onReverseComplete")),
                                  (this._rawPrevTime = n = !b || a || u === a ? a : g)))
                            : 1e-7 > a
                            ? ((this._totalTime = this._time = this._cycle = 0),
                              (this.ratio = this._ease._calcEnd ? this._ease.getRatio(0) : 0),
                              (0 !== r || (0 === t && u > 0)) && ((f = "onReverseComplete"), (e = this._reversed)),
                              0 > a &&
                                  ((this._active = !1),
                                  0 === t && (this._initted || !this.vars.lazy || d) && (u >= 0 && (d = !0), (this._rawPrevTime = n = !b || a || u === a ? a : g))),
                              this._initted || (d = !0))
                            : ((this._totalTime = this._time = a),
                              0 !== this._repeat &&
                                  ((j = t + this._repeatDelay),
                                  (this._cycle = (this._totalTime / j) >> 0),
                                  0 !== this._cycle && this._cycle === this._totalTime / j && a >= r && this._cycle--,
                                  (this._time = this._totalTime - this._cycle * j),
                                  this._yoyo &&
                                      0 !== (1 & this._cycle) &&
                                      ((this._time = t - this._time),
                                      (o = this._yoyoEase || this.vars.yoyoEase),
                                      o &&
                                          (this._yoyoEase ||
                                              (o !== !0 || this._initted
                                                  ? (this._yoyoEase = o = o === !0 ? this._ease : o instanceof Ease ? o : Ease.map[o])
                                                  : ((o = this.vars.ease),
                                                    (this._yoyoEase = o = o
                                                        ? o instanceof Ease
                                                            ? o
                                                            : "function" == typeof o
                                                            ? new Ease(o, this.vars.easeParams)
                                                            : Ease.map[o] || c.defaultEase
                                                        : c.defaultEase))),
                                          (this.ratio = o ? 1 - o.getRatio((t - this._time) / t) : 0))),
                                  this._time > t ? (this._time = t) : this._time < 0 && (this._time = 0)),
                              this._easeType && !o
                                  ? ((k = this._time / t),
                                    (l = this._easeType),
                                    (m = this._easePower),
                                    (1 === l || (3 === l && k >= 0.5)) && (k = 1 - k),
                                    3 === l && (k *= 2),
                                    1 === m ? (k *= k) : 2 === m ? (k *= k * k) : 3 === m ? (k *= k * k * k) : 4 === m && (k *= k * k * k * k),
                                    1 === l ? (this.ratio = 1 - k) : 2 === l ? (this.ratio = k) : this._time / t < 0.5 ? (this.ratio = k / 2) : (this.ratio = 1 - k / 2))
                                  : o || (this.ratio = this._ease.getRatio(this._time / t))),
                        q === this._time && !d && s === this._cycle)
                    )
                        return void (r !== this._totalTime && this._onUpdate && (b || this._callback("onUpdate")));
                    if (!this._initted) {
                        if ((this._init(), !this._initted || this._gc)) return;
                        if (!d && this._firstPT && ((this.vars.lazy !== !1 && this._duration) || (this.vars.lazy && !this._duration)))
                            return (this._time = q), (this._totalTime = r), (this._rawPrevTime = u), (this._cycle = s), h.lazyTweens.push(this), void (this._lazy = [a, b]);
                        !this._time || e || o
                            ? e && this._ease._calcEnd && !o && (this.ratio = this._ease.getRatio(0 === this._time ? 0 : 1))
                            : (this.ratio = this._ease.getRatio(this._time / t));
                    }
                    for (
                        this._lazy !== !1 && (this._lazy = !1),
                            this._active || (!this._paused && this._time !== q && a >= 0 && (this._active = !0)),
                            0 === r &&
                                (2 === this._initted && a > 0 && this._init(),
                                this._startAt && (a >= 0 ? this._startAt.render(a, !0, d) : f || (f = "_dummyGS")),
                                this.vars.onStart && (0 !== this._totalTime || 0 === t) && (b || this._callback("onStart"))),
                            i = this._firstPT;
                        i;

                    )
                        i.f ? i.t[i.p](i.c * this.ratio + i.s) : (i.t[i.p] = i.c * this.ratio + i.s), (i = i._next);
                    this._onUpdate &&
                        (0 > a && this._startAt && this._startTime && this._startAt.render(a, !0, d), b || ((this._totalTime !== r || f) && this._callback("onUpdate"))),
                        this._cycle !== s && (b || this._gc || (this.vars.onRepeat && this._callback("onRepeat"))),
                        f &&
                            (!this._gc || d) &&
                            (0 > a && this._startAt && !this._onUpdate && this._startTime && this._startAt.render(a, !0, d),
                            e && (this._timeline.autoRemoveChildren && this._enabled(!1, !1), (this._active = !1)),
                            !b && this.vars[f] && this._callback(f),
                            0 === t && this._rawPrevTime === g && n !== g && (this._rawPrevTime = 0));
                }),
                (f.to = function(a, b, c) {
                    return new f(a, b, c);
                }),
                (f.from = function(a, b, c) {
                    return (c.runBackwards = !0), (c.immediateRender = 0 != c.immediateRender), new f(a, b, c);
                }),
                (f.fromTo = function(a, b, c, d) {
                    return (d.startAt = c), (d.immediateRender = 0 != d.immediateRender && 0 != c.immediateRender), new f(a, b, d);
                }),
                (f.staggerTo = f.allTo = function(a, b, g, h, k, m, n) {
                    h = h || 0;
                    var o,
                        p,
                        q,
                        r,
                        s = 0,
                        t = [],
                        u = function() {
                            g.onComplete && g.onComplete.apply(g.onCompleteScope || this, arguments), k.apply(n || g.callbackScope || this, m || l);
                        },
                        v = g.cycle,
                        w = g.startAt && g.startAt.cycle;
                    for (
                        j(a) || ("string" == typeof a && (a = c.selector(a) || a), i(a) && (a = d(a))),
                            a = a || [],
                            0 > h && ((a = d(a)), a.reverse(), (h *= -1)),
                            o = a.length - 1,
                            q = 0;
                        o >= q;
                        q++
                    ) {
                        p = {};
                        for (r in g) p[r] = g[r];
                        if ((v && (e(p, a, q), null != p.duration && ((b = p.duration), delete p.duration)), w)) {
                            w = p.startAt = {};
                            for (r in g.startAt) w[r] = g.startAt[r];
                            e(p.startAt, a, q);
                        }
                        (p.delay = s + (p.delay || 0)), q === o && k && (p.onComplete = u), (t[q] = new f(a[q], b, p)), (s += h);
                    }
                    return t;
                }),
                (f.staggerFrom = f.allFrom = function(a, b, c, d, e, g, h) {
                    return (c.runBackwards = !0), (c.immediateRender = 0 != c.immediateRender), f.staggerTo(a, b, c, d, e, g, h);
                }),
                (f.staggerFromTo = f.allFromTo = function(a, b, c, d, e, g, h, i) {
                    return (d.startAt = c), (d.immediateRender = 0 != d.immediateRender && 0 != c.immediateRender), f.staggerTo(a, b, d, e, g, h, i);
                }),
                (f.delayedCall = function(a, b, c, d, e) {
                    return new f(b, 0, {
                        delay: a,
                        onComplete: b,
                        onCompleteParams: c,
                        callbackScope: d,
                        onReverseComplete: b,
                        onReverseCompleteParams: c,
                        immediateRender: !1,
                        useFrames: e,
                        overwrite: 0
                    });
                }),
                (f.set = function(a, b) {
                    return new f(a, 0, b);
                }),
                (f.isTweening = function(a) {
                    return c.getTweensOf(a, !0).length > 0;
                });
            var m = function(a, b) {
                    for (var d = [], e = 0, f = a._first; f; ) f instanceof c ? (d[e++] = f) : (b && (d[e++] = f), (d = d.concat(m(f, b))), (e = d.length)), (f = f._next);
                    return d;
                },
                n = (f.getAllTweens = function(b) {
                    return m(a._rootTimeline, b).concat(m(a._rootFramesTimeline, b));
                });
            (f.killAll = function(a, c, d, e) {
                null == c && (c = !0), null == d && (d = !0);
                var f,
                    g,
                    h,
                    i = n(0 != e),
                    j = i.length,
                    k = c && d && e;
                for (h = 0; j > h; h++)
                    (g = i[h]),
                        (k || g instanceof b || ((f = g.target === g.vars.onComplete) && d) || (c && !f)) &&
                            (a ? g.totalTime(g._reversed ? 0 : g.totalDuration()) : g._enabled(!1, !1));
            }),
                (f.killChildTweensOf = function(a, b) {
                    if (null != a) {
                        var e,
                            g,
                            k,
                            l,
                            m,
                            n = h.tweenLookup;
                        if (("string" == typeof a && (a = c.selector(a) || a), i(a) && (a = d(a)), j(a))) for (l = a.length; --l > -1; ) f.killChildTweensOf(a[l], b);
                        else {
                            e = [];
                            for (k in n) for (g = n[k].target.parentNode; g; ) g === a && (e = e.concat(n[k].tweens)), (g = g.parentNode);
                            for (m = e.length, l = 0; m > l; l++) b && e[l].totalTime(e[l].totalDuration()), e[l]._enabled(!1, !1);
                        }
                    }
                });
            var o = function(a, c, d, e) {
                (c = c !== !1), (d = d !== !1), (e = e !== !1);
                for (var f, g, h = n(e), i = c && d && e, j = h.length; --j > -1; )
                    (g = h[j]), (i || g instanceof b || ((f = g.target === g.vars.onComplete) && d) || (c && !f)) && g.paused(a);
            };
            return (
                (f.pauseAll = function(a, b, c) {
                    o(!0, a, b, c);
                }),
                (f.resumeAll = function(a, b, c) {
                    o(!1, a, b, c);
                }),
                (f.globalTimeScale = function(b) {
                    var d = a._rootTimeline,
                        e = c.ticker.time;
                    return arguments.length
                        ? ((b = b || g),
                          (d._startTime = e - ((e - d._startTime) * d._timeScale) / b),
                          (d = a._rootFramesTimeline),
                          (e = c.ticker.frame),
                          (d._startTime = e - ((e - d._startTime) * d._timeScale) / b),
                          (d._timeScale = a._rootTimeline._timeScale = b),
                          b)
                        : d._timeScale;
                }),
                (k.progress = function(a, b) {
                    return arguments.length
                        ? this.totalTime(this.duration() * (this._yoyo && 0 !== (1 & this._cycle) ? 1 - a : a) + this._cycle * (this._duration + this._repeatDelay), b)
                        : this._time / this.duration();
                }),
                (k.totalProgress = function(a, b) {
                    return arguments.length ? this.totalTime(this.totalDuration() * a, b) : this._totalTime / this.totalDuration();
                }),
                (k.time = function(a, b) {
                    return arguments.length
                        ? (this._dirty && this.totalDuration(),
                          a > this._duration && (a = this._duration),
                          this._yoyo && 0 !== (1 & this._cycle)
                              ? (a = this._duration - a + this._cycle * (this._duration + this._repeatDelay))
                              : 0 !== this._repeat && (a += this._cycle * (this._duration + this._repeatDelay)),
                          this.totalTime(a, b))
                        : this._time;
                }),
                (k.duration = function(b) {
                    return arguments.length ? a.prototype.duration.call(this, b) : this._duration;
                }),
                (k.totalDuration = function(a) {
                    return arguments.length
                        ? -1 === this._repeat
                            ? this
                            : this.duration((a - this._repeat * this._repeatDelay) / (this._repeat + 1))
                        : (this._dirty &&
                              ((this._totalDuration = -1 === this._repeat ? 999999999999 : this._duration * (this._repeat + 1) + this._repeatDelay * this._repeat),
                              (this._dirty = !1)),
                          this._totalDuration);
                }),
                (k.repeat = function(a) {
                    return arguments.length ? ((this._repeat = a), this._uncache(!0)) : this._repeat;
                }),
                (k.repeatDelay = function(a) {
                    return arguments.length ? ((this._repeatDelay = a), this._uncache(!0)) : this._repeatDelay;
                }),
                (k.yoyo = function(a) {
                    return arguments.length ? ((this._yoyo = a), this) : this._yoyo;
                }),
                f
            );
        },
        !0
    ),
        _gsScope._gsDefine(
            "TimelineLite",
            ["core.Animation", "core.SimpleTimeline", "TweenLite"],
            function(a, b, c) {
                var d = function(a) {
                        b.call(this, a),
                            (this._labels = {}),
                            (this.autoRemoveChildren = this.vars.autoRemoveChildren === !0),
                            (this.smoothChildTiming = this.vars.smoothChildTiming === !0),
                            (this._sortChildren = !0),
                            (this._onUpdate = this.vars.onUpdate);
                        var c,
                            d,
                            e = this.vars;
                        for (d in e) (c = e[d]), i(c) && -1 !== c.join("").indexOf("{self}") && (e[d] = this._swapSelfInParams(c));
                        i(e.tweens) && this.add(e.tweens, 0, e.align, e.stagger);
                    },
                    e = 1e-10,
                    f = c._internals,
                    g = (d._internals = {}),
                    h = f.isSelector,
                    i = f.isArray,
                    j = f.lazyTweens,
                    k = f.lazyRender,
                    l = _gsScope._gsDefine.globals,
                    m = function(a) {
                        var b,
                            c = {};
                        for (b in a) c[b] = a[b];
                        return c;
                    },
                    n = function(a, b, c) {
                        var d,
                            e,
                            f = a.cycle;
                        for (d in f) (e = f[d]), (a[d] = "function" == typeof e ? e(c, b[c]) : e[c % e.length]);
                        delete a.cycle;
                    },
                    o = (g.pauseCallback = function() {}),
                    p = function(a) {
                        var b,
                            c = [],
                            d = a.length;
                        for (b = 0; b !== d; c.push(a[b++]));
                        return c;
                    },
                    q = (d.prototype = new b());
                return (
                    (d.version = "1.20.3"),
                    (q.constructor = d),
                    (q.kill()._gc = q._forcingPlayhead = q._hasPause = !1),
                    (q.to = function(a, b, d, e) {
                        var f = (d.repeat && l.TweenMax) || c;
                        return b ? this.add(new f(a, b, d), e) : this.set(a, d, e);
                    }),
                    (q.from = function(a, b, d, e) {
                        return this.add(((d.repeat && l.TweenMax) || c).from(a, b, d), e);
                    }),
                    (q.fromTo = function(a, b, d, e, f) {
                        var g = (e.repeat && l.TweenMax) || c;
                        return b ? this.add(g.fromTo(a, b, d, e), f) : this.set(a, e, f);
                    }),
                    (q.staggerTo = function(a, b, e, f, g, i, j, k) {
                        var l,
                            o,
                            q = new d({ onComplete: i, onCompleteParams: j, callbackScope: k, smoothChildTiming: this.smoothChildTiming }),
                            r = e.cycle;
                        for (
                            "string" == typeof a && (a = c.selector(a) || a), a = a || [], h(a) && (a = p(a)), f = f || 0, 0 > f && ((a = p(a)), a.reverse(), (f *= -1)), o = 0;
                            o < a.length;
                            o++
                        )
                            (l = m(e)),
                                l.startAt && ((l.startAt = m(l.startAt)), l.startAt.cycle && n(l.startAt, a, o)),
                                r && (n(l, a, o), null != l.duration && ((b = l.duration), delete l.duration)),
                                q.to(a[o], b, l, o * f);
                        return this.add(q, g);
                    }),
                    (q.staggerFrom = function(a, b, c, d, e, f, g, h) {
                        return (c.immediateRender = 0 != c.immediateRender), (c.runBackwards = !0), this.staggerTo(a, b, c, d, e, f, g, h);
                    }),
                    (q.staggerFromTo = function(a, b, c, d, e, f, g, h, i) {
                        return (d.startAt = c), (d.immediateRender = 0 != d.immediateRender && 0 != c.immediateRender), this.staggerTo(a, b, d, e, f, g, h, i);
                    }),
                    (q.call = function(a, b, d, e) {
                        return this.add(c.delayedCall(0, a, b, d), e);
                    }),
                    (q.set = function(a, b, d) {
                        return (
                            (d = this._parseTimeOrLabel(d, 0, !0)),
                            null == b.immediateRender && (b.immediateRender = d === this._time && !this._paused),
                            this.add(new c(a, 0, b), d)
                        );
                    }),
                    (d.exportRoot = function(a, b) {
                        (a = a || {}), null == a.smoothChildTiming && (a.smoothChildTiming = !0);
                        var e,
                            f,
                            g,
                            h,
                            i = new d(a),
                            j = i._timeline;
                        for (null == b && (b = !0), j._remove(i, !0), i._startTime = 0, i._rawPrevTime = i._time = i._totalTime = j._time, g = j._first; g; )
                            (h = g._next), (b && g instanceof c && g.target === g.vars.onComplete) || ((f = g._startTime - g._delay), 0 > f && (e = 1), i.add(g, f)), (g = h);
                        return j.add(i, 0), e && i.totalDuration(), i;
                    }),
                    (q.add = function(e, f, g, h) {
                        var j, k, l, m, n, o;
                        if (("number" != typeof f && (f = this._parseTimeOrLabel(f, 0, !0, e)), !(e instanceof a))) {
                            if (e instanceof Array || (e && e.push && i(e))) {
                                for (g = g || "normal", h = h || 0, j = f, k = e.length, l = 0; k > l; l++)
                                    i((m = e[l])) && (m = new d({ tweens: m })),
                                        this.add(m, j),
                                        "string" != typeof m &&
                                            "function" != typeof m &&
                                            ("sequence" === g ? (j = m._startTime + m.totalDuration() / m._timeScale) : "start" === g && (m._startTime -= m.delay())),
                                        (j += h);
                                return this._uncache(!0);
                            }
                            if ("string" == typeof e) return this.addLabel(e, f);
                            if ("function" != typeof e) throw "Cannot add " + e + " into the timeline; it is not a tween, timeline, function, or string.";
                            e = c.delayedCall(0, e);
                        }
                        if (
                            (b.prototype.add.call(this, e, f),
                            e._time && e.render((this.rawTime() - e._startTime) * e._timeScale, !1, !1),
                            (this._gc || this._time === this._duration) && !this._paused && this._duration < this.duration())
                        )
                            for (n = this, o = n.rawTime() > e._startTime; n._timeline; )
                                o && n._timeline.smoothChildTiming ? n.totalTime(n._totalTime, !0) : n._gc && n._enabled(!0, !1), (n = n._timeline);
                        return this;
                    }),
                    (q.remove = function(b) {
                        if (b instanceof a) {
                            this._remove(b, !1);
                            var c = (b._timeline = b.vars.useFrames ? a._rootFramesTimeline : a._rootTimeline);
                            return (b._startTime = (b._paused ? b._pauseTime : c._time) - (b._reversed ? b.totalDuration() - b._totalTime : b._totalTime) / b._timeScale), this;
                        }
                        if (b instanceof Array || (b && b.push && i(b))) {
                            for (var d = b.length; --d > -1; ) this.remove(b[d]);
                            return this;
                        }
                        return "string" == typeof b ? this.removeLabel(b) : this.kill(null, b);
                    }),
                    (q._remove = function(a, c) {
                        b.prototype._remove.call(this, a, c);
                        var d = this._last;
                        return (
                            d
                                ? this._time > this.duration() && ((this._time = this._duration), (this._totalTime = this._totalDuration))
                                : (this._time = this._totalTime = this._duration = this._totalDuration = 0),
                            this
                        );
                    }),
                    (q.append = function(a, b) {
                        return this.add(a, this._parseTimeOrLabel(null, b, !0, a));
                    }),
                    (q.insert = q.insertMultiple = function(a, b, c, d) {
                        return this.add(a, b || 0, c, d);
                    }),
                    (q.appendMultiple = function(a, b, c, d) {
                        return this.add(a, this._parseTimeOrLabel(null, b, !0, a), c, d);
                    }),
                    (q.addLabel = function(a, b) {
                        return (this._labels[a] = this._parseTimeOrLabel(b)), this;
                    }),
                    (q.addPause = function(a, b, d, e) {
                        var f = c.delayedCall(0, o, d, e || this);
                        return (f.vars.onComplete = f.vars.onReverseComplete = b), (f.data = "isPause"), (this._hasPause = !0), this.add(f, a);
                    }),
                    (q.removeLabel = function(a) {
                        return delete this._labels[a], this;
                    }),
                    (q.getLabelTime = function(a) {
                        return null != this._labels[a] ? this._labels[a] : -1;
                    }),
                    (q._parseTimeOrLabel = function(b, c, d, e) {
                        var f, g;
                        if (e instanceof a && e.timeline === this) this.remove(e);
                        else if (e && (e instanceof Array || (e.push && i(e)))) for (g = e.length; --g > -1; ) e[g] instanceof a && e[g].timeline === this && this.remove(e[g]);
                        if (((f = "number" != typeof b || c ? (this.duration() > 99999999999 ? this.recent().endTime(!1) : this._duration) : 0), "string" == typeof c))
                            return this._parseTimeOrLabel(c, d && "number" == typeof b && null == this._labels[c] ? b - f : 0, d);
                        if (((c = c || 0), "string" != typeof b || (!isNaN(b) && null == this._labels[b]))) null == b && (b = f);
                        else {
                            if (((g = b.indexOf("=")), -1 === g)) return null == this._labels[b] ? (d ? (this._labels[b] = f + c) : c) : this._labels[b] + c;
                            (c = parseInt(b.charAt(g - 1) + "1", 10) * Number(b.substr(g + 1))), (b = g > 1 ? this._parseTimeOrLabel(b.substr(0, g - 1), 0, d) : f);
                        }
                        return Number(b) + c;
                    }),
                    (q.seek = function(a, b) {
                        return this.totalTime("number" == typeof a ? a : this._parseTimeOrLabel(a), b !== !1);
                    }),
                    (q.stop = function() {
                        return this.paused(!0);
                    }),
                    (q.gotoAndPlay = function(a, b) {
                        return this.play(a, b);
                    }),
                    (q.gotoAndStop = function(a, b) {
                        return this.pause(a, b);
                    }),
                    (q.render = function(a, b, c) {
                        this._gc && this._enabled(!0, !1);
                        var d,
                            f,
                            g,
                            h,
                            i,
                            l,
                            m,
                            n = this._time,
                            o = this._dirty ? this.totalDuration() : this._totalDuration,
                            p = this._startTime,
                            q = this._timeScale,
                            r = this._paused;
                        if ((n !== this._time && (a += this._time - n), a >= o - 1e-7 && a >= 0))
                            (this._totalTime = this._time = o),
                                this._reversed ||
                                    this._hasPausedChild() ||
                                    ((f = !0),
                                    (h = "onComplete"),
                                    (i = !!this._timeline.autoRemoveChildren),
                                    0 === this._duration &&
                                        ((0 >= a && a >= -1e-7) || this._rawPrevTime < 0 || this._rawPrevTime === e) &&
                                        this._rawPrevTime !== a &&
                                        this._first &&
                                        ((i = !0), this._rawPrevTime > e && (h = "onReverseComplete"))),
                                (this._rawPrevTime = this._duration || !b || a || this._rawPrevTime === a ? a : e),
                                (a = o + 1e-4);
                        else if (1e-7 > a)
                            if (
                                ((this._totalTime = this._time = 0),
                                (0 !== n || (0 === this._duration && this._rawPrevTime !== e && (this._rawPrevTime > 0 || (0 > a && this._rawPrevTime >= 0)))) &&
                                    ((h = "onReverseComplete"), (f = this._reversed)),
                                0 > a)
                            )
                                (this._active = !1),
                                    this._timeline.autoRemoveChildren && this._reversed
                                        ? ((i = f = !0), (h = "onReverseComplete"))
                                        : this._rawPrevTime >= 0 && this._first && (i = !0),
                                    (this._rawPrevTime = a);
                            else {
                                if (((this._rawPrevTime = this._duration || !b || a || this._rawPrevTime === a ? a : e), 0 === a && f))
                                    for (d = this._first; d && 0 === d._startTime; ) d._duration || (f = !1), (d = d._next);
                                (a = 0), this._initted || (i = !0);
                            }
                        else {
                            if (this._hasPause && !this._forcingPlayhead && !b) {
                                if (a >= n)
                                    for (d = this._first; d && d._startTime <= a && !l; )
                                        d._duration || "isPause" !== d.data || d.ratio || (0 === d._startTime && 0 === this._rawPrevTime) || (l = d), (d = d._next);
                                else for (d = this._last; d && d._startTime >= a && !l; ) d._duration || ("isPause" === d.data && d._rawPrevTime > 0 && (l = d)), (d = d._prev);
                                l && ((this._time = a = l._startTime), (this._totalTime = a + this._cycle * (this._totalDuration + this._repeatDelay)));
                            }
                            this._totalTime = this._time = this._rawPrevTime = a;
                        }
                        if ((this._time !== n && this._first) || c || i || l) {
                            if (
                                (this._initted || (this._initted = !0),
                                this._active || (!this._paused && this._time !== n && a > 0 && (this._active = !0)),
                                0 === n && this.vars.onStart && ((0 === this._time && this._duration) || b || this._callback("onStart")),
                                (m = this._time),
                                m >= n)
                            )
                                for (d = this._first; d && ((g = d._next), m === this._time && (!this._paused || r)); )
                                    (d._active || (d._startTime <= m && !d._paused && !d._gc)) &&
                                        (l === d && this.pause(),
                                        d._reversed
                                            ? d.render((d._dirty ? d.totalDuration() : d._totalDuration) - (a - d._startTime) * d._timeScale, b, c)
                                            : d.render((a - d._startTime) * d._timeScale, b, c)),
                                        (d = g);
                            else
                                for (d = this._last; d && ((g = d._prev), m === this._time && (!this._paused || r)); ) {
                                    if (d._active || (d._startTime <= n && !d._paused && !d._gc)) {
                                        if (l === d) {
                                            for (l = d._prev; l && l.endTime() > this._time; )
                                                l.render(l._reversed ? l.totalDuration() - (a - l._startTime) * l._timeScale : (a - l._startTime) * l._timeScale, b, c),
                                                    (l = l._prev);
                                            (l = null), this.pause();
                                        }
                                        d._reversed
                                            ? d.render((d._dirty ? d.totalDuration() : d._totalDuration) - (a - d._startTime) * d._timeScale, b, c)
                                            : d.render((a - d._startTime) * d._timeScale, b, c);
                                    }
                                    d = g;
                                }
                            this._onUpdate && (b || (j.length && k(), this._callback("onUpdate"))),
                                h &&
                                    (this._gc ||
                                        ((p === this._startTime || q !== this._timeScale) &&
                                            (0 === this._time || o >= this.totalDuration()) &&
                                            (f && (j.length && k(), this._timeline.autoRemoveChildren && this._enabled(!1, !1), (this._active = !1)),
                                            !b && this.vars[h] && this._callback(h))));
                        }
                    }),
                    (q._hasPausedChild = function() {
                        for (var a = this._first; a; ) {
                            if (a._paused || (a instanceof d && a._hasPausedChild())) return !0;
                            a = a._next;
                        }
                        return !1;
                    }),
                    (q.getChildren = function(a, b, d, e) {
                        e = e || -9999999999;
                        for (var f = [], g = this._first, h = 0; g; )
                            g._startTime < e ||
                                (g instanceof c ? b !== !1 && (f[h++] = g) : (d !== !1 && (f[h++] = g), a !== !1 && ((f = f.concat(g.getChildren(!0, b, d))), (h = f.length)))),
                                (g = g._next);
                        return f;
                    }),
                    (q.getTweensOf = function(a, b) {
                        var d,
                            e,
                            f = this._gc,
                            g = [],
                            h = 0;
                        for (f && this._enabled(!0, !0), d = c.getTweensOf(a), e = d.length; --e > -1; ) (d[e].timeline === this || (b && this._contains(d[e]))) && (g[h++] = d[e]);
                        return f && this._enabled(!1, !0), g;
                    }),
                    (q.recent = function() {
                        return this._recent;
                    }),
                    (q._contains = function(a) {
                        for (var b = a.timeline; b; ) {
                            if (b === this) return !0;
                            b = b.timeline;
                        }
                        return !1;
                    }),
                    (q.shiftChildren = function(a, b, c) {
                        c = c || 0;
                        for (var d, e = this._first, f = this._labels; e; ) e._startTime >= c && (e._startTime += a), (e = e._next);
                        if (b) for (d in f) f[d] >= c && (f[d] += a);
                        return this._uncache(!0);
                    }),
                    (q._kill = function(a, b) {
                        if (!a && !b) return this._enabled(!1, !1);
                        for (var c = b ? this.getTweensOf(b) : this.getChildren(!0, !0, !1), d = c.length, e = !1; --d > -1; ) c[d]._kill(a, b) && (e = !0);
                        return e;
                    }),
                    (q.clear = function(a) {
                        var b = this.getChildren(!1, !0, !0),
                            c = b.length;
                        for (this._time = this._totalTime = 0; --c > -1; ) b[c]._enabled(!1, !1);
                        return a !== !1 && (this._labels = {}), this._uncache(!0);
                    }),
                    (q.invalidate = function() {
                        for (var b = this._first; b; ) b.invalidate(), (b = b._next);
                        return a.prototype.invalidate.call(this);
                    }),
                    (q._enabled = function(a, c) {
                        if (a === this._gc) for (var d = this._first; d; ) d._enabled(a, !0), (d = d._next);
                        return b.prototype._enabled.call(this, a, c);
                    }),
                    (q.totalTime = function(b, c, d) {
                        this._forcingPlayhead = !0;
                        var e = a.prototype.totalTime.apply(this, arguments);
                        return (this._forcingPlayhead = !1), e;
                    }),
                    (q.duration = function(a) {
                        return arguments.length
                            ? (0 !== this.duration() && 0 !== a && this.timeScale(this._duration / a), this)
                            : (this._dirty && this.totalDuration(), this._duration);
                    }),
                    (q.totalDuration = function(a) {
                        if (!arguments.length) {
                            if (this._dirty) {
                                for (var b, c, d = 0, e = this._last, f = 999999999999; e; )
                                    (b = e._prev),
                                        e._dirty && e.totalDuration(),
                                        e._startTime > f && this._sortChildren && !e._paused && !this._calculatingDuration
                                            ? ((this._calculatingDuration = 1), this.add(e, e._startTime - e._delay), (this._calculatingDuration = 0))
                                            : (f = e._startTime),
                                        e._startTime < 0 &&
                                            !e._paused &&
                                            ((d -= e._startTime),
                                            this._timeline.smoothChildTiming &&
                                                ((this._startTime += e._startTime / this._timeScale),
                                                (this._time -= e._startTime),
                                                (this._totalTime -= e._startTime),
                                                (this._rawPrevTime -= e._startTime)),
                                            this.shiftChildren(-e._startTime, !1, -9999999999),
                                            (f = 0)),
                                        (c = e._startTime + e._totalDuration / e._timeScale),
                                        c > d && (d = c),
                                        (e = b);
                                (this._duration = this._totalDuration = d), (this._dirty = !1);
                            }
                            return this._totalDuration;
                        }
                        return a && this.totalDuration() ? this.timeScale(this._totalDuration / a) : this;
                    }),
                    (q.paused = function(b) {
                        if (!b) for (var c = this._first, d = this._time; c; ) c._startTime === d && "isPause" === c.data && (c._rawPrevTime = 0), (c = c._next);
                        return a.prototype.paused.apply(this, arguments);
                    }),
                    (q.usesFrames = function() {
                        for (var b = this._timeline; b._timeline; ) b = b._timeline;
                        return b === a._rootFramesTimeline;
                    }),
                    (q.rawTime = function(a) {
                        return a && (this._paused || (this._repeat && this.time() > 0 && this.totalProgress() < 1))
                            ? this._totalTime % (this._duration + this._repeatDelay)
                            : this._paused
                            ? this._totalTime
                            : (this._timeline.rawTime(a) - this._startTime) * this._timeScale;
                    }),
                    d
                );
            },
            !0
        ),
        _gsScope._gsDefine(
            "TimelineMax",
            ["TimelineLite", "TweenLite", "easing.Ease"],
            function(a, b, c) {
                var d = function(b) {
                        a.call(this, b),
                            (this._repeat = this.vars.repeat || 0),
                            (this._repeatDelay = this.vars.repeatDelay || 0),
                            (this._cycle = 0),
                            (this._yoyo = this.vars.yoyo === !0),
                            (this._dirty = !0);
                    },
                    e = 1e-10,
                    f = b._internals,
                    g = f.lazyTweens,
                    h = f.lazyRender,
                    i = _gsScope._gsDefine.globals,
                    j = new c(null, null, 1, 0),
                    k = (d.prototype = new a());
                return (
                    (k.constructor = d),
                    (k.kill()._gc = !1),
                    (d.version = "1.20.3"),
                    (k.invalidate = function() {
                        return (
                            (this._yoyo = this.vars.yoyo === !0),
                            (this._repeat = this.vars.repeat || 0),
                            (this._repeatDelay = this.vars.repeatDelay || 0),
                            this._uncache(!0),
                            a.prototype.invalidate.call(this)
                        );
                    }),
                    (k.addCallback = function(a, c, d, e) {
                        return this.add(b.delayedCall(0, a, d, e), c);
                    }),
                    (k.removeCallback = function(a, b) {
                        if (a)
                            if (null == b) this._kill(null, a);
                            else for (var c = this.getTweensOf(a, !1), d = c.length, e = this._parseTimeOrLabel(b); --d > -1; ) c[d]._startTime === e && c[d]._enabled(!1, !1);
                        return this;
                    }),
                    (k.removePause = function(b) {
                        return this.removeCallback(a._internals.pauseCallback, b);
                    }),
                    (k.tweenTo = function(a, c) {
                        c = c || {};
                        var d,
                            e,
                            f,
                            g = { ease: j, useFrames: this.usesFrames(), immediateRender: !1 },
                            h = (c.repeat && i.TweenMax) || b;
                        for (e in c) g[e] = c[e];
                        return (
                            (g.time = this._parseTimeOrLabel(a)),
                            (d = Math.abs(Number(g.time) - this._time) / this._timeScale || 0.001),
                            (f = new h(this, d, g)),
                            (g.onStart = function() {
                                f.target.paused(!0),
                                    f.vars.time !== f.target.time() && d === f.duration() && f.duration(Math.abs(f.vars.time - f.target.time()) / f.target._timeScale),
                                    c.onStart && c.onStart.apply(c.onStartScope || c.callbackScope || f, c.onStartParams || []);
                            }),
                            f
                        );
                    }),
                    (k.tweenFromTo = function(a, b, c) {
                        (c = c || {}),
                            (a = this._parseTimeOrLabel(a)),
                            (c.startAt = { onComplete: this.seek, onCompleteParams: [a], callbackScope: this }),
                            (c.immediateRender = c.immediateRender !== !1);
                        var d = this.tweenTo(b, c);
                        return d.duration(Math.abs(d.vars.time - a) / this._timeScale || 0.001);
                    }),
                    (k.render = function(a, b, c) {
                        this._gc && this._enabled(!0, !1);
                        var d,
                            f,
                            i,
                            j,
                            k,
                            l,
                            m,
                            n,
                            o = this._time,
                            p = this._dirty ? this.totalDuration() : this._totalDuration,
                            q = this._duration,
                            r = this._totalTime,
                            s = this._startTime,
                            t = this._timeScale,
                            u = this._rawPrevTime,
                            v = this._paused,
                            w = this._cycle;
                        if ((o !== this._time && (a += this._time - o), a >= p - 1e-7 && a >= 0))
                            this._locked || ((this._totalTime = p), (this._cycle = this._repeat)),
                                this._reversed ||
                                    this._hasPausedChild() ||
                                    ((f = !0),
                                    (j = "onComplete"),
                                    (k = !!this._timeline.autoRemoveChildren),
                                    0 === this._duration &&
                                        ((0 >= a && a >= -1e-7) || 0 > u || u === e) &&
                                        u !== a &&
                                        this._first &&
                                        ((k = !0), u > e && (j = "onReverseComplete"))),
                                (this._rawPrevTime = this._duration || !b || a || this._rawPrevTime === a ? a : e),
                                this._yoyo && 0 !== (1 & this._cycle) ? (this._time = a = 0) : ((this._time = q), (a = q + 1e-4));
                        else if (1e-7 > a)
                            if (
                                (this._locked || (this._totalTime = this._cycle = 0),
                                (this._time = 0),
                                (0 !== o || (0 === q && u !== e && (u > 0 || (0 > a && u >= 0)) && !this._locked)) && ((j = "onReverseComplete"), (f = this._reversed)),
                                0 > a)
                            )
                                (this._active = !1),
                                    this._timeline.autoRemoveChildren && this._reversed ? ((k = f = !0), (j = "onReverseComplete")) : u >= 0 && this._first && (k = !0),
                                    (this._rawPrevTime = a);
                            else {
                                if (((this._rawPrevTime = q || !b || a || this._rawPrevTime === a ? a : e), 0 === a && f))
                                    for (d = this._first; d && 0 === d._startTime; ) d._duration || (f = !1), (d = d._next);
                                (a = 0), this._initted || (k = !0);
                            }
                        else if (
                            (0 === q && 0 > u && (k = !0),
                            (this._time = this._rawPrevTime = a),
                            this._locked ||
                                ((this._totalTime = a),
                                0 !== this._repeat &&
                                    ((l = q + this._repeatDelay),
                                    (this._cycle = (this._totalTime / l) >> 0),
                                    0 !== this._cycle && this._cycle === this._totalTime / l && a >= r && this._cycle--,
                                    (this._time = this._totalTime - this._cycle * l),
                                    this._yoyo && 0 !== (1 & this._cycle) && (this._time = q - this._time),
                                    this._time > q ? ((this._time = q), (a = q + 1e-4)) : this._time < 0 ? (this._time = a = 0) : (a = this._time))),
                            this._hasPause && !this._forcingPlayhead && !b)
                        ) {
                            if (((a = this._time), a >= o || (this._repeat && w !== this._cycle)))
                                for (d = this._first; d && d._startTime <= a && !m; )
                                    d._duration || "isPause" !== d.data || d.ratio || (0 === d._startTime && 0 === this._rawPrevTime) || (m = d), (d = d._next);
                            else for (d = this._last; d && d._startTime >= a && !m; ) d._duration || ("isPause" === d.data && d._rawPrevTime > 0 && (m = d)), (d = d._prev);
                            m && m._startTime < q && ((this._time = a = m._startTime), (this._totalTime = a + this._cycle * (this._totalDuration + this._repeatDelay)));
                        }
                        if (this._cycle !== w && !this._locked) {
                            var x = this._yoyo && 0 !== (1 & w),
                                y = x === (this._yoyo && 0 !== (1 & this._cycle)),
                                z = this._totalTime,
                                A = this._cycle,
                                B = this._rawPrevTime,
                                C = this._time;
                            if (
                                ((this._totalTime = w * q),
                                this._cycle < w ? (x = !x) : (this._totalTime += q),
                                (this._time = o),
                                (this._rawPrevTime = 0 === q ? u - 1e-4 : u),
                                (this._cycle = w),
                                (this._locked = !0),
                                (o = x ? 0 : q),
                                this.render(o, b, 0 === q),
                                b || this._gc || (this.vars.onRepeat && ((this._cycle = A), (this._locked = !1), this._callback("onRepeat"))),
                                o !== this._time)
                            )
                                return;
                            if ((y && ((this._cycle = w), (this._locked = !0), (o = x ? q + 1e-4 : -1e-4), this.render(o, !0, !1)), (this._locked = !1), this._paused && !v))
                                return;
                            (this._time = C), (this._totalTime = z), (this._cycle = A), (this._rawPrevTime = B);
                        }
                        if (!((this._time !== o && this._first) || c || k || m)) return void (r !== this._totalTime && this._onUpdate && (b || this._callback("onUpdate")));
                        if (
                            (this._initted || (this._initted = !0),
                            this._active || (!this._paused && this._totalTime !== r && a > 0 && (this._active = !0)),
                            0 === r && this.vars.onStart && ((0 === this._totalTime && this._totalDuration) || b || this._callback("onStart")),
                            (n = this._time),
                            n >= o)
                        )
                            for (d = this._first; d && ((i = d._next), n === this._time && (!this._paused || v)); )
                                (d._active || (d._startTime <= this._time && !d._paused && !d._gc)) &&
                                    (m === d && this.pause(),
                                    d._reversed
                                        ? d.render((d._dirty ? d.totalDuration() : d._totalDuration) - (a - d._startTime) * d._timeScale, b, c)
                                        : d.render((a - d._startTime) * d._timeScale, b, c)),
                                    (d = i);
                        else
                            for (d = this._last; d && ((i = d._prev), n === this._time && (!this._paused || v)); ) {
                                if (d._active || (d._startTime <= o && !d._paused && !d._gc)) {
                                    if (m === d) {
                                        for (m = d._prev; m && m.endTime() > this._time; )
                                            m.render(m._reversed ? m.totalDuration() - (a - m._startTime) * m._timeScale : (a - m._startTime) * m._timeScale, b, c), (m = m._prev);
                                        (m = null), this.pause();
                                    }
                                    d._reversed
                                        ? d.render((d._dirty ? d.totalDuration() : d._totalDuration) - (a - d._startTime) * d._timeScale, b, c)
                                        : d.render((a - d._startTime) * d._timeScale, b, c);
                                }
                                d = i;
                            }
                        this._onUpdate && (b || (g.length && h(), this._callback("onUpdate"))),
                            j &&
                                (this._locked ||
                                    this._gc ||
                                    ((s === this._startTime || t !== this._timeScale) &&
                                        (0 === this._time || p >= this.totalDuration()) &&
                                        (f && (g.length && h(), this._timeline.autoRemoveChildren && this._enabled(!1, !1), (this._active = !1)),
                                        !b && this.vars[j] && this._callback(j))));
                    }),
                    (k.getActive = function(a, b, c) {
                        null == a && (a = !0), null == b && (b = !0), null == c && (c = !1);
                        var d,
                            e,
                            f = [],
                            g = this.getChildren(a, b, c),
                            h = 0,
                            i = g.length;
                        for (d = 0; i > d; d++) (e = g[d]), e.isActive() && (f[h++] = e);
                        return f;
                    }),
                    (k.getLabelAfter = function(a) {
                        a || (0 !== a && (a = this._time));
                        var b,
                            c = this.getLabelsArray(),
                            d = c.length;
                        for (b = 0; d > b; b++) if (c[b].time > a) return c[b].name;
                        return null;
                    }),
                    (k.getLabelBefore = function(a) {
                        null == a && (a = this._time);
                        for (var b = this.getLabelsArray(), c = b.length; --c > -1; ) if (b[c].time < a) return b[c].name;
                        return null;
                    }),
                    (k.getLabelsArray = function() {
                        var a,
                            b = [],
                            c = 0;
                        for (a in this._labels) b[c++] = { time: this._labels[a], name: a };
                        return (
                            b.sort(function(a, b) {
                                return a.time - b.time;
                            }),
                            b
                        );
                    }),
                    (k.invalidate = function() {
                        return (this._locked = !1), a.prototype.invalidate.call(this);
                    }),
                    (k.progress = function(a, b) {
                        return arguments.length
                            ? this.totalTime(this.duration() * (this._yoyo && 0 !== (1 & this._cycle) ? 1 - a : a) + this._cycle * (this._duration + this._repeatDelay), b)
                            : this._time / this.duration() || 0;
                    }),
                    (k.totalProgress = function(a, b) {
                        return arguments.length ? this.totalTime(this.totalDuration() * a, b) : this._totalTime / this.totalDuration() || 0;
                    }),
                    (k.totalDuration = function(b) {
                        return arguments.length
                            ? -1 !== this._repeat && b
                                ? this.timeScale(this.totalDuration() / b)
                                : this
                            : (this._dirty &&
                                  (a.prototype.totalDuration.call(this),
                                  (this._totalDuration = -1 === this._repeat ? 999999999999 : this._duration * (this._repeat + 1) + this._repeatDelay * this._repeat)),
                              this._totalDuration);
                    }),
                    (k.time = function(a, b) {
                        return arguments.length
                            ? (this._dirty && this.totalDuration(),
                              a > this._duration && (a = this._duration),
                              this._yoyo && 0 !== (1 & this._cycle)
                                  ? (a = this._duration - a + this._cycle * (this._duration + this._repeatDelay))
                                  : 0 !== this._repeat && (a += this._cycle * (this._duration + this._repeatDelay)),
                              this.totalTime(a, b))
                            : this._time;
                    }),
                    (k.repeat = function(a) {
                        return arguments.length ? ((this._repeat = a), this._uncache(!0)) : this._repeat;
                    }),
                    (k.repeatDelay = function(a) {
                        return arguments.length ? ((this._repeatDelay = a), this._uncache(!0)) : this._repeatDelay;
                    }),
                    (k.yoyo = function(a) {
                        return arguments.length ? ((this._yoyo = a), this) : this._yoyo;
                    }),
                    (k.currentLabel = function(a) {
                        return arguments.length ? this.seek(a, !0) : this.getLabelBefore(this._time + 1e-8);
                    }),
                    d
                );
            },
            !0
        ),
        (function() {
            var a = 180 / Math.PI,
                b = [],
                c = [],
                d = [],
                e = {},
                f = _gsScope._gsDefine.globals,
                g = function(a, b, c, d) {
                    c === d && (c = d - (d - b) / 1e6),
                        a === b && (b = a + (c - a) / 1e6),
                        (this.a = a),
                        (this.b = b),
                        (this.c = c),
                        (this.d = d),
                        (this.da = d - a),
                        (this.ca = c - a),
                        (this.ba = b - a);
                },
                h =
                    ",x,y,z,left,top,right,bottom,marginTop,marginLeft,marginRight,marginBottom,paddingLeft,paddingTop,paddingRight,paddingBottom,backgroundPosition,backgroundPosition_y,",
                i = function(a, b, c, d) {
                    var e = { a: a },
                        f = {},
                        g = {},
                        h = { c: d },
                        i = (a + b) / 2,
                        j = (b + c) / 2,
                        k = (c + d) / 2,
                        l = (i + j) / 2,
                        m = (j + k) / 2,
                        n = (m - l) / 8;
                    return (
                        (e.b = i + (a - i) / 4),
                        (f.b = l + n),
                        (e.c = f.a = (e.b + f.b) / 2),
                        (f.c = g.a = (l + m) / 2),
                        (g.b = m - n),
                        (h.b = k + (d - k) / 4),
                        (g.c = h.a = (g.b + h.b) / 2),
                        [e, f, g, h]
                    );
                },
                j = function(a, e, f, g, h) {
                    var j,
                        k,
                        l,
                        m,
                        n,
                        o,
                        p,
                        q,
                        r,
                        s,
                        t,
                        u,
                        v,
                        w = a.length - 1,
                        x = 0,
                        y = a[0].a;
                    for (j = 0; w > j; j++)
                        (n = a[x]),
                            (k = n.a),
                            (l = n.d),
                            (m = a[x + 1].d),
                            h
                                ? ((t = b[j]),
                                  (u = c[j]),
                                  (v = ((u + t) * e * 0.25) / (g ? 0.5 : d[j] || 0.5)),
                                  (o = l - (l - k) * (g ? 0.5 * e : 0 !== t ? v / t : 0)),
                                  (p = l + (m - l) * (g ? 0.5 * e : 0 !== u ? v / u : 0)),
                                  (q = l - (o + (((p - o) * ((3 * t) / (t + u) + 0.5)) / 4 || 0))))
                                : ((o = l - (l - k) * e * 0.5), (p = l + (m - l) * e * 0.5), (q = l - (o + p) / 2)),
                            (o += q),
                            (p += q),
                            (n.c = r = o),
                            0 !== j ? (n.b = y) : (n.b = y = n.a + 0.6 * (n.c - n.a)),
                            (n.da = l - k),
                            (n.ca = r - k),
                            (n.ba = y - k),
                            f ? ((s = i(k, y, r, l)), a.splice(x, 1, s[0], s[1], s[2], s[3]), (x += 4)) : x++,
                            (y = p);
                    (n = a[x]),
                        (n.b = y),
                        (n.c = y + 0.4 * (n.d - y)),
                        (n.da = n.d - n.a),
                        (n.ca = n.c - n.a),
                        (n.ba = y - n.a),
                        f && ((s = i(n.a, y, n.c, n.d)), a.splice(x, 1, s[0], s[1], s[2], s[3]));
                },
                k = function(a, d, e, f) {
                    var h,
                        i,
                        j,
                        k,
                        l,
                        m,
                        n = [];
                    if (f)
                        for (a = [f].concat(a), i = a.length; --i > -1; )
                            "string" == typeof (m = a[i][d]) && "=" === m.charAt(1) && (a[i][d] = f[d] + Number(m.charAt(0) + m.substr(2)));
                    if (((h = a.length - 2), 0 > h)) return (n[0] = new g(a[0][d], 0, 0, a[0][d])), n;
                    for (i = 0; h > i; i++)
                        (j = a[i][d]),
                            (k = a[i + 1][d]),
                            (n[i] = new g(j, 0, 0, k)),
                            e && ((l = a[i + 2][d]), (b[i] = (b[i] || 0) + (k - j) * (k - j)), (c[i] = (c[i] || 0) + (l - k) * (l - k)));
                    return (n[i] = new g(a[i][d], 0, 0, a[i + 1][d])), n;
                },
                l = function(a, f, g, i, l, m) {
                    var n,
                        o,
                        p,
                        q,
                        r,
                        s,
                        t,
                        u,
                        v = {},
                        w = [],
                        x = m || a[0];
                    (l = "string" == typeof l ? "," + l + "," : h), null == f && (f = 1);
                    for (o in a[0]) w.push(o);
                    if (a.length > 1) {
                        for (u = a[a.length - 1], t = !0, n = w.length; --n > -1; )
                            if (((o = w[n]), Math.abs(x[o] - u[o]) > 0.05)) {
                                t = !1;
                                break;
                            }
                        t && ((a = a.concat()), m && a.unshift(m), a.push(a[1]), (m = a[a.length - 3]));
                    }
                    for (b.length = c.length = d.length = 0, n = w.length; --n > -1; ) (o = w[n]), (e[o] = -1 !== l.indexOf("," + o + ",")), (v[o] = k(a, o, e[o], m));
                    for (n = b.length; --n > -1; ) (b[n] = Math.sqrt(b[n])), (c[n] = Math.sqrt(c[n]));
                    if (!i) {
                        for (n = w.length; --n > -1; )
                            if (e[o]) for (p = v[w[n]], s = p.length - 1, q = 0; s > q; q++) (r = p[q + 1].da / c[q] + p[q].da / b[q] || 0), (d[q] = (d[q] || 0) + r * r);
                        for (n = d.length; --n > -1; ) d[n] = Math.sqrt(d[n]);
                    }
                    for (n = w.length, q = g ? 4 : 1; --n > -1; ) (o = w[n]), (p = v[o]), j(p, f, g, i, e[o]), t && (p.splice(0, q), p.splice(p.length - q, q));
                    return v;
                },
                m = function(a, b, c) {
                    b = b || "soft";
                    var d,
                        e,
                        f,
                        h,
                        i,
                        j,
                        k,
                        l,
                        m,
                        n,
                        o,
                        p = {},
                        q = "cubic" === b ? 3 : 2,
                        r = "soft" === b,
                        s = [];
                    if ((r && c && (a = [c].concat(a)), null == a || a.length < q + 1)) throw "invalid Bezier data";
                    for (m in a[0]) s.push(m);
                    for (j = s.length; --j > -1; ) {
                        for (m = s[j], p[m] = i = [], n = 0, l = a.length, k = 0; l > k; k++)
                            (d = null == c ? a[k][m] : "string" == typeof (o = a[k][m]) && "=" === o.charAt(1) ? c[m] + Number(o.charAt(0) + o.substr(2)) : Number(o)),
                                r && k > 1 && l - 1 > k && (i[n++] = (d + i[n - 2]) / 2),
                                (i[n++] = d);
                        for (l = n - q + 1, n = 0, k = 0; l > k; k += q)
                            (d = i[k]),
                                (e = i[k + 1]),
                                (f = i[k + 2]),
                                (h = 2 === q ? 0 : i[k + 3]),
                                (i[n++] = o = 3 === q ? new g(d, e, f, h) : new g(d, (2 * e + d) / 3, (2 * e + f) / 3, f));
                        i.length = n;
                    }
                    return p;
                },
                n = function(a, b, c) {
                    for (var d, e, f, g, h, i, j, k, l, m, n, o = 1 / c, p = a.length; --p > -1; )
                        for (m = a[p], f = m.a, g = m.d - f, h = m.c - f, i = m.b - f, d = e = 0, k = 1; c >= k; k++)
                            (j = o * k), (l = 1 - j), (d = e - (e = (j * j * g + 3 * l * (j * h + l * i)) * j)), (n = p * c + k - 1), (b[n] = (b[n] || 0) + d * d);
                },
                o = function(a, b) {
                    b = b >> 0 || 6;
                    var c,
                        d,
                        e,
                        f,
                        g = [],
                        h = [],
                        i = 0,
                        j = 0,
                        k = b - 1,
                        l = [],
                        m = [];
                    for (c in a) n(a[c], g, b);
                    for (e = g.length, d = 0; e > d; d++)
                        (i += Math.sqrt(g[d])), (f = d % b), (m[f] = i), f === k && ((j += i), (f = (d / b) >> 0), (l[f] = m), (h[f] = j), (i = 0), (m = []));
                    return { length: j, lengths: h, segments: l };
                },
                p = _gsScope._gsDefine.plugin({
                    propName: "bezier",
                    priority: -1,
                    version: "1.3.8",
                    API: 2,
                    global: !0,
                    init: function(a, b, c) {
                        (this._target = a),
                            b instanceof Array && (b = { values: b }),
                            (this._func = {}),
                            (this._mod = {}),
                            (this._props = []),
                            (this._timeRes = null == b.timeResolution ? 6 : parseInt(b.timeResolution, 10));
                        var d,
                            e,
                            f,
                            g,
                            h,
                            i = b.values || [],
                            j = {},
                            k = i[0],
                            n = b.autoRotate || c.vars.orientToBezier;
                        this._autoRotate = n ? (n instanceof Array ? n : [["x", "y", "rotation", n === !0 ? 0 : Number(n) || 0]]) : null;
                        for (d in k) this._props.push(d);
                        for (f = this._props.length; --f > -1; )
                            (d = this._props[f]),
                                this._overwriteProps.push(d),
                                (e = this._func[d] = "function" == typeof a[d]),
                                (j[d] = e ? a[d.indexOf("set") || "function" != typeof a["get" + d.substr(3)] ? d : "get" + d.substr(3)]() : parseFloat(a[d])),
                                h || (j[d] !== i[0][d] && (h = j));
                        if (
                            ((this._beziers =
                                "cubic" !== b.type && "quadratic" !== b.type && "soft" !== b.type
                                    ? l(i, isNaN(b.curviness) ? 1 : b.curviness, !1, "thruBasic" === b.type, b.correlate, h)
                                    : m(i, b.type, j)),
                            (this._segCount = this._beziers[d].length),
                            this._timeRes)
                        ) {
                            var p = o(this._beziers, this._timeRes);
                            (this._length = p.length),
                                (this._lengths = p.lengths),
                                (this._segments = p.segments),
                                (this._l1 = this._li = this._s1 = this._si = 0),
                                (this._l2 = this._lengths[0]),
                                (this._curSeg = this._segments[0]),
                                (this._s2 = this._curSeg[0]),
                                (this._prec = 1 / this._curSeg.length);
                        }
                        if ((n = this._autoRotate))
                            for (this._initialRotations = [], n[0] instanceof Array || (this._autoRotate = n = [n]), f = n.length; --f > -1; ) {
                                for (g = 0; 3 > g; g++)
                                    (d = n[f][g]),
                                        (this._func[d] =
                                            "function" == typeof a[d] ? a[d.indexOf("set") || "function" != typeof a["get" + d.substr(3)] ? d : "get" + d.substr(3)] : !1);
                                (d = n[f][2]),
                                    (this._initialRotations[f] = (this._func[d] ? this._func[d].call(this._target) : this._target[d]) || 0),
                                    this._overwriteProps.push(d);
                            }
                        return (this._startRatio = c.vars.runBackwards ? 1 : 0), !0;
                    },
                    set: function(b) {
                        var c,
                            d,
                            e,
                            f,
                            g,
                            h,
                            i,
                            j,
                            k,
                            l,
                            m = this._segCount,
                            n = this._func,
                            o = this._target,
                            p = b !== this._startRatio;
                        if (this._timeRes) {
                            if (((k = this._lengths), (l = this._curSeg), (b *= this._length), (e = this._li), b > this._l2 && m - 1 > e)) {
                                for (j = m - 1; j > e && (this._l2 = k[++e]) <= b; );
                                (this._l1 = k[e - 1]), (this._li = e), (this._curSeg = l = this._segments[e]), (this._s2 = l[(this._s1 = this._si = 0)]);
                            } else if (b < this._l1 && e > 0) {
                                for (; e > 0 && (this._l1 = k[--e]) >= b; );
                                0 === e && b < this._l1 ? (this._l1 = 0) : e++,
                                    (this._l2 = k[e]),
                                    (this._li = e),
                                    (this._curSeg = l = this._segments[e]),
                                    (this._s1 = l[(this._si = l.length - 1) - 1] || 0),
                                    (this._s2 = l[this._si]);
                            }
                            if (((c = e), (b -= this._l1), (e = this._si), b > this._s2 && e < l.length - 1)) {
                                for (j = l.length - 1; j > e && (this._s2 = l[++e]) <= b; );
                                (this._s1 = l[e - 1]), (this._si = e);
                            } else if (b < this._s1 && e > 0) {
                                for (; e > 0 && (this._s1 = l[--e]) >= b; );
                                0 === e && b < this._s1 ? (this._s1 = 0) : e++, (this._s2 = l[e]), (this._si = e);
                            }
                            h = (e + (b - this._s1) / (this._s2 - this._s1)) * this._prec || 0;
                        } else (c = 0 > b ? 0 : b >= 1 ? m - 1 : (m * b) >> 0), (h = (b - c * (1 / m)) * m);
                        for (d = 1 - h, e = this._props.length; --e > -1; )
                            (f = this._props[e]),
                                (g = this._beziers[f][c]),
                                (i = (h * h * g.da + 3 * d * (h * g.ca + d * g.ba)) * h + g.a),
                                this._mod[f] && (i = this._mod[f](i, o)),
                                n[f] ? o[f](i) : (o[f] = i);
                        if (this._autoRotate) {
                            var q,
                                r,
                                s,
                                t,
                                u,
                                v,
                                w,
                                x = this._autoRotate;
                            for (e = x.length; --e > -1; )
                                (f = x[e][2]),
                                    (v = x[e][3] || 0),
                                    (w = x[e][4] === !0 ? 1 : a),
                                    (g = this._beziers[x[e][0]]),
                                    (q = this._beziers[x[e][1]]),
                                    g &&
                                        q &&
                                        ((g = g[c]),
                                        (q = q[c]),
                                        (r = g.a + (g.b - g.a) * h),
                                        (t = g.b + (g.c - g.b) * h),
                                        (r += (t - r) * h),
                                        (t += (g.c + (g.d - g.c) * h - t) * h),
                                        (s = q.a + (q.b - q.a) * h),
                                        (u = q.b + (q.c - q.b) * h),
                                        (s += (u - s) * h),
                                        (u += (q.c + (q.d - q.c) * h - u) * h),
                                        (i = p ? Math.atan2(u - s, t - r) * w + v : this._initialRotations[e]),
                                        this._mod[f] && (i = this._mod[f](i, o)),
                                        n[f] ? o[f](i) : (o[f] = i));
                        }
                    }
                }),
                q = p.prototype;
            (p.bezierThrough = l),
                (p.cubicToQuadratic = i),
                (p._autoCSS = !0),
                (p.quadraticToCubic = function(a, b, c) {
                    return new g(a, (2 * b + a) / 3, (2 * b + c) / 3, c);
                }),
                (p._cssRegister = function() {
                    var a = f.CSSPlugin;
                    if (a) {
                        var b = a._internals,
                            c = b._parseToProxy,
                            d = b._setPluginRatio,
                            e = b.CSSPropTween;
                        b._registerComplexSpecialProp("bezier", {
                            parser: function(a, b, f, g, h, i) {
                                b instanceof Array && (b = { values: b }), (i = new p());
                                var j,
                                    k,
                                    l,
                                    m = b.values,
                                    n = m.length - 1,
                                    o = [],
                                    q = {};
                                if (0 > n) return h;
                                for (j = 0; n >= j; j++) (l = c(a, m[j], g, h, i, n !== j)), (o[j] = l.end);
                                for (k in b) q[k] = b[k];
                                return (
                                    (q.values = o),
                                    (h = new e(a, "bezier", 0, 0, l.pt, 2)),
                                    (h.data = l),
                                    (h.plugin = i),
                                    (h.setRatio = d),
                                    0 === q.autoRotate && (q.autoRotate = !0),
                                    !q.autoRotate ||
                                        q.autoRotate instanceof Array ||
                                        ((j = q.autoRotate === !0 ? 0 : Number(q.autoRotate)),
                                        (q.autoRotate = null != l.end.left ? [["left", "top", "rotation", j, !1]] : null != l.end.x ? [["x", "y", "rotation", j, !1]] : !1)),
                                    q.autoRotate &&
                                        (g._transform || g._enableTransforms(!1),
                                        (l.autoRotate = g._target._gsTransform),
                                        (l.proxy.rotation = l.autoRotate.rotation || 0),
                                        g._overwriteProps.push("rotation")),
                                    i._onInitTween(l.proxy, q, g._tween),
                                    h
                                );
                            }
                        });
                    }
                }),
                (q._mod = function(a) {
                    for (var b, c = this._overwriteProps, d = c.length; --d > -1; ) (b = a[c[d]]), b && "function" == typeof b && (this._mod[c[d]] = b);
                }),
                (q._kill = function(a) {
                    var b,
                        c,
                        d = this._props;
                    for (b in this._beziers) if (b in a) for (delete this._beziers[b], delete this._func[b], c = d.length; --c > -1; ) d[c] === b && d.splice(c, 1);
                    if ((d = this._autoRotate)) for (c = d.length; --c > -1; ) a[d[c][2]] && d.splice(c, 1);
                    return this._super._kill.call(this, a);
                });
        })(),
        _gsScope._gsDefine(
            "plugins.CSSPlugin",
            ["plugins.TweenPlugin", "TweenLite"],
            function(a, b) {
                var c,
                    d,
                    e,
                    f,
                    g = function() {
                        a.call(this, "css"), (this._overwriteProps.length = 0), (this.setRatio = g.prototype.setRatio);
                    },
                    h = _gsScope._gsDefine.globals,
                    i = {},
                    j = (g.prototype = new a("css"));
                (j.constructor = g),
                    (g.version = "1.20.3"),
                    (g.API = 2),
                    (g.defaultTransformPerspective = 0),
                    (g.defaultSkewType = "compensated"),
                    (g.defaultSmoothOrigin = !0),
                    (j = "px"),
                    (g.suffixMap = { top: j, right: j, bottom: j, left: j, width: j, height: j, fontSize: j, padding: j, margin: j, perspective: j, lineHeight: "" });
                var k,
                    l,
                    m,
                    n,
                    o,
                    p,
                    q,
                    r,
                    s = /(?:\-|\.|\b)(\d|\.|e\-)+/g,
                    t = /(?:\d|\-\d|\.\d|\-\.\d|\+=\d|\-=\d|\+=.\d|\-=\.\d)+/g,
                    u = /(?:\+=|\-=|\-|\b)[\d\-\.]+[a-zA-Z0-9]*(?:%|\b)/gi,
                    v = /(?![+-]?\d*\.?\d+|[+-]|e[+-]\d+)[^0-9]/g,
                    w = /(?:\d|\-|\+|=|#|\.)*/g,
                    x = /opacity *= *([^)]*)/i,
                    y = /opacity:([^;]*)/i,
                    z = /alpha\(opacity *=.+?\)/i,
                    A = /^(rgb|hsl)/,
                    B = /([A-Z])/g,
                    C = /-([a-z])/gi,
                    D = /(^(?:url\(\"|url\())|(?:(\"\))$|\)$)/gi,
                    E = function(a, b) {
                        return b.toUpperCase();
                    },
                    F = /(?:Left|Right|Width)/i,
                    G = /(M11|M12|M21|M22)=[\d\-\.e]+/gi,
                    H = /progid\:DXImageTransform\.Microsoft\.Matrix\(.+?\)/i,
                    I = /,(?=[^\)]*(?:\(|$))/gi,
                    J = /[\s,\(]/i,
                    K = Math.PI / 180,
                    L = 180 / Math.PI,
                    M = {},
                    N = { style: {} },
                    O = _gsScope.document || {
                        createElement: function() {
                            return N;
                        }
                    },
                    P = function(a, b) {
                        return O.createElementNS ? O.createElementNS(b || "http://www.w3.org/1999/xhtml", a) : O.createElement(a);
                    },
                    Q = P("div"),
                    R = P("img"),
                    S = (g._internals = { _specialProps: i }),
                    T = (_gsScope.navigator || {}).userAgent || "",
                    U = (function() {
                        var a = T.indexOf("Android"),
                            b = P("a");
                        return (
                            (m = -1 !== T.indexOf("Safari") && -1 === T.indexOf("Chrome") && (-1 === a || parseFloat(T.substr(a + 8, 2)) > 3)),
                            (o = m && parseFloat(T.substr(T.indexOf("Version/") + 8, 2)) < 6),
                            (n = -1 !== T.indexOf("Firefox")),
                            (/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(T) || /Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(T)) && (p = parseFloat(RegExp.$1)),
                            b ? ((b.style.cssText = "top:1px;opacity:.55;"), /^0.55/.test(b.style.opacity)) : !1
                        );
                    })(),
                    V = function(a) {
                        return x.test("string" == typeof a ? a : (a.currentStyle ? a.currentStyle.filter : a.style.filter) || "") ? parseFloat(RegExp.$1) / 100 : 1;
                    },
                    W = function(a) {
                        _gsScope.console && console.log(a);
                    },
                    X = "",
                    Y = "",
                    Z = function(a, b) {
                        b = b || Q;
                        var c,
                            d,
                            e = b.style;
                        if (void 0 !== e[a]) return a;
                        for (a = a.charAt(0).toUpperCase() + a.substr(1), c = ["O", "Moz", "ms", "Ms", "Webkit"], d = 5; --d > -1 && void 0 === e[c[d] + a]; );
                        return d >= 0 ? ((Y = 3 === d ? "ms" : c[d]), (X = "-" + Y.toLowerCase() + "-"), Y + a) : null;
                    },
                    $ = O.defaultView ? O.defaultView.getComputedStyle : function() {},
                    _ = (g.getStyle = function(a, b, c, d, e) {
                        var f;
                        return U || "opacity" !== b
                            ? (!d && a.style[b]
                                  ? (f = a.style[b])
                                  : (c = c || $(a))
                                  ? (f = c[b] || c.getPropertyValue(b) || c.getPropertyValue(b.replace(B, "-$1").toLowerCase()))
                                  : a.currentStyle && (f = a.currentStyle[b]),
                              null == e || (f && "none" !== f && "auto" !== f && "auto auto" !== f) ? f : e)
                            : V(a);
                    }),
                    aa = (S.convertToPixels = function(a, c, d, e, f) {
                        if ("px" === e || (!e && "lineHeight" !== c)) return d;
                        if ("auto" === e || !d) return 0;
                        var h,
                            i,
                            j,
                            k = F.test(c),
                            l = a,
                            m = Q.style,
                            n = 0 > d,
                            o = 1 === d;
                        if ((n && (d = -d), o && (d *= 100), "lineHeight" !== c || e))
                            if ("%" === e && -1 !== c.indexOf("border")) h = (d / 100) * (k ? a.clientWidth : a.clientHeight);
                            else {
                                if (
                                    ((m.cssText = "border:0 solid red;position:" + _(a, "position") + ";line-height:0;"),
                                    "%" !== e && l.appendChild && "v" !== e.charAt(0) && "rem" !== e)
                                )
                                    m[k ? "borderLeftWidth" : "borderTopWidth"] = d + e;
                                else {
                                    if (
                                        ((l = a.parentNode || O.body),
                                        -1 !== _(l, "display").indexOf("flex") && (m.position = "absolute"),
                                        (i = l._gsCache),
                                        (j = b.ticker.frame),
                                        i && k && i.time === j)
                                    )
                                        return (i.width * d) / 100;
                                    m[k ? "width" : "height"] = d + e;
                                }
                                l.appendChild(Q),
                                    (h = parseFloat(Q[k ? "offsetWidth" : "offsetHeight"])),
                                    l.removeChild(Q),
                                    k && "%" === e && g.cacheWidths !== !1 && ((i = l._gsCache = l._gsCache || {}), (i.time = j), (i.width = (h / d) * 100)),
                                    0 !== h || f || (h = aa(a, c, d, e, !0));
                            }
                        else (i = $(a).lineHeight), (a.style.lineHeight = d), (h = parseFloat($(a).lineHeight)), (a.style.lineHeight = i);
                        return o && (h /= 100), n ? -h : h;
                    }),
                    ba = (S.calculateOffset = function(a, b, c) {
                        if ("absolute" !== _(a, "position", c)) return 0;
                        var d = "left" === b ? "Left" : "Top",
                            e = _(a, "margin" + d, c);
                        return a["offset" + d] - (aa(a, b, parseFloat(e), e.replace(w, "")) || 0);
                    }),
                    ca = function(a, b) {
                        var c,
                            d,
                            e,
                            f = {};
                        if ((b = b || $(a, null)))
                            if ((c = b.length)) for (; --c > -1; ) (e = b[c]), (-1 === e.indexOf("-transform") || Da === e) && (f[e.replace(C, E)] = b.getPropertyValue(e));
                            else for (c in b) (-1 === c.indexOf("Transform") || Ca === c) && (f[c] = b[c]);
                        else if ((b = a.currentStyle || a.style)) for (c in b) "string" == typeof c && void 0 === f[c] && (f[c.replace(C, E)] = b[c]);
                        return (
                            U || (f.opacity = V(a)),
                            (d = Ra(a, b, !1)),
                            (f.rotation = d.rotation),
                            (f.skewX = d.skewX),
                            (f.scaleX = d.scaleX),
                            (f.scaleY = d.scaleY),
                            (f.x = d.x),
                            (f.y = d.y),
                            Fa && ((f.z = d.z), (f.rotationX = d.rotationX), (f.rotationY = d.rotationY), (f.scaleZ = d.scaleZ)),
                            f.filters && delete f.filters,
                            f
                        );
                    },
                    da = function(a, b, c, d, e) {
                        var f,
                            g,
                            h,
                            i = {},
                            j = a.style;
                        for (g in c)
                            "cssText" !== g &&
                                "length" !== g &&
                                isNaN(g) &&
                                (b[g] !== (f = c[g]) || (e && e[g])) &&
                                -1 === g.indexOf("Origin") &&
                                ("number" == typeof f || "string" == typeof f) &&
                                ((i[g] =
                                    "auto" !== f || ("left" !== g && "top" !== g)
                                        ? ("" !== f && "auto" !== f && "none" !== f) || "string" != typeof b[g] || "" === b[g].replace(v, "")
                                            ? f
                                            : 0
                                        : ba(a, g)),
                                void 0 !== j[g] && (h = new sa(j, g, j[g], h)));
                        if (d) for (g in d) "className" !== g && (i[g] = d[g]);
                        return { difs: i, firstMPT: h };
                    },
                    ea = { width: ["Left", "Right"], height: ["Top", "Bottom"] },
                    fa = ["marginLeft", "marginRight", "marginTop", "marginBottom"],
                    ga = function(a, b, c) {
                        if ("svg" === (a.nodeName + "").toLowerCase()) return (c || $(a))[b] || 0;
                        if (a.getCTM && Oa(a)) return a.getBBox()[b] || 0;
                        var d = parseFloat("width" === b ? a.offsetWidth : a.offsetHeight),
                            e = ea[b],
                            f = e.length;
                        for (c = c || $(a, null); --f > -1; ) (d -= parseFloat(_(a, "padding" + e[f], c, !0)) || 0), (d -= parseFloat(_(a, "border" + e[f] + "Width", c, !0)) || 0);
                        return d;
                    },
                    ha = function(a, b) {
                        if ("contain" === a || "auto" === a || "auto auto" === a) return a + " ";
                        (null == a || "" === a) && (a = "0 0");
                        var c,
                            d = a.split(" "),
                            e = -1 !== a.indexOf("left") ? "0%" : -1 !== a.indexOf("right") ? "100%" : d[0],
                            f = -1 !== a.indexOf("top") ? "0%" : -1 !== a.indexOf("bottom") ? "100%" : d[1];
                        if (d.length > 3 && !b) {
                            for (
                                d = a
                                    .split(", ")
                                    .join(",")
                                    .split(","),
                                    a = [],
                                    c = 0;
                                c < d.length;
                                c++
                            )
                                a.push(ha(d[c]));
                            return a.join(",");
                        }
                        return (
                            null == f ? (f = "center" === e ? "50%" : "0") : "center" === f && (f = "50%"),
                            ("center" === e || (isNaN(parseFloat(e)) && -1 === (e + "").indexOf("="))) && (e = "50%"),
                            (a = e + " " + f + (d.length > 2 ? " " + d[2] : "")),
                            b &&
                                ((b.oxp = -1 !== e.indexOf("%")),
                                (b.oyp = -1 !== f.indexOf("%")),
                                (b.oxr = "=" === e.charAt(1)),
                                (b.oyr = "=" === f.charAt(1)),
                                (b.ox = parseFloat(e.replace(v, ""))),
                                (b.oy = parseFloat(f.replace(v, ""))),
                                (b.v = a)),
                            b || a
                        );
                    },
                    ia = function(a, b) {
                        return (
                            "function" == typeof a && (a = a(r, q)),
                            "string" == typeof a && "=" === a.charAt(1) ? parseInt(a.charAt(0) + "1", 10) * parseFloat(a.substr(2)) : parseFloat(a) - parseFloat(b) || 0
                        );
                    },
                    ja = function(a, b) {
                        return (
                            "function" == typeof a && (a = a(r, q)),
                            null == a ? b : "string" == typeof a && "=" === a.charAt(1) ? parseInt(a.charAt(0) + "1", 10) * parseFloat(a.substr(2)) + b : parseFloat(a) || 0
                        );
                    },
                    ka = function(a, b, c, d) {
                        var e,
                            f,
                            g,
                            h,
                            i,
                            j = 1e-6;
                        return (
                            "function" == typeof a && (a = a(r, q)),
                            null == a
                                ? (h = b)
                                : "number" == typeof a
                                ? (h = a)
                                : ((e = 360),
                                  (f = a.split("_")),
                                  (i = "=" === a.charAt(1)),
                                  (g = (i ? parseInt(a.charAt(0) + "1", 10) * parseFloat(f[0].substr(2)) : parseFloat(f[0])) * (-1 === a.indexOf("rad") ? 1 : L) - (i ? 0 : b)),
                                  f.length &&
                                      (d && (d[c] = b + g),
                                      -1 !== a.indexOf("short") && ((g %= e), g !== g % (e / 2) && (g = 0 > g ? g + e : g - e)),
                                      -1 !== a.indexOf("_cw") && 0 > g
                                          ? (g = ((g + 9999999999 * e) % e) - ((g / e) | 0) * e)
                                          : -1 !== a.indexOf("ccw") && g > 0 && (g = ((g - 9999999999 * e) % e) - ((g / e) | 0) * e)),
                                  (h = b + g)),
                            j > h && h > -j && (h = 0),
                            h
                        );
                    },
                    la = {
                        aqua: [0, 255, 255],
                        lime: [0, 255, 0],
                        silver: [192, 192, 192],
                        black: [0, 0, 0],
                        maroon: [128, 0, 0],
                        teal: [0, 128, 128],
                        blue: [0, 0, 255],
                        navy: [0, 0, 128],
                        white: [255, 255, 255],
                        fuchsia: [255, 0, 255],
                        olive: [128, 128, 0],
                        yellow: [255, 255, 0],
                        orange: [255, 165, 0],
                        gray: [128, 128, 128],
                        purple: [128, 0, 128],
                        green: [0, 128, 0],
                        red: [255, 0, 0],
                        pink: [255, 192, 203],
                        cyan: [0, 255, 255],
                        transparent: [255, 255, 255, 0]
                    },
                    ma = function(a, b, c) {
                        return (
                            (a = 0 > a ? a + 1 : a > 1 ? a - 1 : a),
                            (255 * (1 > 6 * a ? b + (c - b) * a * 6 : 0.5 > a ? c : 2 > 3 * a ? b + (c - b) * (2 / 3 - a) * 6 : b) + 0.5) | 0
                        );
                    },
                    na = (g.parseColor = function(a, b) {
                        var c, d, e, f, g, h, i, j, k, l, m;
                        if (a)
                            if ("number" == typeof a) c = [a >> 16, (a >> 8) & 255, 255 & a];
                            else {
                                if (("," === a.charAt(a.length - 1) && (a = a.substr(0, a.length - 1)), la[a])) c = la[a];
                                else if ("#" === a.charAt(0))
                                    4 === a.length && ((d = a.charAt(1)), (e = a.charAt(2)), (f = a.charAt(3)), (a = "#" + d + d + e + e + f + f)),
                                        (a = parseInt(a.substr(1), 16)),
                                        (c = [a >> 16, (a >> 8) & 255, 255 & a]);
                                else if ("hsl" === a.substr(0, 3))
                                    if (((c = m = a.match(s)), b)) {
                                        if (-1 !== a.indexOf("=")) return a.match(t);
                                    } else
                                        (g = (Number(c[0]) % 360) / 360),
                                            (h = Number(c[1]) / 100),
                                            (i = Number(c[2]) / 100),
                                            (e = 0.5 >= i ? i * (h + 1) : i + h - i * h),
                                            (d = 2 * i - e),
                                            c.length > 3 && (c[3] = Number(c[3])),
                                            (c[0] = ma(g + 1 / 3, d, e)),
                                            (c[1] = ma(g, d, e)),
                                            (c[2] = ma(g - 1 / 3, d, e));
                                else c = a.match(s) || la.transparent;
                                (c[0] = Number(c[0])), (c[1] = Number(c[1])), (c[2] = Number(c[2])), c.length > 3 && (c[3] = Number(c[3]));
                            }
                        else c = la.black;
                        return (
                            b &&
                                !m &&
                                ((d = c[0] / 255),
                                (e = c[1] / 255),
                                (f = c[2] / 255),
                                (j = Math.max(d, e, f)),
                                (k = Math.min(d, e, f)),
                                (i = (j + k) / 2),
                                j === k
                                    ? (g = h = 0)
                                    : ((l = j - k),
                                      (h = i > 0.5 ? l / (2 - j - k) : l / (j + k)),
                                      (g = j === d ? (e - f) / l + (f > e ? 6 : 0) : j === e ? (f - d) / l + 2 : (d - e) / l + 4),
                                      (g *= 60)),
                                (c[0] = (g + 0.5) | 0),
                                (c[1] = (100 * h + 0.5) | 0),
                                (c[2] = (100 * i + 0.5) | 0)),
                            c
                        );
                    }),
                    oa = function(a, b) {
                        var c,
                            d,
                            e,
                            f = a.match(pa) || [],
                            g = 0,
                            h = "";
                        if (!f.length) return a;
                        for (c = 0; c < f.length; c++)
                            (d = f[c]),
                                (e = a.substr(g, a.indexOf(d, g) - g)),
                                (g += e.length + d.length),
                                (d = na(d, b)),
                                3 === d.length && d.push(1),
                                (h += e + (b ? "hsla(" + d[0] + "," + d[1] + "%," + d[2] + "%," + d[3] : "rgba(" + d.join(",")) + ")");
                        return h + a.substr(g);
                    },
                    pa = "(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3}){1,2}\\b";
                for (j in la) pa += "|" + j + "\\b";
                (pa = new RegExp(pa + ")", "gi")),
                    (g.colorStringFilter = function(a) {
                        var b,
                            c = a[0] + " " + a[1];
                        pa.test(c) && ((b = -1 !== c.indexOf("hsl(") || -1 !== c.indexOf("hsla(")), (a[0] = oa(a[0], b)), (a[1] = oa(a[1], b))), (pa.lastIndex = 0);
                    }),
                    b.defaultStringFilter || (b.defaultStringFilter = g.colorStringFilter);
                var qa = function(a, b, c, d) {
                        if (null == a)
                            return function(a) {
                                return a;
                            };
                        var e,
                            f = b ? (a.match(pa) || [""])[0] : "",
                            g =
                                a
                                    .split(f)
                                    .join("")
                                    .match(u) || [],
                            h = a.substr(0, a.indexOf(g[0])),
                            i = ")" === a.charAt(a.length - 1) ? ")" : "",
                            j = -1 !== a.indexOf(" ") ? " " : ",",
                            k = g.length,
                            l = k > 0 ? g[0].replace(s, "") : "";
                        return k
                            ? (e = b
                                  ? function(a) {
                                        var b, m, n, o;
                                        if ("number" == typeof a) a += l;
                                        else if (d && I.test(a)) {
                                            for (o = a.replace(I, "|").split("|"), n = 0; n < o.length; n++) o[n] = e(o[n]);
                                            return o.join(",");
                                        }
                                        if (
                                            ((b = (a.match(pa) || [f])[0]),
                                            (m =
                                                a
                                                    .split(b)
                                                    .join("")
                                                    .match(u) || []),
                                            (n = m.length),
                                            k > n--)
                                        )
                                            for (; ++n < k; ) m[n] = c ? m[((n - 1) / 2) | 0] : g[n];
                                        return h + m.join(j) + j + b + i + (-1 !== a.indexOf("inset") ? " inset" : "");
                                    }
                                  : function(a) {
                                        var b, f, m;
                                        if ("number" == typeof a) a += l;
                                        else if (d && I.test(a)) {
                                            for (f = a.replace(I, "|").split("|"), m = 0; m < f.length; m++) f[m] = e(f[m]);
                                            return f.join(",");
                                        }
                                        if (((b = a.match(u) || []), (m = b.length), k > m--)) for (; ++m < k; ) b[m] = c ? b[((m - 1) / 2) | 0] : g[m];
                                        return h + b.join(j) + i;
                                    })
                            : function(a) {
                                  return a;
                              };
                    },
                    ra = function(a) {
                        return (
                            (a = a.split(",")),
                            function(b, c, d, e, f, g, h) {
                                var i,
                                    j = (c + "").split(" ");
                                for (h = {}, i = 0; 4 > i; i++) h[a[i]] = j[i] = j[i] || j[((i - 1) / 2) >> 0];
                                return e.parse(b, h, f, g);
                            }
                        );
                    },
                    sa =
                        ((S._setPluginRatio = function(a) {
                            this.plugin.setRatio(a);
                            for (var b, c, d, e, f, g = this.data, h = g.proxy, i = g.firstMPT, j = 1e-6; i; )
                                (b = h[i.v]), i.r ? (b = Math.round(b)) : j > b && b > -j && (b = 0), (i.t[i.p] = b), (i = i._next);
                            if ((g.autoRotate && (g.autoRotate.rotation = g.mod ? g.mod(h.rotation, this.t) : h.rotation), 1 === a || 0 === a))
                                for (i = g.firstMPT, f = 1 === a ? "e" : "b"; i; ) {
                                    if (((c = i.t), c.type)) {
                                        if (1 === c.type) {
                                            for (e = c.xs0 + c.s + c.xs1, d = 1; d < c.l; d++) e += c["xn" + d] + c["xs" + (d + 1)];
                                            c[f] = e;
                                        }
                                    } else c[f] = c.s + c.xs0;
                                    i = i._next;
                                }
                        }),
                        function(a, b, c, d, e) {
                            (this.t = a), (this.p = b), (this.v = c), (this.r = e), d && ((d._prev = this), (this._next = d));
                        }),
                    ta =
                        ((S._parseToProxy = function(a, b, c, d, e, f) {
                            var g,
                                h,
                                i,
                                j,
                                k,
                                l = d,
                                m = {},
                                n = {},
                                o = c._transform,
                                p = M;
                            for (
                                c._transform = null,
                                    M = b,
                                    d = k = c.parse(a, b, d, e),
                                    M = p,
                                    f && ((c._transform = o), l && ((l._prev = null), l._prev && (l._prev._next = null)));
                                d && d !== l;

                            ) {
                                if (d.type <= 1 && ((h = d.p), (n[h] = d.s + d.c), (m[h] = d.s), f || ((j = new sa(d, "s", h, j, d.r)), (d.c = 0)), 1 === d.type))
                                    for (g = d.l; --g > 0; ) (i = "xn" + g), (h = d.p + "_" + i), (n[h] = d.data[i]), (m[h] = d[i]), f || (j = new sa(d, i, h, j, d.rxp[i]));
                                d = d._next;
                            }
                            return { proxy: m, end: n, firstMPT: j, pt: k };
                        }),
                        (S.CSSPropTween = function(a, b, d, e, g, h, i, j, k, l, m) {
                            (this.t = a),
                                (this.p = b),
                                (this.s = d),
                                (this.c = e),
                                (this.n = i || b),
                                a instanceof ta || f.push(this.n),
                                (this.r = j),
                                (this.type = h || 0),
                                k && ((this.pr = k), (c = !0)),
                                (this.b = void 0 === l ? d : l),
                                (this.e = void 0 === m ? d + e : m),
                                g && ((this._next = g), (g._prev = this));
                        })),
                    ua = function(a, b, c, d, e, f) {
                        var g = new ta(a, b, c, d - c, e, -1, f);
                        return (g.b = c), (g.e = g.xs0 = d), g;
                    },
                    va = (g.parseComplex = function(a, b, c, d, e, f, h, i, j, l) {
                        (c = c || f || ""),
                            "function" == typeof d && (d = d(r, q)),
                            (h = new ta(a, b, 0, 0, h, l ? 2 : 1, null, !1, i, c, d)),
                            (d += ""),
                            e && pa.test(d + c) && ((d = [c, d]), g.colorStringFilter(d), (c = d[0]), (d = d[1]));
                        var m,
                            n,
                            o,
                            p,
                            u,
                            v,
                            w,
                            x,
                            y,
                            z,
                            A,
                            B,
                            C,
                            D = c
                                .split(", ")
                                .join(",")
                                .split(" "),
                            E = d
                                .split(", ")
                                .join(",")
                                .split(" "),
                            F = D.length,
                            G = k !== !1;
                        for (
                            (-1 !== d.indexOf(",") || -1 !== c.indexOf(",")) &&
                                (-1 !== (d + c).indexOf("rgb") || -1 !== (d + c).indexOf("hsl")
                                    ? ((D = D.join(" ")
                                          .replace(I, ", ")
                                          .split(" ")),
                                      (E = E.join(" ")
                                          .replace(I, ", ")
                                          .split(" ")))
                                    : ((D = D.join(" ")
                                          .split(",")
                                          .join(", ")
                                          .split(" ")),
                                      (E = E.join(" ")
                                          .split(",")
                                          .join(", ")
                                          .split(" "))),
                                (F = D.length)),
                                F !== E.length && ((D = (f || "").split(" ")), (F = D.length)),
                                h.plugin = j,
                                h.setRatio = l,
                                pa.lastIndex = 0,
                                m = 0;
                            F > m;
                            m++
                        )
                            if (((p = D[m]), (u = E[m]), (x = parseFloat(p)), x || 0 === x)) h.appendXtra("", x, ia(u, x), u.replace(t, ""), G && -1 !== u.indexOf("px"), !0);
                            else if (e && pa.test(p))
                                (B = u.indexOf(")") + 1),
                                    (B = ")" + (B ? u.substr(B) : "")),
                                    (C = -1 !== u.indexOf("hsl") && U),
                                    (z = u),
                                    (p = na(p, C)),
                                    (u = na(u, C)),
                                    (y = p.length + u.length > 6),
                                    y && !U && 0 === u[3]
                                        ? ((h["xs" + h.l] += h.l ? " transparent" : "transparent"), (h.e = h.e.split(E[m]).join("transparent")))
                                        : (U || (y = !1),
                                          C
                                              ? h
                                                    .appendXtra(z.substr(0, z.indexOf("hsl")) + (y ? "hsla(" : "hsl("), p[0], ia(u[0], p[0]), ",", !1, !0)
                                                    .appendXtra("", p[1], ia(u[1], p[1]), "%,", !1)
                                                    .appendXtra("", p[2], ia(u[2], p[2]), y ? "%," : "%" + B, !1)
                                              : h
                                                    .appendXtra(z.substr(0, z.indexOf("rgb")) + (y ? "rgba(" : "rgb("), p[0], u[0] - p[0], ",", !0, !0)
                                                    .appendXtra("", p[1], u[1] - p[1], ",", !0)
                                                    .appendXtra("", p[2], u[2] - p[2], y ? "," : B, !0),
                                          y && ((p = p.length < 4 ? 1 : p[3]), h.appendXtra("", p, (u.length < 4 ? 1 : u[3]) - p, B, !1))),
                                    (pa.lastIndex = 0);
                            else if ((v = p.match(s))) {
                                if (((w = u.match(t)), !w || w.length !== v.length)) return h;
                                for (o = 0, n = 0; n < v.length; n++)
                                    (A = v[n]),
                                        (z = p.indexOf(A, o)),
                                        h.appendXtra(p.substr(o, z - o), Number(A), ia(w[n], A), "", G && "px" === p.substr(z + A.length, 2), 0 === n),
                                        (o = z + A.length);
                                h["xs" + h.l] += p.substr(o);
                            } else h["xs" + h.l] += h.l || h["xs" + h.l] ? " " + u : u;
                        if (-1 !== d.indexOf("=") && h.data) {
                            for (B = h.xs0 + h.data.s, m = 1; m < h.l; m++) B += h["xs" + m] + h.data["xn" + m];
                            h.e = B + h["xs" + m];
                        }
                        return h.l || ((h.type = -1), (h.xs0 = h.e)), h.xfirst || h;
                    }),
                    wa = 9;
                for (j = ta.prototype, j.l = j.pr = 0; --wa > 0; ) (j["xn" + wa] = 0), (j["xs" + wa] = "");
                (j.xs0 = ""),
                    (j._next = j._prev = j.xfirst = j.data = j.plugin = j.setRatio = j.rxp = null),
                    (j.appendXtra = function(a, b, c, d, e, f) {
                        var g = this,
                            h = g.l;
                        return (
                            (g["xs" + h] += f && (h || g["xs" + h]) ? " " + a : a || ""),
                            c || 0 === h || g.plugin
                                ? (g.l++,
                                  (g.type = g.setRatio ? 2 : 1),
                                  (g["xs" + g.l] = d || ""),
                                  h > 0
                                      ? ((g.data["xn" + h] = b + c),
                                        (g.rxp["xn" + h] = e),
                                        (g["xn" + h] = b),
                                        g.plugin || ((g.xfirst = new ta(g, "xn" + h, b, c, g.xfirst || g, 0, g.n, e, g.pr)), (g.xfirst.xs0 = 0)),
                                        g)
                                      : ((g.data = { s: b + c }), (g.rxp = {}), (g.s = b), (g.c = c), (g.r = e), g))
                                : ((g["xs" + h] += b + (d || "")), g)
                        );
                    });
                var xa = function(a, b) {
                        (b = b || {}),
                            (this.p = b.prefix ? Z(a) || a : a),
                            (i[a] = i[this.p] = this),
                            (this.format = b.formatter || qa(b.defaultValue, b.color, b.collapsible, b.multi)),
                            b.parser && (this.parse = b.parser),
                            (this.clrs = b.color),
                            (this.multi = b.multi),
                            (this.keyword = b.keyword),
                            (this.dflt = b.defaultValue),
                            (this.pr = b.priority || 0);
                    },
                    ya = (S._registerComplexSpecialProp = function(a, b, c) {
                        "object" != typeof b && (b = { parser: c });
                        var d,
                            e,
                            f = a.split(","),
                            g = b.defaultValue;
                        for (c = c || [g], d = 0; d < f.length; d++) (b.prefix = 0 === d && b.prefix), (b.defaultValue = c[d] || g), (e = new xa(f[d], b));
                    }),
                    za = (S._registerPluginProp = function(a) {
                        if (!i[a]) {
                            var b = a.charAt(0).toUpperCase() + a.substr(1) + "Plugin";
                            ya(a, {
                                parser: function(a, c, d, e, f, g, j) {
                                    var k = h.com.greensock.plugins[b];
                                    return k ? (k._cssRegister(), i[d].parse(a, c, d, e, f, g, j)) : (W("Error: " + b + " js file not loaded."), f);
                                }
                            });
                        }
                    });
                (j = xa.prototype),
                    (j.parseComplex = function(a, b, c, d, e, f) {
                        var g,
                            h,
                            i,
                            j,
                            k,
                            l,
                            m = this.keyword;
                        if ((this.multi && (I.test(c) || I.test(b) ? ((h = b.replace(I, "|").split("|")), (i = c.replace(I, "|").split("|"))) : m && ((h = [b]), (i = [c]))), i)) {
                            for (j = i.length > h.length ? i.length : h.length, g = 0; j > g; g++)
                                (b = h[g] = h[g] || this.dflt),
                                    (c = i[g] = i[g] || this.dflt),
                                    m && ((k = b.indexOf(m)), (l = c.indexOf(m)), k !== l && (-1 === l ? (h[g] = h[g].split(m).join("")) : -1 === k && (h[g] += " " + m)));
                            (b = h.join(", ")), (c = i.join(", "));
                        }
                        return va(a, this.p, b, c, this.clrs, this.dflt, d, this.pr, e, f);
                    }),
                    (j.parse = function(a, b, c, d, f, g, h) {
                        return this.parseComplex(a.style, this.format(_(a, this.p, e, !1, this.dflt)), this.format(b), f, g);
                    }),
                    (g.registerSpecialProp = function(a, b, c) {
                        ya(a, {
                            parser: function(a, d, e, f, g, h, i) {
                                var j = new ta(a, e, 0, 0, g, 2, e, !1, c);
                                return (j.plugin = h), (j.setRatio = b(a, d, f._tween, e)), j;
                            },
                            priority: c
                        });
                    }),
                    (g.useSVGTransformAttr = !0);
                var Aa,
                    Ba = "scaleX,scaleY,scaleZ,x,y,z,skewX,skewY,rotation,rotationX,rotationY,perspective,xPercent,yPercent".split(","),
                    Ca = Z("transform"),
                    Da = X + "transform",
                    Ea = Z("transformOrigin"),
                    Fa = null !== Z("perspective"),
                    Ga = (S.Transform = function() {
                        (this.perspective = parseFloat(g.defaultTransformPerspective) || 0), (this.force3D = g.defaultForce3D !== !1 && Fa ? g.defaultForce3D || "auto" : !1);
                    }),
                    Ha = _gsScope.SVGElement,
                    Ia = function(a, b, c) {
                        var d,
                            e = O.createElementNS("http://www.w3.org/2000/svg", a),
                            f = /([a-z])([A-Z])/g;
                        for (d in c) e.setAttributeNS(null, d.replace(f, "$1-$2").toLowerCase(), c[d]);
                        return b.appendChild(e), e;
                    },
                    Ja = O.documentElement || {},
                    Ka = (function() {
                        var a,
                            b,
                            c,
                            d = p || (/Android/i.test(T) && !_gsScope.chrome);
                        return (
                            O.createElementNS &&
                                !d &&
                                ((a = Ia("svg", Ja)),
                                (b = Ia("rect", a, { width: 100, height: 50, x: 100 })),
                                (c = b.getBoundingClientRect().width),
                                (b.style[Ea] = "50% 50%"),
                                (b.style[Ca] = "scaleX(0.5)"),
                                (d = c === b.getBoundingClientRect().width && !(n && Fa)),
                                Ja.removeChild(a)),
                            d
                        );
                    })(),
                    La = function(a, b, c, d, e, f) {
                        var h,
                            i,
                            j,
                            k,
                            l,
                            m,
                            n,
                            o,
                            p,
                            q,
                            r,
                            s,
                            t,
                            u,
                            v = a._gsTransform,
                            w = Qa(a, !0);
                        v && ((t = v.xOrigin), (u = v.yOrigin)),
                            (!d || (h = d.split(" ")).length < 2) &&
                                ((n = a.getBBox()),
                                0 === n.x &&
                                    0 === n.y &&
                                    n.width + n.height === 0 &&
                                    (n = {
                                        x: parseFloat(a.hasAttribute("x") ? a.getAttribute("x") : a.hasAttribute("cx") ? a.getAttribute("cx") : 0) || 0,
                                        y: parseFloat(a.hasAttribute("y") ? a.getAttribute("y") : a.hasAttribute("cy") ? a.getAttribute("cy") : 0) || 0,
                                        width: 0,
                                        height: 0
                                    }),
                                (b = ha(b).split(" ")),
                                (h = [
                                    (-1 !== b[0].indexOf("%") ? (parseFloat(b[0]) / 100) * n.width : parseFloat(b[0])) + n.x,
                                    (-1 !== b[1].indexOf("%") ? (parseFloat(b[1]) / 100) * n.height : parseFloat(b[1])) + n.y
                                ])),
                            (c.xOrigin = k = parseFloat(h[0])),
                            (c.yOrigin = l = parseFloat(h[1])),
                            d &&
                                w !== Pa &&
                                ((m = w[0]),
                                (n = w[1]),
                                (o = w[2]),
                                (p = w[3]),
                                (q = w[4]),
                                (r = w[5]),
                                (s = m * p - n * o),
                                s &&
                                    ((i = k * (p / s) + l * (-o / s) + (o * r - p * q) / s),
                                    (j = k * (-n / s) + l * (m / s) - (m * r - n * q) / s),
                                    (k = c.xOrigin = h[0] = i),
                                    (l = c.yOrigin = h[1] = j))),
                            v &&
                                (f && ((c.xOffset = v.xOffset), (c.yOffset = v.yOffset), (v = c)),
                                e || (e !== !1 && g.defaultSmoothOrigin !== !1)
                                    ? ((i = k - t), (j = l - u), (v.xOffset += i * w[0] + j * w[2] - i), (v.yOffset += i * w[1] + j * w[3] - j))
                                    : (v.xOffset = v.yOffset = 0)),
                            f || a.setAttribute("data-svg-origin", h.join(" "));
                    },
                    Ma = function(a) {
                        var b,
                            c = P("svg", (this.ownerSVGElement && this.ownerSVGElement.getAttribute("xmlns")) || "http://www.w3.org/2000/svg"),
                            d = this.parentNode,
                            e = this.nextSibling,
                            f = this.style.cssText;
                        if ((Ja.appendChild(c), c.appendChild(this), (this.style.display = "block"), a))
                            try {
                                (b = this.getBBox()), (this._originalGetBBox = this.getBBox), (this.getBBox = Ma);
                            } catch (g) {}
                        else this._originalGetBBox && (b = this._originalGetBBox());
                        return e ? d.insertBefore(this, e) : d.appendChild(this), Ja.removeChild(c), (this.style.cssText = f), b;
                    },
                    Na = function(a) {
                        try {
                            return a.getBBox();
                        } catch (b) {
                            return Ma.call(a, !0);
                        }
                    },
                    Oa = function(a) {
                        return !(!Ha || !a.getCTM || (a.parentNode && !a.ownerSVGElement) || !Na(a));
                    },
                    Pa = [1, 0, 0, 1, 0, 0],
                    Qa = function(a, b) {
                        var c,
                            d,
                            e,
                            f,
                            g,
                            h,
                            i = a._gsTransform || new Ga(),
                            j = 1e5,
                            k = a.style;
                        if (
                            (Ca
                                ? (d = _(a, Da, null, !0))
                                : a.currentStyle &&
                                  ((d = a.currentStyle.filter.match(G)),
                                  (d = d && 4 === d.length ? [d[0].substr(4), Number(d[2].substr(4)), Number(d[1].substr(4)), d[3].substr(4), i.x || 0, i.y || 0].join(",") : "")),
                            (c = !d || "none" === d || "matrix(1, 0, 0, 1, 0, 0)" === d),
                            !Ca ||
                                (!(h = !$(a) || "none" === $(a).display) && a.parentNode) ||
                                (h && ((f = k.display), (k.display = "block")),
                                a.parentNode || ((g = 1), Ja.appendChild(a)),
                                (d = _(a, Da, null, !0)),
                                (c = !d || "none" === d || "matrix(1, 0, 0, 1, 0, 0)" === d),
                                f ? (k.display = f) : h && Va(k, "display"),
                                g && Ja.removeChild(a)),
                            (i.svg || (a.getCTM && Oa(a))) &&
                                (c && -1 !== (k[Ca] + "").indexOf("matrix") && ((d = k[Ca]), (c = 0)),
                                (e = a.getAttribute("transform")),
                                c &&
                                    e &&
                                    (-1 !== e.indexOf("matrix")
                                        ? ((d = e), (c = 0))
                                        : -1 !== e.indexOf("translate") && ((d = "matrix(1,0,0,1," + e.match(/(?:\-|\b)[\d\-\.e]+\b/gi).join(",") + ")"), (c = 0)))),
                            c)
                        )
                            return Pa;
                        for (e = (d || "").match(s) || [], wa = e.length; --wa > -1; )
                            (f = Number(e[wa])), (e[wa] = (g = f - (f |= 0)) ? ((g * j + (0 > g ? -0.5 : 0.5)) | 0) / j + f : f);
                        return b && e.length > 6 ? [e[0], e[1], e[4], e[5], e[12], e[13]] : e;
                    },
                    Ra = (S.getTransform = function(a, c, d, e) {
                        if (a._gsTransform && d && !e) return a._gsTransform;
                        var f,
                            h,
                            i,
                            j,
                            k,
                            l,
                            m = d ? a._gsTransform || new Ga() : new Ga(),
                            n = m.scaleX < 0,
                            o = 2e-5,
                            p = 1e5,
                            q = Fa ? parseFloat(_(a, Ea, c, !1, "0 0 0").split(" ")[2]) || m.zOrigin || 0 : 0,
                            r = parseFloat(g.defaultTransformPerspective) || 0;
                        if (
                            ((m.svg = !(!a.getCTM || !Oa(a))),
                            m.svg && (La(a, _(a, Ea, c, !1, "50% 50%") + "", m, a.getAttribute("data-svg-origin")), (Aa = g.useSVGTransformAttr || Ka)),
                            (f = Qa(a)),
                            f !== Pa)
                        ) {
                            if (16 === f.length) {
                                var s,
                                    t,
                                    u,
                                    v,
                                    w,
                                    x = f[0],
                                    y = f[1],
                                    z = f[2],
                                    A = f[3],
                                    B = f[4],
                                    C = f[5],
                                    D = f[6],
                                    E = f[7],
                                    F = f[8],
                                    G = f[9],
                                    H = f[10],
                                    I = f[12],
                                    J = f[13],
                                    K = f[14],
                                    M = f[11],
                                    N = Math.atan2(D, H);
                                m.zOrigin && ((K = -m.zOrigin), (I = F * K - f[12]), (J = G * K - f[13]), (K = H * K + m.zOrigin - f[14])),
                                    (m.rotationX = N * L),
                                    N &&
                                        ((v = Math.cos(-N)),
                                        (w = Math.sin(-N)),
                                        (s = B * v + F * w),
                                        (t = C * v + G * w),
                                        (u = D * v + H * w),
                                        (F = B * -w + F * v),
                                        (G = C * -w + G * v),
                                        (H = D * -w + H * v),
                                        (M = E * -w + M * v),
                                        (B = s),
                                        (C = t),
                                        (D = u)),
                                    (N = Math.atan2(-z, H)),
                                    (m.rotationY = N * L),
                                    N &&
                                        ((v = Math.cos(-N)),
                                        (w = Math.sin(-N)),
                                        (s = x * v - F * w),
                                        (t = y * v - G * w),
                                        (u = z * v - H * w),
                                        (G = y * w + G * v),
                                        (H = z * w + H * v),
                                        (M = A * w + M * v),
                                        (x = s),
                                        (y = t),
                                        (z = u)),
                                    (N = Math.atan2(y, x)),
                                    (m.rotation = N * L),
                                    N &&
                                        ((v = Math.cos(N)),
                                        (w = Math.sin(N)),
                                        (s = x * v + y * w),
                                        (t = B * v + C * w),
                                        (u = F * v + G * w),
                                        (y = y * v - x * w),
                                        (C = C * v - B * w),
                                        (G = G * v - F * w),
                                        (x = s),
                                        (B = t),
                                        (F = u)),
                                    m.rotationX && Math.abs(m.rotationX) + Math.abs(m.rotation) > 359.9 && ((m.rotationX = m.rotation = 0), (m.rotationY = 180 - m.rotationY)),
                                    (N = Math.atan2(B, C)),
                                    (m.scaleX = ((Math.sqrt(x * x + y * y + z * z) * p + 0.5) | 0) / p),
                                    (m.scaleY = ((Math.sqrt(C * C + D * D) * p + 0.5) | 0) / p),
                                    (m.scaleZ = ((Math.sqrt(F * F + G * G + H * H) * p + 0.5) | 0) / p),
                                    (x /= m.scaleX),
                                    (B /= m.scaleY),
                                    (y /= m.scaleX),
                                    (C /= m.scaleY),
                                    Math.abs(N) > o ? ((m.skewX = N * L), (B = 0), "simple" !== m.skewType && (m.scaleY *= 1 / Math.cos(N))) : (m.skewX = 0),
                                    (m.perspective = M ? 1 / (0 > M ? -M : M) : 0),
                                    (m.x = I),
                                    (m.y = J),
                                    (m.z = K),
                                    m.svg && ((m.x -= m.xOrigin - (m.xOrigin * x - m.yOrigin * B)), (m.y -= m.yOrigin - (m.yOrigin * y - m.xOrigin * C)));
                            } else if (!Fa || e || !f.length || m.x !== f[4] || m.y !== f[5] || (!m.rotationX && !m.rotationY)) {
                                var O = f.length >= 6,
                                    P = O ? f[0] : 1,
                                    Q = f[1] || 0,
                                    R = f[2] || 0,
                                    S = O ? f[3] : 1;
                                (m.x = f[4] || 0),
                                    (m.y = f[5] || 0),
                                    (i = Math.sqrt(P * P + Q * Q)),
                                    (j = Math.sqrt(S * S + R * R)),
                                    (k = P || Q ? Math.atan2(Q, P) * L : m.rotation || 0),
                                    (l = R || S ? Math.atan2(R, S) * L + k : m.skewX || 0),
                                    (m.scaleX = i),
                                    (m.scaleY = j),
                                    (m.rotation = k),
                                    (m.skewX = l),
                                    Fa && ((m.rotationX = m.rotationY = m.z = 0), (m.perspective = r), (m.scaleZ = 1)),
                                    m.svg && ((m.x -= m.xOrigin - (m.xOrigin * P + m.yOrigin * R)), (m.y -= m.yOrigin - (m.xOrigin * Q + m.yOrigin * S)));
                            }
                            Math.abs(m.skewX) > 90 &&
                                Math.abs(m.skewX) < 270 &&
                                (n
                                    ? ((m.scaleX *= -1), (m.skewX += m.rotation <= 0 ? 180 : -180), (m.rotation += m.rotation <= 0 ? 180 : -180))
                                    : ((m.scaleY *= -1), (m.skewX += m.skewX <= 0 ? 180 : -180))),
                                (m.zOrigin = q);
                            for (h in m) m[h] < o && m[h] > -o && (m[h] = 0);
                        }
                        return (
                            d &&
                                ((a._gsTransform = m),
                                m.svg &&
                                    (Aa && a.style[Ca]
                                        ? b.delayedCall(0.001, function() {
                                              Va(a.style, Ca);
                                          })
                                        : !Aa &&
                                          a.getAttribute("transform") &&
                                          b.delayedCall(0.001, function() {
                                              a.removeAttribute("transform");
                                          }))),
                            m
                        );
                    }),
                    Sa = function(a) {
                        var b,
                            c,
                            d = this.data,
                            e = -d.rotation * K,
                            f = e + d.skewX * K,
                            g = 1e5,
                            h = ((Math.cos(e) * d.scaleX * g) | 0) / g,
                            i = ((Math.sin(e) * d.scaleX * g) | 0) / g,
                            j = ((Math.sin(f) * -d.scaleY * g) | 0) / g,
                            k = ((Math.cos(f) * d.scaleY * g) | 0) / g,
                            l = this.t.style,
                            m = this.t.currentStyle;
                        if (m) {
                            (c = i), (i = -j), (j = -c), (b = m.filter), (l.filter = "");
                            var n,
                                o,
                                q = this.t.offsetWidth,
                                r = this.t.offsetHeight,
                                s = "absolute" !== m.position,
                                t = "progid:DXImageTransform.Microsoft.Matrix(M11=" + h + ", M12=" + i + ", M21=" + j + ", M22=" + k,
                                u = d.x + (q * d.xPercent) / 100,
                                v = d.y + (r * d.yPercent) / 100;
                            if (
                                (null != d.ox &&
                                    ((n = (d.oxp ? q * d.ox * 0.01 : d.ox) - q / 2),
                                    (o = (d.oyp ? r * d.oy * 0.01 : d.oy) - r / 2),
                                    (u += n - (n * h + o * i)),
                                    (v += o - (n * j + o * k))),
                                s
                                    ? ((n = q / 2), (o = r / 2), (t += ", Dx=" + (n - (n * h + o * i) + u) + ", Dy=" + (o - (n * j + o * k) + v) + ")"))
                                    : (t += ", sizingMethod='auto expand')"),
                                -1 !== b.indexOf("DXImageTransform.Microsoft.Matrix(") ? (l.filter = b.replace(H, t)) : (l.filter = t + " " + b),
                                (0 === a || 1 === a) &&
                                    1 === h &&
                                    0 === i &&
                                    0 === j &&
                                    1 === k &&
                                    ((s && -1 === t.indexOf("Dx=0, Dy=0")) ||
                                        (x.test(b) && 100 !== parseFloat(RegExp.$1)) ||
                                        (-1 === b.indexOf(b.indexOf("Alpha")) && l.removeAttribute("filter"))),
                                !s)
                            ) {
                                var y,
                                    z,
                                    A,
                                    B = 8 > p ? 1 : -1;
                                for (
                                    n = d.ieOffsetX || 0,
                                        o = d.ieOffsetY || 0,
                                        d.ieOffsetX = Math.round((q - ((0 > h ? -h : h) * q + (0 > i ? -i : i) * r)) / 2 + u),
                                        d.ieOffsetY = Math.round((r - ((0 > k ? -k : k) * r + (0 > j ? -j : j) * q)) / 2 + v),
                                        wa = 0;
                                    4 > wa;
                                    wa++
                                )
                                    (z = fa[wa]),
                                        (y = m[z]),
                                        (c = -1 !== y.indexOf("px") ? parseFloat(y) : aa(this.t, z, parseFloat(y), y.replace(w, "")) || 0),
                                        (A = c !== d[z] ? (2 > wa ? -d.ieOffsetX : -d.ieOffsetY) : 2 > wa ? n - d.ieOffsetX : o - d.ieOffsetY),
                                        (l[z] = (d[z] = Math.round(c - A * (0 === wa || 2 === wa ? 1 : B))) + "px");
                            }
                        }
                    },
                    Ta = (S.set3DTransformRatio = S.setTransformRatio = function(a) {
                        var b,
                            c,
                            d,
                            e,
                            f,
                            g,
                            h,
                            i,
                            j,
                            k,
                            l,
                            m,
                            o,
                            p,
                            q,
                            r,
                            s,
                            t,
                            u,
                            v,
                            w,
                            x,
                            y,
                            z = this.data,
                            A = this.t.style,
                            B = z.rotation,
                            C = z.rotationX,
                            D = z.rotationY,
                            E = z.scaleX,
                            F = z.scaleY,
                            G = z.scaleZ,
                            H = z.x,
                            I = z.y,
                            J = z.z,
                            L = z.svg,
                            M = z.perspective,
                            N = z.force3D,
                            O = z.skewY,
                            P = z.skewX;
                        if (
                            (O && ((P += O), (B += O)),
                            ((((1 === a || 0 === a) && "auto" === N && (this.tween._totalTime === this.tween._totalDuration || !this.tween._totalTime)) || !N) &&
                                !J &&
                                !M &&
                                !D &&
                                !C &&
                                1 === G) ||
                                (Aa && L) ||
                                !Fa)
                        )
                            return void (B || P || L
                                ? ((B *= K),
                                  (x = P * K),
                                  (y = 1e5),
                                  (c = Math.cos(B) * E),
                                  (f = Math.sin(B) * E),
                                  (d = Math.sin(B - x) * -F),
                                  (g = Math.cos(B - x) * F),
                                  x &&
                                      "simple" === z.skewType &&
                                      ((b = Math.tan(x - O * K)),
                                      (b = Math.sqrt(1 + b * b)),
                                      (d *= b),
                                      (g *= b),
                                      O && ((b = Math.tan(O * K)), (b = Math.sqrt(1 + b * b)), (c *= b), (f *= b))),
                                  L &&
                                      ((H += z.xOrigin - (z.xOrigin * c + z.yOrigin * d) + z.xOffset),
                                      (I += z.yOrigin - (z.xOrigin * f + z.yOrigin * g) + z.yOffset),
                                      Aa && (z.xPercent || z.yPercent) && ((q = this.t.getBBox()), (H += 0.01 * z.xPercent * q.width), (I += 0.01 * z.yPercent * q.height)),
                                      (q = 1e-6),
                                      q > H && H > -q && (H = 0),
                                      q > I && I > -q && (I = 0)),
                                  (u = ((c * y) | 0) / y + "," + ((f * y) | 0) / y + "," + ((d * y) | 0) / y + "," + ((g * y) | 0) / y + "," + H + "," + I + ")"),
                                  L && Aa
                                      ? this.t.setAttribute("transform", "matrix(" + u)
                                      : (A[Ca] = (z.xPercent || z.yPercent ? "translate(" + z.xPercent + "%," + z.yPercent + "%) matrix(" : "matrix(") + u))
                                : (A[Ca] =
                                      (z.xPercent || z.yPercent ? "translate(" + z.xPercent + "%," + z.yPercent + "%) matrix(" : "matrix(") +
                                      E +
                                      ",0,0," +
                                      F +
                                      "," +
                                      H +
                                      "," +
                                      I +
                                      ")"));
                        if ((n && ((q = 1e-4), q > E && E > -q && (E = G = 2e-5), q > F && F > -q && (F = G = 2e-5), !M || z.z || z.rotationX || z.rotationY || (M = 0)), B || P))
                            (B *= K),
                                (r = c = Math.cos(B)),
                                (s = f = Math.sin(B)),
                                P &&
                                    ((B -= P * K),
                                    (r = Math.cos(B)),
                                    (s = Math.sin(B)),
                                    "simple" === z.skewType &&
                                        ((b = Math.tan((P - O) * K)),
                                        (b = Math.sqrt(1 + b * b)),
                                        (r *= b),
                                        (s *= b),
                                        z.skewY && ((b = Math.tan(O * K)), (b = Math.sqrt(1 + b * b)), (c *= b), (f *= b)))),
                                (d = -s),
                                (g = r);
                        else {
                            if (!(D || C || 1 !== G || M || L))
                                return void (A[Ca] =
                                    (z.xPercent || z.yPercent ? "translate(" + z.xPercent + "%," + z.yPercent + "%) translate3d(" : "translate3d(") +
                                    H +
                                    "px," +
                                    I +
                                    "px," +
                                    J +
                                    "px)" +
                                    (1 !== E || 1 !== F ? " scale(" + E + "," + F + ")" : ""));
                            (c = g = 1), (d = f = 0);
                        }
                        (k = 1),
                            (e = h = i = j = l = m = 0),
                            (o = M ? -1 / M : 0),
                            (p = z.zOrigin),
                            (q = 1e-6),
                            (v = ","),
                            (w = "0"),
                            (B = D * K),
                            B && ((r = Math.cos(B)), (s = Math.sin(B)), (i = -s), (l = o * -s), (e = c * s), (h = f * s), (k = r), (o *= r), (c *= r), (f *= r)),
                            (B = C * K),
                            B &&
                                ((r = Math.cos(B)),
                                (s = Math.sin(B)),
                                (b = d * r + e * s),
                                (t = g * r + h * s),
                                (j = k * s),
                                (m = o * s),
                                (e = d * -s + e * r),
                                (h = g * -s + h * r),
                                (k *= r),
                                (o *= r),
                                (d = b),
                                (g = t)),
                            1 !== G && ((e *= G), (h *= G), (k *= G), (o *= G)),
                            1 !== F && ((d *= F), (g *= F), (j *= F), (m *= F)),
                            1 !== E && ((c *= E), (f *= E), (i *= E), (l *= E)),
                            (p || L) &&
                                (p && ((H += e * -p), (I += h * -p), (J += k * -p + p)),
                                L && ((H += z.xOrigin - (z.xOrigin * c + z.yOrigin * d) + z.xOffset), (I += z.yOrigin - (z.xOrigin * f + z.yOrigin * g) + z.yOffset)),
                                q > H && H > -q && (H = w),
                                q > I && I > -q && (I = w),
                                q > J && J > -q && (J = 0)),
                            (u = z.xPercent || z.yPercent ? "translate(" + z.xPercent + "%," + z.yPercent + "%) matrix3d(" : "matrix3d("),
                            (u += (q > c && c > -q ? w : c) + v + (q > f && f > -q ? w : f) + v + (q > i && i > -q ? w : i)),
                            (u += v + (q > l && l > -q ? w : l) + v + (q > d && d > -q ? w : d) + v + (q > g && g > -q ? w : g)),
                            C || D || 1 !== G
                                ? ((u += v + (q > j && j > -q ? w : j) + v + (q > m && m > -q ? w : m) + v + (q > e && e > -q ? w : e)),
                                  (u += v + (q > h && h > -q ? w : h) + v + (q > k && k > -q ? w : k) + v + (q > o && o > -q ? w : o) + v))
                                : (u += ",0,0,0,0,1,0,"),
                            (u += H + v + I + v + J + v + (M ? 1 + -J / M : 1) + ")"),
                            (A[Ca] = u);
                    });
                (j = Ga.prototype),
                    (j.x = j.y = j.z = j.skewX = j.skewY = j.rotation = j.rotationX = j.rotationY = j.zOrigin = j.xPercent = j.yPercent = j.xOffset = j.yOffset = 0),
                    (j.scaleX = j.scaleY = j.scaleZ = 1),
                    ya(
                        "transform,scale,scaleX,scaleY,scaleZ,x,y,z,rotation,rotationX,rotationY,rotationZ,skewX,skewY,shortRotation,shortRotationX,shortRotationY,shortRotationZ,transformOrigin,svgOrigin,transformPerspective,directionalRotation,parseTransform,force3D,skewType,xPercent,yPercent,smoothOrigin",
                        {
                            parser: function(a, b, c, d, f, h, i) {
                                if (d._lastParsedTransform === i) return f;
                                d._lastParsedTransform = i;
                                var j,
                                    k = i.scale && "function" == typeof i.scale ? i.scale : 0;
                                "function" == typeof i[c] && ((j = i[c]), (i[c] = b)), k && (i.scale = k(r, a));
                                var l,
                                    m,
                                    n,
                                    o,
                                    p,
                                    s,
                                    t,
                                    u,
                                    v,
                                    w = a._gsTransform,
                                    x = a.style,
                                    y = 1e-6,
                                    z = Ba.length,
                                    A = i,
                                    B = {},
                                    C = "transformOrigin",
                                    D = Ra(a, e, !0, A.parseTransform),
                                    E = A.transform && ("function" == typeof A.transform ? A.transform(r, q) : A.transform);
                                if (((D.skewType = A.skewType || D.skewType || g.defaultSkewType), (d._transform = D), E && "string" == typeof E && Ca))
                                    (m = Q.style),
                                        (m[Ca] = E),
                                        (m.display = "block"),
                                        (m.position = "absolute"),
                                        O.body.appendChild(Q),
                                        (l = Ra(Q, null, !1)),
                                        "simple" === D.skewType && (l.scaleY *= Math.cos(l.skewX * K)),
                                        D.svg &&
                                            ((s = D.xOrigin),
                                            (t = D.yOrigin),
                                            (l.x -= D.xOffset),
                                            (l.y -= D.yOffset),
                                            (A.transformOrigin || A.svgOrigin) &&
                                                ((E = {}),
                                                La(a, ha(A.transformOrigin), E, A.svgOrigin, A.smoothOrigin, !0),
                                                (s = E.xOrigin),
                                                (t = E.yOrigin),
                                                (l.x -= E.xOffset - D.xOffset),
                                                (l.y -= E.yOffset - D.yOffset)),
                                            (s || t) && ((u = Qa(Q, !0)), (l.x -= s - (s * u[0] + t * u[2])), (l.y -= t - (s * u[1] + t * u[3])))),
                                        O.body.removeChild(Q),
                                        l.perspective || (l.perspective = D.perspective),
                                        null != A.xPercent && (l.xPercent = ja(A.xPercent, D.xPercent)),
                                        null != A.yPercent && (l.yPercent = ja(A.yPercent, D.yPercent));
                                else if ("object" == typeof A) {
                                    if (
                                        ((l = {
                                            scaleX: ja(null != A.scaleX ? A.scaleX : A.scale, D.scaleX),
                                            scaleY: ja(null != A.scaleY ? A.scaleY : A.scale, D.scaleY),
                                            scaleZ: ja(A.scaleZ, D.scaleZ),
                                            x: ja(A.x, D.x),
                                            y: ja(A.y, D.y),
                                            z: ja(A.z, D.z),
                                            xPercent: ja(A.xPercent, D.xPercent),
                                            yPercent: ja(A.yPercent, D.yPercent),
                                            perspective: ja(A.transformPerspective, D.perspective)
                                        }),
                                        (p = A.directionalRotation),
                                        null != p)
                                    )
                                        if ("object" == typeof p) for (m in p) A[m] = p[m];
                                        else A.rotation = p;
                                    "string" == typeof A.x && -1 !== A.x.indexOf("%") && ((l.x = 0), (l.xPercent = ja(A.x, D.xPercent))),
                                        "string" == typeof A.y && -1 !== A.y.indexOf("%") && ((l.y = 0), (l.yPercent = ja(A.y, D.yPercent))),
                                        (l.rotation = ka(
                                            "rotation" in A ? A.rotation : "shortRotation" in A ? A.shortRotation + "_short" : "rotationZ" in A ? A.rotationZ : D.rotation,
                                            D.rotation,
                                            "rotation",
                                            B
                                        )),
                                        Fa &&
                                            ((l.rotationX = ka(
                                                "rotationX" in A ? A.rotationX : "shortRotationX" in A ? A.shortRotationX + "_short" : D.rotationX || 0,
                                                D.rotationX,
                                                "rotationX",
                                                B
                                            )),
                                            (l.rotationY = ka(
                                                "rotationY" in A ? A.rotationY : "shortRotationY" in A ? A.shortRotationY + "_short" : D.rotationY || 0,
                                                D.rotationY,
                                                "rotationY",
                                                B
                                            ))),
                                        (l.skewX = ka(A.skewX, D.skewX)),
                                        (l.skewY = ka(A.skewY, D.skewY));
                                }
                                for (
                                    Fa && null != A.force3D && ((D.force3D = A.force3D), (o = !0)),
                                        n = D.force3D || D.z || D.rotationX || D.rotationY || l.z || l.rotationX || l.rotationY || l.perspective,
                                        n || null == A.scale || (l.scaleZ = 1);
                                    --z > -1;

                                )
                                    (v = Ba[z]),
                                        (E = l[v] - D[v]),
                                        (E > y || -y > E || null != A[v] || null != M[v]) &&
                                            ((o = !0), (f = new ta(D, v, D[v], E, f)), v in B && (f.e = B[v]), (f.xs0 = 0), (f.plugin = h), d._overwriteProps.push(f.n));
                                return (
                                    (E = A.transformOrigin),
                                    D.svg &&
                                        (E || A.svgOrigin) &&
                                        ((s = D.xOffset),
                                        (t = D.yOffset),
                                        La(a, ha(E), l, A.svgOrigin, A.smoothOrigin),
                                        (f = ua(D, "xOrigin", (w ? D : l).xOrigin, l.xOrigin, f, C)),
                                        (f = ua(D, "yOrigin", (w ? D : l).yOrigin, l.yOrigin, f, C)),
                                        (s !== D.xOffset || t !== D.yOffset) &&
                                            ((f = ua(D, "xOffset", w ? s : D.xOffset, D.xOffset, f, C)), (f = ua(D, "yOffset", w ? t : D.yOffset, D.yOffset, f, C))),
                                        (E = "0px 0px")),
                                    (E || (Fa && n && D.zOrigin)) &&
                                        (Ca
                                            ? ((o = !0),
                                              (v = Ea),
                                              (E = (E || _(a, v, e, !1, "50% 50%")) + ""),
                                              (f = new ta(x, v, 0, 0, f, -1, C)),
                                              (f.b = x[v]),
                                              (f.plugin = h),
                                              Fa
                                                  ? ((m = D.zOrigin),
                                                    (E = E.split(" ")),
                                                    (D.zOrigin = (E.length > 2 && (0 === m || "0px" !== E[2]) ? parseFloat(E[2]) : m) || 0),
                                                    (f.xs0 = f.e = E[0] + " " + (E[1] || "50%") + " 0px"),
                                                    (f = new ta(D, "zOrigin", 0, 0, f, -1, f.n)),
                                                    (f.b = m),
                                                    (f.xs0 = f.e = D.zOrigin))
                                                  : (f.xs0 = f.e = E))
                                            : ha(E + "", D)),
                                    o && (d._transformType = (D.svg && Aa) || (!n && 3 !== this._transformType) ? 2 : 3),
                                    j && (i[c] = j),
                                    k && (i.scale = k),
                                    f
                                );
                            },
                            prefix: !0
                        }
                    ),
                    ya("boxShadow", { defaultValue: "0px 0px 0px 0px #999", prefix: !0, color: !0, multi: !0, keyword: "inset" }),
                    ya("borderRadius", {
                        defaultValue: "0px",
                        parser: function(a, b, c, f, g, h) {
                            b = this.format(b);
                            var i,
                                j,
                                k,
                                l,
                                m,
                                n,
                                o,
                                p,
                                q,
                                r,
                                s,
                                t,
                                u,
                                v,
                                w,
                                x,
                                y = ["borderTopLeftRadius", "borderTopRightRadius", "borderBottomRightRadius", "borderBottomLeftRadius"],
                                z = a.style;
                            for (q = parseFloat(a.offsetWidth), r = parseFloat(a.offsetHeight), i = b.split(" "), j = 0; j < y.length; j++)
                                this.p.indexOf("border") && (y[j] = Z(y[j])),
                                    (m = l = _(a, y[j], e, !1, "0px")),
                                    -1 !== m.indexOf(" ") && ((l = m.split(" ")), (m = l[0]), (l = l[1])),
                                    (n = k = i[j]),
                                    (o = parseFloat(m)),
                                    (t = m.substr((o + "").length)),
                                    (u = "=" === n.charAt(1)),
                                    u
                                        ? ((p = parseInt(n.charAt(0) + "1", 10)), (n = n.substr(2)), (p *= parseFloat(n)), (s = n.substr((p + "").length - (0 > p ? 1 : 0)) || ""))
                                        : ((p = parseFloat(n)), (s = n.substr((p + "").length))),
                                    "" === s && (s = d[c] || t),
                                    s !== t &&
                                        ((v = aa(a, "borderLeft", o, t)),
                                        (w = aa(a, "borderTop", o, t)),
                                        "%" === s
                                            ? ((m = (v / q) * 100 + "%"), (l = (w / r) * 100 + "%"))
                                            : "em" === s
                                            ? ((x = aa(a, "borderLeft", 1, "em")), (m = v / x + "em"), (l = w / x + "em"))
                                            : ((m = v + "px"), (l = w + "px")),
                                        u && ((n = parseFloat(m) + p + s), (k = parseFloat(l) + p + s))),
                                    (g = va(z, y[j], m + " " + l, n + " " + k, !1, "0px", g));
                            return g;
                        },
                        prefix: !0,
                        formatter: qa("0px 0px 0px 0px", !1, !0)
                    }),
                    ya("borderBottomLeftRadius,borderBottomRightRadius,borderTopLeftRadius,borderTopRightRadius", {
                        defaultValue: "0px",
                        parser: function(a, b, c, d, f, g) {
                            return va(a.style, c, this.format(_(a, c, e, !1, "0px 0px")), this.format(b), !1, "0px", f);
                        },
                        prefix: !0,
                        formatter: qa("0px 0px", !1, !0)
                    }),
                    ya("backgroundPosition", {
                        defaultValue: "0 0",
                        parser: function(a, b, c, d, f, g) {
                            var h,
                                i,
                                j,
                                k,
                                l,
                                m,
                                n = "background-position",
                                o = e || $(a, null),
                                q = this.format(
                                    (o
                                        ? p
                                            ? o.getPropertyValue(n + "-x") + " " + o.getPropertyValue(n + "-y")
                                            : o.getPropertyValue(n)
                                        : a.currentStyle.backgroundPositionX + " " + a.currentStyle.backgroundPositionY) || "0 0"
                                ),
                                r = this.format(b);
                            if (
                                (-1 !== q.indexOf("%")) != (-1 !== r.indexOf("%")) &&
                                r.split(",").length < 2 &&
                                ((m = _(a, "backgroundImage").replace(D, "")), m && "none" !== m)
                            ) {
                                for (h = q.split(" "), i = r.split(" "), R.setAttribute("src", m), j = 2; --j > -1; )
                                    (q = h[j]),
                                        (k = -1 !== q.indexOf("%")),
                                        k !== (-1 !== i[j].indexOf("%")) &&
                                            ((l = 0 === j ? a.offsetWidth - R.width : a.offsetHeight - R.height),
                                            (h[j] = k ? (parseFloat(q) / 100) * l + "px" : (parseFloat(q) / l) * 100 + "%"));
                                q = h.join(" ");
                            }
                            return this.parseComplex(a.style, q, r, f, g);
                        },
                        formatter: ha
                    }),
                    ya("backgroundSize", {
                        defaultValue: "0 0",
                        formatter: function(a) {
                            return (a += ""), ha(-1 === a.indexOf(" ") ? a + " " + a : a);
                        }
                    }),
                    ya("perspective", { defaultValue: "0px", prefix: !0 }),
                    ya("perspectiveOrigin", { defaultValue: "50% 50%", prefix: !0 }),
                    ya("transformStyle", { prefix: !0 }),
                    ya("backfaceVisibility", { prefix: !0 }),
                    ya("userSelect", { prefix: !0 }),
                    ya("margin", { parser: ra("marginTop,marginRight,marginBottom,marginLeft") }),
                    ya("padding", { parser: ra("paddingTop,paddingRight,paddingBottom,paddingLeft") }),
                    ya("clip", {
                        defaultValue: "rect(0px,0px,0px,0px)",
                        parser: function(a, b, c, d, f, g) {
                            var h, i, j;
                            return (
                                9 > p
                                    ? ((i = a.currentStyle),
                                      (j = 8 > p ? " " : ","),
                                      (h = "rect(" + i.clipTop + j + i.clipRight + j + i.clipBottom + j + i.clipLeft + ")"),
                                      (b = this.format(b)
                                          .split(",")
                                          .join(j)))
                                    : ((h = this.format(_(a, this.p, e, !1, this.dflt))), (b = this.format(b))),
                                this.parseComplex(a.style, h, b, f, g)
                            );
                        }
                    }),
                    ya("textShadow", { defaultValue: "0px 0px 0px #999", color: !0, multi: !0 }),
                    ya("autoRound,strictUnits", {
                        parser: function(a, b, c, d, e) {
                            return e;
                        }
                    }),
                    ya("border", {
                        defaultValue: "0px solid #000",
                        parser: function(a, b, c, d, f, g) {
                            var h = _(a, "borderTopWidth", e, !1, "0px"),
                                i = this.format(b).split(" "),
                                j = i[0].replace(w, "");
                            return (
                                "px" !== j && (h = parseFloat(h) / aa(a, "borderTopWidth", 1, j) + j),
                                this.parseComplex(
                                    a.style,
                                    this.format(h + " " + _(a, "borderTopStyle", e, !1, "solid") + " " + _(a, "borderTopColor", e, !1, "#000")),
                                    i.join(" "),
                                    f,
                                    g
                                )
                            );
                        },
                        color: !0,
                        formatter: function(a) {
                            var b = a.split(" ");
                            return b[0] + " " + (b[1] || "solid") + " " + (a.match(pa) || ["#000"])[0];
                        }
                    }),
                    ya("borderWidth", { parser: ra("borderTopWidth,borderRightWidth,borderBottomWidth,borderLeftWidth") }),
                    ya("float,cssFloat,styleFloat", {
                        parser: function(a, b, c, d, e, f) {
                            var g = a.style,
                                h = "cssFloat" in g ? "cssFloat" : "styleFloat";
                            return new ta(g, h, 0, 0, e, -1, c, !1, 0, g[h], b);
                        }
                    });
                var Ua = function(a) {
                    var b,
                        c = this.t,
                        d = c.filter || _(this.data, "filter") || "",
                        e = (this.s + this.c * a) | 0;
                    100 === e &&
                        (-1 === d.indexOf("atrix(") && -1 === d.indexOf("radient(") && -1 === d.indexOf("oader(")
                            ? (c.removeAttribute("filter"), (b = !_(this.data, "filter")))
                            : ((c.filter = d.replace(z, "")), (b = !0))),
                        b ||
                            (this.xn1 && (c.filter = d = d || "alpha(opacity=" + e + ")"),
                            -1 === d.indexOf("pacity") ? (0 === e && this.xn1) || (c.filter = d + " alpha(opacity=" + e + ")") : (c.filter = d.replace(x, "opacity=" + e)));
                };
                ya("opacity,alpha,autoAlpha", {
                    defaultValue: "1",
                    parser: function(a, b, c, d, f, g) {
                        var h = parseFloat(_(a, "opacity", e, !1, "1")),
                            i = a.style,
                            j = "autoAlpha" === c;
                        return (
                            "string" == typeof b && "=" === b.charAt(1) && (b = ("-" === b.charAt(0) ? -1 : 1) * parseFloat(b.substr(2)) + h),
                            j && 1 === h && "hidden" === _(a, "visibility", e) && 0 !== b && (h = 0),
                            U
                                ? (f = new ta(i, "opacity", h, b - h, f))
                                : ((f = new ta(i, "opacity", 100 * h, 100 * (b - h), f)),
                                  (f.xn1 = j ? 1 : 0),
                                  (i.zoom = 1),
                                  (f.type = 2),
                                  (f.b = "alpha(opacity=" + f.s + ")"),
                                  (f.e = "alpha(opacity=" + (f.s + f.c) + ")"),
                                  (f.data = a),
                                  (f.plugin = g),
                                  (f.setRatio = Ua)),
                            j &&
                                ((f = new ta(i, "visibility", 0, 0, f, -1, null, !1, 0, 0 !== h ? "inherit" : "hidden", 0 === b ? "hidden" : "inherit")),
                                (f.xs0 = "inherit"),
                                d._overwriteProps.push(f.n),
                                d._overwriteProps.push(c)),
                            f
                        );
                    }
                });
                var Va = function(a, b) {
                        b &&
                            (a.removeProperty
                                ? (("ms" === b.substr(0, 2) || "webkit" === b.substr(0, 6)) && (b = "-" + b), a.removeProperty(b.replace(B, "-$1").toLowerCase()))
                                : a.removeAttribute(b));
                    },
                    Wa = function(a) {
                        if (((this.t._gsClassPT = this), 1 === a || 0 === a)) {
                            this.t.setAttribute("class", 0 === a ? this.b : this.e);
                            for (var b = this.data, c = this.t.style; b; ) b.v ? (c[b.p] = b.v) : Va(c, b.p), (b = b._next);
                            1 === a && this.t._gsClassPT === this && (this.t._gsClassPT = null);
                        } else this.t.getAttribute("class") !== this.e && this.t.setAttribute("class", this.e);
                    };
                ya("className", {
                    parser: function(a, b, d, f, g, h, i) {
                        var j,
                            k,
                            l,
                            m,
                            n,
                            o = a.getAttribute("class") || "",
                            p = a.style.cssText;
                        if (((g = f._classNamePT = new ta(a, d, 0, 0, g, 2)), (g.setRatio = Wa), (g.pr = -11), (c = !0), (g.b = o), (k = ca(a, e)), (l = a._gsClassPT))) {
                            for (m = {}, n = l.data; n; ) (m[n.p] = 1), (n = n._next);
                            l.setRatio(1);
                        }
                        return (
                            (a._gsClassPT = g),
                            (g.e = "=" !== b.charAt(1) ? b : o.replace(new RegExp("(?:\\s|^)" + b.substr(2) + "(?![\\w-])"), "") + ("+" === b.charAt(0) ? " " + b.substr(2) : "")),
                            a.setAttribute("class", g.e),
                            (j = da(a, k, ca(a), i, m)),
                            a.setAttribute("class", o),
                            (g.data = j.firstMPT),
                            (a.style.cssText = p),
                            (g = g.xfirst = f.parse(a, j.difs, g, h))
                        );
                    }
                });
                var Xa = function(a) {
                    if ((1 === a || 0 === a) && this.data._totalTime === this.data._totalDuration && "isFromStart" !== this.data.data) {
                        var b,
                            c,
                            d,
                            e,
                            f,
                            g = this.t.style,
                            h = i.transform.parse;
                        if ("all" === this.e) (g.cssText = ""), (e = !0);
                        else
                            for (
                                b = this.e
                                    .split(" ")
                                    .join("")
                                    .split(","),
                                    d = b.length;
                                --d > -1;

                            )
                                (c = b[d]), i[c] && (i[c].parse === h ? (e = !0) : (c = "transformOrigin" === c ? Ea : i[c].p)), Va(g, c);
                        e &&
                            (Va(g, Ca),
                            (f = this.t._gsTransform),
                            f && (f.svg && (this.t.removeAttribute("data-svg-origin"), this.t.removeAttribute("transform")), delete this.t._gsTransform));
                    }
                };
                for (
                    ya("clearProps", {
                        parser: function(a, b, d, e, f) {
                            return (f = new ta(a, d, 0, 0, f, 2)), (f.setRatio = Xa), (f.e = b), (f.pr = -10), (f.data = e._tween), (c = !0), f;
                        }
                    }),
                        j = "bezier,throwProps,physicsProps,physics2D".split(","),
                        wa = j.length;
                    wa--;

                )
                    za(j[wa]);
                (j = g.prototype),
                    (j._firstPT = j._lastParsedTransform = j._transform = null),
                    (j._onInitTween = function(a, b, h, j) {
                        if (!a.nodeType) return !1;
                        (this._target = q = a),
                            (this._tween = h),
                            (this._vars = b),
                            (r = j),
                            (k = b.autoRound),
                            (c = !1),
                            (d = b.suffixMap || g.suffixMap),
                            (e = $(a, "")),
                            (f = this._overwriteProps);
                        var n,
                            p,
                            s,
                            t,
                            u,
                            v,
                            w,
                            x,
                            z,
                            A = a.style;
                        if (
                            (l && "" === A.zIndex && ((n = _(a, "zIndex", e)), ("auto" === n || "" === n) && this._addLazySet(A, "zIndex", 0)),
                            "string" == typeof b &&
                                ((t = A.cssText),
                                (n = ca(a, e)),
                                (A.cssText = t + ";" + b),
                                (n = da(a, n, ca(a)).difs),
                                !U && y.test(b) && (n.opacity = parseFloat(RegExp.$1)),
                                (b = n),
                                (A.cssText = t)),
                            b.className ? (this._firstPT = p = i.className.parse(a, b.className, "className", this, null, null, b)) : (this._firstPT = p = this.parse(a, b, null)),
                            this._transformType)
                        ) {
                            for (
                                z = 3 === this._transformType,
                                    Ca
                                        ? m &&
                                          ((l = !0),
                                          "" === A.zIndex && ((w = _(a, "zIndex", e)), ("auto" === w || "" === w) && this._addLazySet(A, "zIndex", 0)),
                                          o && this._addLazySet(A, "WebkitBackfaceVisibility", this._vars.WebkitBackfaceVisibility || (z ? "visible" : "hidden")))
                                        : (A.zoom = 1),
                                    s = p;
                                s && s._next;

                            )
                                s = s._next;
                            (x = new ta(a, "transform", 0, 0, null, 2)),
                                this._linkCSSP(x, null, s),
                                (x.setRatio = Ca ? Ta : Sa),
                                (x.data = this._transform || Ra(a, e, !0)),
                                (x.tween = h),
                                (x.pr = -1),
                                f.pop();
                        }
                        if (c) {
                            for (; p; ) {
                                for (v = p._next, s = t; s && s.pr > p.pr; ) s = s._next;
                                (p._prev = s ? s._prev : u) ? (p._prev._next = p) : (t = p), (p._next = s) ? (s._prev = p) : (u = p), (p = v);
                            }
                            this._firstPT = t;
                        }
                        return !0;
                    }),
                    (j.parse = function(a, b, c, f) {
                        var g,
                            h,
                            j,
                            l,
                            m,
                            n,
                            o,
                            p,
                            s,
                            t,
                            u = a.style;
                        for (g in b) {
                            if (((n = b[g]), "function" == typeof n && (n = n(r, q)), (h = i[g]))) c = h.parse(a, n, g, this, c, f, b);
                            else {
                                if ("--" === g.substr(0, 2)) {
                                    this._tween._propLookup[g] = this._addTween.call(this._tween, a.style, "setProperty", $(a).getPropertyValue(g) + "", n + "", g, !1, g);
                                    continue;
                                }
                                (m = _(a, g, e) + ""),
                                    (s = "string" == typeof n),
                                    "color" === g || "fill" === g || "stroke" === g || -1 !== g.indexOf("Color") || (s && A.test(n))
                                        ? (s || ((n = na(n)), (n = (n.length > 3 ? "rgba(" : "rgb(") + n.join(",") + ")")), (c = va(u, g, m, n, !0, "transparent", c, 0, f)))
                                        : s && J.test(n)
                                        ? (c = va(u, g, m, n, !0, null, c, 0, f))
                                        : ((j = parseFloat(m)),
                                          (o = j || 0 === j ? m.substr((j + "").length) : ""),
                                          ("" === m || "auto" === m) &&
                                              ("width" === g || "height" === g
                                                  ? ((j = ga(a, g, e)), (o = "px"))
                                                  : "left" === g || "top" === g
                                                  ? ((j = ba(a, g, e)), (o = "px"))
                                                  : ((j = "opacity" !== g ? 0 : 1), (o = ""))),
                                          (t = s && "=" === n.charAt(1)),
                                          t
                                              ? ((l = parseInt(n.charAt(0) + "1", 10)), (n = n.substr(2)), (l *= parseFloat(n)), (p = n.replace(w, "")))
                                              : ((l = parseFloat(n)), (p = s ? n.replace(w, "") : "")),
                                          "" === p && (p = g in d ? d[g] : o),
                                          (n = l || 0 === l ? (t ? l + j : l) + p : b[g]),
                                          o !== p &&
                                              ("" !== p || "lineHeight" === g) &&
                                              (l || 0 === l) &&
                                              j &&
                                              ((j = aa(a, g, j, o)),
                                              "%" === p
                                                  ? ((j /= aa(a, g, 100, "%") / 100), b.strictUnits !== !0 && (m = j + "%"))
                                                  : "em" === p || "rem" === p || "vw" === p || "vh" === p
                                                  ? (j /= aa(a, g, 1, p))
                                                  : "px" !== p && ((l = aa(a, g, l, p)), (p = "px")),
                                              t && (l || 0 === l) && (n = l + j + p)),
                                          t && (l += j),
                                          (!j && 0 !== j) || (!l && 0 !== l)
                                              ? void 0 !== u[g] && (n || (n + "" != "NaN" && null != n))
                                                  ? ((c = new ta(u, g, l || j || 0, 0, c, -1, g, !1, 0, m, n)),
                                                    (c.xs0 = "none" !== n || ("display" !== g && -1 === g.indexOf("Style")) ? n : m))
                                                  : W("invalid " + g + " tween value: " + b[g])
                                              : ((c = new ta(u, g, j, l - j, c, 0, g, k !== !1 && ("px" === p || "zIndex" === g), 0, m, n)), (c.xs0 = p)));
                            }
                            f && c && !c.plugin && (c.plugin = f);
                        }
                        return c;
                    }),
                    (j.setRatio = function(a) {
                        var b,
                            c,
                            d,
                            e = this._firstPT,
                            f = 1e-6;
                        if (1 !== a || (this._tween._time !== this._tween._duration && 0 !== this._tween._time))
                            if (a || (this._tween._time !== this._tween._duration && 0 !== this._tween._time) || this._tween._rawPrevTime === -1e-6)
                                for (; e; ) {
                                    if (((b = e.c * a + e.s), e.r ? (b = Math.round(b)) : f > b && b > -f && (b = 0), e.type))
                                        if (1 === e.type)
                                            if (((d = e.l), 2 === d)) e.t[e.p] = e.xs0 + b + e.xs1 + e.xn1 + e.xs2;
                                            else if (3 === d) e.t[e.p] = e.xs0 + b + e.xs1 + e.xn1 + e.xs2 + e.xn2 + e.xs3;
                                            else if (4 === d) e.t[e.p] = e.xs0 + b + e.xs1 + e.xn1 + e.xs2 + e.xn2 + e.xs3 + e.xn3 + e.xs4;
                                            else if (5 === d) e.t[e.p] = e.xs0 + b + e.xs1 + e.xn1 + e.xs2 + e.xn2 + e.xs3 + e.xn3 + e.xs4 + e.xn4 + e.xs5;
                                            else {
                                                for (c = e.xs0 + b + e.xs1, d = 1; d < e.l; d++) c += e["xn" + d] + e["xs" + (d + 1)];
                                                e.t[e.p] = c;
                                            }
                                        else -1 === e.type ? (e.t[e.p] = e.xs0) : e.setRatio && e.setRatio(a);
                                    else e.t[e.p] = b + e.xs0;
                                    e = e._next;
                                }
                            else for (; e; ) 2 !== e.type ? (e.t[e.p] = e.b) : e.setRatio(a), (e = e._next);
                        else
                            for (; e; ) {
                                if (2 !== e.type)
                                    if (e.r && -1 !== e.type)
                                        if (((b = Math.round(e.s + e.c)), e.type)) {
                                            if (1 === e.type) {
                                                for (d = e.l, c = e.xs0 + b + e.xs1, d = 1; d < e.l; d++) c += e["xn" + d] + e["xs" + (d + 1)];
                                                e.t[e.p] = c;
                                            }
                                        } else e.t[e.p] = b + e.xs0;
                                    else e.t[e.p] = e.e;
                                else e.setRatio(a);
                                e = e._next;
                            }
                    }),
                    (j._enableTransforms = function(a) {
                        (this._transform = this._transform || Ra(this._target, e, !0)),
                            (this._transformType = (this._transform.svg && Aa) || (!a && 3 !== this._transformType) ? 2 : 3);
                    });
                var Ya = function(a) {
                    (this.t[this.p] = this.e), this.data._linkCSSP(this, this._next, null, !0);
                };
                (j._addLazySet = function(a, b, c) {
                    var d = (this._firstPT = new ta(a, b, 0, 0, this._firstPT, 2));
                    (d.e = c), (d.setRatio = Ya), (d.data = this);
                }),
                    (j._linkCSSP = function(a, b, c, d) {
                        return (
                            a &&
                                (b && (b._prev = a),
                                a._next && (a._next._prev = a._prev),
                                a._prev ? (a._prev._next = a._next) : this._firstPT === a && ((this._firstPT = a._next), (d = !0)),
                                c ? (c._next = a) : d || null !== this._firstPT || (this._firstPT = a),
                                (a._next = b),
                                (a._prev = c)),
                            a
                        );
                    }),
                    (j._mod = function(a) {
                        for (var b = this._firstPT; b; ) "function" == typeof a[b.p] && a[b.p] === Math.round && (b.r = 1), (b = b._next);
                    }),
                    (j._kill = function(b) {
                        var c,
                            d,
                            e,
                            f = b;
                        if (b.autoAlpha || b.alpha) {
                            f = {};
                            for (d in b) f[d] = b[d];
                            (f.opacity = 1), f.autoAlpha && (f.visibility = 1);
                        }
                        for (
                            b.className &&
                                (c = this._classNamePT) &&
                                ((e = c.xfirst),
                                e && e._prev ? this._linkCSSP(e._prev, c._next, e._prev._prev) : e === this._firstPT && (this._firstPT = c._next),
                                c._next && this._linkCSSP(c._next, c._next._next, e._prev),
                                (this._classNamePT = null)),
                                c = this._firstPT;
                            c;

                        )
                            c.plugin && c.plugin !== d && c.plugin._kill && (c.plugin._kill(b), (d = c.plugin)), (c = c._next);
                        return a.prototype._kill.call(this, f);
                    });
                var Za = function(a, b, c) {
                    var d, e, f, g;
                    if (a.slice) for (e = a.length; --e > -1; ) Za(a[e], b, c);
                    else
                        for (d = a.childNodes, e = d.length; --e > -1; )
                            (f = d[e]), (g = f.type), f.style && (b.push(ca(f)), c && c.push(f)), (1 !== g && 9 !== g && 11 !== g) || !f.childNodes.length || Za(f, b, c);
                };
                return (
                    (g.cascadeTo = function(a, c, d) {
                        var e,
                            f,
                            g,
                            h,
                            i = b.to(a, c, d),
                            j = [i],
                            k = [],
                            l = [],
                            m = [],
                            n = b._internals.reservedProps;
                        for (a = i._targets || i.target, Za(a, k, m), i.render(c, !0, !0), Za(a, l), i.render(0, !0, !0), i._enabled(!0), e = m.length; --e > -1; )
                            if (((f = da(m[e], k[e], l[e])), f.firstMPT)) {
                                f = f.difs;
                                for (g in d) n[g] && (f[g] = d[g]);
                                h = {};
                                for (g in f) h[g] = k[e][g];
                                j.push(b.fromTo(m[e], c, h, f));
                            }
                        return j;
                    }),
                    a.activate([g]),
                    g
                );
            },
            !0
        ),
        (function() {
            var a = _gsScope._gsDefine.plugin({
                    propName: "roundProps",
                    version: "1.6.0",
                    priority: -1,
                    API: 2,
                    init: function(a, b, c) {
                        return (this._tween = c), !0;
                    }
                }),
                b = function(a) {
                    for (; a; ) a.f || a.blob || (a.m = Math.round), (a = a._next);
                },
                c = a.prototype;
            (c._onInitAllProps = function() {
                for (
                    var a, c, d, e = this._tween, f = e.vars.roundProps.join ? e.vars.roundProps : e.vars.roundProps.split(","), g = f.length, h = {}, i = e._propLookup.roundProps;
                    --g > -1;

                )
                    h[f[g]] = Math.round;
                for (g = f.length; --g > -1; )
                    for (a = f[g], c = e._firstPT; c; )
                        (d = c._next),
                            c.pg
                                ? c.t._mod(h)
                                : c.n === a &&
                                  (2 === c.f && c.t
                                      ? b(c.t._firstPT)
                                      : (this._add(c.t, a, c.s, c.c),
                                        d && (d._prev = c._prev),
                                        c._prev ? (c._prev._next = d) : e._firstPT === c && (e._firstPT = d),
                                        (c._next = c._prev = null),
                                        (e._propLookup[a] = i))),
                            (c = d);
                return !1;
            }),
                (c._add = function(a, b, c, d) {
                    this._addTween(a, b, c, c + d, b, Math.round), this._overwriteProps.push(b);
                });
        })(),
        (function() {
            _gsScope._gsDefine.plugin({
                propName: "attr",
                API: 2,
                version: "0.6.1",
                init: function(a, b, c, d) {
                    var e, f;
                    if ("function" != typeof a.setAttribute) return !1;
                    for (e in b)
                        (f = b[e]),
                            "function" == typeof f && (f = f(d, a)),
                            this._addTween(a, "setAttribute", a.getAttribute(e) + "", f + "", e, !1, e),
                            this._overwriteProps.push(e);
                    return !0;
                }
            });
        })(),
        (_gsScope._gsDefine.plugin({
            propName: "directionalRotation",
            version: "0.3.1",
            API: 2,
            init: function(a, b, c, d) {
                "object" != typeof b && (b = { rotation: b }), (this.finals = {});
                var e,
                    f,
                    g,
                    h,
                    i,
                    j,
                    k = b.useRadians === !0 ? 2 * Math.PI : 360,
                    l = 1e-6;
                for (e in b)
                    "useRadians" !== e &&
                        ((h = b[e]),
                        "function" == typeof h && (h = h(d, a)),
                        (j = (h + "").split("_")),
                        (f = j[0]),
                        (g = parseFloat("function" != typeof a[e] ? a[e] : a[e.indexOf("set") || "function" != typeof a["get" + e.substr(3)] ? e : "get" + e.substr(3)]())),
                        (h = this.finals[e] = "string" == typeof f && "=" === f.charAt(1) ? g + parseInt(f.charAt(0) + "1", 10) * Number(f.substr(2)) : Number(f) || 0),
                        (i = h - g),
                        j.length &&
                            ((f = j.join("_")),
                            -1 !== f.indexOf("short") && ((i %= k), i !== i % (k / 2) && (i = 0 > i ? i + k : i - k)),
                            -1 !== f.indexOf("_cw") && 0 > i
                                ? (i = ((i + 9999999999 * k) % k) - ((i / k) | 0) * k)
                                : -1 !== f.indexOf("ccw") && i > 0 && (i = ((i - 9999999999 * k) % k) - ((i / k) | 0) * k)),
                        (i > l || -l > i) && (this._addTween(a, e, g, g + i, e), this._overwriteProps.push(e)));
                return !0;
            },
            set: function(a) {
                var b;
                if (1 !== a) this._super.setRatio.call(this, a);
                else for (b = this._firstPT; b; ) b.f ? b.t[b.p](this.finals[b.p]) : (b.t[b.p] = this.finals[b.p]), (b = b._next);
            }
        })._autoCSS = !0),
        _gsScope._gsDefine(
            "easing.Back",
            ["easing.Ease"],
            function(a) {
                var b,
                    c,
                    d,
                    e = _gsScope.GreenSockGlobals || _gsScope,
                    f = e.com.greensock,
                    g = 2 * Math.PI,
                    h = Math.PI / 2,
                    i = f._class,
                    j = function(b, c) {
                        var d = i("easing." + b, function() {}, !0),
                            e = (d.prototype = new a());
                        return (e.constructor = d), (e.getRatio = c), d;
                    },
                    k = a.register || function() {},
                    l = function(a, b, c, d, e) {
                        var f = i("easing." + a, { easeOut: new b(), easeIn: new c(), easeInOut: new d() }, !0);
                        return k(f, a), f;
                    },
                    m = function(a, b, c) {
                        (this.t = a), (this.v = b), c && ((this.next = c), (c.prev = this), (this.c = c.v - b), (this.gap = c.t - a));
                    },
                    n = function(b, c) {
                        var d = i(
                                "easing." + b,
                                function(a) {
                                    (this._p1 = a || 0 === a ? a : 1.70158), (this._p2 = 1.525 * this._p1);
                                },
                                !0
                            ),
                            e = (d.prototype = new a());
                        return (
                            (e.constructor = d),
                            (e.getRatio = c),
                            (e.config = function(a) {
                                return new d(a);
                            }),
                            d
                        );
                    },
                    o = l(
                        "Back",
                        n("BackOut", function(a) {
                            return (a -= 1) * a * ((this._p1 + 1) * a + this._p1) + 1;
                        }),
                        n("BackIn", function(a) {
                            return a * a * ((this._p1 + 1) * a - this._p1);
                        }),
                        n("BackInOut", function(a) {
                            return (a *= 2) < 1 ? 0.5 * a * a * ((this._p2 + 1) * a - this._p2) : 0.5 * ((a -= 2) * a * ((this._p2 + 1) * a + this._p2) + 2);
                        })
                    ),
                    p = i(
                        "easing.SlowMo",
                        function(a, b, c) {
                            (b = b || 0 === b ? b : 0.7),
                                null == a ? (a = 0.7) : a > 1 && (a = 1),
                                (this._p = 1 !== a ? b : 0),
                                (this._p1 = (1 - a) / 2),
                                (this._p2 = a),
                                (this._p3 = this._p1 + this._p2),
                                (this._calcEnd = c === !0);
                        },
                        !0
                    ),
                    q = (p.prototype = new a());
                return (
                    (q.constructor = p),
                    (q.getRatio = function(a) {
                        var b = a + (0.5 - a) * this._p;
                        return a < this._p1
                            ? this._calcEnd
                                ? 1 - (a = 1 - a / this._p1) * a
                                : b - (a = 1 - a / this._p1) * a * a * a * b
                            : a > this._p3
                            ? this._calcEnd
                                ? 1 === a
                                    ? 0
                                    : 1 - (a = (a - this._p3) / this._p1) * a
                                : b + (a - b) * (a = (a - this._p3) / this._p1) * a * a * a
                            : this._calcEnd
                            ? 1
                            : b;
                    }),
                    (p.ease = new p(0.7, 0.7)),
                    (q.config = p.config = function(a, b, c) {
                        return new p(a, b, c);
                    }),
                    (b = i(
                        "easing.SteppedEase",
                        function(a, b) {
                            (a = a || 1), (this._p1 = 1 / a), (this._p2 = a + (b ? 0 : 1)), (this._p3 = b ? 1 : 0);
                        },
                        !0
                    )),
                    (q = b.prototype = new a()),
                    (q.constructor = b),
                    (q.getRatio = function(a) {
                        return 0 > a ? (a = 0) : a >= 1 && (a = 0.999999999), (((this._p2 * a) | 0) + this._p3) * this._p1;
                    }),
                    (q.config = b.config = function(a, c) {
                        return new b(a, c);
                    }),
                    (c = i(
                        "easing.RoughEase",
                        function(b) {
                            b = b || {};
                            for (
                                var c,
                                    d,
                                    e,
                                    f,
                                    g,
                                    h,
                                    i = b.taper || "none",
                                    j = [],
                                    k = 0,
                                    l = 0 | (b.points || 20),
                                    n = l,
                                    o = b.randomize !== !1,
                                    p = b.clamp === !0,
                                    q = b.template instanceof a ? b.template : null,
                                    r = "number" == typeof b.strength ? 0.4 * b.strength : 0.4;
                                --n > -1;

                            )
                                (c = o ? Math.random() : (1 / l) * n),
                                    (d = q ? q.getRatio(c) : c),
                                    "none" === i
                                        ? (e = r)
                                        : "out" === i
                                        ? ((f = 1 - c), (e = f * f * r))
                                        : "in" === i
                                        ? (e = c * c * r)
                                        : 0.5 > c
                                        ? ((f = 2 * c), (e = f * f * 0.5 * r))
                                        : ((f = 2 * (1 - c)), (e = f * f * 0.5 * r)),
                                    o ? (d += Math.random() * e - 0.5 * e) : n % 2 ? (d += 0.5 * e) : (d -= 0.5 * e),
                                    p && (d > 1 ? (d = 1) : 0 > d && (d = 0)),
                                    (j[k++] = { x: c, y: d });
                            for (
                                j.sort(function(a, b) {
                                    return a.x - b.x;
                                }),
                                    h = new m(1, 1, null),
                                    n = l;
                                --n > -1;

                            )
                                (g = j[n]), (h = new m(g.x, g.y, h));
                            this._prev = new m(0, 0, 0 !== h.t ? h : h.next);
                        },
                        !0
                    )),
                    (q = c.prototype = new a()),
                    (q.constructor = c),
                    (q.getRatio = function(a) {
                        var b = this._prev;
                        if (a > b.t) {
                            for (; b.next && a >= b.t; ) b = b.next;
                            b = b.prev;
                        } else for (; b.prev && a <= b.t; ) b = b.prev;
                        return (this._prev = b), b.v + ((a - b.t) / b.gap) * b.c;
                    }),
                    (q.config = function(a) {
                        return new c(a);
                    }),
                    (c.ease = new c()),
                    l(
                        "Bounce",
                        j("BounceOut", function(a) {
                            return 1 / 2.75 > a
                                ? 7.5625 * a * a
                                : 2 / 2.75 > a
                                ? 7.5625 * (a -= 1.5 / 2.75) * a + 0.75
                                : 2.5 / 2.75 > a
                                ? 7.5625 * (a -= 2.25 / 2.75) * a + 0.9375
                                : 7.5625 * (a -= 2.625 / 2.75) * a + 0.984375;
                        }),
                        j("BounceIn", function(a) {
                            return (a = 1 - a) < 1 / 2.75
                                ? 1 - 7.5625 * a * a
                                : 2 / 2.75 > a
                                ? 1 - (7.5625 * (a -= 1.5 / 2.75) * a + 0.75)
                                : 2.5 / 2.75 > a
                                ? 1 - (7.5625 * (a -= 2.25 / 2.75) * a + 0.9375)
                                : 1 - (7.5625 * (a -= 2.625 / 2.75) * a + 0.984375);
                        }),
                        j("BounceInOut", function(a) {
                            var b = 0.5 > a;
                            return (
                                (a = b ? 1 - 2 * a : 2 * a - 1),
                                (a =
                                    1 / 2.75 > a
                                        ? 7.5625 * a * a
                                        : 2 / 2.75 > a
                                        ? 7.5625 * (a -= 1.5 / 2.75) * a + 0.75
                                        : 2.5 / 2.75 > a
                                        ? 7.5625 * (a -= 2.25 / 2.75) * a + 0.9375
                                        : 7.5625 * (a -= 2.625 / 2.75) * a + 0.984375),
                                b ? 0.5 * (1 - a) : 0.5 * a + 0.5
                            );
                        })
                    ),
                    l(
                        "Circ",
                        j("CircOut", function(a) {
                            return Math.sqrt(1 - (a -= 1) * a);
                        }),
                        j("CircIn", function(a) {
                            return -(Math.sqrt(1 - a * a) - 1);
                        }),
                        j("CircInOut", function(a) {
                            return (a *= 2) < 1 ? -0.5 * (Math.sqrt(1 - a * a) - 1) : 0.5 * (Math.sqrt(1 - (a -= 2) * a) + 1);
                        })
                    ),
                    (d = function(b, c, d) {
                        var e = i(
                                "easing." + b,
                                function(a, b) {
                                    (this._p1 = a >= 1 ? a : 1),
                                        (this._p2 = (b || d) / (1 > a ? a : 1)),
                                        (this._p3 = (this._p2 / g) * (Math.asin(1 / this._p1) || 0)),
                                        (this._p2 = g / this._p2);
                                },
                                !0
                            ),
                            f = (e.prototype = new a());
                        return (
                            (f.constructor = e),
                            (f.getRatio = c),
                            (f.config = function(a, b) {
                                return new e(a, b);
                            }),
                            e
                        );
                    }),
                    l(
                        "Elastic",
                        d(
                            "ElasticOut",
                            function(a) {
                                return this._p1 * Math.pow(2, -10 * a) * Math.sin((a - this._p3) * this._p2) + 1;
                            },
                            0.3
                        ),
                        d(
                            "ElasticIn",
                            function(a) {
                                return -(this._p1 * Math.pow(2, 10 * (a -= 1)) * Math.sin((a - this._p3) * this._p2));
                            },
                            0.3
                        ),
                        d(
                            "ElasticInOut",
                            function(a) {
                                return (a *= 2) < 1
                                    ? -0.5 * (this._p1 * Math.pow(2, 10 * (a -= 1)) * Math.sin((a - this._p3) * this._p2))
                                    : this._p1 * Math.pow(2, -10 * (a -= 1)) * Math.sin((a - this._p3) * this._p2) * 0.5 + 1;
                            },
                            0.45
                        )
                    ),
                    l(
                        "Expo",
                        j("ExpoOut", function(a) {
                            return 1 - Math.pow(2, -10 * a);
                        }),
                        j("ExpoIn", function(a) {
                            return Math.pow(2, 10 * (a - 1)) - 0.001;
                        }),
                        j("ExpoInOut", function(a) {
                            return (a *= 2) < 1 ? 0.5 * Math.pow(2, 10 * (a - 1)) : 0.5 * (2 - Math.pow(2, -10 * (a - 1)));
                        })
                    ),
                    l(
                        "Sine",
                        j("SineOut", function(a) {
                            return Math.sin(a * h);
                        }),
                        j("SineIn", function(a) {
                            return -Math.cos(a * h) + 1;
                        }),
                        j("SineInOut", function(a) {
                            return -0.5 * (Math.cos(Math.PI * a) - 1);
                        })
                    ),
                    i(
                        "easing.EaseLookup",
                        {
                            find: function(b) {
                                return a.map[b];
                            }
                        },
                        !0
                    ),
                    k(e.SlowMo, "SlowMo", "ease,"),
                    k(c, "RoughEase", "ease,"),
                    k(b, "SteppedEase", "ease,"),
                    o
                );
            },
            !0
        );
}),
    _gsScope._gsDefine && _gsScope._gsQueue.pop()(),
    (function(a, b) {
        "use strict";
        var c = {},
            d = a.document,
            e = (a.GreenSockGlobals = a.GreenSockGlobals || a);
        if (!e.TweenLite) {
            var f,
                g,
                h,
                i,
                j,
                k = function(a) {
                    var b,
                        c = a.split("."),
                        d = e;
                    for (b = 0; b < c.length; b++) d[c[b]] = d = d[c[b]] || {};
                    return d;
                },
                l = k("com.greensock"),
                m = 1e-10,
                n = function(a) {
                    var b,
                        c = [],
                        d = a.length;
                    for (b = 0; b !== d; c.push(a[b++]));
                    return c;
                },
                o = function() {},
                p = (function() {
                    var a = Object.prototype.toString,
                        b = a.call([]);
                    return function(c) {
                        return null != c && (c instanceof Array || ("object" == typeof c && !!c.push && a.call(c) === b));
                    };
                })(),
                q = {},
                r = function(d, f, g, h) {
                    (this.sc = q[d] ? q[d].sc : []), (q[d] = this), (this.gsClass = null), (this.func = g);
                    var i = [];
                    (this.check = function(j) {
                        for (var l, m, n, o, p = f.length, s = p; --p > -1; ) (l = q[f[p]] || new r(f[p], [])).gsClass ? ((i[p] = l.gsClass), s--) : j && l.sc.push(this);
                        if (0 === s && g) {
                            if (((m = ("com.greensock." + d).split(".")), (n = m.pop()), (o = k(m.join("."))[n] = this.gsClass = g.apply(g, i)), h))
                                if (((e[n] = c[n] = o), "undefined" != typeof module && module.exports))
                                    if (d === b) {
                                        module.exports = c[b] = o;
                                        for (p in c) o[p] = c[p];
                                    } else c[b] && (c[b][n] = o);
                                else
                                    "function" === typeof wwplayer.define &&
                                        wwplayer.define.amd &&
                                        wwplayer.define((a.GreenSockAMDPath ? a.GreenSockAMDPath + "/" : "") + d.split(".").pop(), [], function() {
                                            return o;
                                        });
                            for (p = 0; p < this.sc.length; p++) this.sc[p].check();
                        }
                    }),
                        this.check(!0);
                },
                s = (a._gsDefine = function(a, b, c, d) {
                    return new r(a, b, c, d);
                }),
                t = (l._class = function(a, b, c) {
                    return (
                        (b = b || function() {}),
                        s(
                            a,
                            [],
                            function() {
                                return b;
                            },
                            c
                        ),
                        b
                    );
                });
            s.globals = e;
            var u = [0, 0, 1, 1],
                v = t(
                    "easing.Ease",
                    function(a, b, c, d) {
                        (this._func = a), (this._type = c || 0), (this._power = d || 0), (this._params = b ? u.concat(b) : u);
                    },
                    !0
                ),
                w = (v.map = {}),
                x = (v.register = function(a, b, c, d) {
                    for (var e, f, g, h, i = b.split(","), j = i.length, k = (c || "easeIn,easeOut,easeInOut").split(","); --j > -1; )
                        for (f = i[j], e = d ? t("easing." + f, null, !0) : l.easing[f] || {}, g = k.length; --g > -1; )
                            (h = k[g]), (w[f + "." + h] = w[h + f] = e[h] = a.getRatio ? a : a[h] || new a());
                });
            for (
                h = v.prototype,
                    h._calcEnd = !1,
                    h.getRatio = function(a) {
                        if (this._func) return (this._params[0] = a), this._func.apply(null, this._params);
                        var b = this._type,
                            c = this._power,
                            d = 1 === b ? 1 - a : 2 === b ? a : 0.5 > a ? 2 * a : 2 * (1 - a);
                        return (
                            1 === c ? (d *= d) : 2 === c ? (d *= d * d) : 3 === c ? (d *= d * d * d) : 4 === c && (d *= d * d * d * d),
                            1 === b ? 1 - d : 2 === b ? d : 0.5 > a ? d / 2 : 1 - d / 2
                        );
                    },
                    f = ["Linear", "Quad", "Cubic", "Quart", "Quint,Strong"],
                    g = f.length;
                --g > -1;

            )
                (h = f[g] + ",Power" + g),
                    x(new v(null, null, 1, g), h, "easeOut", !0),
                    x(new v(null, null, 2, g), h, "easeIn" + (0 === g ? ",easeNone" : "")),
                    x(new v(null, null, 3, g), h, "easeInOut");
            (w.linear = l.easing.Linear.easeIn), (w.swing = l.easing.Quad.easeInOut);
            var y = t("events.EventDispatcher", function(a) {
                (this._listeners = {}), (this._eventTarget = a || this);
            });
            (h = y.prototype),
                (h.addEventListener = function(a, b, c, d, e) {
                    e = e || 0;
                    var f,
                        g,
                        h = this._listeners[a],
                        k = 0;
                    for (this !== i || j || i.wake(), null == h && (this._listeners[a] = h = []), g = h.length; --g > -1; )
                        (f = h[g]), f.c === b && f.s === c ? h.splice(g, 1) : 0 === k && f.pr < e && (k = g + 1);
                    h.splice(k, 0, { c: b, s: c, up: d, pr: e });
                }),
                (h.removeEventListener = function(a, b) {
                    var c,
                        d = this._listeners[a];
                    if (d) for (c = d.length; --c > -1; ) if (d[c].c === b) return void d.splice(c, 1);
                }),
                (h.dispatchEvent = function(a) {
                    var b,
                        c,
                        d,
                        e = this._listeners[a];
                    if (e)
                        for (b = e.length, b > 1 && (e = e.slice(0)), c = this._eventTarget; --b > -1; )
                            (d = e[b]), d && (d.up ? d.c.call(d.s || c, { type: a, target: c }) : d.c.call(d.s || c));
                });
            var z = a.requestAnimationFrame,
                A = a.cancelAnimationFrame,
                B =
                    Date.now ||
                    function() {
                        return new Date().getTime();
                    },
                C = B();
            for (f = ["ms", "moz", "webkit", "o"], g = f.length; --g > -1 && !z; )
                (z = a[f[g] + "RequestAnimationFrame"]), (A = a[f[g] + "CancelAnimationFrame"] || a[f[g] + "CancelRequestAnimationFrame"]);
            t("Ticker", function(a, b) {
                var c,
                    e,
                    f,
                    g,
                    h,
                    k = this,
                    l = B(),
                    n = b !== !1 && z ? "auto" : !1,
                    p = 500,
                    q = 33,
                    r = "tick",
                    s = function(a) {
                        var b,
                            d,
                            i = B() - C;
                        i > p && (l += i - q),
                            (C += i),
                            (k.time = (C - l) / 1e3),
                            (b = k.time - h),
                            (!c || b > 0 || a === !0) && (k.frame++, (h += b + (b >= g ? 0.004 : g - b)), (d = !0)),
                            a !== !0 && (f = e(s)),
                            d && k.dispatchEvent(r);
                    };
                y.call(k),
                    (k.time = k.frame = 0),
                    (k.tick = function() {
                        s(!0);
                    }),
                    (k.lagSmoothing = function(a, b) {
                        return arguments.length ? ((p = a || 1 / m), void (q = Math.min(b, p, 0))) : 1 / m > p;
                    }),
                    (k.sleep = function() {
                        null != f && (n && A ? A(f) : clearTimeout(f), (e = o), (f = null), k === i && (j = !1));
                    }),
                    (k.wake = function(a) {
                        null !== f ? k.sleep() : a ? (l += -C + (C = B())) : k.frame > 10 && (C = B() - p + 5),
                            (e =
                                0 === c
                                    ? o
                                    : n && z
                                    ? z
                                    : function(a) {
                                          return setTimeout(a, (1e3 * (h - k.time) + 1) | 0);
                                      }),
                            k === i && (j = !0),
                            s(2);
                    }),
                    (k.fps = function(a) {
                        return arguments.length ? ((c = a), (g = 1 / (c || 60)), (h = this.time + g), void k.wake()) : c;
                    }),
                    (k.useRAF = function(a) {
                        return arguments.length ? (k.sleep(), (n = a), void k.fps(c)) : n;
                    }),
                    k.fps(a),
                    setTimeout(function() {
                        "auto" === n && k.frame < 5 && "hidden" !== d.visibilityState && k.useRAF(!1);
                    }, 1500);
            }),
                (h = l.Ticker.prototype = new l.events.EventDispatcher()),
                (h.constructor = l.Ticker);
            var D = t("core.Animation", function(a, b) {
                if (
                    ((this.vars = b = b || {}),
                    (this._duration = this._totalDuration = a || 0),
                    (this._delay = Number(b.delay) || 0),
                    (this._timeScale = 1),
                    (this._active = b.immediateRender === !0),
                    (this.data = b.data),
                    (this._reversed = b.reversed === !0),
                    X)
                ) {
                    j || i.wake();
                    var c = this.vars.useFrames ? W : X;
                    c.add(this, c._time), this.vars.paused && this.paused(!0);
                }
            });
            (i = D.ticker = new l.Ticker()),
                (h = D.prototype),
                (h._dirty = h._gc = h._initted = h._paused = !1),
                (h._totalTime = h._time = 0),
                (h._rawPrevTime = -1),
                (h._next = h._last = h._onUpdate = h._timeline = h.timeline = null),
                (h._paused = !1);
            var E = function() {
                j && B() - C > 2e3 && ("hidden" !== d.visibilityState || !i.lagSmoothing()) && i.wake();
                var a = setTimeout(E, 2e3);
                a.unref && a.unref();
            };
            E(),
                (h.play = function(a, b) {
                    return null != a && this.seek(a, b), this.reversed(!1).paused(!1);
                }),
                (h.pause = function(a, b) {
                    return null != a && this.seek(a, b), this.paused(!0);
                }),
                (h.resume = function(a, b) {
                    return null != a && this.seek(a, b), this.paused(!1);
                }),
                (h.seek = function(a, b) {
                    return this.totalTime(Number(a), b !== !1);
                }),
                (h.restart = function(a, b) {
                    return this.reversed(!1)
                        .paused(!1)
                        .totalTime(a ? -this._delay : 0, b !== !1, !0);
                }),
                (h.reverse = function(a, b) {
                    return null != a && this.seek(a || this.totalDuration(), b), this.reversed(!0).paused(!1);
                }),
                (h.render = function(a, b, c) {}),
                (h.invalidate = function() {
                    return (this._time = this._totalTime = 0), (this._initted = this._gc = !1), (this._rawPrevTime = -1), (this._gc || !this.timeline) && this._enabled(!0), this;
                }),
                (h.isActive = function() {
                    var a,
                        b = this._timeline,
                        c = this._startTime;
                    return !b || (!this._gc && !this._paused && b.isActive() && (a = b.rawTime(!0)) >= c && a < c + this.totalDuration() / this._timeScale - 1e-7);
                }),
                (h._enabled = function(a, b) {
                    return (
                        j || i.wake(),
                        (this._gc = !a),
                        (this._active = this.isActive()),
                        b !== !0 && (a && !this.timeline ? this._timeline.add(this, this._startTime - this._delay) : !a && this.timeline && this._timeline._remove(this, !0)),
                        !1
                    );
                }),
                (h._kill = function(a, b) {
                    return this._enabled(!1, !1);
                }),
                (h.kill = function(a, b) {
                    return this._kill(a, b), this;
                }),
                (h._uncache = function(a) {
                    for (var b = a ? this : this.timeline; b; ) (b._dirty = !0), (b = b.timeline);
                    return this;
                }),
                (h._swapSelfInParams = function(a) {
                    for (var b = a.length, c = a.concat(); --b > -1; ) "{self}" === a[b] && (c[b] = this);
                    return c;
                }),
                (h._callback = function(a) {
                    var b = this.vars,
                        c = b[a],
                        d = b[a + "Params"],
                        e = b[a + "Scope"] || b.callbackScope || this,
                        f = d ? d.length : 0;
                    switch (f) {
                        case 0:
                            c.call(e);
                            break;
                        case 1:
                            c.call(e, d[0]);
                            break;
                        case 2:
                            c.call(e, d[0], d[1]);
                            break;
                        default:
                            c.apply(e, d);
                    }
                }),
                (h.eventCallback = function(a, b, c, d) {
                    if ("on" === (a || "").substr(0, 2)) {
                        var e = this.vars;
                        if (1 === arguments.length) return e[a];
                        null == b
                            ? delete e[a]
                            : ((e[a] = b), (e[a + "Params"] = p(c) && -1 !== c.join("").indexOf("{self}") ? this._swapSelfInParams(c) : c), (e[a + "Scope"] = d)),
                            "onUpdate" === a && (this._onUpdate = b);
                    }
                    return this;
                }),
                (h.delay = function(a) {
                    return arguments.length ? (this._timeline.smoothChildTiming && this.startTime(this._startTime + a - this._delay), (this._delay = a), this) : this._delay;
                }),
                (h.duration = function(a) {
                    return arguments.length
                        ? ((this._duration = this._totalDuration = a),
                          this._uncache(!0),
                          this._timeline.smoothChildTiming &&
                              this._time > 0 &&
                              this._time < this._duration &&
                              0 !== a &&
                              this.totalTime(this._totalTime * (a / this._duration), !0),
                          this)
                        : ((this._dirty = !1), this._duration);
                }),
                (h.totalDuration = function(a) {
                    return (this._dirty = !1), arguments.length ? this.duration(a) : this._totalDuration;
                }),
                (h.time = function(a, b) {
                    return arguments.length ? (this._dirty && this.totalDuration(), this.totalTime(a > this._duration ? this._duration : a, b)) : this._time;
                }),
                (h.totalTime = function(a, b, c) {
                    if ((j || i.wake(), !arguments.length)) return this._totalTime;
                    if (this._timeline) {
                        if ((0 > a && !c && (a += this.totalDuration()), this._timeline.smoothChildTiming)) {
                            this._dirty && this.totalDuration();
                            var d = this._totalDuration,
                                e = this._timeline;
                            if (
                                (a > d && !c && (a = d),
                                (this._startTime = (this._paused ? this._pauseTime : e._time) - (this._reversed ? d - a : a) / this._timeScale),
                                e._dirty || this._uncache(!1),
                                e._timeline)
                            )
                                for (; e._timeline; ) e._timeline._time !== (e._startTime + e._totalTime) / e._timeScale && e.totalTime(e._totalTime, !0), (e = e._timeline);
                        }
                        this._gc && this._enabled(!0, !1), (this._totalTime !== a || 0 === this._duration) && (J.length && Z(), this.render(a, b, !1), J.length && Z());
                    }
                    return this;
                }),
                (h.progress = h.totalProgress = function(a, b) {
                    var c = this.duration();
                    return arguments.length ? this.totalTime(c * a, b) : c ? this._time / c : this.ratio;
                }),
                (h.startTime = function(a) {
                    return arguments.length
                        ? (a !== this._startTime && ((this._startTime = a), this.timeline && this.timeline._sortChildren && this.timeline.add(this, a - this._delay)), this)
                        : this._startTime;
                }),
                (h.endTime = function(a) {
                    return this._startTime + (0 != a ? this.totalDuration() : this.duration()) / this._timeScale;
                }),
                (h.timeScale = function(a) {
                    if (!arguments.length) return this._timeScale;
                    var b, c;
                    for (
                        a = a || m,
                            this._timeline &&
                                this._timeline.smoothChildTiming &&
                                ((b = this._pauseTime), (c = b || 0 === b ? b : this._timeline.totalTime()), (this._startTime = c - ((c - this._startTime) * this._timeScale) / a)),
                            this._timeScale = a,
                            c = this.timeline;
                        c && c.timeline;

                    )
                        (c._dirty = !0), c.totalDuration(), (c = c.timeline);
                    return this;
                }),
                (h.reversed = function(a) {
                    return arguments.length
                        ? (a != this._reversed &&
                              ((this._reversed = a),
                              this.totalTime(this._timeline && !this._timeline.smoothChildTiming ? this.totalDuration() - this._totalTime : this._totalTime, !0)),
                          this)
                        : this._reversed;
                }),
                (h.paused = function(a) {
                    if (!arguments.length) return this._paused;
                    var b,
                        c,
                        d = this._timeline;
                    return (
                        a != this._paused &&
                            d &&
                            (j || a || i.wake(),
                            (b = d.rawTime()),
                            (c = b - this._pauseTime),
                            !a && d.smoothChildTiming && ((this._startTime += c), this._uncache(!1)),
                            (this._pauseTime = a ? b : null),
                            (this._paused = a),
                            (this._active = this.isActive()),
                            !a &&
                                0 !== c &&
                                this._initted &&
                                this.duration() &&
                                ((b = d.smoothChildTiming ? this._totalTime : (b - this._startTime) / this._timeScale), this.render(b, b === this._totalTime, !0))),
                        this._gc && !a && this._enabled(!0, !1),
                        this
                    );
                });
            var F = t("core.SimpleTimeline", function(a) {
                D.call(this, 0, a), (this.autoRemoveChildren = this.smoothChildTiming = !0);
            });
            (h = F.prototype = new D()),
                (h.constructor = F),
                (h.kill()._gc = !1),
                (h._first = h._last = h._recent = null),
                (h._sortChildren = !1),
                (h.add = h.insert = function(a, b, c, d) {
                    var e, f;
                    if (
                        ((a._startTime = Number(b || 0) + a._delay),
                        a._paused && this !== a._timeline && (a._pauseTime = a._startTime + (this.rawTime() - a._startTime) / a._timeScale),
                        a.timeline && a.timeline._remove(a, !0),
                        (a.timeline = a._timeline = this),
                        a._gc && a._enabled(!0, !0),
                        (e = this._last),
                        this._sortChildren)
                    )
                        for (f = a._startTime; e && e._startTime > f; ) e = e._prev;
                    return (
                        e ? ((a._next = e._next), (e._next = a)) : ((a._next = this._first), (this._first = a)),
                        a._next ? (a._next._prev = a) : (this._last = a),
                        (a._prev = e),
                        (this._recent = a),
                        this._timeline && this._uncache(!0),
                        this
                    );
                }),
                (h._remove = function(a, b) {
                    return (
                        a.timeline === this &&
                            (b || a._enabled(!1, !0),
                            a._prev ? (a._prev._next = a._next) : this._first === a && (this._first = a._next),
                            a._next ? (a._next._prev = a._prev) : this._last === a && (this._last = a._prev),
                            (a._next = a._prev = a.timeline = null),
                            a === this._recent && (this._recent = this._last),
                            this._timeline && this._uncache(!0)),
                        this
                    );
                }),
                (h.render = function(a, b, c) {
                    var d,
                        e = this._first;
                    for (this._totalTime = this._time = this._rawPrevTime = a; e; )
                        (d = e._next),
                            (e._active || (a >= e._startTime && !e._paused && !e._gc)) &&
                                (e._reversed
                                    ? e.render((e._dirty ? e.totalDuration() : e._totalDuration) - (a - e._startTime) * e._timeScale, b, c)
                                    : e.render((a - e._startTime) * e._timeScale, b, c)),
                            (e = d);
                }),
                (h.rawTime = function() {
                    return j || i.wake(), this._totalTime;
                });
            var G = t(
                    "TweenLite",
                    function(b, c, d) {
                        if ((D.call(this, c, d), (this.render = G.prototype.render), null == b)) throw "Cannot tween a null target.";
                        this.target = b = "string" != typeof b ? b : G.selector(b) || b;
                        var e,
                            f,
                            g,
                            h = b.jquery || (b.length && b !== a && b[0] && (b[0] === a || (b[0].nodeType && b[0].style && !b.nodeType))),
                            i = this.vars.overwrite;
                        if (
                            ((this._overwrite = i = null == i ? V[G.defaultOverwrite] : "number" == typeof i ? i >> 0 : V[i]),
                            (h || b instanceof Array || (b.push && p(b))) && "number" != typeof b[0])
                        )
                            for (this._targets = g = n(b), this._propLookup = [], this._siblings = [], e = 0; e < g.length; e++)
                                (f = g[e]),
                                    f
                                        ? "string" != typeof f
                                            ? f.length && f !== a && f[0] && (f[0] === a || (f[0].nodeType && f[0].style && !f.nodeType))
                                                ? (g.splice(e--, 1), (this._targets = g = g.concat(n(f))))
                                                : ((this._siblings[e] = $(f, this, !1)), 1 === i && this._siblings[e].length > 1 && aa(f, this, null, 1, this._siblings[e]))
                                            : ((f = g[e--] = G.selector(f)), "string" == typeof f && g.splice(e + 1, 1))
                                        : g.splice(e--, 1);
                        else (this._propLookup = {}), (this._siblings = $(b, this, !1)), 1 === i && this._siblings.length > 1 && aa(b, this, null, 1, this._siblings);
                        (this.vars.immediateRender || (0 === c && 0 === this._delay && this.vars.immediateRender !== !1)) &&
                            ((this._time = -m), this.render(Math.min(0, -this._delay)));
                    },
                    !0
                ),
                H = function(b) {
                    return b && b.length && b !== a && b[0] && (b[0] === a || (b[0].nodeType && b[0].style && !b.nodeType));
                },
                I = function(a, b) {
                    var c,
                        d = {};
                    for (c in a)
                        U[c] ||
                            (c in b && "transform" !== c && "x" !== c && "y" !== c && "width" !== c && "height" !== c && "className" !== c && "border" !== c) ||
                            !(!R[c] || (R[c] && R[c]._autoCSS)) ||
                            ((d[c] = a[c]), delete a[c]);
                    a.css = d;
                };
            (h = G.prototype = new D()),
                (h.constructor = G),
                (h.kill()._gc = !1),
                (h.ratio = 0),
                (h._firstPT = h._targets = h._overwrittenProps = h._startAt = null),
                (h._notifyPluginsOfEnabled = h._lazy = !1),
                (G.version = "1.20.3"),
                (G.defaultEase = h._ease = new v(null, null, 1, 1)),
                (G.defaultOverwrite = "auto"),
                (G.ticker = i),
                (G.autoSleep = 120),
                (G.lagSmoothing = function(a, b) {
                    i.lagSmoothing(a, b);
                }),
                (G.selector =
                    a.$ ||
                    a.jQuery ||
                    function(b) {
                        var c = a.$ || a.jQuery;
                        return c
                            ? ((G.selector = c), c(b))
                            : "undefined" == typeof d
                            ? b
                            : d.querySelectorAll
                            ? d.querySelectorAll(b)
                            : d.getElementById("#" === b.charAt(0) ? b.substr(1) : b);
                    });
            var J = [],
                K = {},
                L = /(?:(-|-=|\+=)?\d*\.?\d*(?:e[\-+]?\d+)?)[0-9]/gi,
                M = /[\+-]=-?[\.\d]/,
                N = function(a) {
                    for (var b, c = this._firstPT, d = 1e-6; c; )
                        (b = c.blob ? (1 === a && null != this.end ? this.end : a ? this.join("") : this.start) : c.c * a + c.s),
                            c.m ? (b = c.m(b, this._target || c.t)) : d > b && b > -d && !c.blob && (b = 0),
                            c.f ? (c.fp ? c.t[c.p](c.fp, b) : c.t[c.p](b)) : (c.t[c.p] = b),
                            (c = c._next);
                },
                O = function(a, b, c, d) {
                    var e,
                        f,
                        g,
                        h,
                        i,
                        j,
                        k,
                        l = [],
                        m = 0,
                        n = "",
                        o = 0;
                    for (
                        l.start = a,
                            l.end = b,
                            a = l[0] = a + "",
                            b = l[1] = b + "",
                            c && (c(l), (a = l[0]), (b = l[1])),
                            l.length = 0,
                            e = a.match(L) || [],
                            f = b.match(L) || [],
                            d && ((d._next = null), (d.blob = 1), (l._firstPT = l._applyPT = d)),
                            i = f.length,
                            h = 0;
                        i > h;
                        h++
                    )
                        (k = f[h]),
                            (j = b.substr(m, b.indexOf(k, m) - m)),
                            (n += j || !h ? j : ","),
                            (m += j.length),
                            o ? (o = (o + 1) % 5) : "rgba(" === j.substr(-5) && (o = 1),
                            k === e[h] || e.length <= h
                                ? (n += k)
                                : (n && (l.push(n), (n = "")),
                                  (g = parseFloat(e[h])),
                                  l.push(g),
                                  (l._firstPT = {
                                      _next: l._firstPT,
                                      t: l,
                                      p: l.length - 1,
                                      s: g,
                                      c: ("=" === k.charAt(1) ? parseInt(k.charAt(0) + "1", 10) * parseFloat(k.substr(2)) : parseFloat(k) - g) || 0,
                                      f: 0,
                                      m: o && 4 > o ? Math.round : 0
                                  })),
                            (m += k.length);
                    return (n += b.substr(m)), n && l.push(n), (l.setRatio = N), M.test(b) && (l.end = null), l;
                },
                P = function(a, b, c, d, e, f, g, h, i) {
                    "function" == typeof d && (d = d(i || 0, a));
                    var j,
                        k = typeof a[b],
                        l = "function" !== k ? "" : b.indexOf("set") || "function" != typeof a["get" + b.substr(3)] ? b : "get" + b.substr(3),
                        m = "get" !== c ? c : l ? (g ? a[l](g) : a[l]()) : a[b],
                        n = "string" == typeof d && "=" === d.charAt(1),
                        o = {
                            t: a,
                            p: b,
                            s: m,
                            f: "function" === k,
                            pg: 0,
                            n: e || b,
                            m: f ? ("function" == typeof f ? f : Math.round) : 0,
                            pr: 0,
                            c: n ? parseInt(d.charAt(0) + "1", 10) * parseFloat(d.substr(2)) : parseFloat(d) - m || 0
                        };
                    return (
                        ("number" != typeof m || ("number" != typeof d && !n)) &&
                            (g || isNaN(m) || (!n && isNaN(d)) || "boolean" == typeof m || "boolean" == typeof d
                                ? ((o.fp = g),
                                  (j = O(m, n ? parseFloat(o.s) + o.c : d, h || G.defaultStringFilter, o)),
                                  (o = { t: j, p: "setRatio", s: 0, c: 1, f: 2, pg: 0, n: e || b, pr: 0, m: 0 }))
                                : ((o.s = parseFloat(m)), n || (o.c = parseFloat(d) - o.s || 0))),
                        o.c ? ((o._next = this._firstPT) && (o._next._prev = o), (this._firstPT = o), o) : void 0
                    );
                },
                Q = (G._internals = { isArray: p, isSelector: H, lazyTweens: J, blobDif: O }),
                R = (G._plugins = {}),
                S = (Q.tweenLookup = {}),
                T = 0,
                U = (Q.reservedProps = {
                    ease: 1,
                    delay: 1,
                    overwrite: 1,
                    onComplete: 1,
                    onCompleteParams: 1,
                    onCompleteScope: 1,
                    useFrames: 1,
                    runBackwards: 1,
                    startAt: 1,
                    onUpdate: 1,
                    onUpdateParams: 1,
                    onUpdateScope: 1,
                    onStart: 1,
                    onStartParams: 1,
                    onStartScope: 1,
                    onReverseComplete: 1,
                    onReverseCompleteParams: 1,
                    onReverseCompleteScope: 1,
                    onRepeat: 1,
                    onRepeatParams: 1,
                    onRepeatScope: 1,
                    easeParams: 1,
                    yoyo: 1,
                    immediateRender: 1,
                    repeat: 1,
                    repeatDelay: 1,
                    data: 1,
                    paused: 1,
                    reversed: 1,
                    autoCSS: 1,
                    lazy: 1,
                    onOverwrite: 1,
                    callbackScope: 1,
                    stringFilter: 1,
                    id: 1,
                    yoyoEase: 1
                }),
                V = { none: 0, all: 1, auto: 2, concurrent: 3, allOnStart: 4, preexisting: 5, true: 1, false: 0 },
                W = (D._rootFramesTimeline = new F()),
                X = (D._rootTimeline = new F()),
                Y = 30,
                Z = (Q.lazyRender = function() {
                    var a,
                        b = J.length;
                    for (K = {}; --b > -1; ) (a = J[b]), a && a._lazy !== !1 && (a.render(a._lazy[0], a._lazy[1], !0), (a._lazy = !1));
                    J.length = 0;
                });
            (X._startTime = i.time),
                (W._startTime = i.frame),
                (X._active = W._active = !0),
                setTimeout(Z, 1),
                (D._updateRoot = G.render = function() {
                    var a, b, c;
                    if (
                        (J.length && Z(),
                        X.render((i.time - X._startTime) * X._timeScale, !1, !1),
                        W.render((i.frame - W._startTime) * W._timeScale, !1, !1),
                        J.length && Z(),
                        i.frame >= Y)
                    ) {
                        Y = i.frame + (parseInt(G.autoSleep, 10) || 120);
                        for (c in S) {
                            for (b = S[c].tweens, a = b.length; --a > -1; ) b[a]._gc && b.splice(a, 1);
                            0 === b.length && delete S[c];
                        }
                        if (((c = X._first), (!c || c._paused) && G.autoSleep && !W._first && 1 === i._listeners.tick.length)) {
                            for (; c && c._paused; ) c = c._next;
                            c || i.sleep();
                        }
                    }
                }),
                i.addEventListener("tick", D._updateRoot);
            var $ = function(a, b, c) {
                    var d,
                        e,
                        f = a._gsTweenID;
                    if ((S[f || (a._gsTweenID = f = "t" + T++)] || (S[f] = { target: a, tweens: [] }), b && ((d = S[f].tweens), (d[(e = d.length)] = b), c)))
                        for (; --e > -1; ) d[e] === b && d.splice(e, 1);
                    return S[f].tweens;
                },
                _ = function(a, b, c, d) {
                    var e,
                        f,
                        g = a.vars.onOverwrite;
                    return g && (e = g(a, b, c, d)), (g = G.onOverwrite), g && (f = g(a, b, c, d)), e !== !1 && f !== !1;
                },
                aa = function(a, b, c, d, e) {
                    var f, g, h, i;
                    if (1 === d || d >= 4) {
                        for (i = e.length, f = 0; i > f; f++)
                            if ((h = e[f]) !== b) h._gc || (h._kill(null, a, b) && (g = !0));
                            else if (5 === d) break;
                        return g;
                    }
                    var j,
                        k = b._startTime + m,
                        l = [],
                        n = 0,
                        o = 0 === b._duration;
                    for (f = e.length; --f > -1; )
                        (h = e[f]) === b ||
                            h._gc ||
                            h._paused ||
                            (h._timeline !== b._timeline
                                ? ((j = j || ba(b, 0, o)), 0 === ba(h, j, o) && (l[n++] = h))
                                : h._startTime <= k && h._startTime + h.totalDuration() / h._timeScale > k && (((o || !h._initted) && k - h._startTime <= 2e-10) || (l[n++] = h)));
                    for (f = n; --f > -1; )
                        if (((h = l[f]), 2 === d && h._kill(c, a, b) && (g = !0), 2 !== d || (!h._firstPT && h._initted))) {
                            if (2 !== d && !_(h, b)) continue;
                            h._enabled(!1, !1) && (g = !0);
                        }
                    return g;
                },
                ba = function(a, b, c) {
                    for (var d = a._timeline, e = d._timeScale, f = a._startTime; d._timeline; ) {
                        if (((f += d._startTime), (e *= d._timeScale), d._paused)) return -100;
                        d = d._timeline;
                    }
                    return (f /= e), f > b ? f - b : (c && f === b) || (!a._initted && 2 * m > f - b) ? m : (f += a.totalDuration() / a._timeScale / e) > b + m ? 0 : f - b - m;
                };
            (h._init = function() {
                var a,
                    b,
                    c,
                    d,
                    e,
                    f,
                    g = this.vars,
                    h = this._overwrittenProps,
                    i = this._duration,
                    j = !!g.immediateRender,
                    k = g.ease;
                if (g.startAt) {
                    this._startAt && (this._startAt.render(-1, !0), this._startAt.kill()), (e = {});
                    for (d in g.startAt) e[d] = g.startAt[d];
                    if (
                        ((e.data = "isStart"),
                        (e.overwrite = !1),
                        (e.immediateRender = !0),
                        (e.lazy = j && g.lazy !== !1),
                        (e.startAt = e.delay = null),
                        (e.onUpdate = g.onUpdate),
                        (e.onUpdateParams = g.onUpdateParams),
                        (e.onUpdateScope = g.onUpdateScope || g.callbackScope || this),
                        (this._startAt = G.to(this.target, 0, e)),
                        j)
                    )
                        if (this._time > 0) this._startAt = null;
                        else if (0 !== i) return;
                } else if (g.runBackwards && 0 !== i)
                    if (this._startAt) this._startAt.render(-1, !0), this._startAt.kill(), (this._startAt = null);
                    else {
                        0 !== this._time && (j = !1), (c = {});
                        for (d in g) (U[d] && "autoCSS" !== d) || (c[d] = g[d]);
                        if (((c.overwrite = 0), (c.data = "isFromStart"), (c.lazy = j && g.lazy !== !1), (c.immediateRender = j), (this._startAt = G.to(this.target, 0, c)), j)) {
                            if (0 === this._time) return;
                        } else this._startAt._init(), this._startAt._enabled(!1), this.vars.immediateRender && (this._startAt = null);
                    }
                if (
                    ((this._ease = k = k ? (k instanceof v ? k : "function" == typeof k ? new v(k, g.easeParams) : w[k] || G.defaultEase) : G.defaultEase),
                    g.easeParams instanceof Array && k.config && (this._ease = k.config.apply(k, g.easeParams)),
                    (this._easeType = this._ease._type),
                    (this._easePower = this._ease._power),
                    (this._firstPT = null),
                    this._targets)
                )
                    for (f = this._targets.length, a = 0; f > a; a++)
                        this._initProps(this._targets[a], (this._propLookup[a] = {}), this._siblings[a], h ? h[a] : null, a) && (b = !0);
                else b = this._initProps(this.target, this._propLookup, this._siblings, h, 0);
                if ((b && G._onPluginEvent("_onInitAllProps", this), h && (this._firstPT || ("function" != typeof this.target && this._enabled(!1, !1))), g.runBackwards))
                    for (c = this._firstPT; c; ) (c.s += c.c), (c.c = -c.c), (c = c._next);
                (this._onUpdate = g.onUpdate), (this._initted = !0);
            }),
                (h._initProps = function(b, c, d, e, f) {
                    var g, h, i, j, k, l;
                    if (null == b) return !1;
                    K[b._gsTweenID] && Z(), this.vars.css || (b.style && b !== a && b.nodeType && R.css && this.vars.autoCSS !== !1 && I(this.vars, b));
                    for (g in this.vars)
                        if (((l = this.vars[g]), U[g]))
                            l && (l instanceof Array || (l.push && p(l))) && -1 !== l.join("").indexOf("{self}") && (this.vars[g] = l = this._swapSelfInParams(l, this));
                        else if (R[g] && (j = new R[g]())._onInitTween(b, this.vars[g], this, f)) {
                            for (
                                this._firstPT = k = { _next: this._firstPT, t: j, p: "setRatio", s: 0, c: 1, f: 1, n: g, pg: 1, pr: j._priority, m: 0 },
                                    h = j._overwriteProps.length;
                                --h > -1;

                            )
                                c[j._overwriteProps[h]] = this._firstPT;
                            (j._priority || j._onInitAllProps) && (i = !0), (j._onDisable || j._onEnable) && (this._notifyPluginsOfEnabled = !0), k._next && (k._next._prev = k);
                        } else c[g] = P.call(this, b, g, "get", l, g, 0, null, this.vars.stringFilter, f);
                    return e && this._kill(e, b)
                        ? this._initProps(b, c, d, e, f)
                        : this._overwrite > 1 && this._firstPT && d.length > 1 && aa(b, this, c, this._overwrite, d)
                        ? (this._kill(c, b), this._initProps(b, c, d, e, f))
                        : (this._firstPT && ((this.vars.lazy !== !1 && this._duration) || (this.vars.lazy && !this._duration)) && (K[b._gsTweenID] = !0), i);
                }),
                (h.render = function(a, b, c) {
                    var d,
                        e,
                        f,
                        g,
                        h = this._time,
                        i = this._duration,
                        j = this._rawPrevTime;
                    if (a >= i - 1e-7 && a >= 0)
                        (this._totalTime = this._time = i),
                            (this.ratio = this._ease._calcEnd ? this._ease.getRatio(1) : 1),
                            this._reversed || ((d = !0), (e = "onComplete"), (c = c || this._timeline.autoRemoveChildren)),
                            0 === i &&
                                (this._initted || !this.vars.lazy || c) &&
                                (this._startTime === this._timeline._duration && (a = 0),
                                (0 > j || (0 >= a && a >= -1e-7) || (j === m && "isPause" !== this.data)) && j !== a && ((c = !0), j > m && (e = "onReverseComplete")),
                                (this._rawPrevTime = g = !b || a || j === a ? a : m));
                    else if (1e-7 > a)
                        (this._totalTime = this._time = 0),
                            (this.ratio = this._ease._calcEnd ? this._ease.getRatio(0) : 0),
                            (0 !== h || (0 === i && j > 0)) && ((e = "onReverseComplete"), (d = this._reversed)),
                            0 > a &&
                                ((this._active = !1),
                                0 === i &&
                                    (this._initted || !this.vars.lazy || c) &&
                                    (j >= 0 && (j !== m || "isPause" !== this.data) && (c = !0), (this._rawPrevTime = g = !b || a || j === a ? a : m))),
                            (!this._initted || (this._startAt && this._startAt.progress())) && (c = !0);
                    else if (((this._totalTime = this._time = a), this._easeType)) {
                        var k = a / i,
                            l = this._easeType,
                            n = this._easePower;
                        (1 === l || (3 === l && k >= 0.5)) && (k = 1 - k),
                            3 === l && (k *= 2),
                            1 === n ? (k *= k) : 2 === n ? (k *= k * k) : 3 === n ? (k *= k * k * k) : 4 === n && (k *= k * k * k * k),
                            1 === l ? (this.ratio = 1 - k) : 2 === l ? (this.ratio = k) : 0.5 > a / i ? (this.ratio = k / 2) : (this.ratio = 1 - k / 2);
                    } else this.ratio = this._ease.getRatio(a / i);
                    if (this._time !== h || c) {
                        if (!this._initted) {
                            if ((this._init(), !this._initted || this._gc)) return;
                            if (!c && this._firstPT && ((this.vars.lazy !== !1 && this._duration) || (this.vars.lazy && !this._duration)))
                                return (this._time = this._totalTime = h), (this._rawPrevTime = j), J.push(this), void (this._lazy = [a, b]);
                            this._time && !d
                                ? (this.ratio = this._ease.getRatio(this._time / i))
                                : d && this._ease._calcEnd && (this.ratio = this._ease.getRatio(0 === this._time ? 0 : 1));
                        }
                        for (
                            this._lazy !== !1 && (this._lazy = !1),
                                this._active || (!this._paused && this._time !== h && a >= 0 && (this._active = !0)),
                                0 === h &&
                                    (this._startAt && (a >= 0 ? this._startAt.render(a, !0, c) : e || (e = "_dummyGS")),
                                    this.vars.onStart && (0 !== this._time || 0 === i) && (b || this._callback("onStart"))),
                                f = this._firstPT;
                            f;

                        )
                            f.f ? f.t[f.p](f.c * this.ratio + f.s) : (f.t[f.p] = f.c * this.ratio + f.s), (f = f._next);
                        this._onUpdate &&
                            (0 > a && this._startAt && a !== -1e-4 && this._startAt.render(a, !0, c), b || ((this._time !== h || d || c) && this._callback("onUpdate"))),
                            e &&
                                (!this._gc || c) &&
                                (0 > a && this._startAt && !this._onUpdate && a !== -1e-4 && this._startAt.render(a, !0, c),
                                d && (this._timeline.autoRemoveChildren && this._enabled(!1, !1), (this._active = !1)),
                                !b && this.vars[e] && this._callback(e),
                                0 === i && this._rawPrevTime === m && g !== m && (this._rawPrevTime = 0));
                    }
                }),
                (h._kill = function(a, b, c) {
                    if (("all" === a && (a = null), null == a && (null == b || b === this.target))) return (this._lazy = !1), this._enabled(!1, !1);
                    b = "string" != typeof b ? b || this._targets || this.target : G.selector(b) || b;
                    var d,
                        e,
                        f,
                        g,
                        h,
                        i,
                        j,
                        k,
                        l,
                        m = c && this._time && c._startTime === this._startTime && this._timeline === c._timeline;
                    if ((p(b) || H(b)) && "number" != typeof b[0]) for (d = b.length; --d > -1; ) this._kill(a, b[d], c) && (i = !0);
                    else {
                        if (this._targets) {
                            for (d = this._targets.length; --d > -1; )
                                if (b === this._targets[d]) {
                                    (h = this._propLookup[d] || {}),
                                        (this._overwrittenProps = this._overwrittenProps || []),
                                        (e = this._overwrittenProps[d] = a ? this._overwrittenProps[d] || {} : "all");
                                    break;
                                }
                        } else {
                            if (b !== this.target) return !1;
                            (h = this._propLookup), (e = this._overwrittenProps = a ? this._overwrittenProps || {} : "all");
                        }
                        if (h) {
                            if (((j = a || h), (k = a !== e && "all" !== e && a !== h && ("object" != typeof a || !a._tempKill)), c && (G.onOverwrite || this.vars.onOverwrite))) {
                                for (f in j) h[f] && (l || (l = []), l.push(f));
                                if ((l || !a) && !_(this, c, b, l)) return !1;
                            }
                            for (f in j)
                                (g = h[f]) &&
                                    (m && (g.f ? g.t[g.p](g.s) : (g.t[g.p] = g.s), (i = !0)),
                                    g.pg && g.t._kill(j) && (i = !0),
                                    (g.pg && 0 !== g.t._overwriteProps.length) ||
                                        (g._prev ? (g._prev._next = g._next) : g === this._firstPT && (this._firstPT = g._next),
                                        g._next && (g._next._prev = g._prev),
                                        (g._next = g._prev = null)),
                                    delete h[f]),
                                    k && (e[f] = 1);
                            !this._firstPT && this._initted && this._enabled(!1, !1);
                        }
                    }
                    return i;
                }),
                (h.invalidate = function() {
                    return (
                        this._notifyPluginsOfEnabled && G._onPluginEvent("_onDisable", this),
                        (this._firstPT = this._overwrittenProps = this._startAt = this._onUpdate = null),
                        (this._notifyPluginsOfEnabled = this._active = this._lazy = !1),
                        (this._propLookup = this._targets ? {} : []),
                        D.prototype.invalidate.call(this),
                        this.vars.immediateRender && ((this._time = -m), this.render(Math.min(0, -this._delay))),
                        this
                    );
                }),
                (h._enabled = function(a, b) {
                    if ((j || i.wake(), a && this._gc)) {
                        var c,
                            d = this._targets;
                        if (d) for (c = d.length; --c > -1; ) this._siblings[c] = $(d[c], this, !0);
                        else this._siblings = $(this.target, this, !0);
                    }
                    return D.prototype._enabled.call(this, a, b), this._notifyPluginsOfEnabled && this._firstPT ? G._onPluginEvent(a ? "_onEnable" : "_onDisable", this) : !1;
                }),
                (G.to = function(a, b, c) {
                    return new G(a, b, c);
                }),
                (G.from = function(a, b, c) {
                    return (c.runBackwards = !0), (c.immediateRender = 0 != c.immediateRender), new G(a, b, c);
                }),
                (G.fromTo = function(a, b, c, d) {
                    return (d.startAt = c), (d.immediateRender = 0 != d.immediateRender && 0 != c.immediateRender), new G(a, b, d);
                }),
                (G.delayedCall = function(a, b, c, d, e) {
                    return new G(b, 0, {
                        delay: a,
                        onComplete: b,
                        onCompleteParams: c,
                        callbackScope: d,
                        onReverseComplete: b,
                        onReverseCompleteParams: c,
                        immediateRender: !1,
                        lazy: !1,
                        useFrames: e,
                        overwrite: 0
                    });
                }),
                (G.set = function(a, b) {
                    return new G(a, 0, b);
                }),
                (G.getTweensOf = function(a, b) {
                    if (null == a) return [];
                    a = "string" != typeof a ? a : G.selector(a) || a;
                    var c, d, e, f;
                    if ((p(a) || H(a)) && "number" != typeof a[0]) {
                        for (c = a.length, d = []; --c > -1; ) d = d.concat(G.getTweensOf(a[c], b));
                        for (c = d.length; --c > -1; ) for (f = d[c], e = c; --e > -1; ) f === d[e] && d.splice(c, 1);
                    } else if (a._gsTweenID) for (d = $(a).concat(), c = d.length; --c > -1; ) (d[c]._gc || (b && !d[c].isActive())) && d.splice(c, 1);
                    return d || [];
                }),
                (G.killTweensOf = G.killDelayedCallsTo = function(a, b, c) {
                    "object" == typeof b && ((c = b), (b = !1));
                    for (var d = G.getTweensOf(a, b), e = d.length; --e > -1; ) d[e]._kill(c, a);
                });
            var ca = t(
                "plugins.TweenPlugin",
                function(a, b) {
                    (this._overwriteProps = (a || "").split(",")), (this._propName = this._overwriteProps[0]), (this._priority = b || 0), (this._super = ca.prototype);
                },
                !0
            );
            if (
                ((h = ca.prototype),
                (ca.version = "1.19.0"),
                (ca.API = 2),
                (h._firstPT = null),
                (h._addTween = P),
                (h.setRatio = N),
                (h._kill = function(a) {
                    var b,
                        c = this._overwriteProps,
                        d = this._firstPT;
                    if (null != a[this._propName]) this._overwriteProps = [];
                    else for (b = c.length; --b > -1; ) null != a[c[b]] && c.splice(b, 1);
                    for (; d; )
                        null != a[d.n] &&
                            (d._next && (d._next._prev = d._prev), d._prev ? ((d._prev._next = d._next), (d._prev = null)) : this._firstPT === d && (this._firstPT = d._next)),
                            (d = d._next);
                    return !1;
                }),
                (h._mod = h._roundProps = function(a) {
                    for (var b, c = this._firstPT; c; )
                        (b = a[this._propName] || (null != c.n && a[c.n.split(this._propName + "_").join("")])),
                            b && "function" == typeof b && (2 === c.f ? (c.t._applyPT.m = b) : (c.m = b)),
                            (c = c._next);
                }),
                (G._onPluginEvent = function(a, b) {
                    var c,
                        d,
                        e,
                        f,
                        g,
                        h = b._firstPT;
                    if ("_onInitAllProps" === a) {
                        for (; h; ) {
                            for (g = h._next, d = e; d && d.pr > h.pr; ) d = d._next;
                            (h._prev = d ? d._prev : f) ? (h._prev._next = h) : (e = h), (h._next = d) ? (d._prev = h) : (f = h), (h = g);
                        }
                        h = b._firstPT = e;
                    }
                    for (; h; ) h.pg && "function" == typeof h.t[a] && h.t[a]() && (c = !0), (h = h._next);
                    return c;
                }),
                (ca.activate = function(a) {
                    for (var b = a.length; --b > -1; ) a[b].API === ca.API && (R[new a[b]()._propName] = a[b]);
                    return !0;
                }),
                (s.plugin = function(a) {
                    if (!(a && a.propName && a.init && a.API)) throw "illegal plugin definition.";
                    var b,
                        c = a.propName,
                        d = a.priority || 0,
                        e = a.overwriteProps,
                        f = { init: "_onInitTween", set: "setRatio", kill: "_kill", round: "_mod", mod: "_mod", initAll: "_onInitAllProps" },
                        g = t(
                            "plugins." + c.charAt(0).toUpperCase() + c.substr(1) + "Plugin",
                            function() {
                                ca.call(this, c, d), (this._overwriteProps = e || []);
                            },
                            a.global === !0
                        ),
                        h = (g.prototype = new ca(c));
                    (h.constructor = g), (g.API = a.API);
                    for (b in f) "function" == typeof a[b] && (h[f[b]] = a[b]);
                    return (g.version = a.version), ca.activate([g]), g;
                }),
                (f = a._gsQueue))
            ) {
                for (g = 0; g < f.length; g++) f[g]();
                for (h in q) q[h].func || a.console.log("GSAP encountered missing dependency: " + h);
            }
            j = !1;
        }
    })("undefined" != typeof module && module.exports && "undefined" != typeof global ? global : this || window, "TweenMax");
wwplayer.define(
    "TweenMax",
    ["TimelineMax"],
    (function(global) {
        return function() {
            var ret, fn;
            return ret || global.TweenMax;
        };
    })(this)
);

wwplayer.define(
    "DefaultToolkit",
    [
        "jquery",
        "Class",
        "underscore",
        "raphael",
        "iscroll",
        "pubsub",
        "globals",
        "apiService",
        "LogEvent",
        "WebFontLoader",
        "Loader",
        "crumpetAudioController",
        "crumpetFrameImageController",
        "crumpetVideoController",
        "iphone-inline-video",
        "videoInVideoPlayer",
        "TweenMax"
    ],
    function(
        $,
        Class,
        _,
        Raphael,
        iScroll,
        PubSub,
        globals,
        apiService,
        LogEvent,
        WebFontLoader,
        Loader,
        AudioController,
        FrameImageController,
        VideoController,
        makeVideoPlayableInline,
        VideoInVideoPlayer,
        TweenMax
    ) {
        var self;
        /**
         * @author legacy developers
         * @module DefaultToolkit
         * @requires jquery, Class, underscore, raphael, iscroll, pubsub, globals, apiService, LogEvent, WebFontLoader, Loader, crumpetAudioController, crumpetFrameImageController, crumpetVideoController, iphone-inline-video, videoInVideoPlayer
         **/

        /**
         * Helper method to generate a carousel
         * @author legacy developers
         * @method makeCarousel
         * @private
         * @param {HTMLElement} elem the Jquery element container for the carousel
         * @param {Object[]} slides array of slide objects for the carousel
         * @param {string} slides[].image (optional) the image url
         * @param {HTMLElement} slides[].element (optional) the element
         * @param {Boolean} nipples show / hide click tp slide nipples
         * @param {Array} nippleElements elements to bind events to
         * @param {Boolean} arrows show / hide next / prev arrows
         * @param {Number} startX start the carousel at a specific x offset
         * @param {Number} startPage start the carousel at a specific page
         * @return {Function} the function to call when destroying the carousel
         **/
        var makeCarousel = function(elem, slides, nipples, nippleElements, arrows, startX, startPage) {
            var slideWidth = elem.width();
            var carouselElement = elem.find(".wirewax-carousel");
            carouselElement.css("width", slides.length * 100 + "%").css("height", "100%");
            var i = 0;
            _.each(slides, function(slide) {
                var slideElement = $('<li style="width:' + 100 / slides.length + "%; height: 100%; position: absolute; left: " + slideWidth * i + 'px;"></li>');
                if (slide.image) {
                    self.waxImage(slideElement, slide.image, true, false, null, false);
                } else if (slide.element) {
                    slideElement.append(slide.element);
                }
                carouselElement.append(slideElement);
                i++;
            });
            var options = {
                snap: "li",
                hScrollbar: false,
                vScrollbar: false,
                vScroll: false,
                onScrollEnd: function() {
                    if (nipples) {
                        $(".nipples .nipple.selected").toggleClass("selected unselected");
                        $(".nipples .nipple:nth-child(" + (slideScroll.currPageX + 1) + ")").toggleClass("selected unselected");
                    }
                    if (arrows) {
                        if (slideScroll.currPageX + 1 === slides.length) {
                            $(".right-arrow").hide();
                            $(".left-arrow").show();
                        } else if (slideScroll.currPageX === 0 && slides.length > 0) {
                            $(".right-arrow").show();
                            $(".left-arrow").hide();
                        } else {
                            $(".right-arrow").show();
                            $(".left-arrow").show();
                        }
                    }
                }
            };
            if (startX) {
                options.x = startX;
            }
            var slideScroll = new iScroll(elem[0], options);
            if (startPage) {
                slideScroll.currPageX = startPage;
            }

            if (nipples) {
                var i = 0;
                nippleElements.forEach(function(nipple) {
                    nipple.bind("click", { page: i }, function(event) {
                        $(".nipples .nipple.selected").toggleClass("selected unselected");
                        $(this).toggleClass("selected unselected");
                        slideScroll.scrollToPage(event.data.page, 0, 300);
                    });

                    i++;
                });
            }

            if (arrows) {
                var leftArrow = $('<div class="left-arrow"></div>');
                var rightArrow = $('<div class="right-arrow"></div>');

                leftArrow.bind("click", function() {
                    if (slideScroll.currPageX > 0) {
                        $(".nipples .nipple.selected").toggleClass("selected unselected");
                        $(".nipples .nipple:nth-child(" + (slideScroll.currPageX - 1) + ")").toggleClass("selected unselected");
                        slideScroll.scrollToPage(slideScroll.currPageX - 1, 0, 300);
                    }
                });

                rightArrow.bind("click", function() {
                    if (slideScroll.currPageX < slides.length) {
                        $(".nipples .nipple.selected").toggleClass("selected unselected");
                        $(".nipples .nipple:nth-child(" + (slideScroll.currPageX + 1) + ")").toggleClass("selected unselected");
                        slideScroll.scrollToPage(slideScroll.currPageX + 1, 0, 300);
                    }
                });

                elem.parent().append(leftArrow);
                elem.parent().append(rightArrow);
                if (startPage + 1 === slides.length) {
                    $(".right-arrow").hide();
                    $(".left-arrow").show();
                } else if (startPage === 0 && slides.length > 0) {
                    $(".right-arrow").show();
                    $(".left-arrow").hide();
                } else {
                    $(".right-arrow").show();
                    $(".left-arrow").show();
                }
            }

            var closeCallback = function() {
                slideScroll.destroy();
                slideScroll = null;
            };

            return closeCallback;
        };

        var Toolkit = Class.extend(
            /** @lends Toolkit.prototype */ {
                /**
                 * @author legacy developers
                 * @description The toolkit has several functions to help you build the tag/overlay.
                 * @constructs Toolkit
                 * @extends Class
                 **/
                init: function() {
                    self = this;
                    this.resourceUrl = "https://d2zqckv5bq8ab.cloudfront.net/resourceData";

                    this.MAX_FONT_RETRY_COUNT = 2;
                    this._fontObjectList = [];
                    this._fontNameList = [];
                },
                /**
                 * @author legacy developers
                 * @description Validates emails
                 * @param {String} email the email that is going to be validated
                 * @example <caption>Check if email is valid.</caption>
                 * self.toolkit.validateEmail(emailInput.val());
                 * @returns {Boolean} Returns the check result
                 **/
                validateEmail: function(email) {
                    return /[^\s@]+@[^\s@]+\.[^\s@]+/.test(email);
                },
                /**
                 * @author legacy developers
                 * @description Draws an animated path in raphael
                 * @param {HTMLElement} canvas the raphael canvas where the path is going to be added
                 * @param {String} pathstr the path that is going to be added
                 * @param {Number} duration the duration of the animation
                 * @param {Object} attr the attributes of the path
                 * @param {Function} callback the callback when the animation ends
                 * @returns {Object} path the path object that was created
                 * @example <caption>(100208.js)drawCircleAroundElement()</caption>
                 * var rsr = Raphael($(element)[0], '100%', '100%');
                 * rsr.setViewBox(0, 0, 664.1, 664.1, false);
                 * tag.toolkit.drawPath(rsr, "M663.1,332.1c0,182.8-148.2,331.1-331.1,331.1S1,514.9,1,332.1S149.2,1,332.1,1S663.1,149.2,663.1,332.1 z", 800, {fill: 'none', 'fill-opacity': 0, stroke: '#00d8ff',"stroke-width": '10px',"stroke-miterlimit": '10','stroke-opacity': '1'}, function(){});
                 **/
                drawPath: function(canvas, pathstr, duration, attr, callback) {
                    var guide_path = canvas.path(pathstr).attr({ stroke: "none", fill: "none" });
                    var path = canvas.path(guide_path.getSubpath(0, 1)).attr(attr);
                    var total_length = guide_path.getTotalLength(guide_path);
                    var last_point = guide_path.getPointAtLength(0);
                    var start_time = new Date().getTime();
                    var interval_length = 1;

                    if (!globals.IS_DESKTOP) {
                        interval_length = 100;
                    }

                    var result = path;
                    var interval_id = setInterval(function() {
                        var elapsed_time = new Date().getTime() - start_time;
                        var this_length = (elapsed_time / duration) * total_length;
                        var subpathstr = guide_path.getSubpath(0, this_length);
                        attr.path = subpathstr;
                        path.animate(attr, interval_length);
                        if (elapsed_time >= duration) {
                            clearInterval(interval_id);
                            if (callback != undefined) callback();
                            guide_path.remove();
                        }
                    }, interval_length);

                    return result;
                },
                /**
                 * @author legacy developers
                 * @description Draws an animated path in raphael (inverted)
                 * @param {HTMLElement} canvas the raphael canvas where the path is going to be added
                 * @param {String} pathstr the path that is going to be added
                 * @param {Number} duration the duration of the animation
                 * @param {Object} startAttr the start attributes of the path
                 * @param {Object} attr the attributes of the path
                 * @param {Function} callback the callback when the animation ends
                 * @returns {Object} path the path object that was created
                 * @example <caption>(100208.js)drawCounterCircleAroundElement()</caption>
                 * var rsr = Raphael($(element)[0], '100%', '100%');
                 * rsr.setViewBox(0, 0, 664.1, 664.1, false);
                 * tag.toolkit.drawPathOut(rsr, "M663.1,332.1c0,182.8-148.2,331.1-331.1,331.1S1,514.9,1,332.1S149.2,1,332.1,1S663.1,149.2,663.1,332.1 z", 800, {fill: 'none', 'fill-opacity': 0, stroke: '#00d8ff',"stroke-width": '10px',"stroke-miterlimit": '10','stroke-opacity': '1'}, {fill: 'none', 'fill-opacity': 0, stroke: '#00d8ff',"stroke-width": '10px',"stroke-miterlimit": '10','stroke-opacity': '1'}, function(){});
                 **/
                drawPathOut: function(canvas, pathstr, duration, startAttr, attr, callback) {
                    var guide_path = canvas.path(pathstr).attr({ stroke: "none", fill: "none" });
                    var total_length = guide_path.getTotalLength(guide_path);
                    var path = canvas.path(guide_path.getSubpath(0, total_length)).attr(startAttr);
                    var last_point = guide_path.getPointAtLength(0);
                    var start_time = new Date().getTime();
                    var interval_length = 1;
                    var result = path;
                    var interval_id = setInterval(function() {
                        var elapsed_time = new Date().getTime() - start_time;
                        var this_length = (elapsed_time / duration) * total_length;
                        var remainder_length = total_length - this_length;
                        var subpathstr = guide_path.getSubpath(0, remainder_length);
                        attr.path = subpathstr;
                        path.animate(attr, interval_length);
                        if (elapsed_time >= duration) {
                            clearInterval(interval_id);
                            if (callback != undefined) callback();
                            guide_path.remove();
                        }
                    }, interval_length);

                    return result;
                },
                /**
                 * @description Converts a time string to seconds
                 * @param {String} hrsMinSecString time(hours:minutes:seconds:frames) Ex: 00:12:23:10
                 * @param {Number} invFps invert frames per seconds ( how much time each frame has / seconds per frame )
                 * @returns {Number} returns the time in seconds
                 * @example <caption>(100348.js)</caption>
                 * var jumptime = "00:12:23:10";
                 * var jumpTimeInSeconds = tag.toolkit.convertToSeconds(jumptime, tag.invFps);
                 **/
                convertToSeconds: function(hrsMinSecString, invFps) {
                    var splitDuration = hrsMinSecString.split(":"),
                        durationInSeconds = parseInt(splitDuration[0], 10) * 3600 + parseInt(splitDuration[1], 10) * 60 + parseInt(splitDuration[2], 10);
                    durationInSeconds += parseInt(splitDuration[3]) * invFps;
                    return durationInSeconds;
                },

                /**
                 * @author legacy developers
                 * @description Converts a time string to frames
                 * @param {String} hrsMinSecString time(hours:minutes:seconds:frames) Ex: 00:12:23:10
                 * @param {fps} fps frames per seconds
                 * @returns {Number} returns the time in seconds
                 * @example <caption>(32997.js)</caption>
                 * var jumptime = "00:12:23:10";
                 * var jumpTimeInFrames = self.toolkit.convertToFrames(jumptime, self.videoData.metaData.fps);
                 **/
                convertToFrames: function(hrsMinSecString, fps) {
                    var splitDuration = hrsMinSecString.split(":");
                    var durationInSeconds = parseInt(splitDuration[0], 10) * 3600 + parseInt(splitDuration[1], 10) * 60 + parseInt(splitDuration[2], 10);
                    return durationInSeconds * fps + parseInt(splitDuration[3]);
                },
                /**
                 * @author legacy developers
                 * @description Wraps an image to provide a loading animation / etc
                 * @param {HTMLElement} element the containing element
                 * @param {String} imageUrl the url of the image
                 * @param {Boolean} contain sets background-size value to contain
                 * @param {Boolean} neither sets background-size value to auto
                 * @param {Function} callback callback to be called onLoad and onError
                 * @param {Boolean} darkMode set dark loading image
                 * @example <caption>(100195.js)</caption>
                 * tag.toolkit.waxImage($(tag.element).find('.thumbnail')[0], data[0].littleimage, true, false, null, true);
                 **/
                waxImage: function(element, imageUrl, contain, neither, callback, darkMode) {
                    //FIXME: mode contain / neither / etc t- args
                    var elem = $(element);

                    elem.css("overflow", "hidden");
                    if (elem.css("position") !== "absolute" || elem.css("position") !== "relative") {
                        elem.css("position", "relative");
                    }

                    elem.append('<img class="image-loading" />');

                    var loader = new Loader(elem.find(".image-loading"));
                    loader.placeLoader(darkMode);
                    loader.show();
                    var tmpImg = new Image();
                    var loadTimeStart = new Date().getTime();
                    tmpImg.onload = function() {
                        PubSub.publish(globals.LOAD_METRIC, {
                            type: 4,
                            urls: [imageUrl],
                            loadTime: new Date().getTime() - loadTimeStart
                        });

                        loader.hide();
                        elem.find(".general-loader-img").remove();
                        $(this).remove();

                        elem.css("background", "url(" + imageUrl + ") no-repeat center");

                        if (contain) {
                            elem.css("background-size", "contain");
                        } else if (neither) {
                            elem.css("background-size", "auto");
                        } else {
                            elem.css("background-size", "cover");
                        }

                        if (callback) {
                            callback();
                        }
                    };
                    tmpImg.onerror = function() {
                        elem.find(".image-loading").remove();

                        if (callback) {
                            callback();
                        }
                    };

                    tmpImg.src = imageUrl;
                },
                /**
                 * @author legacy developers
                 * @description Wraps an image to provide a loading animation / etc
                 * @param {HTMLElement} element the containing element
                 * @param {String} imageUrl the url of the image
                 * @param {Function} callback callback to be called onLoad and onError
                 * @param {Boolean} darkMode set dark loading image
                 * @example <caption>(1187.js)</caption>
                 * self.toolkit.waxImageWithImgTag(elem.find('img'), imgObj.imageurl, function(){ elem.addClass('show'); }, true);
                 **/
                waxImageWithImgTag: function(element, imageUrl, callback, darkMode) {
                    //FIXME: mode contain / neither / etc t- args
                    var elem = $(element);
                    elem.css("overflow", "hidden");
                    if (elem.css("position") !== "absolute" || elem.css("position") !== "relative") {
                        elem.css("position", "relative");
                    }

                    if (elem.height() > 40 || elem.width > 40) {
                        elem.append('<img class="image-loading" />');
                    }
                    var loader = new Loader(elem.find(".image-loading"));
                    loader.placeLoader(darkMode);
                    loader.show();
                    var tmpImg = new Image();
                    var loadTimeStart = new Date().getTime();
                    tmpImg.onload = function() {
                        PubSub.publish(globals.LOAD_METRIC, {
                            type: 4,
                            urls: [imageUrl],
                            loadTime: new Date().getTime() - loadTimeStart
                        });
                        loader.hide();
                        elem.find(".general-loader-img").remove();
                        $(this).remove();
                        elem.attr("src", imageUrl);

                        if (callback) {
                            callback();
                        }
                    };
                    tmpImg.onerror = function() {
                        elem.find(".image-loading").remove();

                        if (callback) {
                            callback();
                        }
                    };

                    tmpImg.src = imageUrl;
                },
                /**
                 * @author legacy developers
                 * @description Generates a carousel
                 * @param {HTMLElement} element the containing element
                 * @param {Object[]} slides array of slide objects for the carousel
                 * @param {string} slides.image (optional) the image url
                 * @param {HTMLElement} slides.element (optional) the element
                 * @param {Boolean} nipples show / hide slide nipples
                 * @param {Boolean} arrows show / hide next / prev arrows
                 * @param {Function} callback callback
                 * @param {Number} skipToPage the page to skip to
                 * @example <caption>(1276.js)</caption>
                 * self.toolkit.waxCarousel(self.subContentContainer.find('.carousel-big')[0], slides, undefined, true, function (killCarousel) {}, 0);
                 **/
                waxCarousel: function(element, slides, nipples, arrows, callback, skipToPage) {
                    var elem = $(element);
                    var nippleElements = [];
                    elem.append('<ul class="wirewax-carousel clearfix"></ul>').css("overflow", "hidden");
                    if (nipples) {
                        var nippleContainer = $('<ul class="nipples"></ul>');
                        for (var i = 0; i < slides.length; i++) {
                            var nipple = $('<li class="nipple"></li>');
                            nippleElements.push(nipple);
                            if (i === 0) {
                                nipple.addClass("selected");
                            } else {
                                nipple.addClass("unselected");
                            }
                            nippleContainer.append(nipple);
                        }

                        elem.parent().append(nippleContainer);
                    }
                    var timer = window.setInterval(function() {
                        if (elem.width() === elem[0].clientWidth && elem.width() > 0) {
                            window.clearInterval(timer);
                            var startX = -1 * skipToPage * elem.width();
                            var destroyCallback = makeCarousel(elem, slides, nipples, nippleElements, arrows, startX, skipToPage);
                            if (callback) {
                                callback(destroyCallback);
                            }
                        }
                    }, 50);
                },
                /**
                 * @author legacy developers
                 * @description Generates an ImagePicker carousel
                 * @param {HTMLElement} element the containing element
                 * @param {Object[]} slides array of slide objects for the carousel
                 * @param {String} slides.image the image url
                 * @param {String} slides.description (optional) the image description
                 * @param {Function} slides.click (optional) the image onClick function
                 * @param {Function} done callback to call on destroy
                 * @param {HTMLElement} leftArrow the element for the left arrow
                 * @param {HTMLElement} rightArrow the element for the right arrow
                 * @param {Object} configs extra config options
                 * @param {Boolean} configs.alignRight align to the right
                 * @param {Boolean} configs.hasImageDescription show / hide image description
                 * @example <caption>(1276.js)</caption>
                 *  self.toolkit.imagePicker(carousel[0], slides, function (destroyFunc) { ... }, leftArrow, rightArrow, {alignRight: true, hasImageDescription:true});
                 **/
                imagePicker: function(element, slides, done, leftArrow, rightArrow, configs) {
                    var jElement = $(element);

                    var slideLock = false;
                    var sliding = false;

                    jElement.bind("touchstart mousedown", function() {
                        slideLock = true;
                    });

                    jElement.bind("touchmove mousemove", function() {
                        if (slideLock && !sliding) {
                            sliding = true;
                        }
                    });

                    jElement.bind("touchend mouseup", function() {
                        setTimeout(function() {
                            sliding = false;
                            slideLock = false;
                        }, 100);
                    });

                    var alignRight = configs && configs.alignRight ? true : false;
                    var pickerWidth = jElement.width();
                    var slideHeight = jElement.height();
                    var slideWidth = (jElement.height() * 96) / 68;
                    var slideMargin = slideWidth * 0.05;
                    var i = 0;
                    var slider = $('<div class="slider"></div>');
                    slider.css({
                        width: slides.length * (Math.ceil(slideWidth) + Math.ceil(slideMargin) + 2),
                        height: "100%"
                    });
                    jElement.append(slider);

                    _.each(slides, function(slide) {
                        var image = $('<div class="slideImage"></div>');

                        if (configs && configs.hasImageDescription) {
                            image.append("<p>" + slide.description + "</p>");
                        }

                        image.css({
                            width: slideWidth + "px",
                            height: slideHeight - 3 + "px"
                        });
                        if (alignRight) {
                            image.css({
                                right: (slideWidth + slideMargin) * i
                            });
                        } else {
                            image.css({
                                left: (slideWidth + slideMargin) * i
                            });
                        }
                        self.waxImage(image[0], slide.image, false, null, null, null);
                        slider.append(image);
                        if (slide.click) {
                            image.on(globals.CLICK_EVENT, function() {
                                if (!sliding) {
                                    slide.click();
                                }
                            });
                        }
                        i++;
                    });
                    if (pickerWidth < slides.length * slideWidth) {
                        if (leftArrow) {
                            $(leftArrow).hide();
                        }
                        var timer = window.setInterval(function() {
                            if (jElement.width() === element.clientWidth && jElement.width() > 0) {
                                window.clearInterval(timer);
                                var options = {
                                    hScrollbar: false,
                                    vScrollbar: false,
                                    vScroll: false
                                };
                                if (leftArrow) {
                                    options.onScrollEnd = function() {
                                        if (this.x != 0) {
                                            if (jElement.is(":visible")) {
                                                $(leftArrow).show();
                                            }
                                        } else {
                                            $(leftArrow).hide();
                                        }
                                        if (this.x == this.maxScrollX) {
                                            $(rightArrow).hide();
                                        } else {
                                            if (jElement.is(":visible")) {
                                                $(rightArrow).show();
                                            }
                                        }
                                    };
                                }
                                var slideScroll = new iScroll(element, options);
                                if (leftArrow) {
                                    $(leftArrow).on(globals.CLICK_EVENT, function() {
                                        var wantedOffset = Math.min(0, slideScroll.x + pickerWidth);
                                        slideScroll.scrollTo(wantedOffset, 0, 400);
                                    });
                                }
                                if (rightArrow) {
                                    $(rightArrow).on(globals.CLICK_EVENT, function() {
                                        var wantedOffset = Math.max(
                                            -1 * slides.length * (Math.ceil(slideWidth) + Math.ceil(slideMargin) + 2),
                                            slideScroll.x - pickerWidth,
                                            slideScroll.maxScrollX
                                        );
                                        slideScroll.scrollTo(wantedOffset, 0, 400);
                                    });
                                }
                                if (done) {
                                    var destroyCallback = function() {
                                        slideScroll.destroy();
                                    };
                                    done(destroyCallback);
                                }
                                if (alignRight) {
                                    slideScroll.scrollTo(slideScroll.maxScrollX, 0, 0);
                                }
                            }
                        }, 50);
                    } else {
                        if (done) {
                            var destroyCallback = function() {
                                return true;
                            };
                            done(destroyCallback);
                        }
                        if (leftArrow) {
                            $(leftArrow).hide();
                        }
                        if (rightArrow) {
                            $(rightArrow).hide();
                        }
                    }
                },
                /**
                 * @author legacy developers, Jose Rego
                 * @description Generates scrolling text using iScroll
                 * @param {HTMLElement} element the containing element
                 * @param {String} text the containing text
                 * @param {String} scrollClass the css class for the scroller
                 * @param {Object} options to override iscroll options
                 * @returns {Object} returns the iscroll object
                 * @example <caption>(1108.js)</caption>
                 * this.toolkit.textScroll($(element).find('.desc-box'), text, 'eurostarScroll');
                 **/
                textScroll: function(element, text, scrollClass, options) {
                    var elem = $(element);
                    var insideElem = $("<ul></ul>");
                    insideElem.html(text);
                    elem.append(insideElem);

                    var defaultOptions = {
                        hScrollbar: false,
                        vScrollbar: true,
                        hScroll: false,
                        hideScrollbar: false,
                        draggableScrollbars: true,
                        scrollbarClass: scrollClass
                    };

                    return new iScroll(elem[0], options || defaultOptions);
                },
                /**
                 * @author legacy developers
                 * @description Generates a panning image using iScroll
                 * @param {HTMLElement} element the containing element
                 * @param {String} imageUrl the image url
                 * @param {Object} options the iscroll options
                 * @returns {Object} returns the iscroll object
                 * @example <caption>(1108.js)</caption>
                 * self.scroller = this.toolkit.imagePan($(self.element).find('.bottom-right-panel').find('.map')[0], self.mapUrl, {
                 *		hScrollbar: false,
                 *		vScrollbar: false,
                 *		hScroll: true,
                 *		vScroll: true,
                 *		lockDirection: false,
                 *		momentum: false,
                 *		bounce: false
                 *	});
                 **/
                imagePan: function(element, imageUrl, options) {
                    var elem = $(element);
                    elem.css("background-color", "transparent");
                    var img = $('<img src="' + imageUrl + '"/>');
                    $(img).css({ "min-width": "100%", "min-height": "100%" });
                    elem.append(img);
                    var imagePanScroll = new iScroll(elem[0], options);

                    img.load(function() {
                        imagePanScroll.refresh();
                    });

                    return imagePanScroll;
                },
                /**
                 * @author legacy developers
                 * @description Generates a Raphael drawing
                 * @param {HTMLElement} element the containing element
                 * @param {String} path the path to draw
                 **/
                waxDrawing: function(element, path) {
                    var r = Raphael(element, "100%", "100%");
                    r.path(path);
                },
                waxTextInput: function(element) {},
                waxSubmit: function(element) {},
                waxCheckbox: function(element) {},

                /**
                 * @author legacy developers
                 * @description Loads a font in all formats
                 * @param {String} fontFolder the folder the font is in
                 * @param {String} fontName the font-family name of the font
                 * @param {String} fontFileName the name of the file on the server
                 * @param {Boolean} forceTTF force the TTF font
                 * @param {Object} options extra options
                 * @param {Object[]} options.extraFonts load extra fonts file the bold/italic version of the font
                 * @param {String} options.extraFonts.fontFileName the name of the file on the server
                 * @param {Object[]} options.extraFonts.fontStyles the styles(name/value) associated with this font type
                 * @param {String} options.extraFonts.fontStyles.name name of css property
                 * @param {String} options.extraFonts.fontStyles.value value of css property
                 * @example <caption>(33022.js)</caption>
                 * this.toolkit.loadFont('creativeData/fonts/DINCond-Medium/', 'DINCond-Medium', 'DINCond-Medium', true);
                 **/
                loadFont: function(fontFolder, fontName, fontFileName, forceTTF, options) {
                    var fontId = "font-" + fontName.replace(/ /g, ""),
                        self = this;
                    if (!$("#" + fontId).length) {
                        var style = document.createElement("style");
                        style.setAttribute("type", "text/css");
                        var fontStyle = "";
                        if (globals.IS_WINDOWS_PHONE || globals.IS_IE) {
                            fontStyle =
                                "@font-face {\r\n\
						font-family:" +
                                fontName +
                                ";\r\n\
						src: url('" +
                                window.wirewax.fontUrl +
                                fontFolder +
                                fontFileName +
                                ".eot?d=" +
                                window.location.hostname +
                                "'); \r\n\
						src: url('" +
                                window.wirewax.fontUrl +
                                fontFolder +
                                fontFileName +
                                ".eot?#iefix&d=" +
                                window.location.hostname +
                                "') format('embedded-opentype'), \r\n\
						url('" +
                                window.wirewax.fontUrl +
                                fontFolder +
                                fontFileName +
                                ".svg?d=" +
                                window.location.hostname +
                                "') format('svg'),\r\n\
						url('" +
                                window.wirewax.fontUrl +
                                fontFolder +
                                fontFileName +
                                ".ttf?d=" +
                                window.location.hostname +
                                "') format('truetype'),\r\n\
						url('" +
                                window.wirewax.fontUrl +
                                fontFolder +
                                fontFileName +
                                ".woff?d=" +
                                window.location.hostname +
                                "') format('woff');\r\n\
					}";
                        } else if (!forceTTF) {
                            fontStyle =
                                "@font-face {\r\n\
						font-family:" +
                                fontName +
                                ";\r\n\
						src: url('" +
                                window.wirewax.fontUrl +
                                fontFolder +
                                fontFileName +
                                ".eot?d=" +
                                window.location.hostname +
                                "'); \r\n\
						src: url('" +
                                window.wirewax.fontUrl +
                                fontFolder +
                                fontFileName +
                                ".eot?#iefix&d=" +
                                window.location.hostname +
                                "') format('embedded-opentype'), \r\n\
						url('" +
                                window.wirewax.fontUrl +
                                fontFolder +
                                fontFileName +
                                ".svg?d=" +
                                window.location.hostname +
                                "') format('svg'),\r\n\
						url('" +
                                window.wirewax.fontUrl +
                                fontFolder +
                                fontFileName +
                                ".ttf?d=" +
                                window.location.hostname +
                                "') format('truetype');\r\n\
					}";
                        } else {
                            fontStyle =
                                "@font-face {\r\n\
						font-family:" +
                                fontName +
                                ";\r\n\
						src: url('" +
                                window.wirewax.fontUrl +
                                fontFolder +
                                fontFileName +
                                ".eot?d=" +
                                window.location.hostname +
                                "'); \r\n\
						src: url('" +
                                window.wirewax.fontUrl +
                                fontFolder +
                                fontFileName +
                                ".eot?#iefix&d=" +
                                window.location.hostname +
                                "') format('embedded-opentype'), \r\n\
						url('" +
                                window.wirewax.fontUrl +
                                fontFolder +
                                fontFileName +
                                ".ttf?d=" +
                                window.location.hostname +
                                "') format('truetype');\r\n\
					}";
                        }

                        if (options && options.extraFonts) {
                            _.each(options.extraFonts, function(extraFont) {
                                var extraFontPath = window.wirewax.fontUrl + extraFont.fontFolder + extraFont.fontFileName;
                                fontStyle += "\r\n\
                            @font-face {\r\n\
                            font-family:" + fontName + ";";

                                _.each(extraFont.fontStyles, function(style) {
                                    fontStyle += style.name + ":" + style.value + ";";
                                });

                                if (!extraFont.forceTTF) {
                                    fontStyle +=
                                        "src: url('" +
                                        extraFontPath +
                                        ".eot?d=" +
                                        window.location.hostname +
                                        "'); \r\n\
                                src: url('" +
                                        extraFontPath +
                                        ".eot?#iefix&d=" +
                                        window.location.hostname +
                                        "') format('embedded-opentype'), \r\n\
                                url('" +
                                        extraFontPath +
                                        ".svg?d=" +
                                        window.location.hostname +
                                        "') format('svg'),\r\n\
                                url('" +
                                        extraFontPath +
                                        ".ttf?d=" +
                                        window.location.hostname +
                                        "') format('truetype');\r\n\
                            }";
                                } else {
                                    fontStyle +=
                                        "src: url('" +
                                        extraFontPath +
                                        ".eot?d=" +
                                        window.location.hostname +
                                        "'); \r\n\
                                src: url('" +
                                        extraFontPath +
                                        ".eot?#iefix&d=" +
                                        window.location.hostname +
                                        "') format('embedded-opentype'), \r\n\
                                url('" +
                                        extraFontPath +
                                        ".ttf?d=" +
                                        window.location.hostname +
                                        "') format('truetype');\r\n\
                            }";
                                }
                            });
                        }

                        style.setAttribute("id", "font-" + fontName.replace(/ /g, ""));

                        if (globals.IS_IE_8) {
                            $("head").append(style);
                        }

                        if (style.styleSheet) {
                            style.styleSheet.cssText = fontStyle;
                        } else {
                            var textNode = document.createTextNode(fontStyle);
                            style.appendChild(textNode);
                        }

                        var loadTimerStart = new Date().getTime();

                        this.maintainFontList(arguments);

                        WebFontLoader.load({
                            custom: {
                                families: [fontName],
                                urls: [style]
                            },

                            active: function() {
                                PubSub.publish(globals.LOAD_METRIC, {
                                    type: 5,
                                    urls: [window.wirewax.fontUrl + fontFolder + fontFileName],
                                    loadTime: new Date().getTime() - loadTimerStart
                                });
                            },

                            inactive: function() {
                                self.retryFailedFont(fontName);
                            }
                        });
                    }
                },
                /**
                 * @author legacy developers
                 * @description maintainFontList
                 * @private
                 * @param {Object} args args
                 **/
                maintainFontList: function(args) {
                    var fontList = this._fontObjectList,
                        fontNameList = this._fontNameList,
                        fontName = args[1];
                    var fontObject = this.createFontObject(args);

                    if (!this.fontObjectExists(fontName)) {
                        fontList.push(fontObject);
                        fontNameList.push(fontName);
                    }
                },
                /**
                 * @author legacy developers
                 * @description fontObjectExists
                 * @private
                 * @param {String} fontName fontName
                 **/
                fontObjectExists: function(fontName) {
                    var index,
                        fontFound = false;
                    if (this._fontNameList.indexOf(fontName) !== -1) {
                        fontFound = true;
                    }
                    return fontFound;
                },
                /**
                 * @author legacy developers
                 * @description retryFailedFont
                 * @private
                 * @param {String} fontName fontName
                 **/
                retryFailedFont: function(fontName) {
                    var fontList = this._fontObjectList,
                        failedFontObj;

                    for (var i = 0; i < fontList.length; i++) {
                        if (fontList[i].fontName === fontName) {
                            failedFontObj = fontList[i];
                            break;
                        }
                    }
                    if (failedFontObj.retryCount < failedFontObj.retryLimit) {
                        // PubSub.publish(globals.ERROR, new LogEvent(globals.ERROR, globals.ERRORS['5025']));
                        $("#font-" + fontName).remove();
                        failedFontObj.retryCount++;
                        this.loadFont.apply(this, failedFontObj.fontOpts);
                    }
                },
                /**
                 * @author legacy developers
                 * @description createFontObject
                 * @private
                 * @param {Object} args args
                 **/
                createFontObject: function(args) {
                    return {
                        fontName: args[1],
                        retryCount: 0,
                        retryLimit: this.MAX_FONT_RETRY_COUNT,
                        fontOpts: args
                    };
                },

                // deprecated: waxVideoInVideo, decentVideoInVideo, backgroundVideo, simpleBackgroundVideo

                /**
         * @author Jose Rego
         * @description Generates a video in video
         * @param {HTMLElement} element video in video container element
         * @param {Number} vidId video Id
         * @param {Object} options video in video options
         * @param {Boolean} options.autoPlay autoPlay auto play the video ( if possible )
         * @param {String} options.forceRendition forceRendition rendition that we want to force to
         * @param {Boolean} options.loop loop loop video
         * @param {Boolean} options.togglePlayOnClick togglePlayOnClick
         * @param {String} options.posterFrame posterFrame posterFrame that we want to force to
         * @example <caption></caption>
         * var videoInVideo = self.toolkit.createVideoInVideo(introVideo[0], vidId, {
                autoPlay: globals.IS_DESKTOP,
                togglePlayOnClick: true
            });
         videoInVideo.onStartPlay = function(){
                self.recordUiMetric('introVideo', self.appRef, globals.WIDGET_METRIC_TYPES.MEDIA_PLAY);
            };

         videoInVideo.onEnd = function () {
                self.recordUiMetric('introVideo', self.appRef, globals.WIDGET_METRIC_TYPES.MEDIA_ENDED);
            };
         **/
                createVideoInVideo: function(element, vidId, options) {
                    return new VideoInVideoPlayer(element, vidId, options);
                },

                /**
                 * @author legacy developers
                 * @deprecated
                 * @ignore
                 * @description Opens a facebook share link
                 * @param {String} shareText text to share
                 * @param {String} shareUrl share url
                 * @example <caption>(1231.js)</caption>
                 * self.toolkit.doFacebookShare(data[0].sharetext, data[0].shareurl);
                 **/
                doFacebookShare: function(shareText, shareUrl) {
                    // window.open(
                    //     apiService.generateWidgetShareLink('fb', 0, 0, shareText, shareUrl),
                    //     'facebook-share-dialog',
                    //     'width=626,height=436');
                    apiService.widgetShareClick("fb", shareText, shareUrl, null, null, null);
                },
                /**
                 * @author legacy developers
                 * @deprecated
                 * @ignore
                 * @description Opens a twitter share link
                 * @param {String} shareText text to share
                 * @param {String} shareUrl share url
                 * @example <caption>(1231.js)</caption>
                 * self.toolkit.doTwitterShare(data[0].sharetext, data[0].shareurl);
                 **/
                doTwitterShare: function(shareText, shareUrl) {
                    // window.open(
                    //     apiService.generateWidgetShareLink('tw', 0, 0, shareText, shareUrl),
                    //     'twitter-share-dialog',
                    //     'width=626,height=436');
                    apiService.widgetShareClick("tw", shareText, shareUrl, null, null, null);
                },
                /**
                 * @author legacy developers
                 * @deprecated
                 * @ignore
                 * @description Opens a google plus share link
                 * @param {String} shareText text to share
                 * @param {String} shareUrl share url
                 * @example <caption>(1228.js)</caption>
                 * self.toolkit.doGPShare(data[0].googleurl, data[0].googleurl);
                 **/
                doGPShare: function(shareText, shareUrl) {
                    // window.open(
                    //     apiService.generateWidgetShareLink('gp', 0, 0, shareText, shareUrl),
                    //     'google-share-dialog',
                    //     'width=626,height=436');
                    apiService.widgetShareClick("gp", shareText, shareUrl, null, null, null);
                },
                /**
                 * @author legacy developers
                 * @description Opens a tumblr share link
                 * @param {String} shareText text to share
                 * @param {String} shareUrl share url
                 * @example <caption>(1168.js)</caption>
                 * self.toolkit.doTumblrShare(shareText, shareUrl, self.tag.vidName, self.appRef);
                 **/
                doTumblrShare: function(shareText, shareUrl, name, appRef) {
                    // window.open(
                    //     apiService.generateWidgetLink(appRef, 0, 'http://www.tumblr.com/share/link?url=' + encodeURIComponent(shareUrl) + '&name=' + encodeURIComponent(name) + '&description=' + encodeURIComponent(shareText)),
                    //     'tumblr-share-dialog',
                    //     'width=626,height=436');
                    apiService.widgetShareClick("tb", shareText, shareUrl, null, null, null);
                },
                /**
                 * @author legacy developers
                 * @description Draws a triangle
                 * @param {HTMLCanvasElement} canvas the canvas to draw the triangle on
                 * @param {Number} height the height of the triangle
                 * @return {HTMLCanvasElement} the canvas path
                 * @example <caption>(1108.js)</caption>
                 * this.toolkit.triangle(canvas, 50).attr({'fill': '#ffd900', 'stroke': 'none'});
                 **/
                triangle: function(canvas, height) {
                    var length = height / 2 / Math.tan(Math.PI / 4);
                    var p1 = {
                            x: (height - length) / 2,
                            y: 0
                        },
                        p2 = {
                            x: (height - length) / 2 + height / 2 / Math.tan(Math.PI / 4),
                            y: height / 2
                        },
                        p3 = { x: (height - length) / 2, y: height };
                    return canvas.path("M" + p1.x + "," + p1.y + " L" + p2.x + "," + p2.y + " L" + p3.x + "," + p3.y + " L" + p1.x + "," + p1.y);
                },
                /**
                 * @author legacy developers
                 * @description Preloads an image. Used for a quicker load later on, since is already cached.
                 * @param {String} imgUrl image url
                 * @param {Function} callback function called when image is loaded
                 * @example <caption>(1229.js)</caption>
                 * self.toolkit.preloadImage(slide.image1);
                 **/
                preloadImage: function(imgUrl, callback) {
                    var tmpImg = new Image();
                    tmpImg.onload = function() {
                        if (callback) {
                            callback();
                        }
                    };
                    tmpImg.src = imgUrl;

                    // $('#font-overlay').append('<img src="'+imgUrl+'" style="visbility: hidden; width: 1px; height: 1px;" />')
                },
                /**
                 * @author legacy developers
                 * @description Generates a audio player
                 * @param {HTMLElement} element container element
                 * @param {String} audioFile file url
                 * @param {Object} args (for future use) extra options
                 * @example <caption>(1168.js)</caption>
                 * self.toolkit.createAudioPlayer(self.element.find('.audio-player'), data[0].audio);
                 **/
                createAudioPlayer: function(element, audioFile, args) {
                    var $elem = $(element);

                    $elem.append(
                        '<div class="audio-play-pause play"></div><div class="audio-timeline"><div class="audio-scrubber"></div></div><audio style="display: none;" autoplay class="audio-file" src="' +
                            audioFile +
                            '"></audio>'
                    );

                    var audioPlayer = $elem.find("audio");
                    var playPause = $elem.find(".audio-play-pause");
                    var audioScrubber = $elem.find(".audio-scrubber");
                    var audioTimeline = $elem.find(".audio-timeline");

                    playPause.bind(globals.CLICK_EVENT, function() {
                        if (audioPlayer[0].readyState !== 0) {
                            if ($(this).hasClass("play")) {
                                audioPlayer[0].play();
                            } else {
                                audioPlayer[0].pause();
                            }
                        }
                    });

                    audioPlayer.on("play", function() {
                        playPause.removeClass("play").addClass("pause");
                    });

                    audioPlayer.on("pause", function() {
                        playPause.removeClass("pause").addClass("play");
                    });

                    audioPlayer.on("ended", function() {
                        playPause.removeClass("pause").addClass("play");
                    });

                    window.setInterval(function() {
                        if (!self.audioLockTimer) {
                            audioScrubber.css("left", parseFloat(audioPlayer[0].currentTime / audioPlayer[0].duration) * 100 + "%");
                        }
                    }, 10);

                    audioTimeline.bind("touchstart mousedown", function(e) {
                        if (audioPlayer[0].readyState !== 0 && !self.audioLockTimer) {
                            var xOffset = event.offsetX ? event.offsetX : event.pageX - audioTimeline.offset().left;

                            if (event.touches) {
                                xOffset = event.touches[0].pageX - event.touches[0].target.offsetLeft;
                            }

                            audioPlayer[0].currentTime = audioPlayer[0].duration * (xOffset / audioTimeline.width());
                        }
                    });

                    audioScrubber.bind("touchstart mousedown", function(event) {
                        event.preventDefault();
                        event.stopImmediatePropagation();
                        var e = event.originalEvent;
                        self.audioLockTimer = true;
                    });

                    audioScrubber.bind("touchmove mousemove", function(event) {
                        if (self.audioLockTimer) {
                            var e = event.originalEvent;
                            if (e.preventDefault) {
                                if (e.preventDefault) {
                                    e.preventDefault();
                                } else {
                                    e.returnValue = false;
                                }
                            }
                            event.stopImmediatePropagation();

                            var offsetLeft = $(this).offset().left;
                            var positionLeft = $(this).position().left;

                            var offsetX;
                            if (e.changedTouches !== undefined) {
                                offsetX = e.changedTouches[0].pageX - offsetLeft;
                            } else {
                                offsetX = (globals.IS_IE_8 ? e.clientX + document.body.scrollLeft : e.pageX) - offsetLeft;
                            }

                            var pixels = positionLeft + offsetX;
                            pixels = Math.min(pixels, audioTimeline.width());
                            pixels = Math.max(pixels, 0);

                            audioScrubber.css("left", pixels);
                        }
                    });

                    audioScrubber.bind("touchend mouseup mouseleave", function(event) {
                        if (self.audioLockTimer) {
                            audioPlayer[0].currentTime = audioPlayer[0].duration * (audioScrubber.position().left / audioTimeline.width());
                            self.audioLockTimer = false;
                        }
                    });
                },
                /**
                 * @author legacy developers
                 * @description Zoom in main video. Adds the classes 'wwx-video-zoomable' and 'wwx-video-zoomed-in' to the '#wireWaxVideo'
                 **/
                zoomInVideo: function() {
                    $("#video-container #wireWaxVideo")
                        .addClass("wwx-video-zoomable")
                        .addClass("wwx-video-zoomed-in");
                },
                /**
                 * @author legacy developers
                 * @description Zoom out main video. Removes the class 'wwx-video-zoomed-in' from the '#wireWaxVideo'
                 **/
                zoomOutVideo: function() {
                    $("#video-container #wireWaxVideo").removeClass("wwx-video-zoomed-in");
                },
                /**
                 * @author legacy developers
                 * @description Blurs main video.  Adds the classes 'wwx-video-blurrable' and 'wwx-video-blurred-in' to the '#wireWaxVideo'
                 **/
                blurVideo: function() {
                    $("#video-container #wireWaxVideo")
                        .addClass("wwx-video-blurrable")
                        .addClass("wwx-video-blurred-in");
                },
                /**
                 * @author legacy developers
                 * @description Unblur main video. Removes the class 'wwx-video-blurred-in' from the '#wireWaxVideo'
                 **/
                unblurVideo: function() {
                    $("#video-container #wireWaxVideo").removeClass("wwx-video-blurred-in");
                },
                /**
                 * @author Klaudia Rozgonyiova
                 * @description Send an email from videos
                 * @param {Array} toEmails array of recipients' email addresses
                 * @param {Array} bccEmails array of bcc emails
                 * @param {String} sourceEmail sender's email address. Needs to be a wirewax email!
                 * @param {String} subject subject
                 * @param {String} bodyHtml body of the email
                 * @example <caption></caption>
                 * self.toolkit.sendEmailWithBcc(['test@wirewax.com'], [], 'someone@wirewax.com', 'Subject', 'Body of the email goes here');
                 **/
                sendEmailWithBcc: function(toEmails, bccEmails, sourceEmail, subject, bodyHtml) {
                    return apiService.sendEmailWithBcc;
                },
                /**
                 * @author Graydon Pleasants
                 * @description make a sprite animation
                 * @param {Object} selector element you want to make a sprite
                 * @param {String} url the short url of the image
                 * @param {String} animationTime time it takes to do the animation
                 * @param {Boolean} loop is it looping
                 * @param {Boolean} playing is it already playing once started
                 * @example <caption></caption>
                 * self.makeSprite(self.tagSprite,'project/sprites/sprite_1_fr20_fps30_w200_h240.png',2,true,true);
                 **/
                makeSprite: function(selector, url, animationTime, loop, playing) {
                    var animationTime = animationTime === undefined ? null : animationTime;
                    var loop = loop === undefined ? true : loop;
                    var playing = playing === undefined ? true : playing;

                    let getValueFromUrl = function(field) {
                        let rawUrl = url.split(".")[0];
                        return rawUrl.indexOf(field) !== -1
                            ? rawUrl
                                  .split(field)
                                  .pop()
                                  .split("_")[0]
                            : null;
                    };

                    var fps = getValueFromUrl("_fps");
                    var frames = getValueFromUrl("_fr") || getValueFromUrl("_f");
                    var width = getValueFromUrl("_w");
                    var height = getValueFromUrl("_h");

                    if (!frames || !height || !width) {
                        console.warn("failed to parse" + url);
                        return false;
                    }
                    var imageUrl = "url(" + self.makeUrl(url) + ")";
                    var backgroundSize = "100% " + frames * 100 + "%";
                    var paddingTop = (height / width) * 100 + "%";
                    selector.css({
                        position: "relative",
                        height: "0",
                        width: "100%",
                        "background-image": imageUrl,
                        "background-size": backgroundSize,
                        "padding-top": paddingTop
                    });
                    var time, repeatState, pausedState;
                    if (animationTime == null) {
                        time = fps ? frames / fps : 1;
                    } else {
                        time = animationTime;
                    }
                    repeatState = loop ? -1 : 0;
                    pausedState = !playing;
                    selector.timeline = new TimelineMax({
                        paused: pausedState,
                        repeat: repeatState
                    });
                    selector.timeline
                        .add("sprite")
                        .fromTo(selector, time, { backgroundPosition: "0 0%" }, { backgroundPosition: "0 100%", ease: SteppedEase.config(frames - 1) }, "sprite");
                    return selector.timeline;
                },
                /**
                 * @author Graydon Pleasants
                 * @description makes a short url long
                 * @param {String} url the short url of the image
                 * @example <caption></caption>
                 * self.makeUrl('sharecare-1/sprites/image.png');
                 **/
                makeUrl: function(subPath) {
                    var subPath = subPath || "";
                    var basePath = "https://edge-assets.wirewax.com/creativeData";
                    if (subPath.charAt(0) !== "/") {
                        return basePath + "/" + subPath;
                    } else {
                        return basePath + subPath;
                    }
                }
            }
        );

        return new Toolkit();
    }
);

// This class allows us to dynamically load AMD modules with requirejs
// It tries to load a file thrice before throwing the error callback

wwplayer.define("require-shim", ["pubsub", "globals", "underscore", "LogEvent"], function(PubSub, globals, _, LogEvent) {
    var self = {
        errorRetries: 0,
        require: function(urls, success, error) {
            var requireFn = window.wwplayer ? window.wwplayer.require : window.require;

            var successCallback = function() {
                if (success) {
                    success.apply(self, arguments);
                }
            };

            requireFn(urls, successCallback, function(err) {
                self.onError(err, successCallback, error);
            });
        },
        undef: function(failedId) {
            var requireFn = window.wwplayer ? window.wwplayer.require : window.require;
            requireFn.undef(failedId);
        },
        onError: function(err, successCallback, errorCallback) {
            self.errorRetries++;

            if (self.errorRetries < 3) {
                _.each(err.requireModules, function(module) {
                    var failedId = module;
                    self.undef(module);
                });

                self.require(err.requireModules, successCallback, errorCallback);
            } else {
                if (errorCallback) {
                    errorCallback();
                }

                if (err.requireType === "timeout") {
                    PubSub.publish(globals.ERROR, new LogEvent(globals.ERROR, globals.ERRORS["5012"], { detail: err.requireModules }));
                } else if (err.requireType === "scripterror") {
                    PubSub.publish(globals.ERROR, new LogEvent(globals.ERROR, globals.ERRORS["5013"], { detail: err.requireModules }));
                } else {
                    PubSub.publish(globals.ERROR, new LogEvent(globals.ERROR, globals.ERRORS["5003"]));
                }
            }
        }
    };
    return self;
});
wwplayer.define("BaseTagNew", ["jquery", "Class", "pubsub", "globals", "modernizr", "apiService", "DefaultToolkit", "LogEvent", "require-shim", "underscore"], function(
    $,
    Class,
    PubSub,
    globals,
    Modernizr,
    apiService,
    Toolkit,
    LogEvent,
    requireShim,
    _
) {
    var BaseTagNew = Class.extend(
        /** @lends BaseTagNew.prototype */ {
            /**
             * @abstract
             * @extends Class
             * @author legacy developers
             * @description Abstract tag class. All tags should extend from this.
             * @constructs BaseTagNew
             * @param {Object} tagData
             * @param {Number} tagData.spriteId the spriteId for this tag
             * @param {Boolean} tagData.isStatic if the tag is static
             * @param {Number} tagData.tagIndex tag index
             * @param {String} tagData.clipIndex clip index where the tag is
             * @param {Number} tagData.clipStartFrame clipStartFrame
             * @param {Number} tagData.clipEndFrame clipEndFrame
             * @param {Number} tagData.staticClipIndex staticClipIndex
             * @param {Number} tagData.tagType tagType
             * @param {Number} tagData.productId productId
             * @param {Object[]} tagData.dataConnections dataConnections
             * @param {Number} tagData.customContent customContent
             * @param {Number} tagData.nameLink nameLink
             * @param {HTMLElement} tagData.tagElement tagElement
             * @param {String} tagData.tagStartTime tagStartTime
             * @param {Number} tagData.tagAnimationTime tagAnimationTime
             * @param {Number} tagData.invFps invFps
             * @param {String} tagData.vidName vidName
             * @param {Number} tagData.tagPositionX tagPositionX
             * @param {Number} tagData.tagPositionY tagPositionY
             * @param {String} tagData.tagText tagText
             * @param {Boolean} tagData.preventPauseOnClick preventPauseOnClick
             * @param {Number} tagData.widgetId widgetId
             * @param {Object} tagData.buttonData buttonData
             * @param {Number} tagData.thumbIndex thumbIndex
             * @param {Number} tagData.thumbImgIndex thumbImgIndex
             * @param {Class} tagData.animationController animationController
             * @param {String} tagData.appRef appRef
             * @param {Number} tagData.tagId tagId
             * @param {Number} tagData.overlayId overlayId
             * @param {Boolean} tagData.isDummy isDummy
             * @param {Number} tagData.appRef (deprecated) appRef is a reference used for metrics
             *
             * @property {Class} animationController
             * @property {Number} animationTimeLeft animationTimeLeft
             * @property {Number|String} appId appId
             * @property {Number|String} appRef appRef
             * @property {Object} buttonData buttonData
             * @property {Boolean} clearLoader clearLoader
             * @property {String} clickoutUrl clickoutUrl
             * @property {Number} clipEndFrame clipEndFrame
             * @property {String} clipIndex clipIndex
             * @property {Number} clipStartFrame clipStartFrame
             * @property {HTMLElement[]} countdownPaths="[]" Raphael countdown paths
             * @property {Object} customContent customContent
             * @property {String} customNameRef customNameRef
             * @property {Object[]} dataConnections dataConnections
             * @property {Boolean} disableWidget disableWidget
             * @property {HTMLElement} element element
             * @property {Number} errorRetries=0 errorRetries (default: 0 )
             * @property {Boolean} hasData hasData
             * @property {Number} invFps invFps
             * @property {Boolean} isStatic isStatic
             * @property {Boolean} loadDataOnce=false loadDataOnce (default: false)
             * @property {Boolean} multiSheet multiSheet
             * @property {Number} nameLink nameLink
             * @property {Object} newTagData newTagData
             * @property {Number} overlayId overlayId
             * @property {Object} overrides overrides
             * @property {Boolean} persistentTag persistentTag
             * @property {Boolean} preloadWidget preloadWidget
             * @property {Boolean} preventPauseOnClick preventPauseOnClick
             * @property {String} productId productId
             * @property {Object} publicData publicData
             * @property {Function} resolve resolve
             * @property {Boolean} showOnPause=true showOnPause (default: true)
             * @property {Number} spriteId spriteId
             * @property {Boolean} static static
             * @property {Object} staticClipIndex staticClipIndex
             * @property {Number} tagAnimationTime tagAnimationTime
             * @property {Number} tagId tagId
             * @property {Number} tagIndex tagIndex
             * @property {String} tagName tagName
             * @property {Number} tagPositionX tagPositionX
             * @property {Number} tagPositionY tagPositionY
             * @property {Number} tagSkipToTime tagSkipToTime
             * @property {Number} tagStartTime tagStartTime
             * @property {String} tagText tagText
             * @property {Number} tagType tagType
             * @property {Object[]} tagTypes tagTypes
             * @property {Number} thumbImgIndex thumbImgIndex
             * @property {Number} thumbIndex thumbIndex
             * @property {Class} toolkit toolkit
             * @property {String} vidName vidName
             * @property {Boolean} widgetCdn widgetCdn (default: true)
             * @property {Number|String} widgetId widgetId
             * @property {Number} tagData.appRef=null (deprecated) appRef is a reference used for metrics
             **/
            init: function(tagData) {
                this.parseTagData(tagData);
                // This is a hack for tags with overridden keyframes to make sure they don't show when scrubbing
                // Remove when we fix the animationControllers pauseTagAtPosition method
                this.showOnPause = true;
                this.loadDataOnce = false;
                this.widgetCdn = true;
                this.countdownPaths = [];
                this.toolkit = Toolkit;
                this.errorRetries = 0;
                this.customConfigData = this.getCustomConfigData();

                if (window.wirewax.writer) {
                    this.disableWidget = true;
                }

                if (tagData.isDummy) {
                    return;
                }

                this.loadFonts();
                this.createElements();
                this.bindEvents();
                this.bindAnimationEvents();
                this.initTag();
                this.loadPanelsData();
            },
            /**
             * @description Overrides the tag properties based on the override property. Called on the end of the constructor.
             **/
            initTag: function() {
                var tag = this;

                if (this.overrides) {
                    _.each(this.overrides, function(overrideValue, overrideKey) {
                        tag[overrideKey] = overrideValue;
                    });
                }
            },
            /**
             * @description Loads the fonts. Called on the end of the constructor.
             **/
            loadFonts: function() {
                // OVERRIDE TO LOAD YOUR FONTS
            },
            /**
             * @description Create the tag elements. Called on the end of the constructor.
             **/
            createElements: function() {
                // OVERRIDE TO CREATE YOUR TAG ELEMENTS
            },
            /**
             * @description Binds events to the tag elements. Called on the end of the constructor.
             **/
            bindEvents: function() {
                var tag = this;

                $(this.element)
                    .find(".tag-inner-box")
                    .bind(
                        globals.CLICK_EVENT,
                        function(e) {
                            e.stopPropagation();
                            e.preventDefault();
                            if (window.wirewax.embedLoc.indexOf("twitter.com") !== -1) {
                                this.twitterClick();
                            } else {
                                this.tagClick(e, true);
                            }
                        }.bind(this)
                    );

                if (globals.CLICK_EVENT !== "touchend") {
                    $(this.element).hover(
                        function(e) {
                            tag.tagMouseOver(e);
                        },
                        function(e) {
                            tag.tagMouseLeave(e);
                        }
                    );
                }
            },
            /**
             * @description adds a svg path that represents the tag countdown
             * @param {HTMLElement} element element
             * @param {Object} viewBox viewBox position and dimensions
             * @param {Number} viewBox.x viewBox x
             * @param {Number} viewBox.y viewBox y
             * @param {Number} viewBox.w viewBox width
             * @param {Number} viewBox.h viewBox height
             * @param {String} path svg path
             * @param {Object} pathAttributes path="{}" path attributes
             * @param {String} pathAttributes.color="#FFFFFF" path stroke color
             * @param {String} pathAttributes.width="3" path stroke width
             * @example <caption>(100359.js)</caption>
             * var viewBox = { 'x': 352.1, 'y': 151.7,'w': 354.9,'h': 354.9 };
             * var path = 'M529.5,216.7c62.1,0,112.4,50.3,112.4,112.4s-50.3,112.4-112.4,112.4s-112.4-50.3-112.4-112.4S467.4,216.7,529.5,216.7z';
             * var pathAttributes = {'color': data[0].taghighlightcol,'width': '8'}
             * tag.createCountdownPath(fixedBoxThin, viewBox, path, pathAttributes);
             **/
            createCountdownPath: function(element, viewBox, path, pathAttributes) {
                var tag = this;

                if (!viewBox || !path) {
                    return;
                }

                if (!pathAttributes) {
                    pathAttributes = {};
                }

                var rsr = Raphael($(element)[0], "100%", "100%");
                rsr.setViewBox(viewBox.x, viewBox.y, viewBox.w, viewBox.h, false);
                var path_a = rsr.path(path);
                path_a
                    .attr({
                        opacity: "1",
                        fill: "none",
                        "fill-opacity": 0,
                        stroke: pathAttributes.color || "#FFFFFF",
                        "stroke-width": pathAttributes.width || "3",
                        "stroke-miterlimit": "10",
                        "enable-background": "new    ",
                        "stroke-opacity": "1"
                    })
                    .data("id", "path_a");

                $(path_a.node).css({
                    "stroke-dasharray": "9999px",
                    "stroke-dashoffset": "9292px"
                });

                tag.countdownPaths.push(path_a);
            },
            /**
             * @description Bind animation events to the elements. Called on the end of the constructor.
             **/
            bindAnimationEvents: function() {
                var tag = this;

                PubSub.subscribe(globals.HAS_PLAYED, function() {
                    var animLeftTime = tag.tagStartTime + tag.tagAnimationTime - globals.GET_CURRENT_PLAYING_TIME();

                    if ($(tag.element).css("display") === "block") {
                        window.setTimeout(function() {
                            _.each(tag.countdownPaths, function(path) {
                                $(path.node).clearQueue();
                                $(path.node).stop();

                                $(path.node).animate(
                                    {
                                        "stroke-dashoffset": "9999px"
                                    },
                                    {
                                        duration: animLeftTime * 1000 - 1000,
                                        easing: "linear"
                                    }
                                );
                            });
                        }, 300);
                    }
                });

                PubSub.subscribe(globals.HAS_PAUSED, function() {
                    if (tag.tagAnimTimeout) {
                        window.clearTimeout(tag.tagAnimTimeout);
                    }

                    _.each(tag.countdownPaths, function(path) {
                        $(path.node).clearQueue();
                        $(path.node).stop();
                    });
                });
            },
            /**
             * @description Parse the tag data received in the constructor. Called on the beginning of the constructor.
             * @param {Object} tagData tagData. See the constructor params for emore detail.
             **/
            parseTagData: function(tagData) {
                this.spriteId = tagData.spriteId;
                this.static = this.isStatic = tagData.isStatic;
                this.tagIndex = tagData.tagIndex;
                this.clipIndex = tagData.clipIndex;
                this.clipStartFrame = tagData.clipStartFrame;
                this.clipEndFrame = tagData.clipEndFrame;
                this.staticClipIndex = tagData.staticClipIndex;
                this.customNameRef = tagData.customNameRef;
                this.tagType = tagData.tagType;
                this.productId = tagData.productId;
                this.dataConnections = tagData.dataConnections;
                this.customContent = tagData.customContent;
                this.tagName = tagData.tagName;
                this.nameLink = tagData.nameLink;
                this.element = tagData.tagElement;
                this.tagStartTime = tagData.tagStartTime;
                this.tagAnimationTime = tagData.tagAnimationTime ? tagData.tagAnimationTime : 0;
                this.invFps = tagData.invFps;
                this.vidName = tagData.vidName;
                this.tagPositionX = tagData.tagPositionX;
                this.tagPositionY = tagData.tagPositionY;
                this.tagText = tagData.tagText;
                this.preventPauseOnClick = tagData.preventPauseOnClick;
                this.videoData = tagData.videoData;

                this.tagSkipToTime = this.getSkipTime() ? this.getSkipTime() * this.invFps : null;
                this.clickoutUrl = this.getClickoutUrl();

                if (this.clickoutUrl || this.tagSkipToTime) {
                    this.disableWidget = true;
                }
                // TODO - this should be a collection in the DB or something. Need to be able to get it from outside
                //  of a player event in Studio. For now have duplicated the list inside studio, so for now,
                //  FIXME if this changes, need to change studio too
                this.tagTypes = [
                    { tagType: 0, tagTypeName: "Center" },
                    { tagType: 1, tagTypeName: "Top Left" },
                    { tagType: 2, tagTypeName: "Top Right" },
                    { tagType: 3, tagTypeName: "Bottom Right" },
                    { tagType: 4, tagTypeName: "Bottom Left" },
                    { tagType: 5, tagTypeName: "Custom Type 6" },
                    { tagType: 6, tagTypeName: "Custom Type 7" },
                    { tagType: 7, tagTypeName: "Custom Type 8" },
                    { tagType: 8, tagTypeName: "Custom Type 9" },
                    { tagType: 9, tagTypeName: "Custom Type 10" }
                ];

                this.widgetId = this.appId = tagData.widgetId;
                this.buttonData = tagData.buttonData;
                this.thumbIndex = tagData.thumbIndex;
                this.thumbImgIndex = tagData.thumbImgIndex;
                this.animationController = tagData.animationController;
                // The below line looks pointless, but `undefined` is coerced to a string during SQS encoding, which
                // causes the metrics aggregator to throw. Null is treated correctly (coerced to zero).
                // To be honest, not sure if appRef is needed. AFAIK it's literally never used for any metrics purpose,
                // it gets stored in the metrics document but is never used. - Richard 2016-01-06
                this.appRef = tagData.appRef || null;
                this.tagId = tagData.tagId;
                this.overlayId = tagData.overlayId;
                this.widgetCdn = tagData.widgetCdn;

                this.publicData = {};
                this.publicData.customNameRef = this.customNameRef;
                this.publicData.tagName = this.tagName;
                this.publicData.spriteId = tagData.spriteId;
                this.publicData.nameLink = this.nameLink;
                this.publicData.tagId = this.tagId;
                this.productDetails = tagData.productDetails;
            },
            /**
             * @description Loads tag css file.
             **/
            loadTagStyle: function() {
                var tagId = this.tagId;
                var styleUrl = window.wirewax.tagUrl + "style/" + tagId + ".css";

                if ($("#wax-tag-style-" + tagId).length === 0) {
                    if (globals.IS_IE_9 || globals.IS_IE_8) {
                        var cssElement = '<link id="wax-tag-style-' + tagId + '" rel="stylesheet" type="text/css" href="' + styleUrl + '" />';
                        $("head").append(cssElement);
                    } else {
                        var loadTimeStart = new Date().getTime();
                        apiService.getCss(styleUrl, function(contents) {
                            if ($("#wax-tag-style-" + tagId).length === 0) {
                                PubSub.publish(globals.LOAD_METRIC, {
                                    type: 3,
                                    urls: [styleUrl],
                                    loadTime: new Date().getTime() - loadTimeStart
                                });
                                $(document.head).append('<style id="wax-tag-style-' + tagId + '">' + contents + "</style>");
                            }
                        });
                    }
                }
            },
            /**
             * @description Tag click when video is embedded inside twitter. Opens a new tab of the video embed page(embed.wirewax.com/VID_ID?spriteId=SPRITE_ID&fromTweet=true) and mimics a click on the same tag that the user clicked.
             **/
            twitterClick: function() {
                var url = "http://embed.wirewax.com/" + window.wirewax.vidId + "?spriteId=" + this.spriteId + "&fromTweet=true";
                var iOSTwitterOpen = function(url) {
                    // Create link in memory
                    var a = window.document.createElement("a");
                    a.target = "_blank";
                    a.href = url;

                    // Dispatch fake click
                    var e = window.document.createEvent("MouseEvents");
                    e.initMouseEvent("click", true, true, window, 0, 0, 0, 0, 0, false, false);
                    a.dispatchEvent(e);
                };
                if (!globals.IS_IPHONE && !globals.IS_IPAD) {
                    window.open(url);
                } else {
                    iOSTwitterOpen(url);
                }
                PubSub.publish(globals.DO_PAUSE);
                PubSub.publish(globals.TAG_CLICK, { tag: this });
                PubSub.publish(globals.WIDGET_SHOWN);
            },
            /**
             * @description  called at tagClick() end. Override to do something after tag click.
             * @param {Event} e click event
             **/
            onTagClick: function(e) {
                // OVERRIDE TO DO SOMETHING ON TAG CLICK
            },
            /**
             * @description  called at tagClick() beginning. Override to do something before tagClick() checks/run the correct behavior.
             * @param {Event} e click event
             **/
            onTagClickPre: function(e) {
                // OVERRIDE TO DO SOMETHING ON TAG CLICK BEFORE THE WIDGET IS LOADED
            },
            /**
             * @description  check/run correct tag behavior when is clicked. Can be:<br/> if in twitter->twitterClick(),<br/> if !tag.disableWidget->loadWidget(),<br/> if clickoutUrl->doClickout(),<br/> if tagSkipToTime->skipToTime()
             * @param {Event} e click event
             * @param {Boolean} checkedTwitter skip twitter embed check
             **/
            tagClick: function(e, checkedTwitter) {
                if (!checkedTwitter && window.wirewax.embedLoc.indexOf("twitter.com") !== -1 && !this.clickoutUrl) {
                    this.twitterClick();
                } else {
                    var tag = this;

                    if (!tag.preventPauseOnClick) {
                        PubSub.publish(globals.DO_PAUSE, { flashIn: false });
                    }

                    if (tag.clickAudioElem) {
                        tag.clickAudioElem.play();

                        window.setTimeout(function() {
                            tag.clickAudioElem.pause();
                            tag.clickAudioElem.currentTime = 0;
                        }, 2000);
                    }

                    if (!tag.disableWidget) {
                        if (tag.overrides && tag.overrides.clearLoader) {
                            PubSub.publish(globals.SHOW_LOADER_TRANSPARENT);
                        } else {
                            PubSub.publish(globals.SHOW_LOADER);
                        }
                    }

                    tag.onTagClickPre();

                    var timeout = globals.IS_DESKTOP ? 100 : 500;
                    window.setTimeout(function() {
                        if (!tag.disableWidget) {
                            tag.loadWidget();
                        }

                        if (tag.clickoutUrl && !window.wirewax.writer) {
                            tag.doClickout(tag.clickoutUrl);
                        } else if (tag.tagSkipToTime && !window.wirewax.writer) {
                            tag.skipToTime(tag.tagSkipToTime);
                        }

                        PubSub.publish(globals.TAG_CLICK, { tag: tag });
                        tag.onTagClick();
                    }, timeout);
                }
            },
            /**
             * @description  Load widget file. When loaded call onWidgetLoad()
             **/
            loadWidget: function() {
                var widgetUrl = window.wirewax.widgetUrl + this.widgetId + ".js";
                requireShim.require([widgetUrl], this.onWidgetLoad.bind(this));
            },
            /**
             * @description  Preload overlay/panel data
             **/
            loadPanelsData: function() {
                if (!this.disableWidget && this.widgetId === "panels" && this.overlayId) {
                    apiService.getOverlayDataCdn(
                        this.overlayId,
                        function() {},
                        function() {}
                    );
                }
            },
            /**
             * @description  creates widget object
             * @param {Class} Widget  widget class
             **/
            onWidgetLoad: function(Widget) {
                if (!this.persistentTag) {
                    PubSub.publish(globals.HIDE_TAG);
                }

                var widgetInstance = new Widget(this);

                window.setTimeout(function() {
                    PubSub.publish(globals.SHOW_WIDGET, widgetInstance);
                }, 50);
            },
            /**
             * @deprecated
             * @description (deprecated) override to do something when finished
             **/
            finished: function() {},
            /**
             * @description  override to do something the first time the tag is brought in
             **/
            onBringInFirst: function() {
                // OVERRIDE TO DO SOMETHING THE FIRST TIME THE TAG IS BROUGHT IN
            },
            /**
             * @description  override to do something everytime the tag is brought in
             **/
            onBringIn: function() {
                // OVERRIDE TO DO SOMETHING EVERYIME THE TAG IS BROUGHT IN
            },
            /**
             * @description  override to do something everytime the tag is animated out
             **/
            onAnimateOut: function() {
                // OVERRIDE TO DO SOMETHING EVERYTIME THE TAG IS ANIMATED OUT
            },
            /**
             * @description tag is displayed and animate countdown paths
             **/
            bringIn: function() {
                var tag = this;

                if (!tag.brungIn) {
                    tag.onBringInFirst();
                    tag.brungIn = true;
                }

                tag.onBringIn();

                var tagAnimTime = tag.tagAnimationTime * 1000;
                var animLeftTime = tag.tagStartTime + tag.tagAnimationTime - globals.GET_CURRENT_PLAYING_TIME();

                if (tag.animatingOut) {
                    return;
                }

                var animationTimeLeftOverride = tag.overrides && tag.overrides["animationTimeLeft"] ? tag.overrides["animationTimeLeft"] : 500;

                if (animLeftTime > animationTimeLeftOverride / 1000 && globals.IS_PLAYING()) {
                    if (tag.tagAnimTimeout) {
                        window.clearTimeout(tag.tagAnimTimeout);
                    }

                    window.setTimeout(function() {
                        $(tag.element)
                            .find(".animates-in")
                            .addClass("show");
                    }, 100);

                    tag.tagAnimTimeout = window.setTimeout(function() {
                        tag.animatingOut = true;
                        $(tag.element)
                            .find(".animates-in")
                            .removeClass("show");

                        tag.onAnimateOut();

                        window.setTimeout(function() {
                            tag.animatingOut = false;
                        }, 1000);
                    }, animLeftTime * 1000 - animationTimeLeftOverride);
                }

                _.each(tag.countdownPaths, function(path) {
                    if ($(path.node).css("stroke-dashoffset") === "9999px") {
                        $(path.node).css({
                            "stroke-dashoffset": "9292px"
                        });
                    }
                });

                window.setTimeout(function() {
                    _.each(tag.countdownPaths, function(path) {
                        $(path.node).clearQueue();
                        $(path.node).stop();

                        $(path.node).animate(
                            {
                                "stroke-dashoffset": "9999px"
                            },
                            {
                                duration: animLeftTime * 1000 - animationTimeLeftOverride,
                                easing: "linear"
                            }
                        );
                    });
                }, 100);
            },
            /**
             * @description override to do something when the mouse over the tag
             **/
            tagMouseOver: function(e) {},
            /**
             * @description override to do something when the mouse leave the tag
             **/
            tagMouseLeave: function(e) {},
            /**
             * @description gets the right url from the data connections for the clickout
             **/
            getClickoutUrl: function() {
                var dc = this.getDataConnections();
                if (dc["region"].length || dc["default"].length) {
                    var conn;
                    if (dc["region"].length) {
                        conn = dc["region"][0];
                    } else {
                        conn = dc["default"][0];
                    }
                    if (conn.type === "Clickout") {
                        this.noUtm = conn.hasUtm === false;
                        this.thisPage = conn.behaviour === "_self";
                        return conn.clickoutUrl;
                    }
                } else {
                    return null;
                }
            },
            /**
             * @description gets the right frame from the data connections for the tagSkipToTime
             **/
            getSkipTime: function() {
                var dc = this.getDataConnections();
                if (dc["region"].length || dc["default"].length) {
                    var conn;
                    if (dc["region"].length) {
                        conn = dc["region"][0];
                    } else {
                        conn = dc["default"][0];
                    }

                    if (conn.type === "Skip Time") {
                        return conn.skipFrame;
                    }
                } else {
                    return null;
                }
            },
            /**
             * @description checks if has spreadsheet
             **/
            hasSpreadsheet: function() {
                var dc = this.getDataConnections();
                if (dc["region"].length || dc["default"].length) {
                    var conn;
                    if (dc["region"].length) {
                        conn = dc["region"][0];
                    } else {
                        conn = dc["default"][0];
                    }

                    if (conn && conn.row) {
                        this.customNameRef = conn.row;
                    }

                    return conn.type === "Spreadsheet";
                } else {
                    return false;
                }
            },
            /**
             * @description load spreadsheet information
             * @param {Function} callback callback
             **/
            loadFromSpreadsheet: function(callback) {
                var dc = this.getDataConnections();
                if (dc["region"].length || dc["default"].length) {
                    var conn;
                    if (dc["region"].length) {
                        conn = dc["region"][0];
                    } else {
                        conn = dc["default"][0];
                    }
                    if (conn.type === "Spreadsheet") {
                        var sheetId = conn.spreadsheetId;

                        if (!sheetId) {
                            console.error("Error - a spreadsheet id is missing for this data connection! - " + this.tagName);
                        }

                        return apiService.getSheetDataCdn(
                            sheetId,
                            function(data) {
                                callback(data);
                            },
                            function() {
                                PubSub.publish(globals.ERROR, new LogEvent(globals.ERROR, globals.ERRORS["5016"]));
                            }
                        );
                    }
                }
            },
            /**
             * @description load tag data
             * @param {Function} callback callback
             **/
            loadTagData: function(callback) {
                var tag = this;
                if (tag.hasData) {
                    if (this.hasSpreadsheet()) {
                        this.loadFromSpreadsheet(callback);
                    } else if (tag.appId && tag.appRef) {
                        this.loadWidgetData(
                            function(data) {
                                callback(data);
                            },
                            tag.appId,
                            tag.appRef,
                            "",
                            globals.LANG,
                            globals.LOCALE,
                            globals.COUNTRY_CODE,
                            tag.multiSheet
                        );
                    } else {
                        callback(null);
                    }
                } else {
                    callback(null);
                }
            },
            /**
             * @description load tag data
             **/
            getCustomConfigData: function() {
                var tag = this;
                var customConfigData = null;
                if (tag && tag.nameLink) {
                    customConfigData = _.findWhere(globals.CUSTOM_CONFIG_DATA, {
                        nameLink: tag.nameLink,
                        widgetId: null
                    });
                }
                return customConfigData;
            },
            /**
             * @description parse data from spreadsheet an set tagData
             * @param {Object} data spreadsheet data
             **/
            setTagData: function(data) {
                var tag = this;

                var groupedData = _.groupBy(data, "customnameref");
                data = groupedData[this.customNameRef];

                if (!data && tag.hasData) {
                    console.info("Data was not found for tag with spriteId " + this.spriteId + " and customNameRef " + this.customNameRef + " and name " + this.tagName);
                }

                this.tagData = data || [{}];

                if (data) {
                    tag.ingestWidgetData(data);
                }
            },
            /**
             * @description Override to do something with the spreadsheet data
             * @param {Object[]} data tagData
             **/
            ingestWidgetData: function(data) {
                // OVERRIDE TO DO SOMETHING WITH THE DOWNLOADED WIDGET DATA
            },
            /**
             * @description load widget data
             * @param {Function} success success
             * @param {String} appId appId
             * @param {String} appRef appRef
             * @param {String} customNameRef customNameRef
             * @param {String} lang lang
             * @param {String} locale locale
             * @param {String} countryCode countryCode
             * @param {Boolean} multiSheet multiSheet
             **/
            loadWidgetData: function(success, appId, appRef, customNameRef, lang, locale, countryCode, multiSheet) {
                data = {
                    appRef: appRef,
                    appId: appId,
                    customNameRef: customNameRef,
                    lang: lang,
                    locale: locale,
                    countryCode: countryCode,
                    widgetCdn: this.widgetCdn,
                    multiSheet: multiSheet
                };

                var successFn = function(data) {
                    this.loadWidgetDataSuccess(success, data);
                };

                var failFn = this.loadWidgetDataFail;

                apiService.loadWidgetData(data, successFn.bind(this), failFn.bind(this));
            },
            //TODO: make this private method -> put this inside loadWidgetData
            loadWidgetDataSuccess: function(success, data) {
                success(data);
            },
            //TODO: make this private method -> put this inside loadWidgetData
            loadWidgetDataFail: function() {
                PubSub.publish(globals.ERROR, new LogEvent(globals.ERROR, globals.ERRORS["5016"]));
            },
            /**
             * @description publish event when widget is closed. Override to do something when widget is closed.
             **/
            widgetClosed: function() {
                // Fix in place to prevent too many events on lesser devices
                window.setTimeout(function() {
                    PubSub.publish(globals.WIDGET_CLOSED);
                }, 100);
            },
            /**
             * @description get font
             * @param {String} fontFolder fontFolder
             * @param {String} fontName fontName
             * @param {String} fontFileName fontFileName
             * @param {Boolean} forceTTF forceTTF
             **/
            getFont: function(fontFolder, fontName, fontFileName, forceTTF) {
                this.toolkit.loadFont(fontFolder, fontName, fontFileName, forceTTF);
            },
            /**
             * @deprecated
             * @description (Deprecated ?) no idea what this does.
             * @returns {Boolean} overridePosition
             **/
            overridePosition: function() {
                return false;
            },
            /**
             * @description do clickout
             * @param {String} href url
             * @param {String} identifier identifier
             **/
            doClickout: function(href, identifier) {
                if (href.indexOf("EVENT_ONLY") !== -1) {
                    return;
                }

                this.openTagLink(this.appRef, this.nameLink, href, identifier, this.spriteId);
            },
            skipToTime: function(skipTime) {
                var tag = this;
                //PubSub.publish(globals.TAG_CLICK, {tag: tag});

                if (!window.wirewax.writer) {
                    globals.LOG("tag skipToTime " + skipTime);
                    PubSub.publish(globals.DO_SEEK, skipTime);
                    if (globals.IS_IE_8) {
                        globals.LOG("tag skipToTime play with delay" + skipTime);
                        window.setTimeout(function() {
                            globals.PLAY_FUNCTION(true);
                        }, 200);
                    } else {
                        globals.PLAY_FUNCTION(true);
                    }
                }
            },
            /**
             * @description open url
             * @param {String} appRef appRef
             * @param {String} nameLink nameLink
             * @param {String} href href
             * @param {String} identifier identifier
             * @param {String} spriteId spriteId
             **/
            openTagLink: function(appRef, nameLink, href, identifier, spriteId) {
                apiService.widgetLinkClick(appRef, nameLink, href, identifier, spriteId, this.noUtm, this.thisPage, this.publicData);
            },
            /**
             * @description Override to override tag css in each frame. Called every frame, so cation with the code inside this function.
             * @param {Object} frameData frameData
             * @returns {Object} css properties to override
             **/
            getKeyFrameCSS: function(frameData) {
                return {};
            },
            /**
             * @description Override to do something when player resizes
             **/
            onPlayerResize: function() {},
            /**
             * @description update tag countdowns and css when the player seeks
             **/
            onPlayerSeek: function() {
                var tag = this;

                if (tag.tagAnimTimeout) {
                    window.clearTimeout(tag.tagAnimTimeout);
                }

                _.each(tag.countdownPaths, function(path) {
                    $(path.node).clearQueue();
                    $(path.node).stop();
                    $(path.node).css({
                        "stroke-dashoffset": "9292px"
                    });
                });

                if ($(tag.element).css("display") === "none") {
                    $(tag.element)
                        .find(".animates-in")
                        .removeClass("show");
                    return;
                }

                $(tag.element)
                    .find(".animates-in")
                    .removeClass("show");

                window.setTimeout(function() {
                    tag.bringIn(tag);
                }, 10);
            },
            /**
             * @description update tag countdowns and css when the player starts seeking
             **/
            onPlayerPreSeek: function() {
                var tag = this;

                if (tag.tagAnimTimeout) {
                    window.clearTimeout(tag.tagAnimTimeout);
                }
                $(tag.element)
                    .find(".animates-in")
                    .removeClass("show");

                _.each(tag.countdownPaths, function(path) {
                    $(path.node).clearQueue();
                    $(path.node).stop();
                    $(path.node).css({
                        "stroke-dashoffset": "9292px"
                    });
                });
            },
            /**
             * @description add audio to play when mouse hover
             * @param {String} src audio src
             * @param {Number} volume volume
             **/
            addHoverInAudio: function(src, volume) {
                var tag = this;

                if (globals.CLICK_EVENT === "touchend") {
                    return;
                }

                if (!$("#waxxer #hover-audio-on").length) {
                    $("#waxxer").append('<audio style="display: none;" id="hover-audio-on" src="' + src + '"></audio>');
                }

                $(tag.element).hover(
                    function() {
                        tag.hoverAudioElemOn = $("#waxxer #hover-audio-on")[0];
                        tag.hoverAudioElemOn.volume = volume || 1;
                        tag.hoverAudioElemOn.play();
                    },
                    function() {
                        tag.hoverAudioElemOn.pause();
                        tag.hoverAudioElemOn.currentTime = 0;
                    }
                );
            },
            /**
             * @description add audio to play when tag is clicked
             * @param {String} src audio src
             * @param {Number} volume volume
             **/
            addClickAudio: function(src, volume) {
                var tag = this;

                if (globals.CLICK_EVENT === "touchend") {
                    return;
                }

                if (!$("#waxxer #click-audio").length) {
                    $("#waxxer").append('<audio style="display: none;" id="click-audio" src="' + src + '"></audio>');
                }

                tag.clickAudioElem = $("#waxxer #click-audio")[0];
                tag.clickAudioElem.volume = volume || 1;
            },
            /**
             * @typedef {Object} dataConnections
             * @property {Object} default The default spreadsheet details
             * @property {Object} region The user region spreadsheet details
             *
             * @description get the default and right region connection(spreadsheet details)
             * @returns {dataConnections} dataConnections dataConnections
             **/
            getDataConnections: function() {
                var specificConnections = _.where(this.dataConnections, { region: globals.COUNTRY });
                if (globals.COUNTRY === "GB" && specificConnections.length === 0) {
                    specificConnections = _.where(this.dataConnections, { region: "UK" });
                }

                var defaultConnections = _.where(this.dataConnections, { region: "Default" });
                return {
                    default: defaultConnections,
                    region: specificConnections
                };
            },
            /**
             * @author Richard Nias
             * @description Record a *widget action*.
             * It shouldn't be called "recordUiMetric" as a UI metric is something else.
             * @see ApiService#recordUiMetric
             * @param {String} identifier The event to record
             * @param {Number} appRef The reference to the widget (`this.appRef` if you're not sure, or just `null`)
             * @param {Number} actionType Enum representing action type (globals.WIDGET_METRIC_TYPES)
             */
            recordUiMetric: function(identifier, appRef, actionType) {
                apiService.recordUiMetric(identifier, appRef, 0, this.nameLink, this.spriteId, actionType);
            },
            positionUpdated: function(position) {
                // OVERRIDE TO DO SOMETHING WHEN THE 360 POSITION IS UPDATED
            }
        }
    );

    return BaseTagNew;
});

/*
 Super class for all tags that have a fixed element and a line that connects to a moving element
 */

wwplayer.define("TailTag", ["jquery", "BaseTagNew", "pubsub", "globals", "modernizr", "apiService", "DefaultToolkit", "LogEvent", "require-shim"], function(
    $,
    BaseTagNew,
    PubSub,
    globals,
    Modernizr,
    apiService,
    Toolkit,
    LogEvent,
    requireShim
) {
    var TailTag = BaseTagNew.extend(
        /** @lends TailTag.prototype */ {
            /**
             * @abstract
             * @extends BaseTagNew
             * @author legacy developers
             * @constructs TailTag
             * @property {HTMLElement} movingElement Element that tracks the tagged item in Studio
             * @property {HTMLElement} fixedElement Element that is fixed in place in the viewbox, can be positioned manually.
             * @property {HTMLElement} lineElement Element that reaches between the fixed and moving elements.
             * @description Abstract tail tag class. All tail tags should extend from this. Should be set as a Sticky tag in Studio. Includes Moving, Fixed and Line elements.
             * All properties from BaseTagNew can also be used.
             * ' "canPositionInBoundingBox" : true ' and ' "isLineTag" : true ' must be added in the database so the fixed element can be positioned in studio.
             *
             *
             * After creating the tag file with grunt change all references from ‘BaseTagNew’ to ‘TailTag’.
             *
             * For the fixed elements to pick up the correct position from Studio use getFixedElementData().
             **/

            parseTagData: function(tagData) {
                this._super(tagData);
                var movingElement = $('<div class="movingElement"></div>')[0];
                this.fixedElement = $('<div class="fixedElement"></div>')[0];
                this.lineElement = $('<div class="lineElement"></div>')[0];
                $(this.element).append(movingElement);
                $(this.element).append(this.fixedElement);
                $(this.element).append(this.lineElement);
                $(this.element).addClass("tail-tag");
                $(this.element)
                    .find(".tag-inner-box")
                    .detach()
                    .appendTo(movingElement);
                $(this.fixedElement);
                if (!tagData.isStatic) {
                    $(this.element).css({
                        position: "absolute",
                        display: "none",
                        left: "0px",
                        top: "0px",
                        height: "100%",
                        width: "100%",
                        "pointer-events": "none"
                    });
                }

                this.movingElement = movingElement;
                $(movingElement)
                    .css("position", "absolute")
                    .css("color", "white")
                    .css("pointer-events", "all");
                $(this.fixedElement)
                    .css("position", "absolute")
                    .css("color", "white")
                    .css("pointer-events", "all");
                $(this.lineElement)
                    .css("position", "absolute")
                    .css("color", "white")
                    .css("pointer-events", "all");
            },
            bindEvents: function() {
                this._super();
                var tag = this;
                if (tag.isStatic) {
                    $(this.element).bind(
                        globals.CLICK_EVENT,
                        function(e) {
                            e.stopPropagation();
                            e.preventDefault();
                            if (window.wirewax.embedLoc.indexOf("twitter") !== -1) {
                                this.twitterClick();
                            } else {
                                this.tagClick(e, true);
                            }
                        }.bind(this)
                    );
                } else {
                    $(this.fixedElement).bind(
                        globals.CLICK_EVENT,
                        function(e) {
                            e.stopPropagation();
                            e.preventDefault();
                            if (window.wirewax.embedLoc.indexOf("twitter") !== -1) {
                                this.twitterClick();
                            } else {
                                this.tagClick(e, true);
                            }
                        }.bind(this)
                    );
                }
            },
            /**
             * @description This must be included for the fixed elements to pick up the correct position from Studio.
             **/
            getFixedElementData: function() {
                return $.Deferred(function(defer) {
                    defer.resolve({
                        left: 0.2,
                        top: 0.2
                    });
                });
            },
            /**
             * @description calculates the distance and rotation to the tag line
             * @param {Object} startPoint
             * @param {Number} startPoint.top
             * @param {Number} startPoint.left
             * @param {Object} endPoint
             * @param {Number} endPoint.top
             * @param {Number} endPoint.left
             * @return {{top: number, left: number, width: number, rotate: number}}
             */
            calculateLine: function(startPoint, endPoint) {
                var rotate = Math.atan(((endPoint.top - startPoint.top) * 9) / ((endPoint.left - startPoint.left) * 16)) * (180 / Math.PI);
                return {
                    top: startPoint.top,
                    left: startPoint.left,
                    width: Math.sqrt(Math.pow((startPoint.left - endPoint.left) * 16, 2) + Math.pow((startPoint.top - endPoint.top) * 9, 2)) / 16,
                    rotate: endPoint.left < startPoint.left ? rotate + 180 : rotate
                };
            }
            /**
             * @description use this function to override the style of the tail tag elements
             * @param {Object} styles
             * @param {Object} styles.tagStyle
             * @param {Object} styles.fixedElementStyle
             * @param {Object} styles.movingElementStyle
             * @return {*}
             */
            // onFrameUpdate: function (styles) {
            //     return styles;
            // },
        }
    );

    return TailTag;
});

wwplayer.define("BaseWidget", ["jquery", "Class", "pubsub", "globals", "apiService", "LogEvent", "DefaultToolkit", "underscore"], function(
    $,
    Class,
    PubSub,
    globals,
    apiService,
    LogEvent,
    Toolkit,
    _
) {
    var self;
    /**
     * @author legacy developers
     * @module BaseWidget
     * @requires jquery, Class, DefaultToolkit, ApiService, pubSub, LogEvent, globals
     **/

    var BaseWidget = Class.extend(
        /** @lends BaseWidget.prototype */ {
            /**
             * @author legacy developers
             * @description The base class for widgets (overlays).
             * @constructs BaseWidget
             * @extends Class
             * @param {Tag} tag object representing the tag that opens this overlay.
             *
             * @property {Class} tag tag object
             * @property {Number|String} appRef appRef
             * @property {Number|String} appId appId
             * @property {Object} toolkit toolkit
             * @property {Object} customConfigData customConfigData
             * @property {Object} animationController animationController
             * @property {HTMLElement} widgetTemplate widgetTemplate
             **/
            init: function(tag) {
                self = this;
                this.tag = tag;
                this.appRef = tag.appRef;
                this.appId = tag.appId;
                if (tag.sheetData) this.sheetData = tag.sheetData;

                this.toolkit = Toolkit;
                this.customConfigData = this.getCustomConfigData();

                if (!this.tag.branchingOverlay) {
                    this.animationController = this.tag.animationController;
                }

                this.videoClickSubscribe = PubSub.subscribe(globals.HAS_VIDEO_CLICKED, function(e) {
                    self.closeClick(e);
                });

                this.widgetCloseSubscribe = PubSub.subscribe(globals.CLOSE_WIDGET, function() {
                    self.closeClick({});
                });

                if (!this.tag.branchingOverlay) {
                    var dc = this.tag.getDataConnections();
                    if (dc["region"].length || dc["default"].length) {
                        var conn;
                        if (dc["region"].length) {
                            conn = dc["region"][0];
                        } else {
                            conn = dc["default"][0];
                        }
                        if (conn.type === "Spreadsheet") {
                            self.waitingForTemplate = true;
                            var sheetId = conn.spreadsheetId;
                            apiService.getSheetDataCdn(
                                sheetId,
                                function(data) {
                                    self.sheetData = _.where(data, { customnameref: conn["row"] });
                                    if (!self.waitingForTemplate) {
                                        self.dataLoaded(self.sheetData);
                                    }
                                },
                                function() {
                                    PubSub.publish(globals.ERROR, new LogEvent(globals.ERROR, globals.ERRORS["5016"]));
                                }
                            );
                        }
                    }
                }

                this.loadStyle((cssUrl = window.wirewax.widgetUrl + "style/" + tag.widgetId + ".css"), function() {
                    if (self.hasTemplate) {
                        self.loadTemplate(
                            window.wirewax.widgetUrl + "templates/" + tag.widgetId + ".html",
                            function(template) {
                                self.widgetTemplate = self.getTemplate(template, tag);
                                if (!self.sheetData && !self.waitingForTemplate) {
                                    self.loadWidgetData(
                                        self.dataLoaded,
                                        self.appId,
                                        self.appRef,
                                        tag.customNameRef,
                                        globals.LANG,
                                        globals.LOCALE,
                                        this.countryCode ? this.countryCode : globals.COUNTRY,
                                        this.multiSheet
                                    );
                                } else {
                                    if (self.sheetData) {
                                        self.dataLoaded(self.sheetData);
                                    } else {
                                        self.waitingForTemplate = false;
                                    }
                                }
                            },
                            { cacheTemplate: self.cacheTemplate }
                        );
                    } else {
                        if (!self.sheetData && !self.waitingForTemplate) {
                            self.loadWidgetData(
                                self.dataLoaded,
                                self.appId,
                                self.appRef,
                                tag.customNameRef,
                                globals.LANG,
                                globals.LOCALE,
                                this.countryCode ? this.countryCode : globals.COUNTRY,
                                this.multiSheet
                            );
                        } else {
                            if (self.sheetData) {
                                self.dataLoaded(self.sheetData);
                            } else {
                                self.waitingForTemplate = false;
                            }
                        }
                    }
                });
            },
            /**
             * Load an HTML template given the template URL.
             * @throws 5028
             * @param {String} templateUrl
             * @param {Function} success callback
             * @param {Object} args arguments to pass to apiService#getTemplate
             * @see ApiService#getTemplate
             */
            loadTemplate: function(templateUrl, success, args) {
                var error = function() {
                    PubSub.publish(globals.ERROR, new LogEvent(globals.ERROR, globals.ERRORS["5028"]), {
                        callback: function() {
                            self.closeClick({ eventType: "error" });
                        }
                    });
                };

                apiService.getTemplate(templateUrl, success, error, args);
            },
            /**
             * Get the contents of the tag with id #widget-template
             * @param {String} template HTML string of template
             * @param {Tag} tag not used
             */
            getTemplate: function(template, tag) {
                return $(template)
                    .filter("#widget-template")
                    .html();
            },
            /**
             * Load a stylesheet by downloading from the URL and adding a `<style>` tag.
             * @param {String} styleUrl
             * @param {Function} [success] callback
             */
            loadStyle: function(styleUrl, success) {
                if ($("#wax-overlay-style-" + self.tag.widgetId).length === 0) {
                    var loadTimeStart = new Date().getTime();

                    if (globals.IS_IE_9 || globals.IS_IE_8) {
                        var cssElement = '<link id="wax-overlay-style-' + self.tag.widgetId + '" rel="stylesheet" type="text/css" href="' + styleUrl + '" />';
                        $("head").append(cssElement);
                        window.setTimeout(function() {
                            if (success) success();
                        }, 1000);
                    } else {
                        apiService.getCss(styleUrl, function(contents) {
                            PubSub.publish(globals.LOAD_METRIC, {
                                type: 3,
                                urls: [styleUrl],
                                loadTime: new Date().getTime() - loadTimeStart
                            });
                            $(document.head).append('<style id="wax-overlay-style-' + self.tag.widgetId + '">' + contents + "</style>");
                            if (success) success();
                        });
                    }
                } else {
                    success();
                }
            },
            /**
             * Close the overlay. Tells the metricsController to stop recording dwell time.
             * @param e eventType
             */
            closeClick: function(e) {
                $(self.element).remove();
                PubSub.unsubscribe(self.videoClickSubscribe);
                PubSub.unsubscribe(self.widgetCloseSubscrube);
                PubSub.publish(globals.WIDGET_ACTION, { widget: self, eventType: e, action: "close" });
                self.tag.widgetClosed();
            },
            /**
             * Show the overlay.
             */
            show: function() {
                PubSub.publish(globals.HIDE_LOADER);
            },
            /**
             * Populate the widget. If `window.callPhantom` exists, take a screenshot
             */
            populateWidget: function() {
                PubSub.publish(globals.HIDE_LOADER);
                PubSub.publish(globals.WIDGET_SHOWN);

                // Take screenshot of overlay
                if (globals.IS_PHANTOM) {
                    self.element.find(".animates-in").addClass("force-show");

                    window.setTimeout(function() {
                        window.callPhantom("takeShot");
                    }, 1000);
                }
            },
            /**
             * @author Jose Rego
             * @description load module custom config data
             **/
            getCustomConfigData: function() {
                var tag = this.tag;
                var customConfigData = null;
                if (tag && tag.nameLink && tag.widgetId) {
                    customConfigData = _.findWhere(globals.CUSTOM_CONFIG_DATA, {
                        nameLink: tag.nameLink,
                        widgetId: tag.widgetId
                    });
                }
                return customConfigData;
            },
            /**
             * @author legacy developers
             * @description Load widget data for the overlay. A convenient wrapper for ApiService#loadWidgetData
             * @param {Function} success callback to run
             * @param {Number} appId
             * @param {Number} appRef
             * @param {String} customNameRef
             * @param {String} [lang] Language. Defaults to `globals.LANG`.
             * @param {String} [locale] Defaults to `globals.LOCALE`.
             * @param {String} [countryCode] Defaults to `globals.COUNTRY`.
             * @param {Boolean} [multiSheet] If true, the spreadsheet has multiple sheets.
             * @see ApiService#loadWidgetData
             **/
            loadWidgetData: function(success, appId, appRef, customNameRef, lang, locale, countryCode, multiSheet) {
                if (!lang) {
                    lang = globals.LANG;
                }
                if (!locale) {
                    locale = globals.LOCALE;
                }
                if (!countryCode) {
                    countryCode = globals.COUNTRY;
                }
                data = {
                    appRef: appRef,
                    appId: appId,
                    customNameRef: customNameRef,
                    lang: lang,
                    locale: locale,
                    countryCode: countryCode,
                    widgetCdn: this.tag.widgetCdn,
                    multiSheet: multiSheet
                };

                apiService.loadWidgetData(
                    data,
                    function(data) {
                        self.loadWidgetDataSuccess(success, data);
                    },
                    function() {
                        self.loadWidgetDataFail();
                    }
                );
            },
            /**
             * Success callback for loadWidgetData
             * @param {Function} success
             * @param {Object} data
             * @see #loadWidgetData
             */
            loadWidgetDataSuccess: function(success, data) {
                if (success) success(data);
            },
            /**
             * Error callback for loadWidgetData
             * @see #loadWidgetData
             * @throws 5016
             */
            loadWidgetDataFail: function() {
                PubSub.publish(
                    globals.ERROR,
                    new LogEvent(globals.ERROR, globals.ERRORS["5016"], {
                        callback: function() {
                            self.closeClick({ eventType: "error" });
                        }
                    })
                );
            },
            /**
             * Get a clickout URL.
             * @deprecated
             * @param appRef
             * @param nameLink
             * @param href
             * @param identifier
             */
            getWidgetLink: function(appRef, nameLink, href, identifier) {
                return apiService.generateWidgetLink(appRef, nameLink, href, identifier);
            },
            /**
             * Wraps Toolkit#getFont
             * @see Toolkit#getFont
             * @param fontFolder
             * @param fontName
             * @param fontFileName
             * @param forceTTF
             * @param options
             */
            getFont: function(fontFolder, fontName, fontFileName, forceTTF, options) {
                this.toolkit.loadFont(fontFolder, fontName, fontFileName, forceTTF, options);
            },
            /**
             * @author Jose Rego
             * @description Record a *widget action*.
             * It shouldn't be called "recordUiMetric" as a UI metric is something else.
             * Wraps ApiService#recordUiMetric
             * @see ApiService#recordUiMetric
             * @param {String} identifier The event to record
             * @param {Number} appRef The reference to the widget (`self.appRef` if you're not sure)
             * @param {Number} actionType Enum representing action type (globals.WIDGET_METRIC_TYPES)
             */
            recordUiMetric: function(identifier, appRef, actionType) {
                apiService.recordUiMetric(identifier, appRef, 0, self.tag.nameLink, self.tag.spriteId, actionType);
            },
            /**
             * @author Richard Nias
             * @description Open a URL and record the appropriate UI action.
             * Wraps ApiService#widgetLinkClick
             * @see ApiService#recordUiMetric
             * @param {String} url The URL to open
             * @param {String} identifier something client specific e.g. "EPIX WATCH EPISODES"
             * @param {String} noUtm usually don't bother including this or anything below this
             * @param {String} thisPage set to true to open the link in the active tab rather than a new one… you pretty much never want to do this
             * @param {String} tagPublicData used in only a few situations
             */
            doClickout: function(url, identifier, noUtm, thisPage, tagPublicData) {
                apiService.widgetLinkClick(self.appRef || null, self.tag.nameLink || null, url, identifier || "", self.tag.spriteId || null, noUtm, thisPage, tagPublicData);
            }
        }
    );

    return BaseWidget;
});

wwplayer.define("BaseModule", ["jquery", "Class", "DefaultToolkit", "apiService", "pubsub", "LogEvent", "globals", "underscore"], function(
    $,
    Class,
    Toolkit,
    apiService,
    PubSub,
    LogEvent,
    globals,
    _
) {
    var self;
    /**
     * @author legacy developers
     * @author Jose Rego
     * @author Richard Nias
     * @module BaseModule
     * @requires jquery, Class, DefaultToolkit, ApiService, pubSub, LogEvent, globals
     **/

    var BaseModule = Class.extend(
        /** @lends BaseModule.prototype */ {
            /**
             * @author legacy developers
             * @author Richard Nias
             * @author Jose Rego
             * @description The base class for player modules.
             * @constructs BaseModule
             * @extends Class
             * @property {Object} interfaceController interfaceController
             * @property {Object} player player
             * @property {Object} animationController animationController
             * @property {Object} videoData videoData
             * @property {Object} tagController tagController
             * @property {Object} moduleData moduleData
             * @property {Object} toolkit toolkit
             * @property {Object} customConfigData customConfigData
             **/
            init: function(args) {
                self = this;
                this.interfaceController = args.interfaceController;
                this.player = args.player;
                this.animationController = args.animationController;
                this.videoData = args.videoData;
                this.tagController = args.tagController;
                this.moduleData = args.moduleData;
                this.toolkit = Toolkit;
                this.customConfigData = this.getCustomConfigData();
            },
            /**
             * @author legacy developers
             * @description Load the style sheet for a module by writing the content directly into a `<style>` tag
             * @param {String} styleUrl URL of the stylesheet
             * @param {Function} [success] callback to run on success.
             **/
            loadStyle: function(styleUrl, success) {
                $.get(styleUrl, function(contents) {
                    $(document.head).append("<style>" + contents + "</style>");
                    if (success) success();
                });
            },
            /**
             * @author legacy developers
             * @description Load the style sheet for a module by adding a `<link>` tag to the head of the document.
             * @param {String} styleUrl URL of the stylesheet
             **/
            loadStyleHead: function(styleUrl) {
                $("head").append('<link rel="stylesheet" type="text/css" href="' + styleUrl + '">');
            },
            /**
             * @author Jose Rego
             * @description load module custom config data
             **/
            getCustomConfigData: function() {
                var customConfigData = null;
                if (this.moduleData) {
                    customConfigData = _.findWhere(globals.CUSTOM_CONFIG_DATA, {
                        moduleId: this.moduleData.id
                    });
                }
                return customConfigData;
            },
            /**
             * @author legacy developers
             * @description Load widget data for the module. A convenient wrapper for ApiService#loadWidgetData
             * @param {Function} success callback to run
             * @param {Number} appId
             * @param {Number} appRef
             * @param {String} customNameRef
             * @param {String} [lang] Language. Defaults to `globals.LANG`.
             * @param {String} [locale] Defaults to `globals.LOCALE`.
             * @param {String} [countryCode] Defaults to `globals.COUNTRY`.
             * @param {Boolean} [loadFromCdn] If true, load the widget data from CDN.
             * @see ApiService#loadWidgetData
             **/
            loadWidgetData: function(success, appId, appRef, customNameRef, lang, locale, countryCode, loadFromCdn) {
                if (self.moduleData && self.moduleData.spreadsheet) {
                    return apiService.getSheetDataCdn(
                        this.moduleData.spreadsheet,
                        function(sheetData) {
                            self.sheetData = sheetData;
                            success(sheetData);
                        },
                        function() {
                            PubSub.publish(globals.ERROR, new LogEvent(globals.ERROR, globals.ERRORS["5016"]));
                        }
                    );
                }
                if (!lang) {
                    lang = globals.LANG;
                }
                if (!locale) {
                    locale = globals.LOCALE;
                }
                if (!countryCode) {
                    countryCode = globals.COUNTRY;
                }
                data = {
                    appRef: appRef,
                    appId: appId,
                    customNameRef: customNameRef,
                    lang: lang,
                    locale: locale,
                    countryCode: countryCode,
                    widgetCdn: loadFromCdn
                };
                apiService.loadWidgetData(data, success, self.loadDataError);
            },
            /**
             * @author legacy developers
             * @description Error handler for loadWidgetData
             **/
            loadDataError: function() {
                PubSub.publish(globals.ERROR, new LogEvent(globals.ERROR, globals.ERRORS["5016"]));
            },
            /**
             * @author Jose Rego
             * @description Record a *widget action*.
             * It shouldn't be called "recordUiMetric" as a UI metric is something else.
             * @see ApiService#recordUiMetric
             * @param {String} identifier The event to record
             * @param {Number} appRef The reference to the widget (`self.appRef` if you're not sure)
             * @param {Number} actionType Enum representing action type (globals.WIDGET_METRIC_TYPES)
             */
            recordUiMetric: function(identifier, appRef, actionType) {
                apiService.recordUiMetric(identifier, appRef, 0, "", "", actionType);
            },
            /**
             * @author Richard Nias
             * @summary Count this impression as a view.
             * @description Force metrics to start counting this impression as a view.
             * Useful when the main video does not start straightaway (e.g. Search Party)
             * Note: this does not call start on the metricsController,
             * so does not kick start the tracking of mouse movements / three sixty metrics etc.
             */
            recordViewStarted: function() {
                globals.LOG("TRIGGERING HAS PLAYED");
                PubSub.publish(globals.DO_HANDSHAKE, { hideIcon: true });
            },

            /**
             * @author Richard Nias
             * @summary Record a dummy tag click.
             * @description Record a tag click. Helpful for ensuring that active views are counted correctly.
             * The namelink and spriteId are options in case you want to associate this with a specific hotspot.
             * If they are not specified then the interactions will be listed as "unnamed tag" in reports.
             */
            recordInteraction: function(nameLink, spriteId) {
                apiService.metricsController.addTagClickData(globals.TAG_CLICK, {
                    tag: {
                        nameLink: nameLink || "",
                        spriteId: spriteId || ""
                    }
                });
            },
            /**
             * @author Richard Nias
             * @description Open a URL and record the appropriate UI action.
             * Wraps ApiService#widgetLinkClick
             * @see ApiService#recordUiMetric
             * @param {String} url The URL to open
             * @param {String} identifier something client specific e.g. "EPIX WATCH EPISODES"
             * @param {String} noUtm usually don't bother including this or anything below this
             * @param {String} thisPage set to true to open the link in the active tab rather than a new one… you pretty much never want to do this
             * @param {String} tagPublicData used in only a few situations
             */
            doClickout: function(url, identifier, noUtm, thisPage, tagPublicData) {
                apiService.widgetLinkClick(self.appRef || null, "", url, identifier || "", "", noUtm, thisPage, tagPublicData);
            },
            /**
             * @author Richard Nias
             * @description Record an overlay opening. Useful for ensuring that dwell time is correctly recorded.
             * **ALWAYS** accompany with a call to recordOverlayClose.
             */
            recordOverlayOpen: function() {
                PubSub.publish(globals.WIDGET_ACTION, { widget: { tag: {} }, eventType: null, action: "open" });
            },
            /**
             * @author Richard Nias
             * @description Record an overlay opening. Useful for ensuring that dwell time is correctly recorded.
             * Only use after a call to recordOverlayOpen
             */
            recordOverlayClose: function() {
                PubSub.publish(globals.WIDGET_ACTION, { widget: { tag: {} }, eventType: null, action: "close" });
            }
        }
    );

    return BaseModule;
});
/**
	@module UserMessage
	@requires jquery, PubSub, globals
**/
wwplayer.define("UserMessage", ["jquery", "pubsub", "globals"], function($, PubSub, globals) {
    /**
		Displays information to the user

		@class UserMessage
		@constructor
		@param {HTMLElement} element the element to put the message in
	**/
    var UserMessage = function(element) {
        var self = this;
        self.element = element;
        self.text = self.element.find(".message-text")[0];
        self.errorCodeText = self.element.find(".error-code-text")[0];

        /**
			Changes and displays the message in the UserMessage box

			@method changeMessage
			@param {String} event the name of the event
			@param {Object} errorObject the object containing the message content and code
		**/
        self.changeMessage = function(event, errorObject) {
            PubSub.publish(globals.HIDE_LOADER);
            PubSub.publish(globals.DO_PAUSE);

            if (errorObject.type === 1) {
                self.text.textContent = errorObject.displayMessage;
                self.errorCodeText.textContent = "#" + errorObject.code;
                self.element.find(".close-button").show();

                self.element.find(".close-button").bind(globals.CLICK_EVENT, function() {
                    $(this).unbind(globals.CLICK_EVENT);
                    self.dismissMessage();
                    if (errorObject.args && errorObject.args.callback) {
                        errorObject.args.callback();
                    }
                });
            } else {
                self.text.textContent = "This video is unavailable right now. Please try again later";
                self.errorCodeText.textContent = "#" + errorObject.code;
                self.element.find(".close-button").hide();
            }

            self.element.find(".reload-button").bind(globals.CLICK_EVENT, function() {
                $(this).unbind(globals.CLICK_EVENT);
                if (window.wirewax.reload) {
                    window.wirewax.reload();
                }
            });

            self.show();
        };

        /**
			Resets and hides the UserMessage box

			@method dismissMessage
		**/
        self.dismissMessage = function() {
            self.text.textContent = "";
            self.element.find(".close-button").hide();
            self.hide();
        };

        /**
			Shows the UserMessage element

			@method show
		**/
        self.show = function() {
            self.element.fadeIn("slow");
        };

        /**
			Hides the UserMessage element

			@method hide
		**/
        self.hide = function() {
            self.element.fadeOut("slow");
        };

        PubSub.subscribe(globals.SHOW_MESSAGE, self.changeMessage);
        PubSub.subscribe(globals.DISMISS_ERROR_MESSAGE, self.dismissMessage);
    };
    return UserMessage;
});

wwplayer.define("LoaderSlick", ["jquery", "text!templates/templates.html", "globals", "pubsub"], function($, Templates, globals, PubSub) {
    var LoaderSlick = function(element) {
        var self = this;
        self.element = element;
        self.shown = false;
        self.loaderTimeout = null;
        self.lastTimeShown = null;

        self.element.find(".reload-button").bind(globals.CLICK_EVENT, function() {
            $(this).unbind(globals.CLICK_EVENT);
            if (window.wirewax.reload) {
                window.wirewax.reload(window.wirewax.vidId);
            }
        });

        self.show = function(transparent) {
            self.shown = true;

            window.clearTimeout(self.loaderTimeout);

            if (globals.ENABLE_STALL_MESSAGES && globals.ALLOW_LOADER_VIDEO_RELOAD) {
                self.loaderTimeout = window.setTimeout(function() {
                    if (!globals.ALLOW_LOADER_VIDEO_RELOAD) {
                        return;
                    }
                    self.element.find(".infinite-throbber-message").fadeIn();
                    self.element.find(".reload-button").fadeIn();
                }, 25000);
            }

            if (transparent) {
                self.element.css("opacity", 0);
                self.element.fadeIn("fast");
            } else {
                self.element.fadeIn("fast");
            }

            self.lastTimeShown = new Date().getTime();
        };

        self.hide = function() {
            self.shown = false;
            window.clearTimeout(self.loaderTimeout);
            self.element.find(".infinite-throbber-message").hide();
            self.element.find(".reload-button").hide();
            self.element.fadeOut("fast");

            if (self.lastTimeShown) {
                var loadTimeDiff = new Date().getTime() - self.lastTimeShown;
                PubSub.publish(globals.THROBBER_METRIC, { event: 0, duration: loadTimeDiff, currentPlayerTime: globals.GET_CURRENT_PLAYING_TIME() });
            }

            self.lastTimeShown = null;
        };
    };

    return LoaderSlick;
});
/**
	@module Button
	@requires jquery, Class, globals
**/
wwplayer.define("Button", ["jquery", "Class", "globals"], function($, Class, globals) {
    /**
		Base Abstract class for all buttons

		@class Button
		@abstract
	**/
    var Button = Class.extend({
        /**
			Initialise

			@method init
			@constructor
			@param {HTMLElement} element the DOM element for the button
		**/
        init: function(element, invertFn, revertFn, onButtonShow, onButtonHide) {
            this.element = element;
            this.invertFn = invertFn;
            this.revertFn = revertFn;
            this.onButtonShow = onButtonShow || function() {};
            this.onButtonHide = onButtonHide || function() {};
            var self = this;
            $(this.element).on("mouseover " + globals.CLICK_EVENT, function(event) {
                self.stopEvent(event);
                self.mouseHoverStart();
            });
            $(this.element).on("touchend touchleave touchcancel", function(event) {
                self.stopEvent(event);
                self.touchEnd();
            });
            $(this.element).on("mouseleave", function(event) {
                self.stopEvent(event);
                self.mouseHoverEnd();
            });
            $(this.element).click(this.onClick);
        },
        /**
			Bind the click handler

			@method onClick
		**/
        onClick: function() {},
        /**
			Stops event default behaviour

			@method stopEvent
			@param {Event} event the event to prevent
		**/
        stopEvent: function(event) {
            if (event.preventDefault) {
                event.preventDefault();
            } else {
                event.returnValue = false;
            }
        },
        /**
			Bind the mouseover handler

			@method mouseHoverStart
		**/
        mouseHoverStart: function() {
            $(this.element).addClass("hover-effect");
            if (this.invertFn && globals.CLICK_EVENT === "click") this.invertFn();
        },
        /**
			Bind the mouseleave handler

			@method mouseHoverEnd
		**/
        mouseHoverEnd: function() {
            $(this.element).removeClass("hover-effect");
            if (this.revertFn) this.revertFn();
        },
        /**
			Bind the touchend handler

			@method touchEnd
		**/
        touchEnd: function() {
            $(this.element).removeClass("hover-effect");
            this.onClick();
        },
        /**
			Hide this element

			@method hide
		**/
        hide: function() {
            $(this.element).hide();
            if (this.onButtonHide) {
                this.onButtonHide();
            }
        },
        /**
			Show this element

			@method show
		**/
        show: function() {
            $(this.element).show();
            if (this.onButtonShow) {
                this.onButtonShow();
            }
        }
    });

    return Button;
});
/**
	@module BottomBarPlayButton
	@requires jquery, Button, PubSub, globals
**/
wwplayer.define("BottomBarPlayButton", ["jquery", "Button", "pubsub", "globals"], function($, Button, PubSub, globals) {
    /**
		Plays the video

		@class BottomBarPlayButton
		@extends Button
	**/
    var BottomBarPlayButton = Button.extend({
        /**
			Initialise

			@method init
			@constructor
			@param {HTMLElement} element the DOM element for the button
		**/
        init: function(element, invertFn, revertFn, onButtonShow, onButtonHide) {
            this._super(element, invertFn, revertFn, onButtonShow, onButtonHide);

            // Wirewax debugging console
            this.element.bind("touchstart", function() {
                self.showConsole = window.setTimeout(function() {
                    PubSub.publish(globals.SHOW_CONSOLE);
                    self.showConsole = null;
                }, 5000);
            });

            this.element.bind("touchend", function() {
                if (self.showConsole) window.clearTimeout(self.showConsole);
            });
        },
        /**
			Bind the click handler

			@method onClick
		**/
        onClick: function() {
            this._super();
            $("#video-container").load();
            globals.PLAY_FUNCTION();
        },
        /**
			Bind the mouseover handler

			@method mouseHoverStart
		**/
        mouseHoverStart: function() {
            this._super();
        },
        /**
			Bind the mouseleave handler

			@method mouseHoverEnd
		**/
        mouseHoverEnd: function() {
            this._super();
        },
        /**
			Bind the touchend handler

			@method touchEnd
		**/
        touchEnd: function() {
            this._super();
            $(this.element)
                .find(".play-image")
                .show();
            $(this.element)
                .find(".play-image-invert")
                .hide();
        }
    });

    return BottomBarPlayButton;
});
/**
	@module BottomBarPauseButton
	@requires jquery, Button, PubSub, globals
**/
wwplayer.define("BottomBarPauseButton", ["jquery", "Button", "pubsub", "globals"], function($, Button, PubSub, globals) {
    /**
		Pauses the video

		@class BottomBarPauseButton
		@extends Button
	**/
    var BottomBarPauseButton = Button.extend({
        /**
			Initialise

			@method init
			@constructor
			@param {HTMLElement} element the DOM element for the button
		**/
        init: function(element, invertFn, revertFn, onButtonShow, onButtonHide) {
            this._super(element, invertFn, revertFn, onButtonShow, onButtonHide);
        },
        /**
			Bind the click handler

			@method onClick
		**/
        onClick: function() {
            this._super();
            PubSub.publish(globals.DO_PAUSE);
        },
        /**
			Bind the mouseover handler

			@method mouseHoverStart
		**/
        mouseHoverStart: function() {
            this._super();
            $(this.element)
                .find(".pause-image")
                .hide();
            $(this.element)
                .find(".pause-image-invert")
                .show();
        },
        /**
			Bind the mouseleave handler

			@method mouseHoverEnd
		**/
        mouseHoverEnd: function() {
            this._super();
            $(this.element)
                .find(".pause-image")
                .show();
            $(this.element)
                .find(".pause-image-invert")
                .hide();
        },
        /**
			Bind the touchend handler

			@method touchEnd
		**/
        touchEnd: function() {
            this._super();
            $(this.element)
                .find(".pause-image")
                .show();
            $(this.element)
                .find(".pause-image-invert")
                .hide();
        }
    });

    return BottomBarPauseButton;
});
wwplayer.define("ScrubberSlick", ["jquery", "underscore", "pubsub", "globals", "BottomBarPlayButton", "LogEvent", "BottomBarPauseButton", "raphael", "modernizr"], function(
    $,
    _,
    PubSub,
    globals,
    BottomBarPlayButton,
    LogEvent,
    BottomBarPauseButton,
    Raphael,
    Modernizr
) {
    var Scrubber = function(element) {
        var self = this;

        self.elements = {};
        self.scrubberBar = element;
        self.scrubberCover = self.scrubberBar.find(".scrubber-cover")[0];
        self.scrubberBarTags = [];

        self.scrubber = self.scrubberBar.find(".scrubber")[0];
        self.videoFrame = self.scrubberBar.find(".video-frame")[0];
        self.scrubberLine = self.scrubberBar.find(".scrubber-line")[0];
        self.scrubberBarInner = self.scrubberBar.find(".inner-bar")[0];
        self.videoDurationText = self.scrubberBar.find(".video-duration")[0];
        self.videoPlayTimeText = self.scrubberBar.find(".video-playtime")[0];

        self.bufferBar = self.scrubberBar.find(".buffer")[0];

        self.innerBar = self.scrubberBar.find(".inner-bar")[0];
        self.scrubLeftOffset = 0;
        self.lockTimer = 0;
        self.lastBuffer = 0;

        PubSub.subscribe(globals.HAS_PAUSED, function() {
            $(self.scrubberBar).removeClass("playing");
        });

        var videoFrameSrc = "//edge-thumbs.wirewax.com/" + window.wirewax.vidId + "/videoThumbCake_2D.jpg";
        $(self.videoFrame).css({
            background: "url(" + videoFrameSrc + ") no-repeat",
            "background-position": "0% 0%"
        });
        // Get dimensions of the videoThumbCake so we can work out number of rows/columns
        // Super hacky but we don't have the right info in vidData.json (added 7/9/16)
        // set default values in case the user clicks play before the image loads
        self.videoFrameWidth = 10;
        self.videoFrameHeight = 10;
        var temp = new Image();
        temp.src = videoFrameSrc;
        temp.addEventListener("load", function() {
            self.videoFrameWidth = temp.width;
            self.videoFrameHeight = temp.height;
            self.calculateThumbcakeLayout();
        });

        self.disableScrubber = function() {
            self.disabled = true;
            $(self.scrubber).hide();
        };

        self.formatTime = function(timetoFormat) {
            timetoFormat = timetoFormat < 0 ? 0 : timetoFormat;
            timetoFormat = timetoFormat > self.videoDuration ? self.videoDuration : timetoFormat;

            timerMinutes = Math.floor(timetoFormat / 60);
            formatMinutes = String(timerMinutes);
            timerSeconds = parseInt(timetoFormat % 60, 10);

            if (timerSeconds < 10) {
                formatSeconds = "0" + timerSeconds;
            } else {
                formatSeconds = timerSeconds;
            }

            return formatMinutes + ":" + formatSeconds;
        };

        self.setSize = function(innerBarWidth) {};

        self.addTag = function(tagArray, index) {
            tagArray[0].clipIndex = tagArray[0].staticClipIndex ? tagArray[0].staticClipIndex : tagArray[0].clipIndex;

            if (!self.disabled) {
                var innerBar = $(self.scrubberBarInner);
                var scrubberTag = $(
                    '<div id="scrubber-tag-' +
                        tagArray[0].clipIndex +
                        '" class="scrubber-tag scrubber-tag-index-' +
                        (index > 20 ? 20 : index) +
                        '"><div class="scrubber-tag-ball"></div><div class="scrubber-tag-hitzone"></div><div class="scrubber-tag-box"><span> tags:</span>' +
                        tagArray.length +
                        "</div></div>"
                );
                var perc = tagArray[0].tagStartTime / self.videoDuration;
                scrubberTag.css("left", perc * 100 + "%");
                innerBar.append(scrubberTag);
                scrubberTag.initalLeft = perc;
                if (perc * innerBar.width() < 14) {
                    scrubberTag.addClass("far-left");
                } else if (innerBar.width() - perc * innerBar.width() < 14) {
                    scrubberTag.addClass("far-right");
                }
                self.scrubberBarTags.push(scrubberTag);
            }
        };

        self.addTimelineMarker = function(marker) {
            if (!self.disabled) {
                var left = (marker.time / self.videoDuration) * 100;
                marker.setLeftPosition(left + "%");
                $(self.innerBar).append(marker.element);
            }
        };

        self.setDuration = function(duration) {
            self.videoDuration = duration;
            self.videoDurationText.innerHTML = self.formatTime(duration);

            var defaultNumThumbs = Math.max(100, Math.min(1000, duration)) - 1; // -1 since 0 indexed
            self.defaultThumbWidth = 160;
            var defaultThumbHeight = 90;

            if (window.wirewax.vidThumbcake) {
                self.setThumbcakeData(window.wirewax.vidThumbcake.numThumbs, window.wirewax.vidThumbcake.thumbWidth, window.wirewax.vidThumbcake.thumbHeight);
            } else {
                self.setThumbcakeData(defaultNumThumbs, self.defaultThumbWidth, defaultThumbHeight);
            }
        };

        self.setThumbcakeData = function(numThumbs, thumbWidth, thumbHeight) {
            self.numThumbs = numThumbs;
            self.thumbWidth = thumbWidth;
            self.thumbHeight = thumbHeight;
            var widthRatio = 1,
                enlargeRatio = 1;
            if (thumbWidth > self.defaultThumbWidth) {
                // has bigger thumbnails, updated 01/06/2018
                widthRatio = self.defaultThumbWidth / self.thumbWidth;
                enlargeRatio = 100 / widthRatio / 100;
                $(self.scrubber)
                    .find(".video-frame")
                    .css({ width: self.thumbWidth + "px", height: self.thumbHeight + "px", zoom: widthRatio });
                $(self.scrubber)
                    .find(".video-playtime")
                    .css({ zoom: enlargeRatio });
                $(self.scrubber)
                    .find(".video-duration")
                    .css({ zoom: enlargeRatio });
            }
            self.calculateThumbcakeLayout();
        };

        self.calculateThumbcakeLayout = function() {
            self.thumbCols = self.videoFrameWidth / self.thumbWidth;
            self.thumbRows = self.videoFrameHeight / self.thumbHeight;
        };

        self.resize = function() {
            self.scrubNumber = $(self.innerBar).width();
            self.updateScrubber(self.lastProgress, self.lastBuffer, true);
        };

        self.updateScrubber = function(videoProgress, bufferProgress, force) {
            if ((videoProgress === self.lastProgress && bufferProgress === self.lastBuffer && !force) || !videoProgress || self.disabled) {
                return;
            }
            if (!self.scrubNumber || self.scrubNumber <= 0) {
                self.resize();
            }
            if (!self.videoDuration) {
                PubSub.publish(globals.ERROR, new LogEvent(globals.ERROR, globals.ERRORS["5005"]));
            }
            if (videoProgress > self.videoDuration) {
                //Internet Explorer doesn't know when the video ends and carries on playing, this stops it
                videoProgress = self.videoDuration;
            }
            if ((videoProgress !== self.lastProgress && self.lockTimer === 0) || force) {
                self.videoPlayTimeText.innerHTML = self.formatTime(videoProgress);
                var percentPlay = parseFloat(videoProgress / self.videoDuration);
                self.scrubber.style["left"] = percentPlay * self.scrubNumber + "px";
                self.scrubberLine.style["width"] = percentPlay * self.scrubNumber + "px";
                updateVideoFrame(percentPlay);
            }
            if (bufferProgress !== self.lastBuffer || force) {
                var percentBuffered = parseFloat(bufferProgress / self.videoDuration);
                self.bufferBar.style.width = Math.min(percentBuffered, 1) * self.scrubNumber + "px";
            }

            if (globals.IS_PLAYING()) {
                $(self.scrubberBar).addClass("playing");
            }

            self.lastProgress = videoProgress;
            self.lastBuffer = bufferProgress;
        };

        function updateVideoFrame(percentPlay) {
            percentPlay = percentPlay < 0 ? 0 : percentPlay;
            percentPlay = percentPlay > 100 ? 100 : percentPlay;
            var n = Math.floor(percentPlay * self.numThumbs);
            var frameXOffset = -Math.floor(n % self.thumbCols) * self.thumbWidth;
            var frameYOffset = -Math.floor(n / self.thumbCols) * self.thumbHeight;
            var videoFrameOffset = frameXOffset + "px " + frameYOffset + "px";
            var offsetLeft = self.scrubNumber * percentPlay;

            if (offsetLeft < 74) {
                $(self.videoFrame).css("margin-left", -offsetLeft + 5 + "px");
            } else if (self.scrubNumber - offsetLeft < 90) {
                var offset = self.scrubNumber - offsetLeft > 0 ? self.scrubNumber - offsetLeft : 0;
                $(self.videoFrame).css("margin-left", Math.max(-163 + offset, -170) + "px");
            } else {
                $(self.videoFrame).css("margin-left", "-74px");
            }

            self.videoFrame.style["background-position"] = videoFrameOffset;
        }

        $(self.scrubber).bind("mouseover", function() {
            $(self.scrubber).addClass("hover-effect");
        });

        $(self.scrubber).bind("mouseleave", function() {
            $(self.scrubber).removeClass("hover-effect");
        });

        var onMouseMoveEvent = _.throttle(function(event) {
            if (self.lockTimer === 1) {
                var e = event.originalEvent;
                if (e.preventDefault) {
                    if (e.preventDefault) {
                        e.preventDefault();
                    } else {
                        e.returnValue = false;
                    }
                }

                if (self.hideTimeout) {
                    window.clearTimeout(self.hideTimeout);
                }

                event.stopImmediatePropagation();
                var posX;
                if (e.changedTouches !== undefined) {
                    posX = e.changedTouches[0].pageX - $(self.scrubberBarInner).offset().left;
                } else {
                    posX = (globals.IS_IE_8 ? e.clientX + document.body.scrollLeft : e.pageX) - $(self.scrubberBarInner).offset().left;
                }

                var innerBarWidth = self.scrubNumber;
                updateVideoFrame(posX / (innerBarWidth - 4));
                self.videoPlayTimeText.innerHTML = self.formatTime((posX / innerBarWidth) * self.videoDuration);

                var secondsPerPixel = self.videoDuration / innerBarWidth;
                pixels = posX;
                pixels = Math.max(pixels, 0);
                pixels = Math.min(pixels, innerBarWidth - 4);
                time = secondsPerPixel * pixels;
                self.scrubberLine.style["width"] = posX + "px";

                $(self.scrubber).css({
                    left: pixels
                });
            }
        }, 40);

        $(document).bind("touchmove mousemove", onMouseMoveEvent);

        $(document).bind("touchend mouseup mouseleave", function(event) {
            if (self.lockTimer === 1) {
                self.lockTimer = 0;
                var e = event.originalEvent;
                if (e.preventDefault) {
                    e.preventDefault();
                } else {
                    e.returnValue = false;
                }

                var posX;
                if (e.changedTouches !== undefined) {
                    posX = e.changedTouches[0].pageX - $(self.scrubberBarInner).offset().left;
                    self.hoverOut(4000);
                } else {
                    posX = (globals.IS_IE_8 ? e.clientX + document.body.scrollLeft : e.pageX) - $(self.scrubberBarInner).offset().left;
                }

                var secondsPerPixel = self.videoDuration / $(self.scrubberBarInner).width();
                pixels = posX;
                pixels = Math.max(pixels, 0);
                time = secondsPerPixel * pixels;

                self.scrubberLine.style["width"] = pixels + "px";
                $(self.scrubber).removeClass("dragging");

                PubSub.publish(globals.DO_SEEK, time);
                PubSub.publish(globals.UI_EVENT, {
                    eventName: "scrubEnd",
                    eventId: 4
                });
            }
        });

        $(self.scrubberCover).bind("touchstart mousedown", function(event) {
            if (!self.disabled) {
                PubSub.publish(globals.HIDE_TAG);
                event.preventDefault();
                event.stopImmediatePropagation();
                var e = event.originalEvent;

                $(self.scrubber).addClass("dragging");
                self.lockTimer = 1;
                PubSub.publish(globals.UI_EVENT, {
                    eventName: "scrubStart",
                    eventId: 3
                });

                self.hoverIn();
            }
        });

        $(self.innerBar).bind("mousedown", function(event) {
            if (!self.disabled) {
                var xOffset = event.offsetX ? event.offsetX : event.pageX - $(self.innerBar).offset().left;

                if (
                    event.target !== this &&
                    $(event.target)
                        .parent()
                        .hasClass("scrubber-tag")
                ) {
                    // clicked on the scrubber tag hitzone
                    xOffset = parseInt(
                        $(event.target)
                            .parent()
                            .css("left")
                    );
                }

                self.scrubber.style["left"] = xOffset + "px";
                self.scrubberLine.style["width"] = xOffset + "px";

                PubSub.publish(globals.DO_SEEK, (xOffset / $(self.innerBar).width()) * self.videoDuration);
            }
        });

        $(self.scrubber).bind("mousemove", function(event) {
            event.stopPropagation();
            event.preventDefault();
        });

        $(self.scrubber).bind("mouseleave", function(event) {
            event.stopPropagation();
            event.preventDefault();
        });

        $(self.scrubberBar).on("mouseover mousemove touchend touchmove", function(e) {
            if (self.hideTimeout) {
                window.clearTimeout(self.hideTimeout);
            }
        });

        PubSub.subscribe(globals.HAS_PLAYED, function() {
            if (!self.startedPlaying) {
                self.startedPlaying = true;
            }

            self.hiddenScrubber = globals.HIDE_SCRUBBER;
            self.scrubberBar.show();

            if (!self.hiddenScrubber) {
                self.scrubberBar.css({
                    bottom: 0
                });
                self.scrubberBar.addClass("show");
            }
        });

        PubSub.subscribe(globals.VIDEO_END, function() {
            self.hiddenScrubber = false;
            self.scrubberBar.css({
                bottom: 0
            });
        });

        if (!globals.IS_DESKTOP) {
            PubSub.subscribe(globals.HAS_PAUSED, function() {
                self.hiddenScrubber = false;
                self.hoverIn();
                self.hoverOut(2000);
            });
        }

        $(window).resize(function() {
            window.setTimeout(function() {
                self.resize();
            }, 300);
        });

        self.hideScrubber = function() {
            $(self.scrubber).addClass("hidden");
        };

        self.showScrubber = function() {
            $(self.scrubber).removeClass("hidden");
        };

        self.hideScrubberBoxes = function() {
            $(self.scrubber)
                .find(".scrubber-tag.active")
                .removeClass("active");
        };

        self.hoverIn = function() {
            if (self.hideTimeout) {
                window.clearTimeout(self.hideTimeout);
                self.hideTimeout = null;
            }

            self.scrubberBar.css({
                bottom: 0
            });

            if (self.startedPlaying) {
                self.scrubberBar.addClass("show");
            }
        };

        self.hoverOut = function(timeout) {
            timeout = timeout || 1000;
            if (!self.hideTimeout) {
                self.hideTimeout = window.setTimeout(function() {
                    self.scrubberBar.css({
                        bottom: -1 * self.scrubberBar.height()
                    });

                    self.scrubberBar.removeClass("show");
                    self.hideTimeout = null;
                }, timeout);
            }
        };
    };
    return Scrubber;
});

wwplayer.define("PlayButton", ["jquery", "Button", "pubsub", "globals"], function($, Button, PubSub, globals) {
    var self;
    var PlayButton = Button.extend({
        init: function(element, animationController) {
            this.element = element;
            self = this;
            self.animationController = animationController;
            this.element.bind(globals.CLICK_EVENT, this.onClick);
        },
        flashIn: function() {
            $(self.element).css({ visibility: "visible" });
            $(self.element)
                .find("svg")
                .show();
            self.animationController.animateTo(self.element[0], 0.4, { opacity: 0.8, transform: "scale(1.3,1.3)" }, 0, "ease-out", function() {});

            window.setTimeout(function() {
                self.animationController.animateTo(self.element[0], 0.4, { opacity: 0, transform: "scale(1,1)" }, 0, "none", function() {});

                window.setTimeout(function() {
                    $(self.element).css({ visibility: "hidden" });
                    $(self.element)
                        .find("svg")
                        .hide();
                }, 400);
            }, 400);
            self.element.unbind("click");
        },
        onClick: function() {
            globals.PLAY_FUNCTION();
        }
    });

    return PlayButton;
});
wwplayer.define("PauseButton", ["jquery", "Button", "pubsub", "globals"], function($, Button, PubSub, globals) {
    var self;
    var PauseButton = Button.extend({
        init: function(element, animationController) {
            this.element = element;
            self = this;
            self.animationController = animationController;
            $(self.element).css({ visibility: "hidden" });
        },
        flashIn: function() {
            $(self.element).css({ visibility: "visible" });
            $(self.element).show();
            $(self.element)
                .find("svg")
                .show();
            self.animationController.animateTo(self.element[0], 0.4, { opacity: 0.8, transform: "scale(1.3,1.3)" }, 0, "ease-out", function() {});

            window.setTimeout(function() {
                self.animationController.animateTo(self.element[0], 0.4, { opacity: 0, transform: "scale(1,1)" }, 0, "none", function() {});

                window.setTimeout(function() {
                    $(self.element).css({ visibility: "hidden" });
                    $(self.element)
                        .find("svg")
                        .hide();
                }, 400);
            }, 400);
            self.element.unbind("click");
        }
    });

    return PauseButton;
});
/**
 @module ShareController
 @requires jquery, PubSub, globals, underscore, ApiService
 **/
wwplayer.define("ShareControllerSlick", ["jquery", "Class", "pubsub", "globals", "underscore", "apiService"], function($, Class, PubSub, globals, _, apiService) {
    /*
     New share controller using class and more configs.
     globals.SHARE_BUTTONS - array with the buttons to show
     globals.SHARE_BG_COLOR - background color
     globals.SHARE_ICON_COLOR - icon color
     globals.SHARE_TEXT - override text to be shared
     globals.SHARE_URL - override url to be shared
     */
    var shareController2 = Class.extend({
        init: function() {
            if (!globals.WHITELABEL) {
                return;
            }
            this.element = $('<div id="shares-version-2"></div>');
            this.showing = false;
            this.shareText = globals.SHARE_TEXT || "https://view.wirewax.com/" + window.wirewax.vidId;
            this.shareUrl = globals.SHARE_URL || "https://view.wirewax.com/" + window.wirewax.vidId;
            this.socialButtons = [];

            this.buildShareButton();
            $.each(
                globals.SHARE_BUTTONS,
                function(index, shareButton) {
                    switch (shareButton) {
                        case globals.SHARE_BUTTON_TYPES.FACEBOOK:
                            this.buildFacebookButton();
                            break;
                        case globals.SHARE_BUTTON_TYPES.TWITTER:
                            this.buildTwitterButton();
                            break;
                        case globals.SHARE_BUTTON_TYPES.LINKEDIN:
                            this.buildLinkedinButton();
                            break;
                        case globals.SHARE_BUTTON_TYPES.PINTEREST:
                            this.buildPinterestButton();
                            break;
                        case globals.SHARE_BUTTON_TYPES.EMBED:
                            this.buildEmbedButton();
                            break;
                    }
                }.bind(this)
            );

            PubSub.subscribe(globals.HAS_PLAYED, this.hide.bind(this));
            PubSub.subscribe(globals.HAS_VIDEO_CLICKED, this.hide.bind(this));

            //expend jquery easings
            $.easing = Object.assign({}, $.easing, {
                easeInExpo: function(x, t, b, c, d) {
                    return t == 0 ? b : c * Math.pow(2, 10 * (t / d - 1)) + b;
                },
                easeOutExpo: function(x, t, b, c, d) {
                    return t == d ? b + c : c * (-Math.pow(2, (-10 * t) / d) + 1) + b;
                }
            });
        },
        show: function() {
            if (!this.showing) {
                this.element.addClass("expanded");
                this.showing = true;
                PubSub.publish(globals.UI_EVENT, {
                    eventName: "socialShareButton",
                    eventId: globals.UI_EVENTS.SOCIAL_SHARE_BUTTON
                });
                $.each(
                    this.socialButtons,
                    function(index, button) {
                        var distance = 40;
                        var delay = 100;
                        var buttonPosition = -1 * (distance + distance * index);
                        // button.css({left: -1 * buttonPosition + "px"});
                        var startProterties = {
                            left: buttonPosition + distance,
                            "z-index": this.socialButtons.length - index,
                            opacity: 0
                        };
                        var animatePropertes = {
                            left: buttonPosition,
                            opacity: 1
                        };
                        var animateOptions = {
                            duration: 300,
                            easing: "easeOutExpo"
                        };
                        button
                            .css(startProterties)
                            .delay(delay * index)
                            .animate(animatePropertes, animateOptions);
                    }.bind(this)
                );
            }
        },
        hide: function() {
            if (this.showing) {
                this.element.removeClass("expanded");
                this.showing = false;
                $.each(
                    this.socialButtons,
                    function(index, button) {
                        var delay = 50;
                        var animatePropertes = {
                            left: 0,
                            opacity: 0,
                            "z-index": 0
                        };
                        var animateOptions = {
                            duration: 300,
                            easing: "easeInExpo"
                        };
                        button.delay(delay * index).animate(animatePropertes, animateOptions);
                    }.bind(this)
                );
            }
        },
        toggle: function() {
            if (this.showing) {
                this.hide();
            } else {
                this.show();
            }
        },
        buildShareButton: function() {
            var icon =
                '<svg class="expand-icon" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100;" xml:space="preserve"><circle fill="' +
                globals.SHARE_BG_COLOR +
                '" cx="50" cy="50" r="41.5"/><path fill="' +
                globals.SHARE_ICON_COLOR +
                '" d="M50,0C22.4,0,0,22.4,0,50c0,27.6,22.4,50,50,50c27.6,0,50-22.4,50-50C100,22.4,77.6,0,50,0z M38.4,50.1c0,0.7-0.1,1.3-0.2,2l19.4,9.6c2-2.2,4.9-3.6,8-3.6c6,0,10.9,4.9,10.9,10.9c0,6-4.9,10.9-10.9,10.9 c-6,0-10.9-4.9-10.9-10.9c0,0,0-0.1,0-0.1L34.2,58.7c-1.8,1.4-4.2,2.3-6.7,2.3c-6,0-10.9-4.9-10.9-10.9c0-6,4.9-10.9,10.9-10.9 c3.1,0,5.9,1.3,7.8,3.4l19.5-10.3c-0.1-0.4-0.1-0.9-0.1-1.3c0-6,4.9-10.9,10.9-10.9c6,0,10.9,4.9,10.9,10.9c0,6-4.9,10.9-10.9,10.9 c-2.8,0-5.3-1-7.2-2.7L38.4,49.7C38.4,49.9,38.4,50,38.4,50.1z"/></svg>';
            var expandedIcon =
                '<svg class="expanded-icon" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100;" xml:space="preserve"><circle fill="' +
                globals.SHARE_ICON_COLOR +
                '" cx="50" cy="50" r="50"/> <path fill="' +
                globals.SHARE_BG_COLOR +
                '" d="M64.3,52.1L38.5,72.5C38.1,72.8,37.6,73,37,73c-1.4,0-2.5-1.1-2.5-2.5c0-0.7,0.3-1.5,1-2L59.4,50L35.5,31.5 c-0.7-0.6-1-1.3-1-2c0-1.4,1.1-2.5,2.5-2.5c0.6,0,1.1,0.2,1.5,0.5l25.9,20.4c0.6,0.5,1.2,1.1,1.2,2.1S65,51.7,64.3,52.1z"/> <path fill="' +
                globals.SHARE_BG_COLOR +
                '" d="M37,75.5c-2.8,0-5-2.2-5-5c0-1.6,0.7-3.1,2-4L55.3,50L34,33.5c-1.3-1-2-2.4-2-4c0-2.8,2.2-5,5-5 c1.1,0,2.1,0.3,3,1l25.9,20.5c1.8,1.3,2.2,2.9,2.2,4.1c0,1.2-0.4,2.8-2.2,4.1L40,74.5C39.1,75.2,38.1,75.5,37,75.5z"/></svg>';
            var button = $('<div class="expand-button"></div>').append(icon, expandedIcon);
            button.bind(globals.CLICK_EVENT, this.toggle.bind(this));
            this.element.append(button);
        },
        buildFacebookButton: function() {
            var icon =
                '<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100;" xml:space="preserve"> <circle fill="' +
                globals.SHARE_ICON_COLOR +
                '" cx="50" cy="50" r="42.2"/><path fill="' +
                globals.SHARE_BG_COLOR +
                '" d="M50,0C22.4,0,0,22.4,0,50c0,27.6,22.4,50,50,50c27.6,0,50-22.4,50-50 C100,22.4,77.6,0,50,0z M64.8,29.4c0,0-5,0-7,0c-2.5,0-3,1-3,3.6c0,2.1,0,6.2,0,6.2h10l-1,10.8h-9v32.3H41.9V50.1h-6.7v-11h6.7 c0,0,0-1.6,0-8.6c0-8.1,4.3-12.3,13.9-12.3c1.6,0,8.9,0,8.9,0V29.4L64.8,29.4z"/> </svg>';
            var button = $('<div class="facebook-button"></div>').append(icon);
            button.bind(
                globals.CLICK_EVENT,
                function() {
                    PubSub.publish(globals.DO_PAUSE);
                    PubSub.publish(globals.UI_EVENT, { eventName: "facebook", eventId: globals.UI_EVENTS.FACEBOOK });
                    apiService.widgetShareClick("fb", this.shareText, this.shareUrl, null, "");
                }.bind(this)
            );
            this.socialButtons.push(button);
            this.element.append(button);
        },
        buildTwitterButton: function() {
            var icon =
                '<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"viewBox="0 0 100 100" style="enable-background:new 0 0 100 100;" xml:space="preserve"><circle fill="' +
                globals.SHARE_ICON_COLOR +
                '" cx="50" cy="50" r="42.2"/><path fill="' +
                globals.SHARE_BG_COLOR +
                '" d="M50,0C22.4,0,0,22.4,0,50c0,27.6,22.4,50,50,50c27.6,0,50-22.4,50-50C100,22.4,77.6,0,50,0z M75.1,41.4c0.7,16.3-11.4,34.5-33,34.5c-6.5,0-12.6-1.9-17.8-5.2c6.2,0.7,12.3-1,17.2-4.8c-5.1-0.1-9.4-3.4-10.8-8.1c1.8,0.3,3.6,0.2,5.2-0.2c-5.6-1.1-9.4-6.1-9.3-11.5c1.6,0.9,3.4,1.4,5.3,1.5c-5.2-3.5-6.6-10.3-3.6-15.5c5.7,7,14.3,11.6,23.9,12.1c-1.7-7.3,3.8-14.2,11.3-14.2c3.3,0,6.4,1.4,8.5,3.7c2.6-0.5,5.1-1.5,7.4-2.8c-0.9,2.7-2.7,5-5.1,6.4c2.3-0.3,4.6-0.9,6.7-1.8C79.4,37.7,77.4,39.8,75.1,41.4z"/></svg>';
            var button = $('<div class="twitter-button"></div>').append(icon);
            button.bind(
                globals.CLICK_EVENT,
                function() {
                    PubSub.publish(globals.DO_PAUSE);
                    PubSub.publish(globals.UI_EVENT, { eventName: "twitter", eventId: globals.UI_EVENTS.TWITTER });
                    apiService.widgetShareClick("tw", this.shareText, this.shareUrl, null, "");
                }.bind(this)
            );
            this.socialButtons.push(button);
            this.element.append(button);
        },
        buildLinkedinButton: function() {
            var icon =
                '<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"viewBox="0 0 100 100" style="enable-background:new 0 0 100 100;" xml:space="preserve"><circle fill="' +
                globals.SHARE_ICON_COLOR +
                '" cx="50" cy="50" r="42.2"/><path fill="' +
                globals.SHARE_BG_COLOR +
                '" d="M50,0C22.4,0,0,22.4,0,50c0,27.6,22.4,50,50,50c27.6,0,50-22.4,50-50C100,22.4,77.6,0,50,0z M36.7,74.2h-11V38.7h11V74.2z M31.1,34.1c-3.6,0-6.5-2.9-6.5-6.5c0-3.6,2.9-6.5,6.5-6.5c3.6,0,6.5,2.9,6.5,6.5C37.6,31.1,34.7,34.1,31.1,34.1z M77.8,74.2H66.9c0,0,0-13.5,0-18.6c0-5.1-1.9-8-6-8c-4.4,0-6.7,3-6.7,8c0,5.5,0,18.6,0,18.6H43.7V38.7h10.5v4.8c0,0,3.2-5.9,10.7-5.9c7.5,0,12.9,4.6,12.9,14.1C77.8,61.2,77.8,74.2,77.8,74.2z"/></svg>';
            var button = $('<div class="linkedin-button"></div>').append(icon);
            button.bind(
                globals.CLICK_EVENT,
                function() {
                    PubSub.publish(globals.DO_PAUSE);
                    //TODO: event id ?
                    // PubSub.publish(globals.UI_EVENT, {eventName: 'twitter', eventId: 20});
                    apiService.widgetShareClick("li", this.shareText, this.shareUrl, null, "");
                }.bind(this)
            );
            this.socialButtons.push(button);
            this.element.append(button);
        },
        buildPinterestButton: function() {
            var icon =
                '<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"viewBox="0 0 100 100" style="enable-background:new 0 0 100 100;" xml:space="preserve"><circle fill="' +
                globals.SHARE_ICON_COLOR +
                '" cx="50" cy="50" r="42.2"/><path fill="' +
                globals.SHARE_BG_COLOR +
                '" d="M50,0C22.4,0,0,22.4,0,50c0,27.6,22.4,50,50,50c27.6,0,50-22.4,50-50C100,22.4,77.6,0,50,0z M56.6,66.5c-3.9,0-7.6-2.1-8.8-4.5c0,0-2.1,8.3-2.5,9.9c-1.6,5.7-6.2,11.4-6.5,11.8c-0.2,0.3-0.8,0.2-0.9-0.2c-0.1-0.7-1.3-7.9,0.1-13.8c0.7-2.9,4.7-19.7,4.7-19.7s-1.2-2.3-1.2-5.7c0-5.4,3.1-9.4,7-9.4c3.3,0,4.9,2.5,4.9,5.4c0,3.3-2.1,8.3-3.2,12.8c-0.9,3.8,1.9,7,5.7,7c6.9,0,11.5-8.8,11.5-19.2c0-7.9-5.3-13.9-15.1-13.9c-11,0-17.8,8.2-17.8,17.3c0,3.2,0.9,5.4,2.4,7.1c0.7,0.8,0.8,1.1,0.5,2c-0.2,0.7-0.6,2.3-0.7,2.9c-0.2,0.9-1,1.2-1.8,0.9c-5.1-2.1-7.4-7.6-7.4-13.8c0-10.3,8.7-22.6,25.9-22.6c13.8,0,22.9,10,22.9,20.7C76.1,55.9,68.2,66.5,56.6,66.5z"/></svg>';
            var button = $('<div class="pinterest-button"></div>').append(icon);
            button.bind(
                globals.CLICK_EVENT,
                function() {
                    PubSub.publish(globals.DO_PAUSE);
                    //TODO: event id ?
                    // PubSub.publish(globals.UI_EVENT, {eventName: 'twitter', eventId: 20});
                    apiService.widgetShareClick("pt", this.shareText, this.shareUrl, null, "");
                }.bind(this)
            );
            this.socialButtons.push(button);
            this.element.append(button);
        },
        buildEmbedButton: function() {
            var icon =
                '<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"viewBox="0 0 100 100" style="enable-background:new 0 0 100 100;" xml:space="preserve"><path fill="' +
                globals.SHARE_BG_COLOR +
                '" d="M100,50c0,27.6-22.4,50-50,50C22.4,100,0,77.6,0,50C0,22.4,22.4,0,50,0C77.6,0,100,22.4,100,50z"/><path fill="' +
                globals.SHARE_ICON_COLOR +
                '" d="M55.5,23.8c3.9-0.1,5.5,1.9,4.4,5.6c-4.2,14.4-8.3,28.8-12.5,43.1c-1.1,3.7-2.1,4.2-5.6,3c-2-0.7-2.6-1.9-2.1-3.9c4.4-15.2,8.8-30.4,13.2-45.6C53.3,24.7,54.2,24,55.5,23.8z"/><path fill="' +
                globals.SHARE_ICON_COLOR +
                '"  d="M35,69.4c-1.1,0-1.7-0.6-2.4-1.2c-5.2-5.2-10.5-10.5-15.7-15.7c-1.9-1.9-1.8-3,0.1-4.9c5.2-5.2,10.3-10.4,15.6-15.6c2-1.9,3.2-1.8,5.3,0.3c2.1,2.1,2.2,3.3,0.2,5.3c-3.5,3.5-7,7.1-10.6,10.5c-1.5,1.4-1.7,2.2-0.1,3.7c3.6,3.4,7.1,7,10.6,10.5c1.1,1.1,2,2.3,1.2,3.8C38.3,67.6,37.1,69.2,35,69.4z"/><path fill="' +
                globals.SHARE_ICON_COLOR +
                '"  d="M64.9,69.4c-2-0.3-3.2-1.8-4.1-3.4c-0.8-1.3,0-2.5,1.1-3.6c3.7-3.6,7.2-7.3,10.9-10.9c1.3-1.3,1.2-2,0-3.2c-3.6-3.4-7.1-7-10.6-10.5c-2.3-2.3-2.3-3.4,0-5.7c2.2-2.2,3.3-2.2,5.5,0c5.1,5.1,10.1,10.1,15.2,15.2c2.1,2.1,2.1,3.1,0,5.3c-5,5.1-10.1,10.1-15.2,15.2C66.9,68.7,66.1,69.5,64.9,69.4z"/></svg>';
            var button = $('<div class="embed-button"></div>').append(icon);
            button.bind(globals.CLICK_EVENT, function() {
                PubSub.publish(globals.DO_PAUSE);
                PubSub.publish(globals.OPEN_SHARE_SCREEN);
            });
            this.socialButtons.push(button);
            this.element.append(button);
        }
    });

    // current/old share controller. It doesnt have any configuration
    var shareController = function(element, vidId, animationController, getFrame, getCurrentTime, onShareButtonClick) {
        var self = this;

        self.onShareButtonClick = onShareButtonClick;
        self.showing = false;
        self.element = $(element);

        var drawShareButton = function(element) {
            var rsr = Raphael(element.find(".innerSvg")[0], "100%", "100%");
            rsr.setViewBox(0, 0, 100, 100, true);
            var buttonSvg = rsr.pathWithShadow(
                "M74.5,19.8L23.3,41.5 M14.5,38.3c-7.6,0-13.8,6.2-13.8,13.8c0,7.6,6.2,13.8,13.8,13.8c7.6,0,13.8-6.2,13.8-13.8C28.3,44.5,22.1,38.3,14.5,38.3z M86.5,3c-7,0-12.7,5.7-12.7,12.7s5.7,12.7,12.7,12.7s12.7-5.7,12.7-12.7C99.1,8.7,93.4,3,86.5,3z M73.8,82.6l-50.4-20 M99.1,84.3c0-7-5.7-12.7-12.7-12.7s-12.7,5.7-12.7,12.7S79.4,97,86.4,97S99.1,91.3,99.1,84.3z",
                4,
                4,
                5
            );
            buttonSvg.attr({
                fill: "transparent",
                stroke: "#ffffff",
                "stroke-width": 1,
                "stroke-linejoin": "round"
            });

            return {
                animateOpen: function() {
                    buttonSvg.animate({ path: "M1.3,91.6l95.2-43.7 M2,8.8l94.4,39" }, 200);
                    buttonSvg.shadow.animate({ path: "M1.3,91.6l95.2-43.7 M2,8.8l94.4,39" }, 200);
                },
                animateClose: function() {
                    buttonSvg.animate(
                        {
                            path:
                                "M74.5,19.8L23.3,41.5 M14.5,38.3c-7.6,0-13.8,6.2-13.8,13.8c0,7.6,6.2,13.8,13.8,13.8c7.6,0,13.8-6.2,13.8-13.8C28.3,44.5,22.1,38.3,14.5,38.3z M86.5,3c-7,0-12.7,5.7-12.7,12.7s5.7,12.7,12.7,12.7s12.7-5.7,12.7-12.7C99.1,8.7,93.4,3,86.5,3z M73.8,82.6l-50.4-20 M99.1,84.3c0-7-5.7-12.7-12.7-12.7s-12.7,5.7-12.7,12.7S79.4,97,86.4,97S99.1,91.3,99.1,84.3z"
                        },
                        200
                    );
                    buttonSvg.shadow.animate(
                        {
                            path:
                                "M74.5,19.8L23.3,41.5 M14.5,38.3c-7.6,0-13.8,6.2-13.8,13.8c0,7.6,6.2,13.8,13.8,13.8c7.6,0,13.8-6.2,13.8-13.8C28.3,44.5,22.1,38.3,14.5,38.3z M86.5,3c-7,0-12.7,5.7-12.7,12.7s5.7,12.7,12.7,12.7s12.7-5.7,12.7-12.7C99.1,8.7,93.4,3,86.5,3z M73.8,82.6l-50.4-20 M99.1,84.3c0-7-5.7-12.7-12.7-12.7s-12.7,5.7-12.7,12.7S79.4,97,86.4,97S99.1,91.3,99.1,84.3z"
                        },
                        200
                    );
                }
            };
        };

        var drawMoreShareButton = function(element) {
            var rsr = Raphael(element.find(".innerSvg")[0], "100%", "100%");
            rsr.setViewBox(0, 0, 100, 100, true);
            var buttonSvg = rsr.pathWithShadow("M30.318,63.976L1.102,47.968l29.216-15.767 M69.682,63.976L98.898,48.21L69.682,32.201 M37.043,80.5l21.98-61", 4, 4, 5);
            buttonSvg.attr({
                fill: "transparent",
                stroke: "#ffffff",
                "stroke-width": 3,
                "stroke-linejoin": "round"
            });

            element.bind(globals.CLICK_EVENT, function() {
                PubSub.publish(globals.DO_PAUSE);
                onShareButtonClick();
            });
        };

        var drawFacebookShareButton = function(element, shareText, shareUrl) {
            var rsr = Raphael(element.find(".innerSvg")[0], "100%", "100%");
            rsr.setViewBox(0, 0, 100, 100, true);
            var buttonSvg = rsr.pathWithShadow(
                "M38.5 98.5V53h-12V36.6h12v-14c0-11 7.1-21.1 23.5-21.1 6.6 0 11.5.6 11.5.6l-.4 15.3s-5-.1-10.5-.1c-5.9 0-6.9 2.7-6.9 7.2v12h17.8L72.8 53h-17v45.5H38.5z",
                6,
                6,
                6
            );
            buttonSvg.attr({
                fill: "transparent",
                stroke: "#ffffff",
                "stroke-width": 3,
                "stroke-linejoin": "round"
            });

            element.bind(globals.CLICK_EVENT, function() {
                PubSub.publish(globals.DO_PAUSE);
                PubSub.publish(globals.UI_EVENT, { eventName: "facebook", eventId: globals.UI_EVENTS.FACEBOOK });
                apiService.widgetShareClick("fb", shareText, shareUrl, null, "");
            });
        };

        var drawTwitterShareButton = function(element, shareText, shareUrl) {
            var rsr = Raphael(element.find(".innerSvg")[0], "100%", "100%");
            rsr.setViewBox(0, 0, 100, 100, true);
            var buttonSvg = rsr.pathWithShadow(
                "M89.142 29.925c.04.866.06 1.737.06 2.613C89.2 59.226 68.886 90 31.738 90 20.333 90 9.717 86.656.78 80.926c1.58.187 3.188.282 4.818.282 9.462 0 18.17-3.228 25.082-8.646-8.837-.162-16.296-6.002-18.866-14.025 1.234.236 2.5.362 3.8.362 1.842 0 3.626-.248 5.32-.71-9.238-1.854-16.2-10.017-16.2-19.802 0-.085 0-.17.002-.254 2.722 1.512 5.837 2.42 9.147 2.526-5.42-3.622-8.985-9.804-8.985-16.81 0-3.702.996-7.17 2.734-10.153 9.96 12.22 24.843 20.26 41.627 21.1-.345-1.477-.524-3.02-.524-4.6C48.738 19.042 57.78 10 68.934 10c5.81 0 11.057 2.453 14.74 6.378 4.602-.905 8.923-2.586 12.826-4.9-1.508 4.715-4.71 8.673-8.88 11.172 4.085-.488 7.978-1.573 11.6-3.18-2.708 4.05-6.132 7.608-10.078 10.455z",
                8,
                8,
                8
            );
            buttonSvg.attr({
                fill: "transparent",
                stroke: "#ffffff",
                "stroke-width": 3,
                "stroke-linejoin": "round"
            });

            element.bind(globals.CLICK_EVENT, function() {
                PubSub.publish(globals.DO_PAUSE);
                PubSub.publish(globals.UI_EVENT, { eventName: "twitter", eventId: globals.UI_EVENTS.TWITTER });
                apiService.widgetShareClick("tw", shareText, shareUrl, null, "");
            });
        };

        var shareButtonAnimationCallbacks = drawShareButton(self.element.find("#bottom-bar-share-button"));
        drawTwitterShareButton(
            self.element.find("#tw-share"),
            globals.SHARE_TEXT || "https://view.wirewax.com/" + window.wirewax.vidId,
            globals.SHARE_URL || "https://view.wirewax.com/" + window.wirewax.vidId
        );
        drawFacebookShareButton(
            self.element.find("#fb-share"),
            globals.SHARE_TEXT || "https://view.wirewax.com/" + window.wirewax.vidId,
            globals.SHARE_URL || "https://view.wirewax.com/" + window.wirewax.vidId
        );
        drawMoreShareButton(self.element.find("#more-share"), "", "");

        self.show = function() {
            if (!self.showing) {
                PubSub.publish(globals.UI_EVENT, {
                    eventName: "socialShareButton",
                    eventId: globals.UI_EVENTS.SOCIAL_SHARE_BUTTON
                });
                shareButtonAnimationCallbacks.animateOpen();
                $(self.element).addClass("expanded");
                self.showing = true;
            }
        };

        /**
         Hides the share buttons
         @method hide
         **/
        self.hide = function() {
            if (self.showing) {
                $(self.element).removeClass("expanded");
                shareButtonAnimationCallbacks.animateClose();
                self.showing = false;
            }
        };

        PubSub.subscribe(globals.HAS_PLAYED, self.hide);
        PubSub.subscribe(globals.HAS_VIDEO_CLICKED, self.hide);

        if (globals.IS_WINDOWS_PHONE) {
            self.element.find("#bottom-bar-share-button").bind("click", function() {
                if (self.showing) {
                    self.hide();
                } else {
                    self.show();
                }
            });
        } else {
            self.element.find("#bottom-bar-share-button").bind(globals.CLICK_EVENT, function() {
                if (self.showing) {
                    self.hide();
                } else {
                    self.show();
                }
            });
        }
    };

    // Check what version of the share buttons it should use
    // globals.SHARE_VERSION - the version to be used
    return function(element, vidId, animationController, getFrame, getCurrentTime, onShareButtonClick) {
        if (globals.SHARE_VERSION == globals.SHARE_VERSIONS.VERSION_2) {
            $.extend(this, new shareController2());
        } else {
            $.extend(this, new shareController(element, vidId, animationController, getFrame, getCurrentTime, onShareButtonClick));
        }
    };
});

wwplayer.define("BottomBarFullscreenButtonSlick", ["jquery", "Button", "pubsub", "globals"], function($, Button, PubSub, globals) {
    var self;

    var BottomBarFullscreenButton = Button.extend({
        /**
        Toggles fullscreen viewing

    	@constructs BottomBarFullscreenButtonSlick
        @extends Button
    	@param {HTMLElement} element the DOM element for the button
    **/

        init: function(element, invertFn, revertFn) {
            self = this;
            self.invertFn = invertFn;
            self.revertFn = revertFn;

            this._super(element, invertFn, revertFn);
            PubSub.subscribe(globals.CANCEL_FULLSCREEN, self.cancelFullscreen);
        },

        isFullscreen: function() {
            return document.fullscreenElement || document.mozFullScreenElement || document.webkitFullscreenElement || document.msFullscreenElement;
        },

        cancelFullscreen: function() {
            if (self.isFullscreen()) {
                self.toggleFullscreen();
            }
        },

        toggleFullscreen: function() {
            if (!self.isFullscreen()) {
                if (document.documentElement.requestFullscreen) {
                    document.documentElement.requestFullscreen();
                    self.revertFn();
                } else if (document.documentElement.mozRequestFullScreen) {
                    document.documentElement.mozRequestFullScreen();
                    self.revertFn();
                } else if (document.documentElement.webkitRequestFullscreen) {
                    document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);
                    self.revertFn();
                } else if (document.documentElement.msRequestFullscreen) {
                    // msRequestFullscreen doesnt work on document.documentElement
                    $("body")[0].msRequestFullscreen();
                    self.revertFn();
                } else if (!globals.DISABLE_MOBILE_FULLSCREEN) {
                    window.open(
                        "https://embed.wirewax.com/" +
                            window.wirewax.vidId +
                            "/?timeStamp=" +
                            globals.GET_CURRENT_PLAYING_TIME() +
                            "&uuId=" +
                            window.wirewax.uuId +
                            "&autoStart=true"
                    );
                } else {
                    alert(globals.STRINGS["FEATURE_NOT_SUPPORTED"]);
                }

                PubSub.publish(globals.UI_EVENT, {
                    eventName: "fullScreen",
                    eventId: 5
                });
            } else {
                if (document.cancelFullScreen) {
                    self.invertFn();
                    document.cancelFullScreen();
                } else if (document.exitFullscreen) {
                    self.invertFn();
                    document.exitFullscreen();
                } else if (document.msCancelFullscreen) {
                    self.invertFn();
                    document.msCancelFullscreen();
                } else if (document.msExitFullscreen) {
                    self.invertFn();
                    document.msExitFullscreen();
                } else if (document.mozCancelFullScreen) {
                    self.invertFn();
                    document.mozCancelFullScreen();
                } else if (document.mozExitFullscreen) {
                    self.invertFn();
                    document.mozExitFullscreen();
                } else if (document.webkitCancelFullScreen) {
                    self.invertFn();
                    document.webkitCancelFullScreen();
                } else if (document.webkitExitFullscreen) {
                    self.invertFn();
                    document.webkitExitFullscreen();
                }

                PubSub.publish(globals.UI_EVENT, {
                    eventName: "normalScreen",
                    eventId: 6
                });
            }
        },

        /**
    	Bind the click handler
        @name BottomBarFullscreenButtonSlick#onClick
    	@method
    **/
        onClick: function() {
            self.toggleFullscreen();
        },
        /**
    	Bind the mouseover handler
    	@method
        @name BottomBarFullscreenButtonSlick#mouseHoverStart
    **/
        mouseHoverStart: function() {},
        /**
    	Bind the mouseleave handler
    	@method
        @name BottomBarFullscreenButtonSlick#mouseHoverEnd
    **/
        mouseHoverEnd: function() {},
        /**
    	Bind the touchend handler
    	@method
        @name BottomBarFullscreenButtonSlick#touchEnd
    **/
        touchEnd: function() {
            this._super();
        }
    });

    return BottomBarFullscreenButton;
});
wwplayer.define("BottomBarSubtitleController", ["jquery", "pubsub", "globals", "underscore", "apiService"], function($, PubSub, globals, _, apiService) {
    var bottomBarSubtitleController = function(element, invertFn, revertFn, subtitles, switchSubtitles) {
        var self = this;

        self.element = $(element);

        var subtitleSVGs = [];

        _.each(subtitles, function(subtitle, index) {
            if (subtitle.label === "RECOG") {
                self.element.append('<a class="speech button-' + index + ' hover-colorable hover-icon"><div class="innerSvg"></div></a>');
                var speech = self.element.find(".speech");

                if (subtitle["default"]) {
                    speech.addClass("active hover-effect");
                }

                var rsr = Raphael(speech.find(".innerSvg")[0], "100%", "100%");
                rsr.setViewBox(0, 0, 23, 20.25, true);
                var Speech = rsr.path(
                    "M15.933,19.745c-0.158,0-0.313-0.062-0.429-0.18l-4.954-5.049H3.188c-1.434,0-2.6-1.166-2.6-2.6v-8.66 c0-1.434,1.166-2.6,2.6-2.6h16.604c1.434,0,2.6,1.166,2.6,2.6v8.66c0,1.434-1.166,2.6-2.6,2.6h-3.257l-0.003,4.629 c0,0.244-0.147,0.463-0.373,0.556C16.086,19.731,16.009,19.745,15.933,19.745z M3.188,1.856c-0.771,0-1.4,0.629-1.4,1.4v8.66 c0,0.771,0.629,1.4,1.4,1.4h7.614c0.161,0,0.315,0.064,0.429,0.18l4.103,4.182l0.003-3.762c0-0.332,0.269-0.6,0.6-0.6h3.856 c0.771,0,1.4-0.629,1.4-1.4v-8.66c0-0.771-0.629-1.4-1.4-1.4H3.188z M11.614,10.217h-6.25c-0.331,0-0.6-0.269-0.6-0.6 s0.269-0.6,0.6-0.6h6.25c0.331,0,0.6,0.269,0.6,0.6S11.945,10.217,11.614,10.217z M17.614,6.017H5.364c-0.331,0-0.6-0.269-0.6-0.6 s0.269-0.6,0.6-0.6h12.25c0.331,0,0.6,0.269,0.6,0.6S17.945,6.017,17.614,6.017z"
                );
                Speech.attr({ id: "Speech", fill: subtitle["default"] ? globals.BUTTON_BACKGROUND_COLOR : window.wirewax.colour, "stroke-width": "0", "stroke-opacity": "1" }).data(
                    "id",
                    "Speech"
                );

                subtitleSVGs.push(Speech);

                speech.bind("mouseenter", function() {
                    if (speech.hasClass("active")) {
                        return;
                    }

                    speech.addClass("hover-effect");
                    Speech.attr({ fill: globals.BUTTON_BACKGROUND_COLOR });
                });

                speech.bind("mouseleave", function() {
                    if (speech.hasClass("active")) {
                        return;
                    }

                    speech.removeClass("hover-effect");
                    Speech.attr({ fill: window.wirewax.colour });
                });

                speech.bind(globals.CLICK_EVENT, function() {
                    var isActive = speech.hasClass("active");
                    self.element.find(".active").removeClass("active hover-effect");
                    _.each(subtitleSVGs, function(svg) {
                        svg.attr({ fill: window.wirewax.colour });
                    });

                    if (isActive) {
                        switchSubtitles("OFF");
                    } else {
                        switchSubtitles(subtitle.label);
                        speech.addClass("active hover-effect");
                        Speech.attr({ fill: globals.BUTTON_BACKGROUND_COLOR });
                    }
                });
            } else if (subtitle.label === "OCR") {
                self.element.append('<a class="abc button-' + index + ' hover-colorable hover-icon"><div class="innerSvg"></div></a>');
                var abc = self.element.find(".abc");

                if (subtitle["default"]) {
                    abc.addClass("active hover-effect");
                }

                var rsr = Raphael(abc.find(".innerSvg")[0], "100%", "100%");
                rsr.setViewBox(0, 0, 23, 20.25, true);
                var Text = rsr.path(
                    "M1.05,18.167c-0.152,0-0.305-0.057-0.421-0.172c-0.236-0.233-0.239-0.613-0.007-0.849l4.021-4.082 c0.536,0.521,0.166,0.193,0.401,0.427c0.236,0.233,0,0,0.454,0.415l-4.021,4.082C1.36,18.108,1.205,18.167,1.05,18.167z M16.314,8.771c0-3.688-2.96-6.688-6.599-6.688c-3.638,0-6.598,3-6.598,6.688c0,3.689,2.96,6.69,6.598,6.69 C13.354,15.461,16.314,12.46,16.314,8.771z M15.115,8.771c0,3.027-2.423,5.491-5.399,5.491s-5.398-2.464-5.398-5.491 c0-3.026,2.422-5.489,5.398-5.489S15.115,5.745,15.115,8.771z M22.55,12.218c0-0.276-0.224-0.5-0.5-0.5h-7.271 c-0.276,0-0.5,0.224-0.5,0.5s0.224,0.5,0.5,0.5h7.271C22.326,12.718,22.55,12.495,22.55,12.218z M22.55,7.566 c0-0.276-0.224-0.5-0.5-0.5h-5.814c-0.276,0-0.5,0.224-0.5,0.5s0.224,0.5,0.5,0.5h5.814C22.326,8.066,22.55,7.842,22.55,7.566z M15.52,6.266c0-0.441-0.358-0.8-0.8-0.8H9.723c-0.441,0-0.8,0.358-0.8,0.8s0.358,0.8,0.8,0.8h4.997 C15.161,7.066,15.52,6.708,15.52,6.266z M15.52,11c0-0.441-0.358-0.8-0.8-0.8H9.723c-0.441,0-0.8,0.358-0.8,0.8s0.358,0.8,0.8,0.8 h4.997C15.161,11.8,15.52,11.442,15.52,11z"
                );
                Text.attr({ id: "Text", fill: subtitle["default"] ? globals.BUTTON_BACKGROUND_COLOR : window.wirewax.colour, "stroke-width": "0", "stroke-opacity": "1" }).data(
                    "id",
                    "Text"
                );

                subtitleSVGs.push(Text);

                abc.bind("mouseenter", function() {
                    if (abc.hasClass("active")) {
                        return;
                    }

                    abc.addClass("hover-effect");
                    Text.attr({ fill: globals.BUTTON_BACKGROUND_COLOR });
                });

                abc.bind("mouseleave", function() {
                    if (abc.hasClass("active")) {
                        return;
                    }

                    abc.removeClass("hover-effect");
                    Text.attr({ fill: window.wirewax.colour });
                });

                abc.bind(globals.CLICK_EVENT, function() {
                    var isActive = abc.hasClass("active");
                    self.element.find(".active").removeClass("active hover-effect");
                    _.each(subtitleSVGs, function(svg) {
                        svg.attr({ fill: window.wirewax.colour });
                    });

                    if (isActive) {
                        switchSubtitles("OFF");
                    } else {
                        switchSubtitles(subtitle.label);
                        abc.addClass("active hover-effect");
                        Text.attr({ fill: globals.BUTTON_BACKGROUND_COLOR });
                    }
                });
            }
        });

        self.show = function() {
            if (!self.showing) {
                self.showing = true;
                self.element.addClass("show");
                self.element.addClass("hover-effect");
                // $('#subtitle-sidebar').addClass('showing');
                PubSub.publish(globals.SHOW_SUBTITLES);
                invertFn();
            }
        };

        self.hide = function(toggleSubtitles) {
            self.showing = false;
            self.element.removeClass("show");
            self.element.removeClass("hover-effect");
            $("#subtitle-sidebar").removeClass("showing");
            if (toggleSubtitles) {
                PubSub.publish(globals.TOGGLE_SUBTITLES);
            }
            revertFn();
        };

        if (globals.CLICK_EVENT === "click" && !globals.IS_WINDOWS_PHONE) {
            self.element.bind("click", function() {
                // PubSub.publish(globals.TOGGLE_SUBTITLES);
                if (self.showing) {
                    self.hide(true);
                } else {
                    self.show();
                }
            });

            //self.element.bind('mouseenter', self.show);
            //self.element.bind('mouseleave', self.hide);
        } else if (globals.IS_WINDOWS_PHONE) {
            //windows phone doesn't do touch events, but needs equivalent of hover
            self.element.bind("click", function() {
                if (self.showing) {
                    self.hide();
                } else {
                    self.show();
                }
            });
        } else {
            self.element.bind("touchstart", function() {
                if (self.showing) {
                    self.hide();
                } else {
                    self.show();
                }
            });
        }
        if (globals.HAS_SUBTITLES) {
            self.show();
            PubSub.publish(globals.TOGGLE_SUBTITLES);
        }
    };

    return bottomBarSubtitleController;
});

wwplayer.define("LogoSlick", ["jquery", "Class", "pubsub", "globals", "raphael"], function($, Class, PubSub, globals, Raphael) {
    var self;
    var LogoSlick = Class.extend({
        init: function(element) {
            self = this;
            this.element = element;

            if (!globals.WHITELABEL) {
                if (element) {
                    var rsr = Raphael(element.find(".innerSvg")[0], "100%", "100%");
                    rsr.setViewBox(0, 0, 800, 15, true);
                    var group_a = rsr.set();
                    group_a.attr({ name: "group_a" });
                    var group_b = rsr.set();
                    var path_d = rsr
                        .path(
                            "M203.6,227.1c0-22.9,0-46.7-0.2-70l0-1l-1.1,0.2c-5.5,0.9-11,1.7-16.3,2.5l-0.8,0.1l0,0.8 c0.3,23.3,0.4,47.1,0.5,70.1c0.1,21.2,0.2,43.1,0.4,64.6l0,1l1.1-0.2c5.1-0.8,10.5-1.7,15.8-2.6l0.8-0.1l0-0.7 C203.5,270.1,203.6,248.2,203.6,227.1z"
                        )
                        .attr({
                            class: "st0",
                            parent: "group_a",
                            "stroke-width": "0",
                            "stroke-opacity": "1",
                            fill: "#FFFFFF"
                        })
                        .data("id", "path_d");
                    var path_e = rsr
                        .path(
                            "M253,152c-3.5-2.7-8.5-3.5-14-2.4c-9.5,1.8-18.8,3.5-27.7,5.1l-0.8,0.1l0,0.8c0.2,23.3,0.1,47,0.1,69.9 c-0.1,21.2-0.2,43,0,64.6l0,1.1l1.1-0.2c5.1-0.9,10.5-2,15.9-3.1l0.8-0.2l0-0.7c-0.1-21.2,0-42.4,0.2-62.2 c2.3-0.4,3.7-0.7,6.2-1.2c2.2-0.4,3.3-0.4,3.9,0c0.7,0.6,0.8,2.4,0.8,4.4c-0.2,16.9-0.3,36.8-0.2,56.5l0,1.1l1.1-0.2 c5.2-1.1,10.6-2.3,16.3-3.5l0.7-0.2l0-0.7c0-19.7,0.1-39.7,0.3-56.5c0.6-6-1.4-10-6.2-12c5.8-4,6.5-10.3,6.4-15.5 c0.1-12.2,0.2-22.9,0.2-32.8C258.2,158.9,256.4,154.6,253,152z M239.7,202.2c0,4.2-0.3,4.5-3.8,5.2c-2.9,0.6-4.5,0.9-7.1,1.4 c0.1-16.4,0.2-29.1,0.1-41.2c1-0.2,1.9-0.4,2.7-0.5c1.5-0.3,2.8-0.6,4.8-0.9c1-0.2,1.8,0,2.5,0.5c0.6,0.5,1,1.3,1,2.3 C239.8,179.8,239.8,190.4,239.7,202.2z"
                        )
                        .attr({
                            class: "st0",
                            parent: "group_a",
                            "stroke-width": "0",
                            "stroke-opacity": "1",
                            fill: "#FFFFFF"
                        })
                        .data("id", "path_e");
                    var path_f = rsr
                        .path(
                            "M266,144.2l-0.7,0.2l0,0.7c0,23.2-0.2,46.7-0.3,69.5c-0.2,21-0.3,42.8-0.3,64.2v1.1l1.2-0.3 c13.1-3,26.1-6.1,39.3-9.3l0.7-0.2l0-15.9l-1.2,0.3c-7.2,1.7-14.4,3.4-21.6,5.1c0-14.8,0.1-29.3,0.2-46.5 c6.2-1.4,12.4-2.8,18.6-4.2l0.7-0.2l0-15.8l-1.2,0.3c-6,1.4-12.1,2.7-18.1,4.1c0.1-16.2,0.1-28.9,0.2-40.8 c7.2-1.6,14.5-3.1,21.7-4.7l0.7-0.2l0-15.9l-1.2,0.2C291.8,138.7,279.1,141.4,266,144.2z"
                        )
                        .attr({
                            class: "st0",
                            parent: "group_a",
                            "stroke-width": "0",
                            "stroke-opacity": "1",
                            fill: "#FFFFFF"
                        })
                        .data("id", "path_f");
                    var path_g = rsr
                        .path(
                            "M372,255.1l0.1-0.6c2.4-19.4,4.7-39.1,7-58.2c2.9-25,6-50.8,9.2-76.1l0.2-1.2l-1.3,0.2 c-5.4,1-11.1,2-16.8,3.1l-0.7,0.1l-0.1,0.6c-2,17.5-3.9,34.9-5.7,51.5c-2.6-19.1-4.6-34.4-6.4-48.8l-0.1-1l-1,0.2 c-5.1,1-10.2,2.1-15.3,3.1l-0.7,0.1l-0.1,0.6c-1.9,17.2-3.8,34.2-5.6,50.9c-2.3-17.1-4.3-32.8-6.2-48l-0.1-1l-1,0.2 c-5.7,1.2-11.3,2.4-17,3.7l-0.8,0.2l0.1,0.8c3.3,26,6.7,52.4,10,77.9c2.2,16.9,4.4,33.8,6.5,50.7l0.1,1l1-0.2c5-1.2,10-2.3,15-3.5 l0.6-0.1l0.1-0.6c2.1-16.2,4.4-33.7,7.1-54.8c1.9,18,3.7,34.7,5.4,51.6l0.1,1l1.1-0.2c4.9-1.1,9.9-2.1,14.6-3.1L372,255.1z"
                        )
                        .attr({
                            class: "st0",
                            parent: "group_a",
                            "stroke-width": "0",
                            "stroke-opacity": "1",
                            fill: "#FFFFFF"
                        })
                        .data("id", "path_g");
                    var path_h = rsr
                        .path(
                            "M419.8,247.1l1-0.1c5.6-0.8,11.3-1.4,16.9-2.1l0.9-0.1l-0.1-0.9c-2.6-19.8-5.3-40-8-59.5 c-3.1-22.8-6.4-46.5-9.3-69.7l-0.1-0.9l-1,0.1c-6.6,0.9-13.6,2-21.4,3.3l-0.7,0.1l-0.1,0.7c-3.1,24.3-6.1,49.1-9,73.1 c-2.4,20-4.9,40.7-7.4,61l-0.2,1.2l1.3-0.2c5.2-1,10.4-1.9,15.6-2.8l0.7-0.1l0.1-0.7c1.3-10.1,2.7-20.9,4.2-33.1 c4.2-0.7,8.4-1.3,12.5-1.9c1.4,11.2,2.7,21.6,4,31.6L419.8,247.1z M405.2,200.5l1.3-10.1c0.9-7.6,1.9-15.3,2.8-22.9 c0.7,5.3,1.4,10.5,2.1,15.8l2.1,16C410.3,199.7,408.3,200,405.2,200.5z"
                        )
                        .attr({
                            class: "st0",
                            parent: "group_a",
                            "stroke-width": "0",
                            "stroke-opacity": "1",
                            fill: "#FFFFFF"
                        })
                        .data("id", "path_h");
                    var path_i = rsr
                        .path(
                            "M497.4,240.9l-0.3-1.1c-5.3-21.6-10.8-43.8-17-67.9c5.8-22.7,11.1-43.3,16.2-63.1l0.3-1.1l-1.2,0 c-5.7,0.1-11.5,0.2-17.3,0.5l-0.7,0l-0.2,0.7c-2.5,10.3-5,20.6-7.4,30.9c-3-9.9-5.9-19.9-8.8-29.8l-0.2-0.7l-0.8,0.1 c-5.5,0.4-11.2,1-16.8,1.6l-1.1,0.1l0.3,1c4.7,15.9,9.6,31.9,14.4,47.5l4.2,13.8l-5.2,18.5c-4.7,16.8-9.6,34.2-14.4,51.3l-0.4,1.3 l1.4-0.1c5.8-0.6,11.7-1.1,17.5-1.6l0.7-0.1l0.2-0.6c3-11.7,6-23.4,9.1-35c2.7,11.4,5.3,22.8,7.9,33.8l0.2,0.7l0.8,0 c5.9-0.3,11.7-0.5,17.5-0.6L497.4,240.9z"
                        )
                        .attr({
                            class: "st0",
                            parent: "group_a",
                            "stroke-width": "0",
                            "stroke-opacity": "1",
                            fill: "#FFFFFF"
                        })
                        .data("id", "path_i");
                    var path_j = rsr
                        .path(
                            "M163.3,161.5l-0.8,0.1l-0.1,0.7c-1.6,17.4-3.2,35-4.8,52.1c-2.5-18.4-4.9-35.1-7.2-50.8l-0.1-0.8l-0.9,0.1 c-5.1,0.4-10.2,0.8-15.2,1.1l-0.8,0.1l-0.1,0.8c-1.1,12.9-2.3,25.8-3.4,38.8l-1.1,12.1c-2.5-17.1-5-33.9-7.4-50.3l-0.1-0.8l-0.8,0 c-5.7,0.2-11.4,0.3-17,0.3l-1.1,0l0.2,1c6.8,46,13.5,92.1,19.7,135.1l0.1,0.8l0.9,0c4.8-0.2,9.6-0.5,14.4-0.9l0.8-0.1l0.1-0.7 c1.8-17.1,3.7-35.1,5.9-54.8l1,8.7c1.7,14.9,3.4,29.9,5.1,44.8l0.1,0.9l0.9-0.1c4.7-0.5,9.5-1,14.3-1.6l0.8-0.1l0.1-0.7 c2.7-27.5,5.8-55.5,8.7-82.6c1.9-17.8,4-36.2,5.8-54.3l0.1-1.1l-1.2,0.2C174.5,160.2,168.8,160.9,163.3,161.5z"
                        )
                        .attr({
                            class: "st0",
                            parent: "group_a",
                            "stroke-width": "0",
                            "stroke-opacity": "1",
                            fill: "#FFFFFF"
                        })
                        .data("id", "path_j");
                    group_b.attr({ parent: "group_a", name: "group_b" });
                    var group_c = rsr.set();
                    var path_k = rsr
                        .path(
                            "M520.4,109.4c-1.3-1.4-3.1-2.1-5.3-2.1c-2.2,0-3.9,0.7-5.3,2.1c-1.3,1.4-2,3.2-2,5.3c0,2.2,0.7,3.9,2,5.3 c1.3,1.4,3.1,2.1,5.3,2.1c2.1,0,3.9-0.7,5.3-2.1c1.3-1.4,2-3.2,2-5.3C522.4,112.6,521.7,110.8,520.4,109.4z M521.1,114.7 c0,1.9-0.5,3.4-1.6,4.5h0c-1.1,1.1-2.5,1.7-4.4,1.7c-1.8,0-3.3-0.6-4.4-1.7c-1.1-1.1-1.6-2.6-1.6-4.5c0-1.9,0.5-3.4,1.6-4.5 c1.1-1.1,2.5-1.7,4.4-1.7c1.8,0,3.3,0.6,4.4,1.7C520.6,111.4,521.1,112.9,521.1,114.7z"
                        )
                        .attr({
                            class: "st0",
                            parent: "group_a",
                            "stroke-width": "0",
                            "stroke-opacity": "1",
                            fill: "#FFFFFF"
                        })
                        .data("id", "path_k");
                    var path_l = rsr
                        .path(
                            "M517.6,114.6c0.3-0.4,0.5-1,0.5-1.6c0-0.6-0.2-1.2-0.7-1.6c-0.5-0.4-1.2-0.7-2.1-0.7h-2.6v7.8h1.4v-3.1h0.7 l1.9,3.1h1.7l-2.1-3.2C516.9,115.2,517.3,114.9,517.6,114.6z M514.1,111.8h1.2c1,0,1.4,0.4,1.4,1.2c0,0.8-0.4,1.2-1.4,1.2h-1.2 V111.8z"
                        )
                        .attr({
                            class: "st0",
                            parent: "group_a",
                            "stroke-width": "0",
                            "stroke-opacity": "1",
                            fill: "#FFFFFF"
                        })
                        .data("id", "path_l");
                    group_c.attr({ parent: "group_a", name: "group_c" });
                    var rsrGroups = [group_a, group_b, group_c];
                    group_a.push();
                    group_b.push(path_d, path_e, path_f, path_g, path_h, path_i, path_j);
                    group_c.push(path_k, path_l);
                }

                // if (!globals.IS_WINDOWS_PHONE) {    //windows phone registers clicks, not touches
                //     $(this.element).hover(self.onMouseEnter, self.onMouseLeave);
                // }
                $(this.element).on(globals.CLICK_EVENT, self.click);
                PubSub.subscribe(globals.HAS_PLAYED, self.onMouseLeave);
            }
        },
        hidePTCOnly: function() {
            self.element.addClass("small");
        },
        click: function() {
            if (globals.DISABLE_LOGO) {
                return;
            }

            PubSub.publish(globals.DO_PAUSE);
            window.open("http://www.wirewax.com", "_blank");
            PubSub.publish(globals.UI_EVENT, { eventName: "wirewaxTab", eventId: 12 });
        }
    });

    return LogoSlick;
});
wwplayer.define("LogoWithBanner", ["jquery", "Class", "pubsub", "globals", "raphael"], function($, Class, PubSub, globals, Raphael) {
    var self;
    var LogoWithBanner = Class.extend({
        init: function(element) {
            self = this;
            this.element = element;

            if (!globals.WHITELABEL) {
                if (element) {
                    $(element)
                        .find(".join-wirewax-message_with_logo")
                        .append("Create your own interactive video today");
                    $(element)
                        .find(".wirewax-studio-button_with_logo")
                        .append("Request a demo");
                    $("#shares").remove();
                    var rsr = Raphael(element.find(".innerSvg_with_logo")[0], "150%", "150%");
                    rsr.setViewBox(0, 0, 500, 500, true);
                    // var rsr = Raphael(element.find('.innerSvg')[0], "100%", "100%");
                    // rsr.setViewBox(0, 0, 800, 15, true);
                    var group_a = rsr.set();
                    group_a.attr({ name: "group_a" });
                    var group_b = rsr.set();
                    var path_d = rsr
                        .path(
                            "M203.6,227.1c0-22.9,0-46.7-0.2-70l0-1l-1.1,0.2c-5.5,0.9-11,1.7-16.3,2.5l-0.8,0.1l0,0.8 c0.3,23.3,0.4,47.1,0.5,70.1c0.1,21.2,0.2,43.1,0.4,64.6l0,1l1.1-0.2c5.1-0.8,10.5-1.7,15.8-2.6l0.8-0.1l0-0.7 C203.5,270.1,203.6,248.2,203.6,227.1z"
                        )
                        .attr({
                            class: "st0",
                            parent: "group_a",
                            "stroke-width": "0",
                            "stroke-opacity": "1",
                            fill: "#FFFFFF"
                        })
                        .data("id", "path_d");
                    var path_e = rsr
                        .path(
                            "M253,152c-3.5-2.7-8.5-3.5-14-2.4c-9.5,1.8-18.8,3.5-27.7,5.1l-0.8,0.1l0,0.8c0.2,23.3,0.1,47,0.1,69.9 c-0.1,21.2-0.2,43,0,64.6l0,1.1l1.1-0.2c5.1-0.9,10.5-2,15.9-3.1l0.8-0.2l0-0.7c-0.1-21.2,0-42.4,0.2-62.2 c2.3-0.4,3.7-0.7,6.2-1.2c2.2-0.4,3.3-0.4,3.9,0c0.7,0.6,0.8,2.4,0.8,4.4c-0.2,16.9-0.3,36.8-0.2,56.5l0,1.1l1.1-0.2 c5.2-1.1,10.6-2.3,16.3-3.5l0.7-0.2l0-0.7c0-19.7,0.1-39.7,0.3-56.5c0.6-6-1.4-10-6.2-12c5.8-4,6.5-10.3,6.4-15.5 c0.1-12.2,0.2-22.9,0.2-32.8C258.2,158.9,256.4,154.6,253,152z M239.7,202.2c0,4.2-0.3,4.5-3.8,5.2c-2.9,0.6-4.5,0.9-7.1,1.4 c0.1-16.4,0.2-29.1,0.1-41.2c1-0.2,1.9-0.4,2.7-0.5c1.5-0.3,2.8-0.6,4.8-0.9c1-0.2,1.8,0,2.5,0.5c0.6,0.5,1,1.3,1,2.3 C239.8,179.8,239.8,190.4,239.7,202.2z"
                        )
                        .attr({
                            class: "st0",
                            parent: "group_a",
                            "stroke-width": "0",
                            "stroke-opacity": "1",
                            fill: "#FFFFFF"
                        })
                        .data("id", "path_e");
                    var path_f = rsr
                        .path(
                            "M266,144.2l-0.7,0.2l0,0.7c0,23.2-0.2,46.7-0.3,69.5c-0.2,21-0.3,42.8-0.3,64.2v1.1l1.2-0.3 c13.1-3,26.1-6.1,39.3-9.3l0.7-0.2l0-15.9l-1.2,0.3c-7.2,1.7-14.4,3.4-21.6,5.1c0-14.8,0.1-29.3,0.2-46.5 c6.2-1.4,12.4-2.8,18.6-4.2l0.7-0.2l0-15.8l-1.2,0.3c-6,1.4-12.1,2.7-18.1,4.1c0.1-16.2,0.1-28.9,0.2-40.8 c7.2-1.6,14.5-3.1,21.7-4.7l0.7-0.2l0-15.9l-1.2,0.2C291.8,138.7,279.1,141.4,266,144.2z"
                        )
                        .attr({
                            class: "st0",
                            parent: "group_a",
                            "stroke-width": "0",
                            "stroke-opacity": "1",
                            fill: "#FFFFFF"
                        })
                        .data("id", "path_f");
                    var path_g = rsr
                        .path(
                            "M372,255.1l0.1-0.6c2.4-19.4,4.7-39.1,7-58.2c2.9-25,6-50.8,9.2-76.1l0.2-1.2l-1.3,0.2 c-5.4,1-11.1,2-16.8,3.1l-0.7,0.1l-0.1,0.6c-2,17.5-3.9,34.9-5.7,51.5c-2.6-19.1-4.6-34.4-6.4-48.8l-0.1-1l-1,0.2 c-5.1,1-10.2,2.1-15.3,3.1l-0.7,0.1l-0.1,0.6c-1.9,17.2-3.8,34.2-5.6,50.9c-2.3-17.1-4.3-32.8-6.2-48l-0.1-1l-1,0.2 c-5.7,1.2-11.3,2.4-17,3.7l-0.8,0.2l0.1,0.8c3.3,26,6.7,52.4,10,77.9c2.2,16.9,4.4,33.8,6.5,50.7l0.1,1l1-0.2c5-1.2,10-2.3,15-3.5 l0.6-0.1l0.1-0.6c2.1-16.2,4.4-33.7,7.1-54.8c1.9,18,3.7,34.7,5.4,51.6l0.1,1l1.1-0.2c4.9-1.1,9.9-2.1,14.6-3.1L372,255.1z"
                        )
                        .attr({
                            class: "st0",
                            parent: "group_a",
                            "stroke-width": "0",
                            "stroke-opacity": "1",
                            fill: "#FFFFFF"
                        })
                        .data("id", "path_g");
                    var path_h = rsr
                        .path(
                            "M419.8,247.1l1-0.1c5.6-0.8,11.3-1.4,16.9-2.1l0.9-0.1l-0.1-0.9c-2.6-19.8-5.3-40-8-59.5 c-3.1-22.8-6.4-46.5-9.3-69.7l-0.1-0.9l-1,0.1c-6.6,0.9-13.6,2-21.4,3.3l-0.7,0.1l-0.1,0.7c-3.1,24.3-6.1,49.1-9,73.1 c-2.4,20-4.9,40.7-7.4,61l-0.2,1.2l1.3-0.2c5.2-1,10.4-1.9,15.6-2.8l0.7-0.1l0.1-0.7c1.3-10.1,2.7-20.9,4.2-33.1 c4.2-0.7,8.4-1.3,12.5-1.9c1.4,11.2,2.7,21.6,4,31.6L419.8,247.1z M405.2,200.5l1.3-10.1c0.9-7.6,1.9-15.3,2.8-22.9 c0.7,5.3,1.4,10.5,2.1,15.8l2.1,16C410.3,199.7,408.3,200,405.2,200.5z"
                        )
                        .attr({
                            class: "st0",
                            parent: "group_a",
                            "stroke-width": "0",
                            "stroke-opacity": "1",
                            fill: "#FFFFFF"
                        })
                        .data("id", "path_h");
                    var path_i = rsr
                        .path(
                            "M497.4,240.9l-0.3-1.1c-5.3-21.6-10.8-43.8-17-67.9c5.8-22.7,11.1-43.3,16.2-63.1l0.3-1.1l-1.2,0 c-5.7,0.1-11.5,0.2-17.3,0.5l-0.7,0l-0.2,0.7c-2.5,10.3-5,20.6-7.4,30.9c-3-9.9-5.9-19.9-8.8-29.8l-0.2-0.7l-0.8,0.1 c-5.5,0.4-11.2,1-16.8,1.6l-1.1,0.1l0.3,1c4.7,15.9,9.6,31.9,14.4,47.5l4.2,13.8l-5.2,18.5c-4.7,16.8-9.6,34.2-14.4,51.3l-0.4,1.3 l1.4-0.1c5.8-0.6,11.7-1.1,17.5-1.6l0.7-0.1l0.2-0.6c3-11.7,6-23.4,9.1-35c2.7,11.4,5.3,22.8,7.9,33.8l0.2,0.7l0.8,0 c5.9-0.3,11.7-0.5,17.5-0.6L497.4,240.9z"
                        )
                        .attr({
                            class: "st0",
                            parent: "group_a",
                            "stroke-width": "0",
                            "stroke-opacity": "1",
                            fill: "#FFFFFF"
                        })
                        .data("id", "path_i");
                    var path_j = rsr
                        .path(
                            "M163.3,161.5l-0.8,0.1l-0.1,0.7c-1.6,17.4-3.2,35-4.8,52.1c-2.5-18.4-4.9-35.1-7.2-50.8l-0.1-0.8l-0.9,0.1 c-5.1,0.4-10.2,0.8-15.2,1.1l-0.8,0.1l-0.1,0.8c-1.1,12.9-2.3,25.8-3.4,38.8l-1.1,12.1c-2.5-17.1-5-33.9-7.4-50.3l-0.1-0.8l-0.8,0 c-5.7,0.2-11.4,0.3-17,0.3l-1.1,0l0.2,1c6.8,46,13.5,92.1,19.7,135.1l0.1,0.8l0.9,0c4.8-0.2,9.6-0.5,14.4-0.9l0.8-0.1l0.1-0.7 c1.8-17.1,3.7-35.1,5.9-54.8l1,8.7c1.7,14.9,3.4,29.9,5.1,44.8l0.1,0.9l0.9-0.1c4.7-0.5,9.5-1,14.3-1.6l0.8-0.1l0.1-0.7 c2.7-27.5,5.8-55.5,8.7-82.6c1.9-17.8,4-36.2,5.8-54.3l0.1-1.1l-1.2,0.2C174.5,160.2,168.8,160.9,163.3,161.5z"
                        )
                        .attr({
                            class: "st0",
                            parent: "group_a",
                            "stroke-width": "0",
                            "stroke-opacity": "1",
                            fill: "#FFFFFF"
                        })
                        .data("id", "path_j");
                    group_b.attr({ parent: "group_a", name: "group_b" });
                    var group_c = rsr.set();
                    var path_k = rsr
                        .path(
                            "M520.4,109.4c-1.3-1.4-3.1-2.1-5.3-2.1c-2.2,0-3.9,0.7-5.3,2.1c-1.3,1.4-2,3.2-2,5.3c0,2.2,0.7,3.9,2,5.3 c1.3,1.4,3.1,2.1,5.3,2.1c2.1,0,3.9-0.7,5.3-2.1c1.3-1.4,2-3.2,2-5.3C522.4,112.6,521.7,110.8,520.4,109.4z M521.1,114.7 c0,1.9-0.5,3.4-1.6,4.5h0c-1.1,1.1-2.5,1.7-4.4,1.7c-1.8,0-3.3-0.6-4.4-1.7c-1.1-1.1-1.6-2.6-1.6-4.5c0-1.9,0.5-3.4,1.6-4.5 c1.1-1.1,2.5-1.7,4.4-1.7c1.8,0,3.3,0.6,4.4,1.7C520.6,111.4,521.1,112.9,521.1,114.7z"
                        )
                        .attr({
                            class: "st0",
                            parent: "group_a",
                            "stroke-width": "0",
                            "stroke-opacity": "1",
                            fill: "#FFFFFF"
                        })
                        .data("id", "path_k");
                    var path_l = rsr
                        .path(
                            "M517.6,114.6c0.3-0.4,0.5-1,0.5-1.6c0-0.6-0.2-1.2-0.7-1.6c-0.5-0.4-1.2-0.7-2.1-0.7h-2.6v7.8h1.4v-3.1h0.7 l1.9,3.1h1.7l-2.1-3.2C516.9,115.2,517.3,114.9,517.6,114.6z M514.1,111.8h1.2c1,0,1.4,0.4,1.4,1.2c0,0.8-0.4,1.2-1.4,1.2h-1.2 V111.8z"
                        )
                        .attr({
                            class: "st0",
                            parent: "group_a",
                            "stroke-width": "0",
                            "stroke-opacity": "1",
                            fill: "#FFFFFF"
                        })
                        .data("id", "path_l");
                    group_c.attr({ parent: "group_a", name: "group_c" });
                    var rsrGroups = [group_a, group_b, group_c];
                    group_a.push();
                    group_b.push(path_d, path_e, path_f, path_g, path_h, path_i, path_j);
                    group_c.push(path_k, path_l);

                    $(this.element)
                        .find(".wirewax-studio-button_with_logo")
                        .on(globals.CLICK_EVENT, self.openStudio5);
                    $(this.element)
                        .find("#wirewax-logo_with_logo")
                        .on(globals.CLICK_EVENT, self.openFOH);
                    PubSub.subscribe(globals.HAS_PLAYED, self.onMouseLeave);
                }
            }
        },
        hidePTCOnly: function() {
            self.element.addClass("small");
        },
        openStudio5: function() {
            PubSub.publish(globals.DO_PAUSE);
            window.open("https://www.wirewax.com/studio#studio-form", "_blank");
            PubSub.publish(globals.UI_EVENT, { eventName: "wirewaxTab", eventId: 12 });
        },
        openFOH: function() {
            PubSub.publish(globals.DO_PAUSE);
            window.open("https://www.wirewax.com", "_blank");
            PubSub.publish(globals.UI_EVENT, { eventName: "wirewaxTab", eventId: 12 });
        }
    });

    return LogoWithBanner;
});
wwplayer.define("BottomBarRenditionControllerSlick", ["jquery", "pubsub", "globals", "underscore", "apiService"], function($, PubSub, globals, _, apiService) {
    var bottomBarRenditionController = function(element, toggleHDFn, toggleSDFn) {
        var self = this;

        self.element = $(element);

        self.element.bind(globals.CLICK_EVENT, function(e) {
            e.preventDefault();
            e.stopPropagation();

            var isHD = false;
            if (parseInt(globals.RENDITION) >= 720) {
                isHD = true;
            }

            if (isHD) {
                toggleHDFn();
                PubSub.publish(globals.CHANGE_RENDITION, "360");
            } else {
                toggleSDFn();
                PubSub.publish(globals.CHANGE_RENDITION, globals.HD_RENDITION);
            }
        });
    };

    return bottomBarRenditionController;
});
wwplayer.define("BottomBarSettingsController", ["jquery", "pubsub", "globals", "underscore"], function($, PubSub, globals, _) {
    var bottomBarSettingsController = function(element, invertFn, revertFn, settingsElements) {
        var self = this;

        self.element = $(element);
        self.showing = false;

        _.each(settingsElements, function(setting) {
            if (setting) {
                self.element.append(setting.element);
                if (globals.CLICK_EVENT !== "touchend") {
                    setting.element.hover(
                        function() {
                            window.clearTimeout(self.hideTimeout);
                        },
                        function() {
                            self.hideTimeout = window.setTimeout(function() {
                                self.hide();
                            }, 3000);
                        }
                    );
                }
            }
        });

        self.show = function() {
            if (!self.showing) {
                self.showing = true;
                self.element.addClass("expanded").addClass("show");

                self.hideTimeout = window.setTimeout(function() {
                    self.hide();
                }, 3000);

                invertFn();
            }
        };

        self.hide = function() {
            self.showing = false;
            self.element.removeClass("show");
            window.setTimeout(function() {
                self.element.removeClass("expanded");
            }, 200);
            revertFn();
        };

        self.element.bind(globals.CLICK_EVENT, function() {
            if (self.showing) {
                self.hide();
            } else {
                self.show();
            }
        });
    };

    return bottomBarSettingsController;
});
wwplayer.define("ShareScreen", ["jquery", "pubsub", "globals", "require-shim"], function($, PubSub, globals, requireShim) {
    var ShareScreen = function(element, closeCallback) {
        var self = this;
        self.element = element;

        self.wasPlaying = false;
        self.element.find(".close-button").bind(globals.CLICK_EVENT, closeCallback);

        self.drawLinkIcon = function() {
            var linkBox = self.element.find(".link .icon");
            var rsr = Raphael(linkBox[0], "100%", "100%");
            rsr.setViewBox(0, 0, 18, 18, false);
            var path_b = rsr.path(
                "M16.441,1.561c2.079,2.079,2.079,5.45,0,7.529l-2.275,2.275c-0.324,0.324-0.68,0.597-1.058,0.822 l-0.001,0.001c-0.051,0.03-0.105,0.059-0.157,0.088c-0.02,0.012-0.04,0.023-0.068,0.038c0,0-0.007,0.004-0.014,0.007 c-0.124,0.064-0.251,0.123-0.38,0.178c-1.042,0.442-2.195,0.539-3.285,0.287c-0.02-0.004-0.038-0.007-0.057-0.012 c-0.008-0.001-0.014-0.003-0.022-0.006c-0.106-0.025-0.209-0.056-0.313-0.087c-0.124-0.039-0.246-0.082-0.366-0.13 c-0.658-0.26-1.275-0.654-1.808-1.186c-0.532-0.532-0.926-1.149-1.186-1.808l0.758-0.758c0.368-0.368,0.84-0.571,1.322-0.611 c0.002,0.015,0.004,0.03,0.007,0.046c0.103,0.533,0.361,1.041,0.773,1.454c0.424,0.424,0.95,0.685,1.5,0.781l0.001,0.001 l0.001,0.001c0,0,0.127,0.034,0.348,0.043c0.1,0.004,0.218,0.004,0.353-0.008l0.001-0.001l-0.001-0.001 c0.65-0.049,1.285-0.32,1.782-0.817l0.477-0.477l0.001-0.001l0.286-0.286l0.295-0.295l1.431-1.431c1.1-1.099,1.101-2.885,0-3.985 c-1.1-1.101-2.885-1.1-3.985,0L9.546,4.469L9.36,4.655C8.269,4.321,7.102,4.304,6.004,4.601c0.033-0.049,0.064-0.097,0.099-0.145 C6.262,4.239,6.441,4.03,6.637,3.834l2.275-2.275C10.991-0.52,14.362-0.52,16.441,1.561z M9.089,16.441l2.275-2.275 c0.196-0.196,0.374-0.405,0.534-0.622c0.035-0.046,0.066-0.096,0.099-0.144c-1.099,0.298-2.266,0.28-3.357-0.054l-0.186,0.186 L7.2,14.786c-1.101,1.101-2.886,1.101-3.986,0.001c-1.101-1.101-1.101-2.885,0.001-3.986l1.43-1.43L4.94,9.075l0.287-0.287 l0.001-0.001l0.477-0.477c0.497-0.497,1.133-0.768,1.782-0.816l0.001-0.001l0.001,0.001C7.623,7.483,7.741,7.481,7.84,7.486 c0.22,0.009,0.348,0.043,0.348,0.043v0.001H8.19c0.55,0.096,1.075,0.357,1.5,0.781c0.413,0.413,0.671,0.922,0.774,1.455 c0.004,0.014,0.004,0.03,0.007,0.046c0.482-0.039,0.955-0.242,1.322-0.611l0.758-0.758c-0.26-0.658-0.654-1.275-1.186-1.807 C10.833,6.105,10.216,5.71,9.558,5.45C9.437,5.403,9.316,5.359,9.191,5.321C9.088,5.289,8.983,5.259,8.878,5.233 C8.871,5.231,8.864,5.229,8.857,5.228C8.838,5.223,8.82,5.219,8.801,5.215C7.709,4.964,6.556,5.06,5.514,5.504 C5.385,5.557,5.258,5.616,5.133,5.682C5.127,5.685,5.12,5.688,5.12,5.688C5.093,5.703,5.073,5.714,5.053,5.726 C4.999,5.754,4.947,5.783,4.896,5.813L4.894,5.815C4.515,6.038,4.159,6.312,3.835,6.636L1.559,8.912c-2.079,2.079-2.079,5.45,0,7.53 C3.639,18.52,7.01,18.52,9.089,16.441z"
            );
            path_b.attr({ fill: "#C3C3C3", "stroke-width": "0", "stroke-opacity": "1" });
        };

        self.drawEmbedIcon = function() {
            var embedBox = self.element.find(".embed .icon");
            var rsr = Raphael(embedBox[0], "100%", "100%");
            rsr.setViewBox(0, 0, 32.64, 15, false);
            var path_b = rsr.path(
                "M11.149,1.165v2.908L3.444,7.499l7.706,3.428v2.896L0,8.721V6.255L11.149,1.165z M17.72,0h2.792l-5.766,15 h-2.89L17.72,0z M21.491,13.834v-2.907l7.706-3.428l-7.706-3.427V1.176L32.64,6.278v2.466L21.491,13.834z"
            );
            path_b.attr({ fill: "#C3C3C3", "stroke-width": "0", "stroke-opacity": "1" });
        };

        self.drawCloseButton = function() {
            var closeBox = self.element.find(".close-button");
            var rsr = Raphael(closeBox[0], "100%", "100%");
            rsr.setViewBox(0, 0, 22.938, 22.938, false);
            var path_b = rsr.path(" M21.969,21.969l-21-21 M21.969,0.969l-21,21");
            path_b.attr({
                fill: "none",
                stroke: "#FFFFFF",
                "stroke-width": "1.94",
                "stroke-linecap": "round",
                "stroke-linejoin": "round",
                "stroke-miterlimit": "10",
                "stroke-opacity": "1"
            });
        };

        self.drawResolutionSeparator = function() {
            var sep = self.element.find(".separator");
            var rsr = Raphael(sep[0], "100%", "100%");
            rsr.setViewBox(0, 0, 22.938, 22.938, false);
            var path_b = rsr.path(" M21.969,21.969l-21-21 M21.969,0.969l-21,21");
            path_b.attr({
                fill: "none",
                stroke: "#FFFFFF",
                "stroke-width": "1.94",
                "stroke-linecap": "round",
                "stroke-linejoin": "round",
                "stroke-miterlimit": "10",
                "stroke-opacity": "1"
            });
        };

        self.drawCheckMark = function(element) {
            var rsr = Raphael(element[0], "100%", "100%");
            rsr.setViewBox(0, 0, 24.234, 17.393, false);
            var path_b = rsr.path(" M23.234,1L7.841,16.393L1,9.551");
            path_b.attr({
                fill: "none",
                stroke: "#FFFFFF",
                "stroke-width": "2",
                "stroke-linecap": "round",
                "stroke-linejoin": "round",
                "stroke-miterlimit": "10",
                "stroke-opacity": "1"
            });
        };

        self.show = function(wasPlaying) {
            self.wasPlaying = wasPlaying;
            window.setTimeout(function() {
                self.element.addClass("show");
            }, 100);
        };

        self.hide = function() {
            self.element.removeClass("show");

            return self.wasPlaying;
        };

        self.setupEvents = function() {
            self.element.find("input").on("keypress keyup", function(e) {
                var input = $(this);

                setTimeout(function() {
                    if (input.val() !== "") {
                        var number = parseInt(input.val());
                        var otherNumber = 0;

                        if (isNaN(number)) {
                            number = "";
                            otherNumber = "";
                        }

                        if (number !== "") {
                            if (input.hasClass("resolution-width")) {
                                var otherInput = self.element.find(".resolution-height");
                                otherNumber = Math.ceil((number * 9) / 16);
                            } else {
                                var otherInput = self.element.find(".resolution-width");
                                otherNumber = Math.ceil((number * 16) / 9);
                            }
                        }

                        input.val(number);
                        otherInput.val(otherNumber);

                        self.setEmbedCode();
                    }
                }, 0);
            });

            self.element.find("textarea").on("keypress keyup keydown change", function(event) {
                event.preventDefault();
                event.stopPropagation();
            });

            self.element.find("textarea").on(globals.CLICK_EVENT, function(event) {
                $(this).select();
            });

            if (window.wirewax.offline) {
                self.element.find(".copy-button").hide();
            } else {
                requireShim.require(["Clipboard"], function(Clipboard) {
                    if (!Clipboard.isSupported()) {
                        self.element.find(".copy-button").hide();
                    }
                    var clipboard = new Clipboard(".copy-button");

                    clipboard.on("success", function(e) {
                        var elem = $(e.trigger);
                        if (elem.hasClass("copied")) {
                            return;
                        }

                        if (elem.hasClass("link")) {
                            PubSub.publish(globals.UI_EVENT, { eventName: "copyLink", eventId: 28 });
                        } else if (elem.hasClass("embed")) {
                            PubSub.publish(globals.UI_EVENT, { eventName: "copyEmbed", eventId: 29 });
                        }

                        elem.parent().addClass("flash");
                        elem.addClass("copied");

                        window.setTimeout(function() {
                            elem.parent().removeClass("flash");
                            elem.removeClass("copied");
                        }, 500);
                    });

                    clipboard.on("error", function(e) {
                        // todo
                    });
                });
            }
        };

        self.setLinkLocation = function() {
            var link = window.wirewax.embedLoc ? window.wirewax.embedLoc : window.location;
            self.element.find(".link textarea").val(link);
        };

        self.setEmbedCode = function() {
            var width = self.element.find(".embed .resolution-width").val();
            var height = self.element.find(".embed .resolution-height").val();
            self.element.find(".embed textarea").val(self.generateEmbedCode(width, height));
        };

        self.generateEmbedCode = function(width, height) {
            return (
                '<iframe width="' +
                width +
                '" height="' +
                height +
                '" src="//embed.wirewax.com/' +
                window.wirewax.vidId +
                "/" +
                window.wirewax.colour.substring(1) +
                '/" frameborder="0" scrollable="false" allowfullscreen></iframe>'
            );
        };

        self.drawIcons = function() {
            self.drawLinkIcon();
            self.drawEmbedIcon();
            self.drawCloseButton();
            self.drawResolutionSeparator();
            self.drawCheckMark(self.element.find(".link .check-mark"));
            self.drawCheckMark(self.element.find(".embed .check-mark"));
        };

        self.init = function() {
            if (!globals.WHITELABEL) {
                return;
            }
            self.drawIcons();
            self.setEmbedCode();
            self.setLinkLocation();
            self.setupEvents();
        };

        self.init();
    };
    return ShareScreen;
});

wwplayer.define("Console", ["jquery", "underscore", "pubsub", "globals", "require-shim"], function($, _, PubSub, globals, requireShim) {
    var Console = function(element, player) {
        var self = this;
        self.element = $(element);
        self.player = player;
        self.currentClipNumber = 1;
        self.showing = false;
        self.allTags = {};

        self.init = function() {
            if (globals.ENABLE_PIXEL_TIMECODE) {
                requireShim.require(["Timecode"], function(Timecode) {
                    self.timecode = new Timecode(player.videoElement);
                });
            }

            self.element.find(".vid-id span").text(window.wirewax.vidId);

            self.element.find(".formFrame").bind("keydown", function(event) {
                if (event.keyCode === 13) {
                    var frame = self.element.find(".formFrame").val();
                    self.player.seekToFrame(parseInt(frame));
                }
            });

            self.element.find(".formTime").bind("keydown", function(event) {
                if (event.keyCode === 13) {
                    var time = self.element.find(".formTime").val();
                    self.player.seekToFrame(parseFloat(time) * self.player.videoData.fps);
                }
            });

            self.element.find(".forwardFrame").click(function() {
                self.player.frameForward(function(retryFn) {
                    if (self.timecode && self.timecode.canRenderCode()) {
                        self.timecode.renderCode();
                        if (Math.pow(self.timecode.getFrame() - self.player.getFrame(), 2) > 16) {
                            retryFn();
                        }
                    }
                });
            });

            self.element.find(".backFrame").click(function() {
                self.player.frameBack(function(retryFn) {
                    if (self.timecode && self.timecode.canRenderCode()) {
                        self.timecode.renderCode();
                        if (Math.pow(self.timecode.getFrame() - self.player.getFrame(), 2) > 16) {
                            retryFn();
                        }
                    }
                });
            });

            self.element.find(".toggle-tag-highlight").bind(globals.CLICK_EVENT, function() {
                $(this).toggleClass("active");
                $(".tag").toggleClass("console-selected ");
            });

            PubSub.subscribe(globals.NEW_CLIP, function(eventName, eventData) {
                if (eventData !== -1) {
                    self.currentClipNumber = eventData;
                    self.element.find(".dynamic-tags").empty();
                    self.element.find(".clip-number span").text(eventData);
                    self.element.find(".clip-start-frame span").text(self.player.clipData[eventData]["in"]);
                    self.element.find(".clip-duration span").text(self.player.clipData[eventData]["out"] - self.player.clipData[eventData]["in"]);

                    var tags = _.filter(self.player.clipData[eventData]["tags"], function(tag) {
                        return !tag.deleted && tag.nameLink !== 0;
                    });

                    self.element.find(".tags-in-clip span").text(tags.length);
                }
            });

            PubSub.subscribe(globals.PLAYER_READY, function(eventName) {
                self.staticTags = _.filter(self.player.staticData, function(tag) {
                    return !tag.deleted && tag.nameLink !== 0;
                });

                self.movingTags = [];
                _.each(self.player.clipData, function(clip) {
                    self.movingTags = _.union(
                        self.movingTags,
                        _.filter(clip.tags, function(tag) {
                            return !tag.deleted && tag.nameLink !== 0 && tag.nameLink !== null;
                        })
                    );
                });

                self.element.find(".static-tags-count span").text(_.size(self.staticTags));
                self.element.find(".tags-count span").text(self.movingTags.length);
                self.element.find(".clips-count span").text(_.size(self.player.clipData));
                self.element.find(".fps span").text(self.player.videoData.fps);
                self.element.find(".tag-id span").text(self.player.videoData.tagId);
                self.element.find(".rendition-text span").text(globals.RENDITION);
                self.element.find(".duration-text span").text(self.player.videoData.duration);
                self.element.find(".vid-title span").text(self.player.videoData.vidName);

                ///////////////////////////////////////////////////
                //   RENDITION CODES

                var RenditionCodes = {
                    12: "180",
                    0: "360",
                    1: "480",
                    4: "540",
                    2: "720",
                    3: "1080",
                    10: "PAD",
                    11: "PHONE",
                    13: "360WEB",
                    14: "180WEB",
                    15: "180MP4",
                    16: "360MP4",
                    17: "540MP4",
                    18: "720MP4",
                    19: "1080MP4",
                    20: "540WEB",
                    21: "720WEB",
                    22: "1080WEB",
                    23: "MOBILE",
                    24: "IPHONE_SPRITE",
                    25: "360VP9",
                    26: "540VP9",
                    27: "720VP9",
                    28: "1080VP9",
                    29: "4KMP4",
                    30: "4KWEB",
                    31: "4KVP9",
                    32: "IPHONE_SPRITE_LOW_RES",
                    33: "IPHONE_SPRITE_HIGH_RES",
                    34: "HLS",
                    50: "360MP4_STACKED",
                    51: "360WEB_STACKED",
                    52: "720MP4_STACKED",
                    53: "720WEB_STACKED",
                    54: "1080MP4_STACKED",
                    55: "1080WEB_STACKED",
                    98: "360MOUSEMAPWEB",
                    99: "360MOUSEMAP",
                    100: "360_NOPTC",
                    101: "480_NOPTC",
                    102: "720_NOPTC",
                    103: "1080_NOPTC",
                    104: "540_NOPTC",
                    110: "IPAD_NOPTC",
                    111: "IPHONE_NOPTC",
                    112: "180_NOPTC",
                    113: "360WEB_NOPTC",
                    114: "180WEB_NOPTC",
                    115: "180MP4_NOPTC",
                    116: "360MP4_NOPTC",
                    117: "540MP4_NOPTC",
                    118: "720MP4_NOPTC",
                    119: "1080MP4_NOPTC",
                    120: "540WEB_NOPTC",
                    121: "720WEB_NOPTC",
                    122: "1080WEB_NOPTC",
                    123: "MOBILE_NOPTC",
                    125: "360VP9_NOPTC",
                    126: "540VP9_NOPTC",
                    127: "720VP9_NOPTC",
                    128: "1080VP9_NOPTC",
                    129: "4KMP4_NOPTC",
                    130: "4KWEB_NOPTC",
                    131: "4KVP9_NOPTC",
                    132: "IPHONE_SPRITE_LOW_RES_NOPTC",
                    133: "IPHONE_SPRITE_HIGH_RES_NOPTC",
                    150: "360MEDSRC",
                    151: "540MEDSRC",
                    152: "720MEDSRC",
                    153: "1080MEDSRC",
                    1000: "IMAGE_540",
                    1001: "IMAGE_1080",
                    1002: "IMAGE_2160",
                    1003: "IMAGE_4320",
                    1004: "IMAGE_8640"
                };

                var renditionString = self.player.videoData.renditionCodes;
                var renditionArray = renditionString.split(",");

                for (var index = 0; index < renditionArray.length; index++) {
                    var ren = renditionArray[index];
                    var renditionDiv = $("<div>" + RenditionCodes[ren] + ", </div>");
                    self.element.find(".all-renditions span").append(renditionDiv);
                }

                PubSub.publish(globals.GET_TAGS);
            });
            PubSub.subscribe(globals.RENDITION_CHANGED, function() {
                self.element.find(".rendition-text span").text(globals.RENDITION);
            });

            ///////////////////////////////////////////////////
            //   SUBTITLES
            if (self.player.subtitles) {
                for (var key in self.player.subtitles) {
                    var subtitleLang = $('<a target="_blank" download="subtitle.text"><span>' + key + ", </span></a>");
                    self.element.find(".subtitle-languages").append(subtitleLang);

                    var subtitles = self.player.videoData.subtitles;
                    for (var index = 0; index < subtitles.length; index++) {
                        if (subtitles[index].language === key) {
                            subtitleLang.attr({ href: "http://embed.wirewax.com" + subtitles[index].file });
                            break;
                        }
                    }
                }
            }

            ///////////////////////////////////////////////////
            //   HOTSPOT CONTENT
            PubSub.subscribe(globals.RETURN_TAGS, function(eventName, tags) {
                self.allTags = tags;

                _.each(self.allTags, function(tag) {
                    var staticTag = "Sticky";
                    if (tag.isStatic === 1) {
                        staticTag = "Static";
                    }
                    var showWidget = "false";
                    if (tag.disableWidget === false) {
                        showWidget = "true";
                    }
                    var clickoutUrl = tag.clickoutUrl || "";
                    var sprite = $(
                        '<li class="tag-sprite sprite-' +
                            tag.spriteId +
                            '"><span class="tag-name tag-field">' +
                            tag.tagName +
                            '</span><span class="is-static tag-field">' +
                            staticTag +
                            '</span><span class="widgetId tag-field">' +
                            tag.widgetId +
                            '</span><span class="spriteId tag-field">' +
                            tag.publicData.spriteId +
                            '</span><span class="clickoutUrl tag-field">' +
                            clickoutUrl +
                            '</span><span class="open-widget tag-field">' +
                            showWidget +
                            '</span><span class="tag-type tag-field">' +
                            tag.tagType +
                            "</span></li>" +
                            '<div class="hotspot-click-wrap"><span class="click-to-time tag-links">Go to hotspot</span><span class="click-open tag-links">Open hotspot</span></div>'
                    );

                    sprite.find(".click-to-time").bind(globals.CLICK_EVENT, function() {
                        self.toggle();
                        PubSub.publish(globals.GO_TO_TAG, tag.spriteId);
                        window.setTimeout(function() {
                            globals.PLAY_PAUSE_FUNCTION();
                        }, 150);
                    });
                    sprite.find(".click-open").bind(globals.CLICK_EVENT, function() {
                        self.toggle();
                        PubSub.publish(globals.OPEN_TAG, tag.spriteId);
                    });
                    self.element.find(".tag-sprites").append(sprite);
                });
            });

            ///////////////////////////////////////////////////
            //   METRICS CONTENT
            PubSub.subscribe(globals.CONSOLE_EVENTS.SENT_METRIC, function(eventName, data) {
                var metricName = "";

                $.map(data, function(value, name) {
                    if (name !== "isFirstActive") {
                        metricName = name;

                        var metricElement = $(
                            '<div class="metric-ele">' +
                                '<span class="metric-type">' +
                                metricName +
                                "</span>" +
                                '<span class="timestamp">' +
                                self.getTimeString() +
                                "</span>" +
                                '<span class="metric-data-wrap">' +
                                '<div class="metric-data">' +
                                '<span class="inner-name">Data: </span>' +
                                '<span class="inner-data data-expander">&#x21E9;' +
                                "</div>" +
                                "</span>" +
                                "</div>"
                        );
                        for (var index = 0; index < value.length; index++) {
                            var stringObject = JSON.stringify(value[index]);
                            var cleanString = stringObject.replace(/,/g, ", </br>");

                            var codeBlock = $("<pre><code>" + cleanString + "</code></pre>");
                            metricElement.find(".inner-data").append(codeBlock);
                        }

                        self.element.find(".metrics-list").prepend(metricElement);
                        metricElement.find(".metric-data-wrap").on(globals.CLICK_EVENT, function() {
                            $(this).toggleClass("expand");
                        });
                    }
                });
            });
            self.element.find(".metrics-search-submit").on(globals.CLICK_EVENT, function(e) {
                e.preventDefault();
                e.stopPropagation();
                // get the text entered in the box
                var textInput = document.getElementById("metrics-search-box").value;

                // turn each metric html element into a string to check the index of the entered text against.
                var metricElements = self.element.find(".metric-ele");
                for (var index = 0; index < metricElements.length; index++) {
                    var singleElement = JSON.stringify($(metricElements[index]).html());

                    var matches = singleElement.indexOf(textInput);
                    // hide any elements that don't match the string
                    if (matches === -1) {
                        $(metricElements[index]).addClass("hide");
                    }
                }
            });
            self.element.find(".metrics-show-all").on(globals.CLICK_EVENT, function() {
                self.element.find(".metrics-list .hide").removeClass("hide");
            });

            ///////////////////////////////////////////////////
            //  API EVENTS CONTENT
            // events we send out
            PubSub.subscribe(globals.CONSOLE_EVENTS.SENT_API_EVENT, function(eventName, data) {
                var eventDataInner;
                var eventDiv = $(
                    '<div class="events-element sent-event">' +
                        '<span class="event-name">Sent event</span>' +
                        '<span class="event-time">' +
                        self.getTimeString() +
                        "</span>" +
                        '<span class="event-data"></span>' +
                        "</div>"
                );

                // if the name and data is within the data object
                if (typeof data.eventData === "object") {
                    $.map(data.eventData, function(innerValue, innerName) {
                        if (innerName !== "hideIcon") {
                            eventDataInner = $('<div class="event-data-inner"><span class="inner-name">' + data.eventName + '</span><span class="inner-data"></span></div>');

                            // if the data is an object with the original data object
                            if (typeof innerValue === "object" && innerValue !== null) {
                                $.map(innerValue, function(innerValue2, innerName2) {
                                    var inner2EventData = $(
                                        '<div class="event-data-2"><span class="inner-name-2">&nbsp;&nbsp;' +
                                            innerName2 +
                                            ': </span><span class="inner-data-2">&nbsp;&nbsp;' +
                                            innerValue2 +
                                            "</span></div>"
                                    );
                                    eventDataInner.find(".inner-data").append(inner2EventData);
                                });
                            } else {
                                eventDataInner.find(".inner-data").append(innerValue);
                            }
                        }
                        // if the innerName is hideIcon then there isn't any data to show so just add the name
                        else {
                            eventDataInner = $('<div class="event-data-inner"><span class="inner-name">' + data.eventName + '</span><span class="inner-data"></span></div>');
                        }
                        eventDiv.find(".event-data").append(eventDataInner);
                    });
                }
                // else if the data is just a number or string, the name being eventName
                else if (typeof data.eventData === "string" || typeof data.eventData === "number") {
                    eventDataInner = $(
                        '<div class="event-data-inner"><span class="inner-name">' +
                            data.eventName +
                            '</span><span class="inner-data">&nbsp;&nbsp;' +
                            data.eventData +
                            "</span></div>"
                    );
                }
                // else there's no data, just an event name
                else {
                    eventDataInner = $('<div class="event-data-inner"><span class="inner-name">' + data.eventName + '</span><span class="inner-data"></span></div>');
                }
                eventDiv.find(".event-data").append(eventDataInner);

                self.element.find(".api-events-list").prepend(eventDiv);
            });

            PubSub.subscribe(globals.CONSOLE_EVENTS.RECEIVED_API_EVENT, function(eventName, data) {
                var eventDiv = $(
                    '<div class="events-element received-event"><span class="event-name">Received event</span><span class="event-data"></span><span class="event-time">' +
                        self.getTimeString() +
                        "</span></div>"
                );

                if (typeof data === "object" && data !== null) {
                    $.map(data, function(value, name) {
                        if (name !== "name") {
                            var innerData = $(
                                '<div class="event-data-inner">' +
                                    '<span class="inner-name">' +
                                    data.name +
                                    ": </span>" +
                                    '<span class="inner-data">' +
                                    value +
                                    "</span>" +
                                    "</div>"
                            );
                        }
                        eventDiv.find(".event-data").append(innerData);
                    });
                } else {
                    eventDiv.find(".event-data").append(data);
                }

                self.element.find(".api-events-list").prepend(eventDiv);
            });
            self.element.find(".events-search-submit").on(globals.CLICK_EVENT, function(e) {
                e.preventDefault();
                e.stopPropagation();
                var textInput = document.getElementById("events-search-box").value;

                var eventsElements = self.element.find(".events-element");
                for (var index = 0; index < eventsElements.length; index++) {
                    var singleElement = JSON.stringify($(eventsElements[index]).html());

                    var matches = singleElement.indexOf(textInput);
                    if (matches === -1) {
                        $(eventsElements[index]).addClass("hide");
                    }
                }
            });
            self.element.find(".events-show-all").on(globals.CLICK_EVENT, function() {
                self.element.find(".api-events-list .hide").removeClass("hide");
            });

            ///////////////////////////////////////////////////
            // Toggle show console
            PubSub.subscribe(globals.SHOW_CONSOLE, self.toggle);

            $(document).keydown(function(event) {
                if ((event.keyCode === 122 || event.keyCode === 67) && event.ctrlKey && event.shiftKey) {
                    self.toggle();
                }
            });
        };

        self.updateConsole = function() {
            if (self.showing) {
                var currentTime = self.player.getCurrentTime().toFixed(2);
                self.element.find(".player-frame span").text(self.player.getFrame());
                self.element.find(".player-timestamp span").text(currentTime);
                self.element.find(".clip-frame span").text(self.player.getFrame() - self.player.clipData[self.currentClipNumber]["in"] + 1);

                self.element.find(".tag-sprite.active").removeClass("active");

                _.each(self.allTags, function(tag) {
                    if (currentTime > tag.tagStartTime && currentTime < tag.tagStartTime + tag.tagAnimationTime) {
                        self.element.find(".sprite-" + tag.spriteId).addClass("active");
                    }
                });

                if (self.timecode && self.timecode.canRenderCode()) {
                    self.timecode.renderCode();
                    self.element.find(".ptc-frame span").text(self.timecode.getFrame());
                }
            }
        };

        self.toggle = function() {
            self.showing = !self.showing;

            if (self.loopInterval) {
                window.clearInterval(self.loopInterval);
                self.loopInterval = null;
            }

            if (self.showing) {
                self.loopInterval = window.setInterval(self.updateConsole, 40);
                self.controlTabs();
            } else {
                self.element.find(".active").removeClass("active");
                PubSub.unsubscribe(self.globalEvents);
            }
            self.element.toggle();
            if (self.consoleIsHidden) {
                self.element.css({ left: "10%" });
                self.element.find(".video-console-hide-button").off(globals.CLICK_EVENT);
            }
        };

        self.controlTabs = function() {
            var headers = self.element.find(".header");

            ///////////////////////////////////////////////////
            // TAB CONTROLLER
            // hide all content tabs apart from meta
            self.element.find(".hide").removeClass("hide");
            self.element.find(".body-content:not(.body-meta)").addClass("hide");
            headers.find(".tab-meta").addClass("active");

            for (var index = 0; index < headers.children().length; index++) {
                headers
                    .children()
                    .eq(index)
                    .on(globals.CLICK_EVENT, function(event) {
                        // on click of header, user index to show content
                        headers.find(".header-tab").removeClass("active");
                        $(this).addClass("active");

                        var thisIndex = $(this).index();
                        self.element.find(".body-content").addClass("hide");
                        self.element
                            .find(".body-content")
                            .eq(thisIndex)
                            .removeClass("hide");
                    });
            }

            ///////////////////////////////////////////////////
            //  BODY CONTENT CONTROLLER
            // only show the metrics and events tabs when set as dev
            if (!window.wirewax.debug) {
                self.element.find(".tab-metrics").hide();
                self.element.find(".tab-events").hide();
                self.element.find(".body-metrics").hide();
                self.element.find(".body-events").hide();
            }

            ///////////////////////////////////////////////////
            //   HIDE ARROW CONTROLLER
            self.consoleIsHidden = false;
            self.element.find(".right-arrow").hide();
            self.element.find(".left-arrow").show();
            self.element.find(".video-console-hide-button").on(globals.CLICK_EVENT, function() {
                if (!self.consoleIsHidden) {
                    self.element.css({ left: "-77%" });
                    self.consoleIsHidden = true;
                    self.element.find(".left-arrow").hide();
                    self.element.find(".right-arrow").show();
                } else {
                    self.element.css({ left: "10%" });
                    self.consoleIsHidden = false;
                    self.element.find(".right-arrow").hide();
                    self.element.find(".left-arrow").show();
                }
            });

            self.element.find(".metrics-clear-button").on(globals.CLICK_EVENT, function() {
                self.element.find(".metrics-list").empty();
            });
            self.element.find(".events-clear-button").on(globals.CLICK_EVENT, function() {
                self.element.find(".api-events-list").empty();
            });
        };
        self.getTimeString = function() {
            var theTime = new Date(); // for now
            var hours = theTime.getHours(); // => 9
            var minutes = theTime.getMinutes(); // =>  30
            var seconds = theTime.getSeconds();
            var timeString = hours + ":" + minutes + ":" + seconds;
            return timeString;
        };
    };

    return Console;
});

wwplayer.define("VolumeControllerSlick", ["jquery", "underscore", "pubsub", "globals"], function($, _, PubSub, globals) {
    var volumeController = function(element, getVolumeFn, setVolumeFn) {
        var self = this;
        self.getVolumeFn = getVolumeFn;
        self.setVolumeFn = setVolumeFn;
        self.element = element;
        self.volumeBar = element.find("#volume-bar");
        self.volumeBarController = element;
        self.volumeBarControllerIcon = self.volumeBarController.find("#volume-bar-icon");
        self.volumeBarBall = self.volumeBarController.find("#volume-bar-ball");
        self.volumeBarActive = self.volumeBarController.find("#volume-bar-active");
        self.movingVolume = false;
        self.opened = false;
        self.preMuteVolume = globals.VOLUME;
        self.isMutedState = false;

        var rsr = Raphael(self.element.find("#speaker")[0], "100%", "100%");
        rsr.setViewBox(0, 0, 100, 100, true);

        var mutePath = "M82.6,78.4v21.1L32.3,68.9l0,0H6.8v-38h25.5l0,0L82.6,0.5v22.9 M69.3,36.2l26.9,27.5 M69,63.4l27.5-26.9";
        var regularPath = "M82.6,0.5V50v49.5L32.3,68.9l0,0H6.8v-38h25.5l0,0L82.6,0.5z";

        var currentPath = globals.VOLUME === 0 ? mutePath : regularPath;
        var buttonSvg = rsr.path(currentPath);
        buttonSvg.attr({
            fill: "transparent",
            stroke: "#ffffff",
            "stroke-width": 3,
            "stroke-linejoin": "round"
        });

        var animateMutePath = function() {
            self.isMutedState = true;
            buttonSvg.animate({ path: mutePath }, 100);
        };

        var animateRegularPath = function() {
            self.isMutedState = false;
            buttonSvg.animate({ path: regularPath }, 100);
        };

        self.setVolume = function(volume, setPosition) {
            if (setPosition) {
                self.updatePosition(volume);
            }
            globals.VOLUME = volume;
            if (volume === 0) {
                animateMutePath();
            } else {
                animateRegularPath();
            }
            self.setVolumeFn(volume);
        };

        self.updatePosition = function(volume) {
            self.volumeBarBall.css("left", volume * self.volumeBar.width());
            self.volumeBarActive.css("width", volume * self.volumeBar.width());
            if (volume === 0) {
                animateMutePath();
            } else {
                animateRegularPath();
            }
        };

        self.open = function() {
            self.minWidth = 0;
            self.maxWidth = parseInt(self.volumeBar.css("max-width"));

            self.element.addClass("active");
            self.opened = true;
        };

        self.close = function() {
            self.element.removeClass("active");
            self.opened = false;
        };

        self.toggle = function() {
            if (self.opened) {
                self.close();
            } else {
                self.open();
            }
        };

        $(self.element)
            .find("#volume-bar-icon")
            .bind("mouseenter", function(e) {
                self.open();
            });

        $(self.element).bind("mouseleave", function(e) {
            if (!self.movingVolume) {
                self.close();
            }
        });

        $(self.element).bind(globals.CLICK_EVENT, function(e) {
            e.stopPropagation();
            e.preventDefault();

            if (e.changedTouches !== undefined) {
                posX = e.changedTouches[0].pageX;
            } else {
                posX = globals.IS_IE_8 ? e.clientX + document.body.scrollLeft : e.pageX;
            }

            var volumePosition = posX - 10 - ($(this).offset().left + parseFloat(self.volumeBar.css("left")));
            volumePosition = Math.max(volumePosition, 0);
            volumePosition = Math.min(volumePosition, self.volumeBar.width());

            var volume = volumePosition / self.volumeBar.width();
            self.setVolume(volume, true);
        });

        $(self.volumeBarControllerIcon).bind("touchstart", function(e) {
            if (!self.movingVolume) {
                self.toggle();
            }
        });

        $(self.volumeBarControllerIcon).bind("click", function(e) {
            e.stopPropagation();
            e.preventDefault();
            if (!self.isMutedState) {
                self.preMuteVolume = globals.VOLUME;
                self.setVolume(0, true);
            } else {
                self.setVolume(self.preMuteVolume, true);
                PubSub.publishSync(globals.ENABLE_AUDIO);
            }
        });

        $(self.volumeBarBall).bind("touchstart mousedown", function(event) {
            event.preventDefault();
            event.stopPropagation();
            if (self.opened) {
                self.movingVolume = true;
                $(self.volumeBarBall).addClass("moving");
            }
        });

        var onMouseMoveEvent = _.throttle(function(event) {
            if (self.movingVolume) {
                event.preventDefault();
                event.stopPropagation();

                var e = event.originalEvent;
                var posX;
                if (e.changedTouches !== undefined) {
                    posX = e.changedTouches[0].pageX - $(self.volumeBar).offset().left;
                } else {
                    posX = (globals.IS_IE_8 ? e.clientX + document.body.scrollLeft : e.pageX) - $(self.volumeBar).offset().left;
                }

                var pixels = posX;
                pixels = Math.max(pixels, self.minWidth);
                pixels = Math.min(pixels, self.maxWidth);

                $(self.volumeBarBall).css({
                    left: pixels
                });

                $(self.volumeBarActive).css({
                    width: pixels
                });

                var volumePerPixel = 1 / (self.maxWidth - self.minWidth);
                volume = volumePerPixel * pixels;

                if (volume > 1) {
                    volume = 1;
                }

                if (pixels <= 0) {
                    volume = 0;
                }

                self.setVolume(volume, false);
            }
        }, 40);

        $(document).bind("touchmove mousemove", onMouseMoveEvent);

        $(document).bind("touchend mouseup mouseleave", function(event) {
            if (self.movingVolume) {
                self.movingVolume = false;
            }
        });

        PubSub.subscribe(globals.HAS_PLAYED, self.close);
        PubSub.subscribe(globals.HAS_VIDEO_CLICKED, self.close);

        PubSub.subscribe(globals.VOLUME_CHANGE, function(eventName, volume) {
            //self.setVolume(volume, true);
            self.updatePosition(volume);
        });
        PubSub.subscribe(globals.MUTE_VOLUME, function(eventName) {
            self.updatePosition(0);
        });
        PubSub.subscribe(globals.UNMUTE_VOLUME, function(eventName) {
            self.updatePosition(1);
        });
        PubSub.subscribe(globals.ENABLE_AUDIO, function(eventName) {
            window.setTimeout(function() {
                self.updatePosition(globals.VOLUME);
            }, 100);
        });
    };

    return volumeController;
});

/**
 @module ShareController
 @requires jquery, PubSub, globals, underscore, ApiService
 **/
wwplayer.define("ForwardsBackwardsControllerSlick", ["jquery", "pubsub", "globals", "underscore", "apiService"], function($, PubSub, globals, _, apiService) {
    var forwardsBackwardsController = function(element) {
        var self = this;
        self.element = element;

        $(self.element)
            .find("#backwards-control")
            .bind(globals.CLICK_EVENT, function() {
                PubSub.publish(globals.GO_TO_PREV_CLIP);
            });

        $(self.element)
            .find("#forwards-control")
            .bind(globals.CLICK_EVENT, function() {
                PubSub.publish(globals.GO_TO_NEXT_CLIP);
            });
    };

    return forwardsBackwardsController;
});
wwplayer.define(
    "SkinBaseSlick",
    [
        "jquery",
        "underscore",
        "UserMessage",
        "LoaderSlick",
        "ScrubberSlick",
        "PlayButton",
        "PauseButton",
        "ShareControllerSlick",
        "BottomBarPlayButton",
        "BottomBarPauseButton",
        "BottomBarFullscreenButtonSlick",
        "BottomBarSubtitleController",
        "globals",
        "raphael",
        "DefaultToolkit",
        "LogoSlick",
        "LogoWithBanner",
        "pubsub",
        "text!templates/templates.html",
        "BottomBarRenditionControllerSlick",
        "BottomBarSettingsController",
        "ShareScreen",
        "modernizr",
        "Console",
        "VolumeControllerSlick",
        "ForwardsBackwardsControllerSlick"
    ],
    function(
        $,
        _,
        UserMessage,
        Loader,
        Scrubber,
        PlayButton,
        PauseButton,
        ShareController,
        BottomBarPlayButton,
        BottomBarPauseButton,
        BottomBarFullscreenButton,
        BottomBarSubtitleController,
        globals,
        Raphael,
        Toolkit,
        Logo,
        LogoWithBanner,
        PubSub,
        Templates,
        BottomBarRenditionController,
        BottomBarSettingsController,
        ShareScreen,
        Modernizr,
        Console,
        VolumeControllerSlick,
        ForwardsBackwardsControllerSlick
    ) {
        var self;
        var resourceUrl = window.wirewax.cdnUrl + "resourceData";

        var SkinBaseSlick = Class.extend({
            init: function(controlOverlay) {
                self = this;
                this.controlOverlay = controlOverlay;
                self.hideScrubber = true;
                this.toolkit = Toolkit;
                this.templates = Templates;
                this.refactored = true;
                $("#wwx-color-style").remove();
            },
            setAnimationController: function(animationController) {
                this.animationController = animationController;
            },
            apply: function() {},
            get360Controls: function(goUp, goDown, goLeft, goRight) {
                if (!self.threeSixtyControls) {
                    var mousedown = "mousedown";
                    var mouseup = "mouseup";
                    if (!globals.IS_DESKTOP) {
                        // is not desktop
                        mousedown = "touchstart";
                        mouseup = "touchend";
                    }

                    var element = $('<div id="three-sixty-controls"></div>');

                    var rsr = Raphael(element[0], "100%", "100%");
                    rsr.setViewBox(0, 0, 168, 168, true);

                    var rect_f = rsr.rect(50, 118, 69.5, 51.5);
                    var rect_g = rsr.rect(50, 0, 69.5, 51.5);
                    var rect_h = rsr.rect(0, 50, 51.5, 69.5);
                    var rect_i = rsr.rect(118, 50, 51.5, 69.5);
                    var group_a = rsr.set();
                    var path_j = rsr
                        .path(
                            "M84.8,99.1c-7.9,0-14.3-6.4-14.3-14.3c0-7.9,6.4-14.3,14.3-14.3c7.9,0,14.3,6.4,14.3,14.3 S92.7,99.1,84.8,99.1z M84.8,75.5c-5.1,0-9.3,4.2-9.3,9.3s4.2,9.3,9.3,9.3s9.3-4.2,9.3-9.3C94.1,79.7,89.9,75.5,84.8,75.5z"
                        )
                        .attr({
                            parent: "group_a",
                            fill: "#FFFFFF",
                            "stroke-width": "0",
                            "stroke-opacity": "1"
                        })
                        .data("id", "path_j");
                    var path_k = rsr
                        .path(
                            "M84.8,169.5c-46.7,0-84.7-38-84.7-84.7s38-84.7,84.7-84.7s84.7,38,84.7,84.7S131.5,169.5,84.8,169.5 z M84.8,5.1C40.9,5.1,5.1,40.9,5.1,84.8s35.8,79.7,79.7,79.7s79.7-35.8,79.7-79.7S128.7,5.1,84.8,5.1z"
                        )
                        .attr({
                            parent: "group_a",
                            fill: "#FFFFFF",
                            "stroke-width": "0",
                            "stroke-opacity": "1"
                        })
                        .data("id", "path_k");
                    group_a.attr({ name: "group_a" });
                    var group_b = rsr.set();
                    var path_l = rsr
                        .path(
                            "M149.4,86.3l-17.8,14.1c-0.3,0.2-0.6,0.3-1,0.3c-1,0-1.7-0.8-1.7-1.7c0-0.5,0.2-1,0.7-1.4 l16.5-12.8L129.6,72c-0.5-0.4-0.7-0.9-0.7-1.4c0-1,0.8-1.7,1.7-1.7c0.4,0,0.8,0.1,1,0.3l17.8,14.1c0.4,0.3,0.8,0.8,0.8,1.5 S149.9,85.9,149.4,86.3z"
                        )
                        .attr({
                            parent: "group_a",
                            fill: "#FFFFFF",
                            "stroke-width": "0",
                            "stroke-opacity": "1"
                        })
                        .data("id", "path_l");
                    group_b.attr({ parent: "group_a", name: "group_b" });
                    var group_c = rsr.set();
                    var path_m = rsr
                        .path(
                            "M18.6,83.3l17.8-14.1c0.3-0.2,0.6-0.3,1-0.3c1,0,1.7,0.8,1.7,1.7c0,0.5-0.2,1-0.7,1.4L22,84.8 l16.5,12.8c0.5,0.4,0.7,0.9,0.7,1.4c0,1-0.8,1.7-1.7,1.7c-0.4,0-0.8-0.1-1-0.3L18.6,86.3c-0.4-0.3-0.8-0.8-0.8-1.5 S18.2,83.7,18.6,83.3z"
                        )
                        .attr({
                            parent: "group_a",
                            fill: "#FFFFFF",
                            "stroke-width": "0",
                            "stroke-opacity": "1"
                        })
                        .data("id", "path_m");
                    group_c.attr({ parent: "group_a", name: "group_c" });
                    var group_d = rsr.set();
                    var path_n = rsr
                        .path(
                            "M83.3,149.2l-14.1-17.8c-0.2-0.3-0.3-0.6-0.3-1c0-1,0.8-1.7,1.7-1.7c0.5,0,1,0.2,1.4,0.7l12.8,16.5 l12.8-16.5c0.4-0.5,0.9-0.7,1.4-0.7c1,0,1.7,0.8,1.7,1.7c0,0.4-0.1,0.8-0.3,1l-14.1,17.8c-0.3,0.4-0.8,0.8-1.5,0.8 S83.7,149.6,83.3,149.2z"
                        )
                        .attr({
                            parent: "group_a",
                            fill: "#FFFFFF",
                            "stroke-width": "0",
                            "stroke-opacity": "1"
                        })
                        .data("id", "path_n");
                    group_d.attr({ parent: "group_a", name: "group_d" });
                    var group_e = rsr.set();
                    var path_o = rsr
                        .path(
                            "M86.3,18.4l14.1,17.8c0.2,0.3,0.3,0.6,0.3,1c0,1-0.8,1.7-1.7,1.7c-0.5,0-1-0.2-1.4-0.7L84.8,21.8 L72,38.3c-0.4,0.5-0.9,0.7-1.4,0.7c-1,0-1.7-0.8-1.7-1.7c0-0.4,0.1-0.8,0.3-1l14.1-17.8c0.3-0.4,0.8-0.8,1.5-0.8 C85.5,17.6,85.9,18,86.3,18.4z"
                        )
                        .attr({
                            parent: "group_a",
                            fill: "#FFFFFF",
                            "stroke-width": "0",
                            "stroke-opacity": "1"
                        })
                        .data("id", "path_o");
                    group_e.attr({ parent: "group_a", name: "group_e" });
                    var rsrGroups = [group_a, group_b, group_c, group_d, group_e];
                    group_a.push(path_j, path_k);
                    group_b.push(path_l);
                    group_c.push(path_m);
                    group_d.push(path_n);
                    group_e.push(path_o);

                    var panInterval = null;
                    element.on("dblclick", function(e) {
                        e.stopPropagation();
                        e.preventDefault();
                    });
                    $(path_l.node)
                        .add(rect_i.node)
                        .on(mousedown, function(e) {
                            if (panInterval) {
                                window.clearInterval(panInterval);
                            }

                            panInterval = window.setInterval(function() {
                                goRight();
                            }, 10);

                            e.stopPropagation();
                            e.preventDefault();
                        });
                    $(path_m.node)
                        .add(rect_h.node)
                        .on(mousedown, function(e) {
                            if (panInterval) {
                                window.clearInterval(panInterval);
                            }

                            panInterval = window.setInterval(function() {
                                goLeft();
                            }, 10);

                            e.stopPropagation();
                            e.preventDefault();
                        });
                    $(path_n.node)
                        .add(rect_f.node)
                        .on(mousedown, function(e) {
                            if (panInterval) {
                                window.clearInterval(panInterval);
                            }

                            panInterval = window.setInterval(function() {
                                goUp();
                            }, 10);

                            e.stopPropagation();
                            e.preventDefault();
                        });
                    $(path_o.node)
                        .add(rect_g.node)
                        .on(mousedown, function(e) {
                            if (panInterval) {
                                window.clearInterval(panInterval);
                            }

                            panInterval = window.setInterval(function() {
                                goDown();
                            }, 10);

                            e.stopPropagation();
                            e.preventDefault();
                        });

                    $(document).on(mouseup, function(e) {
                        if (panInterval) {
                            window.clearInterval(panInterval);
                        }
                    });

                    self.threeSixtyControls = element;
                }
                return self.threeSixtyControls;
            },
            get360Radar: function() {
                if (!self.threeSixtyRadar) {
                    var element = $(
                        '<div id="three-sixty-radar"><div class="three-sixty-radar-fov"></div><div class="three-sixty-radar-tag-container"></div><div class="three-sixty-radar-inner-dot"></div></div>'
                    );
                    var tagContainerElement = element.find(".three-sixty-radar-tag-container");
                    var rsr = Raphael(element[0], "100%", "100%");
                    rsr.setViewBox(0, 0, 589.5, 646, true);
                    $(rsr.canvas).css("transform", "translate(-4%,0%)");
                    var group_a = rsr.set();
                    var path_b = rsr
                        .path(
                            "M511.4,134.5c-50.3-50.3-117.2-78-188.4-78c-71.2,0-138.1,27.7-188.4,78S56.5,251.8,56.5,323 s27.7,138.1,78.1,188.4c50.3,50.3,117.2,78,188.4,78c71.2,0,138.1-27.7,188.4-78c50.3-50.3,78.1-117.3,78.1-188.4 S561.8,184.9,511.4,134.5z M501.5,501.5c-47.7,47.7-111.1,73.9-178.5,73.9c-67.4,0-130.8-26.3-178.5-73.9 c-47.7-47.7-74-111.1-74-178.5s26.3-130.8,74-178.5c47.7-47.7,111.1-74,178.5-74c67.4,0,130.8,26.3,178.5,74s74,111.1,74,178.5 S549.2,453.8,501.5,501.5z"
                        )
                        .attr({
                            parent: "group_a",
                            fill: "#FFFFFF",
                            "stroke-width": "0",
                            "stroke-opacity": "1"
                        })
                        .data("id", "path_b");
                    var path_c = rsr
                        .path(
                            "M321,26V4c-10.2,0.1-20.3,0.6-30.3,1.6l1.2,12.8l-2,0.2l-1.2-12.8C283,6.4,277.5,7.2,271.9,8l2,12.4 l-2,0.3l-2-12.3c-5.7,1-11.4,2.1-17.1,3.3l3.6,12.2l-1.9,0.6l-3.7-12.3c-7.7,1.8-15.3,3.8-22.8,6.1l4.7,11.7l-1.8,0.7l-4.7-11.8 c-10,3.2-19.8,6.8-29.5,11L209.7,52l-3.5,2l-13.1-22.5l0.7-0.4c-6.3,2.8-12.5,5.8-18.6,9l5.7,11.9l-1.8,0.9L173.5,41 c-4.8,2.6-9.6,5.3-14.3,8.1l6,10.9l-1.8,1l-6-10.8c-4.9,3-9.8,6.1-14.5,9.4l7.1,9.6l-1.6,1.2l-7.2-9.7c-6.4,4.4-12.6,9.1-18.7,14.1 l7.3,8.2l-1.5,1.3l-7.3-8.2c-6.7,5.5-13.2,11.3-19.6,17.5l17.8,17.8l-2.8,2.8L98.5,96.3c-0.4,0.4-0.7,0.7-1.1,1.1 c-6.8,6.8-13.2,13.9-19.3,21.1l9.9,8.4l-1.3,1.5l-9.8-8.4c-3.8,4.6-7.5,9.3-11,14.1l10.3,7.8l-1.2,1.6l-10.3-7.8 c-3.3,4.6-6.5,9.2-9.6,13.9l11.3,6.3l-1,1.8L54,151.4c-4.2,6.6-8.2,13.3-11.9,20.2l11.8,5.3l-0.8,1.8l-11.9-5.3 c-5,9.5-9.6,19.2-13.6,29.1l23.9,9.4l-1.5,3.7L26,206.1c-3.5,8.9-6.6,18-9.3,27.3l0.3-1l12.6,3.9l-0.6,1.9l-12.6-3.8 c-1.6,5.4-3,10.8-4.2,16.3l12.4,3l-0.5,2l-12.4-3c-1.3,5.7-2.4,11.3-3.3,17.1l12.7,1.3l-0.2,2l-12.8-1.3 c-1.2,7.7-2.2,15.5-2.9,23.4l12.4,0.2l0,2L5,297.1C4.4,305,4.1,313,4,321h26v4H4c0,9.3,0.5,18.5,1.3,27.6l12.9-1.2l0.2,2l-12.9,1.2 c0.6,5.6,1.2,11.2,2.1,16.8l12.5-1.9l0.3,2l-12.5,1.9c0.9,5.8,2,11.5,3.2,17.1l12.4-3.6l0.6,1.9l-12.5,3.6 c1.7,7.7,3.7,15.3,5.9,22.8l11.9-4.7l0.7,1.9l-12,4.7c3.2,10.4,7,20.7,11.2,30.7l26.4-11.5l1.6,3.7l-26.4,11.5 c3,6.8,6.3,13.6,9.8,20.2l11.7-5.6l0.9,1.8l-11.6,5.6c2.7,5,5.5,10,8.5,14.9l11.1-6.2l1,1.8l-11,6.2c3.1,5.1,6.4,10.1,9.8,15 l10-7.5l1.2,1.6l-10.1,7.5c4.5,6.3,9.2,12.5,14.1,18.5l9.4-8.4l1.3,1.5l-9.4,8.5c5.7,6.8,11.7,13.5,18,19.9l20.2-20.2l2.8,2.8 l-20.2,20.2c6.4,6.3,13,12.3,19.8,18.1l8.3-9.6l1.5,1.3l-8.2,9.6c4.4,3.6,8.8,7.1,13.3,10.5l7.9-10.4l1.6,1.2l-7.9,10.4 c4.7,3.5,9.5,6.8,14.3,10l6.5-11.4l1.7,1l-6.5,11.5l-0.8-0.4c6.9,4.5,13.9,8.6,21.1,12.5l5.3-11.6l1.8,0.8l-5.3,11.8 c10.6,5.7,21.5,10.8,32.7,15.2l9.8-24.8l3.7,1.5l-9.8,24.8c6.9,2.6,13.8,5,20.9,7.1l3.9-12.4l1.9,0.6l-3.9,12.3 c5.4,1.6,10.8,3.1,16.3,4.4l3-12.1l1.9,0.5l-3,12c5.6,1.3,11.3,2.5,17,3.5l1.4-12.3l2,0.2l-1.4,12.4c7.7,1.3,15.5,2.3,23.3,3.1 l0.3-12l2,0l-0.3,12.1c8.8,0.8,17.6,1.2,26.5,1.2v-25h4v29h-2c-0.7,0-1.3,0-2,0c-85.5-0.5-165.8-34.1-226.4-94.6 C33.6,490.4,0,409.3,0,323c0-86.3,33.6-167.4,94.6-228.4C155.1,34.1,235.5,0.5,321,0c0.7,0,1.3,0,2,0h2v26H321z"
                        )
                        .attr({
                            parent: "group_a",
                            fill: "#FFFFFF",
                            "stroke-width": "0",
                            "stroke-opacity": "1"
                        })
                        .data("id", "path_c");
                    var path_d = rsr
                        .path("M323,0c-0.7,0-1.3,0-2,0v0H323z")
                        .attr({
                            parent: "group_a",
                            fill: "#FFFFFF",
                            "stroke-width": "0",
                            "stroke-opacity": "1"
                        })
                        .data("id", "path_d");
                    var path_e = rsr
                        .path(
                            "M481.4,164.6C439.1,122.3,382.8,99,323,99c-59.8,0-116.1,23.3-158.4,65.6 C122.3,206.9,99,263.2,99,323c0,59.8,23.3,116.1,65.6,158.4C206.9,523.7,263.2,547,323,547c59.8,0,116.1-23.3,158.4-65.6 C523.7,439.1,547,382.8,547,323C547,263.2,523.7,206.9,481.4,164.6z M166.4,168.5l27.4,27.4c-31.9,32.4-51.7,76.7-52.1,125.6H103 C103.4,263.8,125.8,209.6,166.4,168.5z M202,324.5h50.8c0.4,18.2,7.7,34.8,19.5,47.1l-35.9,35.9C215.5,385.9,202.4,356.7,202,324.5 z M233.6,410.2L233.6,410.2l-37,37c-31.2-31.7-50.6-75-50.9-122.8H198C198.4,357.8,211.9,388,233.6,410.2z M256.8,324.5h62.6 l-44.2,44.2C264.1,357.1,257.2,341.6,256.8,324.5z M256.8,321.5c0.4-17.1,7.3-32.7,18.3-44.2l44.2,44.2H256.8z M252.8,321.5H202 c0.4-32.2,13.4-61.4,34.4-82.9l35.9,35.9C260.5,286.7,253.2,303.3,252.8,321.5z M198,321.5h-52.4c0.4-47.8,19.8-91.1,50.9-122.8 l37,37C211.9,257.9,198.4,288.2,198,321.5z M103,324.5h38.6c0.4,48.9,20.2,93.2,52.1,125.6l-27.4,27.4 C125.8,436.4,103.4,382.2,103,324.5z M321.5,543c-57.7-0.4-111.9-22.8-153-63.4l27.4-27.4c32.4,31.9,76.7,51.7,125.6,52.1V543z M321.5,500.4c-47.8-0.4-91.1-19.8-122.8-51l37-37c22.2,21.7,52.4,35.2,85.8,35.6V500.4z M321.5,444c-32.2-0.4-61.5-13.4-82.9-34.4 l35.9-35.9c12.3,11.8,28.8,19.1,47.1,19.5V444z M321.5,389.2c-17.1-0.4-32.7-7.3-44.2-18.3l44.2-44.2V389.2z M321.5,319.3 l-44.2-44.2c11.6-11.1,27.1-18,44.2-18.4V319.3z M321.5,252.8c-18.2,0.4-34.8,7.8-47,19.5l-35.9-35.9c21.5-21,50.7-34,82.9-34.4 V252.8z M321.5,198c-33.3,0.4-63.6,13.9-85.8,35.6l-37-37c31.7-31.2,75-50.5,122.8-50.9V198z M321.5,141.6 c-48.9,0.4-93.2,20.2-125.6,52.1l-27.4-27.4c41.1-40.5,95.3-63,153-63.4V141.6z M543,321.5h-38.6c-0.4-48.9-20.2-93.2-52.1-125.6 l27.4-27.4C520.1,209.6,542.6,263.8,543,321.5z M389.2,321.5h-62.6l44.2-44.2C381.9,288.8,388.8,304.4,389.2,321.5z M373.6,274.4 l35.9-35.9c21,21.5,34,50.7,34.4,82.9h-50.8C392.8,303.3,385.4,286.7,373.6,274.4z M389.2,324.5c-0.4,17.1-7.3,32.7-18.3,44.2 l-44.2-44.2H389.2z M393.2,324.5H444c-0.4,32.2-13.4,61.5-34.4,83l-35.9-35.9C385.4,359.2,392.8,342.7,393.2,324.5z M448,324.5 h52.4c-0.4,47.8-19.8,91.1-50.9,122.8l-37-37C434.1,388,447.6,357.8,448,324.5z M448,321.5c-0.4-33.3-13.9-63.6-35.6-85.8l37-37 c31.2,31.7,50.6,75,50.9,122.8H448z M324.5,103c57.7,0.4,111.9,22.8,153,63.4l-27.4,27.4c-32.4-31.9-76.8-51.7-125.6-52.1V103z M324.5,145.6c47.8,0.4,91.1,19.8,122.8,50.9l-37,37h0c-22.2-21.7-52.4-35.2-85.8-35.6V145.6z M324.5,202 c32.2,0.4,61.4,13.4,82.9,34.4l-35.9,35.9c-12.3-11.8-28.8-19.1-47-19.5V202z M324.5,256.8c17.1,0.4,32.7,7.3,44.2,18.3l-44.2,44.2 V256.8z M324.5,326.6l44.2,44.2c-11.6,11-27.1,18-44.2,18.3V326.6z M324.5,393.2c18.2-0.4,34.8-7.7,47.1-19.5l35.9,35.9 c-21.5,21-50.7,34-82.9,34.4V393.2z M324.5,448c33.3-0.4,63.6-13.9,85.8-35.6l37,37c-31.7,31.2-75,50.6-122.8,51V448z M324.5,543 v-38.6c48.9-0.4,93.2-20.2,125.6-52.1l27.4,27.4C436.4,520.1,382.2,542.6,324.5,543z M479.6,477.5l-27.4-27.4 c31.9-32.4,51.7-76.8,52.1-125.6H543C542.6,382.2,520.1,436.4,479.6,477.5z"
                        )
                        .attr({ parent: "group_a", fill: "#FFFFFF", "stroke-width": "0", "stroke-opacity": "1" })
                        .data("id", "path_e");
                    group_a.attr({ name: "group_a" });
                    var rsrGroups = [group_a];
                    group_a.push(path_b, path_c, path_d, path_e);
                    self.threeSixtyRadar = {
                        redrawTags: _.throttle(function(tagYaws, playerYaw, maxYaw, minYaw) {
                            element.find(".three-sixty-radar-fov").show();

                            tagContainerElement.empty();
                            _.each(tagYaws, function(tagYaw) {
                                var rotation = tagYaw > 0 ? tagYaw : 360 + tagYaw;
                                var tagElem = $('<div class="three-sixty-radar-tag" style="transform: rotate(' + rotation + 'deg);"></div>');
                                tagContainerElement.append(tagElem);
                            });

                            tagContainerElement.css("transform", "rotate(" + -playerYaw + "deg) scale(0.5)");
                        }, 300),
                        element: element
                    };
                }

                return self.threeSixtyRadar;
            },
            getForwardsBackwardsController: function() {
                var self = this;
                if (!self.forwardsBackwardsController) {
                    var element = $(
                        $(Templates)
                            .filter("#forwards-backwards-slick-template")
                            .html()
                    );

                    var rsr = Raphael(element.find("#backwards-control .innerSvg")[0], "100%", "100%");
                    rsr.setViewBox(0, 0, 100, 100, true);
                    var path_b = rsr.path(
                        "M4.1,12.5L4.1,12.5c0.1,0,0.1-0.1,0.2-0.1c0.1,0,0.2,0,0.3,0.1l6.8,4.5c9.2-10.1,22.2-15.8,36-15.8 c26.9,0,48.8,21.9,48.8,48.8c0,26.9-21.9,48.8-48.8,48.8c-15.4,0-29.6-7-38.9-19.3c-0.2-0.3-0.2-0.8,0.1-1c0.3-0.2,0.8-0.2,1,0.1 c9.1,11.9,22.8,18.8,37.8,18.8c26.1,0,47.4-21.3,47.4-47.4c0-26.1-21.3-47.4-47.4-47.4c-13.3,0-25.8,5.5-34.8,15.2l6.7,4.5 c0.1,0.1,0.2,0.3,0.2,0.4c0,0.2-0.1,0.3-0.3,0.4l-7.1,2.7l-7.4,3.1c-0.1,0.1-0.3,0-0.4,0c-0.1-0.1-0.2-0.2-0.2-0.4L3.8,12.9 C3.8,12.7,3.9,12.5,4.1,12.5z"
                    );
                    path_b.attr({ fill: "#FFFFFF", "stroke-width": "0", "stroke-opacity": "1" }).data("id", "path_b");
                    var group_a = rsr.set();
                    var path_c = rsr
                        .path(
                            "M39.4,51l11.9-9.4c0.2-0.1,0.4-0.1,0.5-0.1c0.2,0.1,0.3,0.3,0.3,0.5v7.9h20.4c0.8,0,1.5,0.7,1.5,1.5 s-0.7,1.5-1.5,1.5H52.1v7.9c0,0.2-0.1,0.4-0.3,0.5c-0.1,0-0.1,0-0.2,0c-0.1,0-0.2,0-0.3-0.1l-11.9-9.4c-0.1-0.1-0.2-0.2-0.2-0.4 S39.2,51.1,39.4,51z"
                        )
                        .attr({ parent: "group_a", fill: "#FFFFFF", "stroke-width": "0", "stroke-opacity": "1" })
                        .data("id", "path_c");
                    var path_d = rsr
                        .path("M30.3,71.6c0.6,0,1-0.4,1-1V32.3c0-0.6-0.4-1-1-1s-1,0.4-1,1v38.3C29.3,71.1,29.8,71.6,30.3,71.6z")
                        .attr({ parent: "group_a", fill: "#FFFFFF", "stroke-width": "0", "stroke-opacity": "1" })
                        .data("id", "path_d");
                    group_a.attr({ name: "group_a" });
                    var rsrGroups = [group_a];
                    group_a.push(path_c, path_d);

                    var rsr = Raphael(element.find("#forwards-control .innerSvg")[0], "100%", "100%");
                    rsr.setViewBox(0, 0, 100, 100, true);
                    var path_a = rsr.path(
                        "M95.9,12.5L95.9,12.5c-0.1,0-0.1-0.1-0.2-0.1c-0.1,0-0.2,0-0.3,0.1L88.6,17 C79.4,6.9,66.4,1.2,52.7,1.2C25.7,1.2,3.8,23.1,3.8,50c0,26.9,21.9,48.8,48.8,48.8c15.4,0,29.6-7,38.9-19.3c0.2-0.3,0.2-0.8-0.1-1 c-0.3-0.2-0.8-0.2-1,0.1c-9.1,11.9-22.8,18.8-37.8,18.8C26.5,97.4,5.2,76.1,5.2,50c0-26.1,21.3-47.4,47.4-47.4 c13.3,0,25.8,5.5,34.8,15.2l-6.7,4.5c-0.1,0.1-0.2,0.3-0.2,0.4c0,0.2,0.1,0.3,0.3,0.4l7.1,2.7l7.4,3.1c0.1,0.1,0.3,0,0.4,0 c0.1-0.1,0.2-0.2,0.2-0.4l0.3-15.6C96.2,12.7,96.1,12.5,95.9,12.5z"
                    );
                    path_a.attr({ fill: "#FFFFFF", "stroke-width": "0", "stroke-opacity": "1" }).data("id", "path_a");
                    var path_b = rsr.path(
                        "M62.9,51l-11.9-9.4c-0.2-0.1-0.4-0.1-0.5-0.1c-0.2,0.1-0.3,0.3-0.3,0.5v7.9H29.8 c-0.8,0-1.5,0.7-1.5,1.5s0.7,1.5,1.5,1.5h20.4v7.9c0,0.2,0.1,0.4,0.3,0.5c0.1,0,0.1,0,0.2,0c0.1,0,0.2,0,0.3-0.1l11.9-9.4 c0.1-0.1,0.2-0.2,0.2-0.4S63.1,51.1,62.9,51z"
                    );
                    path_b.attr({ fill: "#FFFFFF", "stroke-width": "0", "stroke-opacity": "1" }).data("id", "path_b");
                    var path_c = rsr.path("M72,71.6c-0.6,0-1-0.4-1-1V32.3c0-0.6,0.4-1,1-1s1,0.4,1,1v38.3C73,71.1,72.6,71.6,72,71.6z");
                    path_c.attr({ fill: "#FFFFFF", "stroke-width": "0", "stroke-opacity": "1" }).data("id", "path_c");
                    var rsrGroups = [];

                    self.forwardsBackwardsController = new ForwardsBackwardsControllerSlick(element);
                }
                return self.forwardsBackwardsController;
            },
            getLogo: function() {
                var self = this;
                if (!self.logo) {
                    if (!globals.MEDIA_TYPE && !globals.WHITELABEL && globals.DISABLE_STANDARD_END_FRAME) {
                        var logoElement = $(
                            $(Templates)
                                .filter("#logo-slick-template")
                                .html()
                        );
                        self.logo = new Logo(logoElement);
                    } else if (!globals.MEDIA_TYPE && !globals.WHITELABEL && !globals.DISABLE_STANDARD_END_FRAME) {
                        var logoElement = $(
                            $(Templates)
                                .filter("#logo-slick-template-with-banner")
                                .html()
                        );
                        self.logo = new LogoWithBanner(logoElement);
                    }
                }
                return globals.WHITELABEL ? null : self.logo;
            },
            getWaxConsole: function(player) {
                if (!self.waxConsole) {
                    var consoleElement = $(Templates)
                        .filter("#wax-console-template")
                        .html();
                    self.waxConsole = new Console(consoleElement, player);
                }
                return self.waxConsole;
            },
            getFont: function(folder, fontName) {
                this.toolkit.getFont(folder, fontName, fontName);
            },
            getLoader: function() {
                if (!self.loader) {
                    var loaderElement = $(
                        $(Templates)
                            .filter("#loader-slick-template")
                            .html()
                    );
                    self.loader = new Loader(loaderElement);
                }
                return self.loader;
            },
            getScrubber: function() {
                if (!self.scrubber) {
                    var scrubberElement = $(
                        $(Templates)
                            .filter("#scrubber-slick-template")
                            .html()
                    );
                    self.scrubber = new Scrubber(scrubberElement);
                }

                return self.scrubber;
            },
            getPlayButton: function() {
                if (!self.playButton) {
                    var playButtonElement = $(
                        $(Templates)
                            .filter("#play-button-template")
                            .html()
                    );

                    var rsr = Raphael(playButtonElement.find(".innerSvg")[0], "100%", "100%");
                    rsr.setViewBox(0, 0, 100, 100, true);
                    var buttonSvg = rsr.path("M18.7,1L18.8,1L81.2,49.5L18.8,99z");
                    buttonSvg.attr({
                        fill: "transparent",
                        stroke: "#ffffff",
                        "stroke-width": 5,
                        "stroke-linejoin": "round"
                    });

                    if (window.wirewax.writer) {
                        playButtonElement.addClass("studio-play-button");
                    }

                    self.playButton = new PlayButton(playButtonElement, self.animationController);
                }
                return self.playButton;
            },
            getPauseButton: function() {
                if (!self.pauseButton) {
                    var pauseButtonElement = $(
                        $(Templates)
                            .filter("#pause-button-template")
                            .html()
                    );

                    var rsr = Raphael(pauseButtonElement.find(".innerSvg")[0], "100%", "100%");
                    rsr.setViewBox(0, 0, 100, 100, true);
                    var buttonSvg = rsr.path("M22.7,0.5v98 M77.3,0.5v98");
                    buttonSvg.attr({
                        fill: "transparent",
                        stroke: "#ffffff",
                        "stroke-width": 10,
                        "stroke-linejoin": "round"
                    });

                    self.pauseButton = new PauseButton(pauseButtonElement, self.animationController);
                }
                return self.pauseButton;
            },
            getBottomBarPlayButton: function() {
                if (!self.bottomBarPlayButton) {
                    var bottomBarPlayButtonElement = $(
                        $(Templates)
                            .filter("#bottom-bar-play-button-template")
                            .html()
                    );

                    var rsr = Raphael(bottomBarPlayButtonElement.find(".innerSvg")[0], "100%", "100%");
                    rsr.setViewBox(0, 0, 100, 100, true);
                    var buttonSvg = rsr.path("M18.7,1L18.8,1L81.2,49.5L18.8,99z");
                    buttonSvg.attr({
                        fill: "transparent",
                        stroke: "#ffffff",
                        "stroke-width": 3,
                        "stroke-linejoin": "round"
                    });

                    var onButtonShow = function() {
                        buttonSvg.animate({ path: "M18.7,1L18.8,1L81.2,49.5L18.8,99z" }, 200);
                    };

                    var onButtonHide = function() {
                        buttonSvg.animate({ path: "M22.7,0.5v98 M77.3,0.5v98" }, 200);
                    };

                    var invertFn = function() {};

                    var revertFn = function() {};

                    self.bottomBarPlayButton = new BottomBarPlayButton(bottomBarPlayButtonElement, invertFn, revertFn, onButtonShow, onButtonHide);
                }
                return self.bottomBarPlayButton;
            },
            getBottomBarPauseButton: function() {
                if (!self.bottomBarPauseButton) {
                    var bottomBarPauseButtonElement = $(
                        $(Templates)
                            .filter("#bottom-bar-pause-button-template")
                            .html()
                    );

                    var rsr = Raphael(bottomBarPauseButtonElement.find(".innerSvg")[0], "100%", "100%");
                    rsr.setViewBox(0, 0, 100, 100, true);
                    var buttonSvg = rsr.path("M18.7,1L18.8,1L81.2,49.5L18.8,99z");
                    buttonSvg.attr({
                        fill: "transparent",
                        stroke: "#ffffff",
                        "stroke-width": 3,
                        "stroke-linejoin": "round"
                    });

                    var onButtonShow = function() {
                        buttonSvg.animate({ path: "M22.7,0.5v98 M77.3,0.5v98" }, 200);
                    };

                    var onButtonHide = function() {
                        buttonSvg.animate({ path: "M18.7,1L18.8,1L81.2,49.5L18.8,99z" }, 200);
                    };

                    var invertFn = function() {};

                    var revertFn = function() {};

                    self.bottomBarPauseButton = new BottomBarPauseButton(bottomBarPauseButtonElement, invertFn, revertFn, onButtonShow, onButtonHide);
                }
                return self.bottomBarPauseButton;
            },
            getShareControllerElement: function() {
                if (!self.shareControllerElement) {
                    self.shareControllerElement = $(
                        $(Templates)
                            .filter("#share-controller-slick-template")
                            .html()
                    );
                }

                return self.shareControllerElement;
            },
            getBottomBarFullscreenButton: function() {
                if (!self.bottomBarFullscreenButton) {
                    var bottomBarFullscreenButtonElement = $(
                        $(Templates)
                            .filter("#bottom-bar-fullscreen-button-slick-template")
                            .html()
                    );

                    var rsr = Raphael(bottomBarFullscreenButtonElement.find(".innerSvg")[0], "100%", "100%");
                    rsr.setViewBox(0, 0, 100, 100, true);
                    var buttonSvg = rsr.path("M1,40.7v-27h37.2 M99,40.7v-27H61.8 M61.8,86.3H99v-27 M1,59.3v27h37.2");
                    buttonSvg.attr({
                        fill: "transparent",
                        stroke: "#ffffff",
                        "stroke-width": 3,
                        "stroke-linejoin": "round"
                    });

                    var invertFn = function() {
                        buttonSvg.animate({ path: "M1,40.7v-27h37.2 M99,40.7v-27H61.8 M61.8,86.3H99v-27 M1,59.3v27h37.2" }, 200);
                    };

                    var revertFn = function() {
                        buttonSvg.animate({ path: "M38.2,13.7v27H1M61.8,13.7v27H99 M99,59.3H61.8v27 M38.2,86.3v-27H1" }, 200);
                    };

                    self.bottomBarFullscreenButton = new BottomBarFullscreenButton(bottomBarFullscreenButtonElement, invertFn, revertFn);
                }

                return self.bottomBarFullscreenButton;
            },
            getBottomBarRenditionController: function() {
                if (!self.bottomBarRenditionController) {
                    var bottomBarRenditionControllerElement = $(
                        $(Templates)
                            .filter("#bottom-bar-rendition-controller-slick-template")
                            .html()
                    );

                    var HDPath = "M50.2,6.3C74.4,6.3,99,13.3,99,50c0,36.8-24.7,43.7-48.8,43.7V6.3z M1,6.3v87.4 M49.7,50H1";
                    var SDPath =
                        "M50.2,88.6c21.6,0,43.9-6.2,43.9-39.3c0-33-22.1-39.3-43.9-39.3V88.6zM37.3,12.4c-1.4-0.9-6.3-2.3-9.6-2.3C24.4,10,9.4,10,9.4,26.8s16.8,19.2,19.6,21c2.8,1.9,14,4.2,14,21.3S28.9,89.9,26.3,89.9s-12.9,1.2-20.3-11";
                    var currentPath = HDPath;

                    if (globals.RENDITION === "1080" || globals.RENDITION === "720") {
                        var currentPath = SDPath;
                    }

                    var rsr = Raphael(bottomBarRenditionControllerElement.find(".innerSvg")[0], "100%", "100%");
                    rsr.setViewBox(0, 0, 100, 100, true);
                    var buttonSvg = rsr.path(currentPath);
                    buttonSvg.attr({
                        fill: "transparent",
                        stroke: "#ffffff",
                        "stroke-width": 3,
                        "stroke-linejoin": "round"
                    });

                    var toggleHDFn = function() {
                        buttonSvg.animate({ path: HDPath }, 200);
                    };

                    var toggleSDFn = function() {
                        buttonSvg.animate({ path: SDPath }, 200);
                    };

                    self.bottomBarRenditionController = new BottomBarRenditionController(bottomBarRenditionControllerElement, toggleHDFn, toggleSDFn);
                }

                if (_.contains(globals.RENDITIONS, "720")) {
                    return self.bottomBarRenditionController;
                } else {
                    return null;
                }
            },
            getOverlayButtons: function(player) {
                var elements = [];

                if (!globals.DISABLE_SHARES && globals.WHITELABEL) {
                    var shareControllerElement = self.getShareControllerElement();

                    if (shareControllerElement) {
                        var shareController = new ShareController(shareControllerElement, vidId, self.animationController, player.getFrame, player.getCurrentTime, function() {
                            PubSub.publish(globals.OPEN_SHARE_SCREEN);
                        });

                        elements.push(shareController);
                    }
                }

                return elements;
            },
            getBottomBarElements: function() {
                return [];
            },
            getSettingsElements: function() {
                return [];
            },
            getBottomBarSettingsController: function(settingsElements) {
                if (!self.bottomBarSettingsController) {
                    var bottomBarSettingsControllerElement = $(
                        $(Templates)
                            .filter("#bottom-bar-settings-controller-template")
                            .html()
                    );

                    var invertFn = function() {};
                    var revertFn = function() {};

                    self.bottomBarSettingsController = new BottomBarSettingsController(bottomBarSettingsControllerElement, invertFn, revertFn, settingsElements);
                }
                return self.bottomBarSettingsController;
            },
            getBottomBarSubtitleController: function(subtitles, switchSubtitles, player) {
                if (!self.bottomBarSubtitleController) {
                    var bottomBarSubtitleControllerElement = $(
                        $(Templates)
                            .filter("#bottom-bar-subtitle-controller-slick-template")
                            .html()
                    );
                    var allSubtitles = player.subtitles;
                    var subtitlesShowing = false;
                    var subtitlesPopulated = false;

                    var rsr = Raphael(bottomBarSubtitleControllerElement.find(".innerSvg")[0], "100%", "100%");
                    rsr.setViewBox(0, 0, 21, 21, true);
                    var circle_a = rsr.circle(10, 10, 10);
                    circle_a
                        .attr({
                            fill: "none",
                            stroke: "#949b88",
                            "stroke-width": "1",
                            "stroke-opacity": "1"
                        })
                        .data("id", "circle_a");
                    var text_b = rsr.text("5.803px", "18.167px", "S");
                    text_b
                        .attr({
                            "font-family": "AppleSDGothicNeo-Thin, Apple SD Gothic Neo",
                            "font-weight": "100",
                            "font-size": "20.417px",
                            fill: "#949b88",
                            "stroke-width": "0",
                            "stroke-opacity": "1"
                        })
                        .data("id", "text_b");
                    text_b.node.setAttribute("class", "inner-s");

                    var invertFn = function() {};
                    var revertFn = function() {};

                    self.bottomBarSubtitleController = new BottomBarSubtitleController(bottomBarSubtitleControllerElement, invertFn, revertFn, subtitles, switchSubtitles);

                    var allLanguages = {
                        af: "Afrikaans", // Afrikaans
                        sq: "Shqip", // Albanian
                        ar: "العربية", // Arabic
                        hy: "հայերեն", // Armenian
                        az: "azərbaycan", // Azerbaijani
                        eu: "euskara", // Basque
                        be: "беларуская", // Belarusian
                        bn: "বাংলা", // Bengali
                        bg: "български", // Bulgarian
                        ca: "català", // Catalan
                        zh: "中文 (Zhōngwén), 汉语, 漢語", // Chinese
                        "zh-CN": "Chinese (Simplified)", // Chinese Simplified
                        "zh-TW": "Chinese (Traditional)", // Chinese Traditional
                        "zh-HK": "Chinese (Hong Kong)", // Chinese Hong Kong
                        hr: "Hrvatski", // Croatian
                        cs: "čeština", // Czech
                        da: "Dansk", // Danish
                        nl: "Nederlands", // Dutch
                        en: "English", // English
                        eo: "Esperanto", // Esperanto
                        et: "Eesti", // Estonian
                        tl: "Filipino", // Filipino
                        fi: "Suomi", // Finnish
                        fr: "Français", // French
                        "fr-CA": "Français (Canada)", // Canadian French
                        gl: "Galego", // Galician
                        de: "Deutsch", // German
                        ka: "ქართული", // Georgian
                        el: "Ελληνικά", // Greek
                        gu: "ગુજરાતી", // Gujarati
                        ht: "Kreyòl ayisyen", // Haitian Creole
                        he: "עברית‎", // Hebrew
                        hi: "हिन्दी", // Hindi
                        hu: "Magyar", // Hungarian
                        is: "íslenska", // Icelandic
                        id: "Indonesia", // Indonesian
                        ga: "Gaeilge", // Irish
                        it: "Italiano", // Italian
                        ja: "日本語", // Japanese
                        kn: "ಕನ್ನಡ", // Kannada
                        ko: "한국어", // Korean
                        la: "Latine", // Latin
                        lv: "Latviešu", // Latvian
                        lt: "Lietuvių", // Lithuanian
                        mk: "македонски", // Macedonian
                        ms: "بهاس ملايو", // Malay
                        mt: "Malti", // Maltese
                        no: "Norsk", // Norwegian
                        fa: "فارسی‎", // Persian
                        pl: "Polski", // Polish
                        pt: "Português", // Portuguese
                        ro: "Română", // Romanian
                        ru: "Pусский", // Russian
                        sr: "Cрпски", // Serbain
                        sk: "Slovenčina", // Slovak
                        sl: "Slovenščina", // Slovenian
                        es: "Español", // Spanish
                        sw: "Kiswahili", // Swahili
                        sv: "Svenska", // Swedish
                        ta: "தமிழ்", // Tamil
                        te: "తెలుగు", // Telugu
                        th: "ไทย", // Thai
                        tr: "Türkçe", // Turkish
                        uk: "Yкраїнська", // Ukrainian
                        ur: "اردو", // Urdu
                        vi: "Tiếng Việt", // Vietnamese
                        cy: "Cymraeg", // Welsh
                        yi: "ייִדיש" // Yiddish
                    };

                    var subtitleSidebar = $('<div id="subtitle-sidebar"><div class="subtitle-header">Subtitles</div></div>');
                    var noneOption = $(
                        '<div class="subtitle-option-wrap none-option">' +
                            '<input type="checkbox" class="subtitle-option" data-lang="" id="option-none">' +
                            '<label for="option-none">None</label>' +
                            "</div>"
                    );
                    subtitleSidebar.append(noneOption);

                    var selectedLanguage;

                    var populateSubtitleOptions = function() {
                        subtitlesPopulated = true;
                        for (var key in allSubtitles) {
                            var language = allLanguages[key] || "Unknown";
                            var subtitleOptionWrap = $(
                                '<div class="subtitle-option-wrap">' +
                                    '<input type="checkbox" class="subtitle-option" data-lang="' +
                                    key +
                                    '" id="option-' +
                                    key +
                                    '">' +
                                    '<label for="option-' +
                                    key +
                                    '"><p>' +
                                    language +
                                    "</p></label>" +
                                    "</div>"
                            );
                            if (selectedLanguage) {
                                subtitleOptionWrap.find("#option-" + selectedLanguage).prop("checked", true);
                            }
                            subtitleSidebar.append(subtitleOptionWrap);

                            $(subtitleOptionWrap)
                                .find(".subtitle-option")
                                .on(globals.CLICK_EVENT, function(e) {
                                    if (!$(this).prop("checked")) {
                                        e.preventDefault();
                                    } else {
                                        $('input[type="checkbox"]')
                                            .not(this)
                                            .prop("checked", false);

                                        selectedLanguage = this.getAttribute("data-lang");
                                        PubSub.publish(globals.CHOSEN_SUBTITLES, selectedLanguage);
                                    }
                                    window.setTimeout(function() {
                                        self.bottomBarSubtitleController.hide(!subtitlesShowing);
                                        subtitleSidebar
                                            .find(".subtitle-option-wrap")
                                            .not(".none-option")
                                            .remove();
                                        subtitlesPopulated = false;
                                        subtitlesShowing = true;
                                    }, 500);
                                });
                        }
                    };
                    noneOption.find("#option-none").on(globals.CLICK_EVENT, function(e) {
                        selectedLanguage = "";
                        $('input[type="checkbox"]')
                            .not(this)
                            .prop("checked", false);
                        window.setTimeout(function() {
                            self.bottomBarSubtitleController.hide(subtitlesShowing);
                            if (subtitlesShowing) {
                                subtitlesShowing = false;
                            } else {
                                e.preventDefault();
                            }
                            subtitleSidebar
                                .find(".subtitle-option-wrap")
                                .not(".none-option")
                                .remove();
                            subtitlesPopulated = false;
                        }, 500);
                    });
                    $("#control-overlay").append(subtitleSidebar);

                    PubSub.subscribe(globals.SHOW_SUBTITLES, function() {
                        if (!subtitlesPopulated) {
                            populateSubtitleOptions();
                        }

                        if (Object.keys(allSubtitles).length > 1) {
                            $("#subtitle-sidebar").addClass("showing");
                        } else {
                            PubSub.publish(globals.TOGGLE_SUBTITLES);
                        }
                    });
                }
                return self.bottomBarSubtitleController;
            },
            getVolumeControllerElement: function() {
                if (!self.volumeControllerElement) {
                    self.volumeControllerElement = $(
                        $(Templates)
                            .filter("#volume-controller-slick-template")
                            .html()
                    );
                }

                return self.volumeControllerElement;
            },
            getUserMessage: function() {
                if (!self.userMessage) {
                    var userMessageElement = $(
                        $(Templates)
                            .filter("#user-message-template")
                            .html()
                    );
                    self.userMessage = new UserMessage($(userMessageElement));
                }
                return self.userMessage;
            },
            getShareScreen: function(closeCallback) {
                if (!self.shareScreen) {
                    var shareScreenElement = $(
                        $(Templates)
                            .filter("#share-screen-template")
                            .html()
                    );
                    self.shareScreen = new ShareScreen($(shareScreenElement), closeCallback);
                }

                return self.shareScreen;
            },
            getStartOverlay: function() {
                return null;
            },
            getDisabledAudioIcon: function() {
                if (!self.disabledAudioIcon) {
                    self.disabledAudioIcon = $(
                        $(Templates)
                            .filter("#disabled-audio-template")
                            .html()
                    ).hide();

                    var rsr = Raphael(self.disabledAudioIcon.find(".innerSvg")[0], "100%", "100%");
                    rsr.setViewBox(0, 0, 100, 100, true);
                    var buttonSvg = rsr.path("M82.6,78.4v21.1L32.3,68.9l0,0H6.8v-38h25.5l0,0L82.6,0.5v22.9 M69.3,36.2l26.9,27.5 M69,63.4l27.5-26.9");
                    buttonSvg
                        .attr({
                            fill: "transparent",
                            stroke: "#ffffff",
                            "stroke-width": 3,
                            "stroke-linejoin": "round"
                        })
                        .data("id", "path_c");
                    var unMute = Raphael(self.disabledAudioIcon.find(".un-mute-symbol")[0], "100%", "100%");

                    unMute.setViewBox(0, 0, 100, 100, true);
                    var regularPath = "M82.6,0.5V50v49.5L32.3,68.9l0,0H6.8v-38h25.5l0,0L82.6,0.5z";
                    var buttonSvg = unMute.path(regularPath);
                    buttonSvg.attr({
                        fill: "transparent",
                        stroke: "#ffffff",
                        "stroke-width": 3,
                        "stroke-linejoin": "round"
                    });
                }
                return self.disabledAudioIcon;
            },
            applyBindings: function() {
                // MOVE THIS ALL TO THE SCRUBBER
                self.hideScrubber = globals.HIDE_SCRUBBER;

                if (globals.IS_DESKTOP) {
                    var waxHoverFn = function(e) {
                        if (self.hideScrubber && self.scrubber) {
                            var parentOffset = $(this)
                                .parent()
                                .offset();
                            var relY = (e.pageY - parentOffset.top) / $(this).height();
                            // var relX = (e.pageX - parentOffset.left) / $(this).width();
                            if (relY > 0.7) {
                                self.scrubber.hoverIn();
                            } else {
                                self.scrubber.hoverOut();
                            }
                        }
                    };

                    if (Modernizr.cssanimations) {
                        //fixme, find a way better way of determining when this works?
                        $("#waxxer").on("mousemove", _.throttle(waxHoverFn, 100));
                    } else {
                        $("#video-container").on("mousemove", _.throttle(waxHoverFn, 100));
                    }
                }
            }
        });

        return SkinBaseSlick;
    }
);
wwplayer.define("AnimationController", ["jquery", "underscore", "Class", "pubsub", "globals"], function($, _, Class, PubSub, globals) {
    var self;

    var AnimationController = Class.extend(
        /** @lends AnimationController.prototype */ {
            /**
         Sets up the AnimationController

         @constructs AnimationController
         @extends Class
         @param {Number} fps the fps of the video
         @param {Number} duration the duration of the video
         @param {Number} tagDisplayMode the inital display mode for tags
         @param {HTMLElement} tagOverlay the element to draw tags to
         **/
            init: function(fps, duration, tagDisplayMode, tagOverlay) {
                self = this;
                self.log = function(message) {
                    if (window.wirewax.debug) {
                        var date = new Date();
                        console.log(date.getHours() + ":" + date.getMinutes() + ":" + date.getSeconds() + "." + date.getMilliseconds() + " " + message);
                    }
                };
                this.fps = fps;
                this.duration = duration;
                this.tagDisplayMode = tagDisplayMode;
                this.tagOverlay = tagOverlay;
                this.showTags = this.tagDisplayMode === 2;
                this.currentlyAnimatingTags = [];
                this.currentClipIndex = 0;
                this.tagAnimationCallbacks = [];
            },
            /**
         Resets the tag display mode
         @param {Number} tagDisplayMode the new display mode for tags
         **/
            setTagDisplayMode: function(tagDisplayMode) {
                self.tagDisplayMode = tagDisplayMode;
                this.showTags = self.tagDisplayMode === 2;
                // This might break the CSS Animation Engine if called too many times
                // if(tagDisplayMode === 2){
                // 	$('.tag').css('opacity', 1);
                // }
                // else {
                // 	$('.tag').css('opacity', 0);
                // }
            },
            /**
         Creates the animations from the tagData and associated elements
         @param {Object} tagData the data related to each tag
         @param {Array} tags the tag Class for each tag
         @param {Array} staticData the static tag data
         **/
            createAnimations: function(tagData, tags, staticData) {},
            /**
         Starts the animation for a tag
         @param {Tag} tag the tag to animate
         @param {Number} tagAnimationTime the total amount of time the tag will be animated
         @param {Number} tagStartOffset the offset from the clip start time
         **/
            animateTag: function(tag, tagAnimationTime, tagStartOffset) {
                if (this.tagDisplayMode === 0) {
                    return;
                }
                var tagElement = $(tag.element).find(".tag-inner-box");
                tagElement.unbind("mouseover");
                tagElement.unbind("mouseleave");

                if (!this.showTags) {
                    tagElement.css("opacity", 0);
                }

                if (this.tagDisplayMode === 1) {
                    tagElement.bind("mouseover", function() {
                        tagElement.css("opacity", 1);
                    });

                    tagElement.bind("mouseout", function() {
                        tagElement.css("opacity", 0);
                    });
                }

                PubSub.publish(globals.TAG_SHOW, tag);
            },
            /**
         Pauses the animation for a tag
         @param {HTMLElement} tagElement the element related to the tag
         **/
            pauseAnimation: function(tagElement) {},
            /**
         Notifies that all the animations have been created
         **/
            animationsCreated: function(lastRule) {
                // if(self.dummyAnimation || !lastRule || lastRule === ""){
                // 	PubSub.publish(globals.ANIMATIONS_READY);
                // 	return;
                // }

                // var dummy = document.createElement('dummy');
                //    var done = function(result) {
                //    	 if (dummy.parentNode) {
                //            dummy.parentNode.removeChild(dummy);
                //             PubSub.publish(globals.ANIMATIONS_READY);
                //        }
                //    };

                //    var onanimstart = function() {
                //    	self.dummyAnimation = true;
                //        done(true);
                //    };

                //    if (typeof dummy.style.animationName != 'undefined') {
                //        dummy.style.animationName = lastRule;
                //        dummy.style.animationDuration = '0.001s';
                //        dummy.addEventListener('animationstart', onanimstart);
                //    } else {
                //        dummy.style.webkitAnimationName = lastRule;
                //        dummy.style.webkitAnimationDuration = '0.001s';
                //        dummy.addEventListener('webkitAnimationStart', onanimstart);
                //    }

                //     (document.body || document.documentElement).appendChild(dummy);

                //     window.setTimeout(function(){
                //     	if(!self.dummyAnimation){
                //     		if (dummy.parentNode) {
                //     			dummy.removeEventListener('animationstart');
                //             dummy.parentNode.removeChild(dummy);
                //             self.animationsCreated(lastRule);
                //         }
                //     	}
                //     }, 1000);

                // Currently in place to fix the static tags in the first clip of shakespeares globe not showing up
                // due to animations not being ready yet
                globals.LOG("ANIMATIONS COMPLETED");
                var date = new Date().getTime();
                // TODO: FIX THIS
                if (window.wirewax.vidId === 8007330) {
                    if (globals.IS_IPHONE) {
                        window.setTimeout(function() {
                            PubSub.publish(globals.ANIMATIONS_READY);
                        }, 5000);
                    } else {
                        window.setTimeout(function() {
                            PubSub.publish(globals.ANIMATIONS_READY);
                        }, 3000);
                    }
                } else {
                    PubSub.publish(globals.ANIMATIONS_READY);
                }
            },
            /**
         Animates a set of css properties on an element
         @param {HTMLElement} element the element to animate
         @param {Number} duration the duration of the animation
         @param {Object} to the properties to animate to
         @param {Number} delay the starting delay of the animation
         @param {String} easing the easing function to use
         @param {Function} callback the callback for when the animations done
         **/
            animateTo: function(element, duration, to, delay, easing, callback) {},
            addTagAnimationCallback: function(callback) {
                this.tagAnimationCallbacks.push(callback);
            },
            pauseTagAtPosition: function(tag, position) {}
        }
    );

    return AnimationController;
});

/**
 @module TagCreator
 @requires jquery, underscore, globals
 **/
wwplayer.define("TagCreator", ["jquery", "underscore", "globals"], function($, _, globals) {
    /**
     Creates the Tag objects and DOM Elements based on the tag data
     @class TagCreator
     @constructor
     @param {Object} tagData
     @param {Class} Tag
     @param {Number} invFps
     @param {Object} swissData
     @param {Object} buttonData
     @param {Class} animationController
     @param {Object} staticTags
     **/
    var TempTag = null;
    if (window.wirewax.writer) {
        wwplayer.require(
            ["TempTag"],
            function(tempTag) {
                TempTag = tempTag;
            },
            function() {}
        );
    }
    var TagCreator = function(tagData, Tag, invFps, swissData, buttonData, animationController, metaData, staticTags) {
        var self = this;

        self.setCurrentTag = function(tagClass, tagId) {
            Tag = tagClass;
            metaData["tagId"] = tagId;
        };

        self.createDummyTag = function(isStatic) {
            return new Tag({
                tagIndex: 0,
                clipIndex: 0,
                tagType: 0,
                tagName: "",
                nameLink: 0,
                tagStartTime: 0,
                customNameRef: 0,
                tagElement: $("<div></div>"),
                widgetId: 0,
                animationController: animationController,
                isStatic: isStatic ? 1 : 0,
                spriteId: -1,
                appRef: 0,
                tagId: metaData["tagId"],
                buttonData: null,
                thumbIndex: 0,
                productId: null,
                dataConnections: [],
                isDummy: true
            });
        };

        self.getClipFromTimestamp = function(timestamp) {
            var frame = timestamp * (1 / invFps);

            for (var clipIndex in tagData) {
                if (frame > tagData[clipIndex]["in"] && frame < tagData[clipIndex]["out"]) {
                    return tagData[clipIndex];
                }
            }

            return 0;
        };

        self.createTagWithSpriteId = function(spriteId, tagData, swissData, buttonData, staticTags, videoData) {
            for (var clipIndex in tagData) {
                if (tagData[clipIndex]["tags"]) {
                    for (var tagIndex = 0; tagIndex < tagData[clipIndex]["tags"].length; tagIndex++) {
                        if (tagData[clipIndex]["tags"][tagIndex]["spriteId"] === spriteId) {
                            var thisTag = self.createTag(clipIndex, tagIndex, tagData, swissData, buttonData, videoData);
                            self.addTagToTagList(thisTag, clipIndex, tagIndex);
                            return thisTag;
                        }
                    }
                }
            }

            for (staticIndex in staticTags) {
                if (staticIndex % 1 === 0) {
                    var staticTagData = staticTags[staticIndex];
                    if (staticTagData.spriteId === spriteId) {
                        var staticTag = self.createStaticTag(tagData, staticTagData, staticTags, staticIndex, swissData, buttonData, videoData);
                        self.addStaticTagToTagList(staticTag, staticIndex);
                        return staticTag;
                    }
                }
            }

            return null;
        };

        self.getSpritesFromTagData = function(tagData, staticSpriteData) {
            var sprites = [];

            for (var clipIndex in tagData) {
                if (tagData[clipIndex]["tags"]) {
                    for (var tagIndex = 0; tagIndex < tagData[clipIndex]["tags"].length; tagIndex++) {
                        sprites.push(tagData[clipIndex]["tags"][tagIndex]["spriteId"]);
                    }
                }
            }

            _.each(staticTags, function(staticTag) {
                sprites.push(staticTag.spriteId);
            });

            return sprites;
        };

        // TODO: These 2 methods aren't very DRY
        self.createTag = function(clipIndex, tagIndex, tagData, swissData, buttonData, videoData) {
            var thisTag = tagData[clipIndex]["tags"][tagIndex];
            var deleted = thisTag["deleted"];
            var isStatic = 0;
            var tag = null;

            if (!deleted) {
                var w = thisTag["w"][0];
                var h = thisTag["h"][0];
                var l = thisTag["x"][0] - w / 2;
                var t = thisTag["y"][0] - h / 2;
                var spriteId = thisTag["spriteId"];

                if (thisTag["nameLink"]) {
                    var tagSwiss = _.findWhere(swissData, { nameLink: thisTag["nameLink"] });
                    var tagButton = tagSwiss !== undefined && tagSwiss["btnLink"] ? _.findWhere(buttonData, { btnLink: tagSwiss["btnLink"] }) : null;
                    var type = tagSwiss !== undefined ? tagSwiss.type : "undefined";
                    var productId = tagSwiss !== undefined ? tagSwiss.productId : "undefined";
                    var dataConnections = tagSwiss !== undefined ? tagSwiss.dataConnections : "undefined";
                    var customContent = tagSwiss !== undefined && tagSwiss.customContent !== null ? tagSwiss.customContent : "undefined";
                    var namelink = thisTag["nameLink"];
                    var name = tagSwiss !== undefined ? tagSwiss.tagName : "undefined";
                    var customNameRef = tagSwiss !== undefined ? tagSwiss.customNameRef : "undefined";
                    var widgetId = tagButton !== undefined && tagButton !== null && tagButton[0] ? tagButton[0].widgetId : undefined;
                    var widgetCdn = tagButton !== undefined && tagButton !== null && tagButton[0] ? tagButton[0].widgetCdn : false;
                    var defaultAppRef = tagButton !== undefined && tagButton !== null && tagButton[0] ? tagButton[0].defaultAppRef : "undefined";
                    var thumbIndex = thisTag["thumbIndex"];
                    var thumbImgIndex = thisTag["thumbImgIdx"] ? thisTag["thumbImgIdx"] : 0;
                    var overlayId = tagSwiss ? tagSwiss.overlayId : null;
                    var tagPositionX = thisTag["positionX"];
                    var tagPositionY = thisTag["positionY"];
                    var tagText = thisTag["tagText"];
                    var recognizedPerson = {
                        name: thisTag["recognizedPerson"],
                        conf: thisTag["recognizedPersonConf"]
                    };
                    var identifConf = thisTag["identifConf"];

                    if (!widgetId && tagSwiss && tagSwiss.widgetId) {
                        widgetId = tagSwiss.widgetId;
                    } else {
                        if (!tagButton || !tagButton[0] || tagButton[0].widgetRef === 0) {
                            widgetId = "popup";
                        }
                        if (tagSwiss && tagSwiss.overlayId) {
                            widgetId = "panels";
                        }
                    }

                    var tagStyle = "position: absolute;";
                    var tagElement = _.template(
                        "<div id='tag-<%= clipIndex %>-<%= tagIndex %>' style='width: " +
                            w * 100 +
                            "%; height: " +
                            h * 100 +
                            "%; <%= tagStyle %>' class='tag moving-tag tag-<%= clipIndex %> tag-type-<%= tagType %>' data-tagtype='<%= tagType %>' data-spriteid='<%= spriteId %>' data-clipindex='<%= clipIndex %>' data-tagindex='<%= tagIndex %>'>" +
                            "<div class='tag-inner-box'></div>" +
                            "</div>",
                        {
                            tagIndex: tagIndex,
                            clipIndex: clipIndex,
                            tagType: type,
                            tagStyle: tagStyle,
                            spriteId: spriteId
                        }
                    );
                    var clipStartFrame = tagData[clipIndex]["in"],
                        clipEndFrame = tagData[clipIndex]["out"],
                        tagStartFrame = clipStartFrame + thisTag["in"],
                        tagStartTime = tagStartFrame * invFps;

                    tag = new Tag({
                        videoData: videoData,
                        tagIndex: tagIndex,
                        clipIndex: clipIndex,
                        clipStartFrame: clipStartFrame,
                        clipEndFrame: clipEndFrame,
                        tagType: type,
                        productId: productId,
                        dataConnections: dataConnections,
                        customContent: customContent,
                        tagName: name,
                        nameLink: namelink,
                        tagStartTime: tagStartTime,
                        tagAnimationTime: parseFloat(thisTag["x"].length * invFps),
                        invFps: invFps,
                        customNameRef: customNameRef,
                        tagElement: $(tagElement)[0],
                        widgetId: widgetId,
                        animationController: animationController,
                        isStatic: isStatic,
                        spriteId: spriteId,
                        appRef: defaultAppRef,
                        tagId: metaData["tagId"],
                        buttonData: tagButton,
                        thumbIndex: thumbIndex,
                        thumbImgIndex: thumbImgIndex,
                        widgetCdn: widgetCdn,
                        vidName: metaData["vidName"],
                        overlayId: overlayId,
                        tagPositionX: tagPositionX,
                        tagPositionY: tagPositionY,
                        tagText: tagText,
                        recognizedPerson: recognizedPerson,
                        identifConf: identifConf,
                        preventPauseOnClick: thisTag["preventPauseOnClick"],
                        productDetails: tagSwiss && tagSwiss.productDetails
                    });
                } else if (window.wirewax.writer) {
                    var tagElement = _.template(
                        "<div id='tag-<%= clipIndex %>-<%= tagIndex %>' style='width: " +
                            w * 100 +
                            "%; height: " +
                            h * 100 +
                            "%; position: absolute;' class='temp-tag tag tag-<%= clipIndex %>' data-spriteid='<%= spriteId %>' data-clipindex='<%= clipIndex %>' data-tagindex='<%= tagIndex %>'>" +
                            "<div class='tag-inner-box'></div>" +
                            "</div>",
                        {
                            tagIndex: tagIndex,
                            clipIndex: clipIndex,
                            spriteId: spriteId
                        }
                    );

                    var clipStartFrame = tagData[clipIndex]["in"],
                        clipEndFrame = tagData[clipIndex]["out"],
                        tagStartFrame = clipStartFrame + thisTag["in"],
                        tagStartTime = tagStartFrame * invFps;

                    tag = new TempTag({
                        videoData: videoData,
                        tagIndex: tagIndex,
                        clipIndex: clipIndex,
                        clipStartFrame: clipStartFrame,
                        clipEndFrame: clipEndFrame,
                        tagType: type,
                        invFps: invFps,
                        tagAnimationTime: parseFloat(thisTag["x"].length * invFps),
                        tagStartTime: tagStartTime,
                        tagElement: $(tagElement)[0],
                        animationController: animationController,
                        isStatic: isStatic,
                        spriteId: spriteId,
                        thumbIndex: thumbIndex,
                        thumbImgIndex: thumbImgIndex,
                        vidName: metaData["vidName"],
                        customContent: customContent,
                        preventPauseOnClick: thisTag["preventPauseOnClick"]
                    });

                    // TODO Change this so that is isn't called more than once
                    tag.loadTagStyle();
                }
            }

            return tag;
        };

        self.createStaticTag = function(tagData, staticTag, staticTags, staticIndex, swissData, buttonData, videoData) {
            var deleted = staticTag["deleted"];
            var namelink = staticTag["nameLink"];
            var tag = null;

            if (deleted !== 1 && namelink !== 0) {
                var w = staticTag["w"][0];
                var h = staticTag["h"][0];
                var l = staticTag["x"][0] - w / 2;
                var t = staticTag["y"][0] - h / 2;
                var spriteId = staticTag["spriteId"];
                var isStatic = 1;

                var tagSwiss = _.findWhere(swissData, { nameLink: staticTag["nameLink"] });
                var tagButton = tagSwiss !== undefined && tagSwiss["btnLink"] ? _.findWhere(buttonData, { btnLink: tagSwiss["btnLink"] }) : null;
                var type = tagSwiss !== undefined ? tagSwiss.type : "undefined";
                var name = tagSwiss !== undefined ? tagSwiss.tagName : "undefined";
                var productId = tagSwiss !== undefined ? tagSwiss.productId : "undefined";
                var dataConnections = tagSwiss !== undefined ? tagSwiss.dataConnections : "undefined";
                var customContent = tagSwiss !== undefined && tagSwiss.customContent !== null ? tagSwiss.customContent : "undefined";
                var customNameRef = tagSwiss !== undefined ? tagSwiss.customNameRef : "undefined";
                var widgetId = tagButton !== undefined && tagButton !== null && tagButton[0] ? tagButton[0].widgetId : undefined;
                var widgetCdn = tagButton !== undefined && tagButton !== null && tagButton[0] ? tagButton[0].widgetCdn : false;
                var defaultAppRef = tagButton !== undefined && tagButton !== null && tagButton[0] ? tagButton[0].defaultAppRef : "undefined";
                var thumbIndex = staticTags[staticIndex]["thumbIndex"];
                var thumbImgIndex = staticTags[staticIndex]["thumbImgIdx"] ? tagData[clipIndex]["tags"][tagIndex]["thumbImgIdx"] : 0;
                var overlayId = tagSwiss ? tagSwiss.overlayId : null;
                var tagPositionX = staticTag["positionX"];
                var tagPositionY = staticTag["positionY"];
                var tagText = staticTag["tagText"];

                if (!widgetId && tagSwiss && tagSwiss.widgetId) {
                    widgetId = tagSwiss.widgetId;
                } else {
                    if (!tagButton || !tagButton[0] || tagButton[0].widgetRef === 0) {
                        widgetId = "popup";
                    }
                    if (tagSwiss && tagSwiss.overlayId) {
                        widgetId = "panels";
                    }
                }

                var tagElement = _.template(
                    "<div id='static-<%= staticIndex %>' class='tag static-tag static-<%= staticIndex %> tag-type-<%= tagType %>' data-spriteid='<%= spriteId %>' data-tagtype='<%= tagType %>'>" +
                        "<div class='tag-inner-box'></div>" +
                        "</div>",
                    {
                        staticIndex: staticIndex,
                        tagType: type,
                        spriteId: spriteId
                    }
                );

                tagElement = $(tagElement).css({
                    width: w * 100 + "%",
                    height: h * 100 + "%",
                    top: t * 100 + "%",
                    left: l * 100 + "%",
                    position: "absolute"
                })[0];

                var tagStartTime = staticTag["in"];
                var staticClipIndex = 0;

                _.each(tagData, function(clip, key) {
                    if (staticTag["in"] <= parseFloat(clip["in"] * invFps) && staticClipIndex === 0) {
                        staticClipIndex = key;
                    }
                });

                tag = new Tag({
                    videoData: videoData,
                    tagIndex: "s" + staticIndex,
                    clipIndex: -1,
                    staticClipIndex: staticClipIndex,
                    tagType: type,
                    productId: productId,
                    dataConnections: dataConnections,
                    customContent: customContent,
                    tagName: name,
                    nameLink: namelink,
                    tagStartTime: tagStartTime,
                    invFps: invFps,
                    tagAnimationTime: parseFloat(staticTag["out"]) - parseFloat(staticTag["in"]),
                    customNameRef: customNameRef,
                    buttonData: tagButton,
                    tagElement: $(tagElement)[0],
                    widgetId: widgetId,
                    animationController: animationController,
                    isStatic: isStatic,
                    spriteId: spriteId,
                    appRef: defaultAppRef,
                    tagId: metaData["tagId"],
                    thumbIndex: thumbIndex,
                    thumbImgIndex: thumbImgIndex,
                    widgetCdn: widgetCdn,
                    vidName: metaData["vidName"],
                    overlayId: overlayId,
                    tagPositionX: tagPositionX,
                    tagPositionY: tagPositionY,
                    tagText: tagText,
                    preventPauseOnClick: staticTag["preventPauseOnClick"],
                    productDetails: tagSwiss && tagSwiss.productDetails
                });
            }

            return tag;
        };

        self.addTagToTagList = function(tag, clipIndex, tagIndex) {
            if (tag) {
                self.tags[clipIndex + "-" + tagIndex] = tag;
            }
        };

        self.addStaticTagToTagList = function(tag, staticIndex) {
            if (tag) {
                self.tags["-1" + "-" + staticIndex] = tag;
            }
        };

        self.createTags = function(tagData, swissData, buttonData, staticTags, videoData) {
            self.tags = {};

            if (tagData) {
                for (var clipIndex in tagData) {
                    if (tagData[clipIndex]["tags"]) {
                        for (var tagIndex = 0; tagIndex < tagData[clipIndex]["tags"].length; tagIndex++) {
                            var thisTag = self.createTag(clipIndex, tagIndex, tagData, swissData, buttonData, videoData);
                            self.addTagToTagList(thisTag, clipIndex, tagIndex);
                        }
                    }
                }
            }

            if (staticTags) {
                for (staticIndex in staticTags) {
                    if (staticIndex % 1 === 0) {
                        //this is a weird bug in IE8 where "indexOf" was coming through as one of the indexes?!
                        var staticTagData = staticTags[staticIndex];
                        var staticTag = self.createStaticTag(tagData, staticTagData, staticTags, staticIndex, swissData, buttonData, videoData);
                        self.addStaticTagToTagList(staticTag, staticIndex);
                    }
                }
            }

            return self.tags;
        };

        self.createAnimations = function(tagData, tags, staticTags, redraw) {
            animationController.createAnimations(tagData, tags, staticTags, redraw);
        };
    };

    return TagCreator;
});

/**
	@module tagAnimator
	@requires jquery
**/
wwplayer.define("TagAnimator", ["jquery"], function($) {
    /**
		Animates tags

		@class TagAnimator
		@constructor
	**/
    var TagAnimator = function(animationController) {
        var self = this;

        /**
			Starts the animation for a given tag

			@method startAnimation
			@param {Tag} tag The tag to animate
			@param {Number} tagAnimationTime The time to animate the tag
			@param {Number} tagStartOffset The offset before the tag starts being animated
		**/
        self.startAnimation = function(tag, tagAnimationTime, tagStartOffset, timeFn) {
            animationController.animateTag(tag, tagAnimationTime, tagStartOffset, timeFn);
        };

        /**
			Shows the tag

			@method showTag
			@param {HTMLElement} tagElement The tag element to show
		**/
        self.showTag = function(tagElement) {
            $(tagElement).show();
        };

        /**
			Hides the tag

			@method hideTag
			@param {HTMLElement} tagElement The tag element to hide
		**/
        self.hideTag = function(tagElement) {
            $(tagElement).hide();
        };

        /**
			Stops the animation for a given tag

			@method stopAnimation
			@param {Tag} tag The tag to stop animating
		**/
        self.stopAnimation = function(tag) {
            animationController.pauseAnimation(tag);
        };

        self.pauseTagAtPosition = function(tag, position) {
            animationController.pauseTagAtPosition(tag, position);
        };
    };

    return TagAnimator;
});

/**
	@module TagController
	@requires jquery, underscore, TagCreator, TagAnimator, PubSub, globals
**/
wwplayer.define("TagController", ["jquery", "underscore", "TagCreator", "TagAnimator", "pubsub", "globals", "LogEvent", "require-shim"], function(
    $,
    _,
    TagCreator,
    TagAnimator,
    PubSub,
    globals,
    LogEvent,
    requireShim
) {
    /**
		Controls Tag creation, animation and data loading

		@class TagController
		@param {Object} tagData
		@param {Object} overlays
		@param {Class} Tag
		@param {Class} animationController
		@param {Function} getTimeFn
		@param {Function} isPlayingFn
		@param {Object} staticTags
	**/
    var TagController = function(videoData, tagOverlay, Tag, animationController, getTimeFn, isPlayingFn) {
        var self = this;

        self.tagData = videoData["tagData"];
        self.staticTags = videoData["staticSpriteData"];
        self.tagDataCallbacks = [];
        self.currentClip = 0;
        self.invFps = 1 / videoData["metaData"]["fps"];
        self.tagCreator = new TagCreator(
            self.tagData,
            Tag,
            self.invFps,
            videoData["swissData"],
            videoData["buttonData"],
            animationController,
            videoData["metaData"],
            videoData["staticSpriteData"]
        );
        self.tagAnimator = new TagAnimator(animationController);
        self.getTimeFn = getTimeFn;
        self.isPlayingFn = isPlayingFn;
        self.tagDivs = {};
        self.appId = 0;
        self.appRef = 0;

        if (window.wirewax.forceWidgetsOpenOnLoad) {
            PubSub.subscribe(globals.PLAYER_READY, function() {
                _.each(self.tags, function(tag) {
                    if (!tag.disableWidget) {
                        window.setTimeout(function() {
                            tag.tagClick();
                        }, 10);
                    }
                });
            });
        }

        PubSub.subscribe(globals.DO_SEEK, function() {
            self.hideTags(true);
            self.resetAnimations();
        });

        PubSub.subscribe(globals.TAG_HOVER_IN, function(eventName, eventData) {
            var tag = self.getTagBySpriteId(eventData.spriteId);
            if (tag) {
                $(".tag").addClass("timeline-hover");
                $(tag.element).addClass("timeline-selected");
            }
        });

        PubSub.subscribe(globals.TAG_HOVER_OUT, function(eventName, eventData) {
            $(".tag")
                .removeClass("timeline-selected")
                .removeClass("timeline-hover");
        });

        PubSub.subscribe(globals.GO_TO_TAG, function(eventName, spriteId) {
            if (spriteId) {
                var tag = self.getTagBySpriteId(spriteId);

                if (tag) {
                    PubSub.publish(globals.CLOSE_WIDGET);
                    globals.PLAY_FUNCTION();
                    PubSub.publish(globals.DO_SEEK, tag.tagStartTime);
                }
            }
        });

        PubSub.subscribe(globals.OPEN_TAG, function(eventName, spriteId) {
            if (spriteId) {
                var tag = self.getTagBySpriteId(spriteId);

                if (tag) {
                    PubSub.publish(globals.CLOSE_WIDGET);

                    window.setTimeout(function() {
                        PubSub.publish(globals.DO_SEEK, tag.tagStartTime);

                        window.setTimeout(function() {
                            tag.tagClick();
                        }, 1000);
                    }, 300);
                }
            }
        });

        PubSub.subscribe(globals.GET_TAGS, function() {
            PubSub.publish(globals.RETURN_TAGS, self.tags);
        });

        /**
			Private functions
		**/
        var getTag = function(tags) {
            var aTag;
            for (tag in tags) {
                aTag = tags[tag];
                if (!aTag.isTemp) {
                    break;
                } else {
                    aTag = null;
                }
            }

            // Create a Dummy Tag so that we at least load the stylesheet for the tag
            if (!aTag) {
                try {
                    return self.tagCreator.createDummyTag();
                } catch (err) {
                    // PubSub.publish(globals.ERROR, new LogEvent(globals.ERROR, globals.ERRORS['5026']));
                    return;
                }
            }

            return aTag;
        };

        var loadTagData = function(aTag, tags, callback) {
            if (aTag && !aTag.loadDataOnce) {
                _.each(tags, function(tag) {
                    try {
                        tag.loadTagData(function(data) {
                            tag.setTagData(data);

                            _.each(self.tagDataCallbacks, function(listenerCallback) {
                                listenerCallback(data);
                            });
                        });
                    } catch (e) {
                        console.error("Error loading and applying tag data to tag with tagName", tag.tagName, e);
                    }
                });

                callback(null);
            } else if (aTag && aTag.spriteId !== -1) {
                aTag.loadTagData(function(data) {
                    callback(data);

                    _.each(self.tagDataCallbacks, function(listenerCallback) {
                        listenerCallback(data);
                    });
                });
            } else {
                callback(null);
            }
        };

        var addResizeHandler = function(tags) {
            $(window).resize(function() {
                _.each(tags, function(tag) {
                    tag.onPlayerResize();
                });
            });
        };

        var removeAllTags = function() {
            $(".tag").remove();
            $("#wirewax-keyframes").remove();
        };

        self.registerTagDataCallback = function(callback) {
            self.tagDataCallbacks.push(callback);
        };

        /**
			Starts the tagController
			Creates the tags and loads the tag data

			@method start
		**/
        self.start = function() {
            self.tags = self.tagCreator.createTags(videoData["tagData"], videoData["swissData"], videoData["buttonData"], videoData["staticSpriteData"], videoData);

            // Preload the widget js and css files
            if (!window.wirewax.writer) {
                var widgetIds = _.uniq(
                    _.map(self.tags, function(tag) {
                        if (tag.widgetId === "panels" || tag.preloadWidget === true) {
                            return tag.widgetId;
                        }
                    })
                );
                if (widgetIds.length > 0) {
                    _.each(widgetIds, function(widgetId) {
                        if (widgetId) {
                            $("head").append(
                                '<link id="wax-overlay-style-' +
                                    widgetId +
                                    '" rel="stylesheet" type="text/css" href="' +
                                    window.wirewax.widgetUrl +
                                    "style/" +
                                    widgetId +
                                    ".css" +
                                    '">'
                            );
                            requireShim.require([window.wirewax.widgetUrl + widgetId + ".js"]);
                        }
                    });
                }
            }

            // TODO refactor to support multiple tags or rewrite BaseTag to include temporary tags
            // Get the first non-temporary tag
            var aTag = getTag(self.tags);

            if (aTag) {
                aTag.loadTagStyle();

                self.appId = aTag.appId;
                self.appRef = aTag.appRef;
            }

            loadTagData(aTag, self.tags, self.tagDataLoaded);
            addResizeHandler(self.tags);
        };

        /**
			Gets the created tags

			@method getTags
			@returns {Object} the created tags
		**/
        self.getTags = function() {
            return self.tags;
        };

        self.getDummyTag = function(isStatic) {
            return self.tagCreator.createDummyTag(isStatic);
        };

        self.getClipFromTimestamp = function(timestamp) {
            return self.tagCreator.getClipFromTimestamp(timestamp);
        };

        var createTagElements = function(tags, tagData) {
            var tagDivs = {};

            for (index in tags) {
                var element = createTagElement(tagDivs, tags[index], tagData);
            }

            return tagDivs;
        };

        var createTagElement = function(tagDivs, tag, tagData) {
            var element = tag.element;
            if (tagData) {
                try {
                    tag.setTagData(tagData);
                } catch (e) {
                    console.error("Error applying tag data to tag with tagName", tag.tagName, e);
                }
            }

            tagDivs[tag.clipIndex + "-" + tag.tagIndex] = element;
            $(tagOverlay).append(element);

            if (globals.VR_ENABLED) {
                var element2 = $(element).clone()[0];
                element2.id += "-clone";
                tag.clonedElement = element2;
                $("#tag-overlay-duplicate").append(element2);
            }
            return element;
        };

        /**
			Sets the tag data per tag and sets up the event subscriptions

			@method tagDataLoaded
			@param {Object} data the tag data
		**/
        self.tagDataLoaded = function(data) {
            self.tagDivs = createTagElements(self.tags, data);
            self.tagCreator.createAnimations(videoData["tagData"], self.tags, self.staticTags);

            PubSub.subscribe(globals.NEW_CLIP, self.onNewClip);
            PubSub.subscribe(globals.HAS_PAUSED, self.pauseTags);
            PubSub.subscribe(globals.VIDEO_END, self.pauseTags);
            PubSub.subscribe(globals.HAS_PLAYED, self.resumeTags);
            PubSub.subscribe(globals.HIDE_TAG, self.hideTags);
            PubSub.subscribe(globals.HAS_SEEKED, self.notifyTagSeek);
            PubSub.subscribe(globals.DO_SEEK, self.notifyTagPreSeek);
        };

        /**
			Syncs tags for the given clip

			@method onNewClip
			@param {String} eventType the event name that called this function
			@param {Number} clipNumber the number of the clip
		**/
        self.onNewClip = function(eventType, clipNumber) {
            self.currentClip = clipNumber;
            globals.LOG("new clip " + clipNumber);
            self.syncTags(self.tagData, self.staticTags);
        };

        /**
			Pauses all tags

			@method pauseTags
		**/
        self.pauseTags = function() {
            _.each(self.tags, function(tag) {
                self.tagAnimator.stopAnimation(tag);
            });
        };

        /**
			Syncs tags

			@method syncTags
		**/
        self.syncTags = function(tagData, staticTags) {
            // TODO Refactor
            self.hideTags();
            globals.LOG("sync tags");
            var currentTime = self.getTimeFn;
            var clipIndex = parseInt(self.currentClip);
            var clipStartFrame;
            var clipOutFrame;

            if (clipIndex === -1) {
                clipStartFrame = Number.NEGATIVE_INFINITY;
                clipOutFrame = Number.POSITIVE_INFINITY;
            } else if (tagData[clipIndex] && tagData[clipIndex]["tags"]) {
                globals.LOG("found tags in this clip " + tagData[clipIndex]["tags"].length);
                if (window.wirewax.debug) {
                    // JSON.stringify is slow, only do it in debug mode!
                    globals.LOG(JSON.stringify(tagData[clipIndex]));
                }
                clipStartFrame = tagData[clipIndex]["in"];
                clipOutFrame = tagData[clipIndex]["out"];
                for (var tagIndex = 0; tagIndex < tagData[clipIndex]["tags"].length; tagIndex++) {
                    if (self.tags[clipIndex + "-" + tagIndex]) {
                        globals.LOG("found real tag to animate");
                        var tagInfo = self.getTagInfo(tagData, clipIndex, tagIndex);
                        var tagStartFrame = tagInfo["in"] + clipStartFrame - 1;
                        var tagStartOffset = (tagStartFrame - 1) * self.invFps - currentTime();
                        var tag = self.tags[clipIndex + "-" + tagIndex];
                        var tagAnimationTime = tagInfo["x"].length - 1;
                        var currentFrame = Math.floor((getTimeFn() * 1) / self.invFps) + 1;
                        if (!self.isPlayingFn()) {
                            globals.LOG("not playing");
                            var frameDiff = currentFrame - tagStartFrame;
                            if (frameDiff >= 0) {
                                var width = parseFloat(tagInfo["w"][frameDiff]);
                                var height = parseFloat(tagInfo["h"][frameDiff]);
                                var top = parseFloat(tagInfo["y"][frameDiff]) - height * 0.5;
                                var left = parseFloat(tagInfo["x"][frameDiff]) - width * 0.5;
                                self.tagAnimator.pauseTagAtPosition(tag, { width: width, height: height, top: top, left: left });
                            }
                        } else {
                            globals.LOG("start animation cos playing");
                            var outTime = tagInfo["out"] * self.invFps;
                            var clipInTime = tagData[clipIndex]["in"] * self.invFps;
                            if (currentTime() - clipInTime < outTime) {
                                self.tagAnimator.startAnimation(tag, tagAnimationTime, tagStartOffset, self.getTimeFn);
                            }
                        }
                    }
                }
            } else {
                // We still want these for syncing the static tags
                clipStartFrame = tagData[clipIndex] && tagData[clipIndex]["in"];
                clipOutFrame = tagData[clipIndex] && tagData[clipIndex]["out"];
            }

            if (staticTags && clipStartFrame) {
                for (staticIndex in staticTags) {
                    if (self.tags["-1-" + staticIndex]) {
                        var staticTag = staticTags[staticIndex];
                        if (
                            (staticTag["in"] < clipStartFrame * self.invFps && staticTag["out"] >= clipStartFrame * self.invFps) ||
                            (staticTag["in"] >= clipStartFrame * self.invFps && staticTag["in"] <= clipOutFrame * self.invFps)
                        ) {
                            if (parseFloat(staticTag["out"]) > currentTime()) {
                                var tag = self.tags["-1-" + staticIndex];
                                var tagAnimationTime = (parseFloat(staticTag["out"]) - parseFloat(staticTag["in"])) / self.invFps;
                                var tagStartOffset = parseFloat(staticTag["in"]) - currentTime();

                                if (!self.isPlayingFn()) {
                                    self.tagAnimator.pauseTagAtPosition(tag, null);
                                } else {
                                    if (globals.IS_CHROME_PAST_40) {
                                        if (!tag.element.style["-webkit-animation-name"] && !tag.element.style["animation-name"]) {
                                            self.tagAnimator.startAnimation(tag, tagAnimationTime, tagStartOffset);
                                        }
                                    } else {
                                        self.tagAnimator.startAnimation(tag, tagAnimationTime, tagStartOffset);
                                    }
                                }
                            }
                        }
                    }
                }
            }
        };

        /**
			Hides all tags

			@method hideTags
		**/
        self.hideTags = function(force) {
            if (globals.HIDE_STATICS === false && !force) {
                $(".tag")
                    .not(".static-tag")
                    .css({ display: "none" });
            } else {
                $(".tag").css({ display: "none" });
            }

            // Slower but better encapsulation
            // _.each(self.tags, function(tag){
            // 	tag.element.style.display = 'none';
            // });
        };

        self.resetAnimations = function() {
            if (globals.IS_CHROME_PAST_40) {
                $(".static-tag").css({ "webkit-animation-name": "", "animation-name": "" });
            }
        };

        self.notifyTagSeek = function() {
            _.each(self.tags, function(tag) {
                if (tag.onPlayerSeek) {
                    tag.onPlayerSeek();
                }
            });
        };

        self.notifyTagPreSeek = function() {
            _.each(self.tags, function(tag) {
                if (tag.onPlayerPreSeek) {
                    tag.onPlayerPreSeek();
                }
            });
        };

        /**
			Resumes tag animations

			@method resumetags
		**/
        self.resumeTags = function() {
            self.syncTags(self.tagData, self.staticTags);
        };

        /**
			Returns the tag data for a tag in a clip

			@method getTagInfo
			@param {Object} tagData the tag data object
			@param {Number} clipIndex the clip number of this tag
			@param {Number} tagIndex the tag number
			@returns {Object} the tag data
		**/
        self.getTagInfo = function(tagData, clipIndex, tagIndex) {
            return tagData[clipIndex]["tags"][tagIndex];
        };

        self.removeTag = function(spriteId) {
            var tag = self.getTagBySpriteId(spriteId);

            if (tag) {
                $(tag.element).remove();
            }
        };

        /**
			Returns the tag object for a tag with a given sprite id

			@method getTagBySpriteId
			@param {Number} spriteId the sprite id to search the tags for
			@returns {Tag} tag the tag with the given spriteId
		**/
        self.getTagBySpriteId = function(spriteId) {
            var returnTag = null;
            _.each(self.tags, function(tag) {
                if (tag.spriteId === spriteId) {
                    returnTag = tag;
                }
            });

            return returnTag;
        };

        self.getTagDataSpriteDifference = function(tagData, newTagData, staticTags, newStaticTags) {
            var newSprites = self.tagCreator.getSpritesFromTagData(newTagData, newStaticTags);
            var oldSprites = self.tagCreator.getSpritesFromTagData(tagData, staticTags);

            return _.difference(newSprites, oldSprites);
        };

        self.redrawTag = function(tagData, swissData, buttonData, staticSpriteData, spriteId, videoData) {
            var spriteDifference = self.getTagDataSpriteDifference(self.tagData, tagData, self.staticTags, staticSpriteData);

            // More than 1 sprite has changed which means the data is out of sync, its probably better to just redraw all of them
            // TODO Possibly rewrite this to individually create the sprites instead of just redrawing everything
            if (spriteDifference.length > 1) {
                self.redrawTags(tagData, swissData, buttonData, staticSpriteData, videoData);
            } else {
                self.tagData = tagData;
                self.staticTags = staticSpriteData;

                var changedTag = self.getTagBySpriteId(spriteId);

                if (changedTag) {
                    $(changedTag.element).remove();
                }

                var createdTag = self.tagCreator.createTagWithSpriteId(spriteId, tagData, swissData, buttonData, staticSpriteData, videoData);
                self.tags = self.tagCreator.tags;
                createdTag.loadTagStyle();

                var onTagDataLoaded = function(data) {
                    createTagElement(self.tagDivs, createdTag, data);
                    self.tagCreator.createAnimations(tagData, self.tags, self.staticTags, true);
                    self.syncTags(tagData, self.staticTags);
                };

                try {
                    createdTag.loadTagData(onTagDataLoaded);
                } catch (err) {
                    onTagDataLoaded(null);
                }
            }
        };

        self.redrawTags = function(tagData, swissData, buttonData, staticSpriteData, tagClassData, videoData) {
            self.tagData = tagData;
            self.staticTags = staticSpriteData;

            if (tagClassData) {
                self.tagCreator.setCurrentTag(tagClassData.TagClass, tagClassData.tagId);
            }

            removeAllTags();
            self.tags = self.tagCreator.createTags(tagData, swissData, buttonData, staticSpriteData, videoData);
            var aTag = getTag(self.tags);

            if (aTag) {
                aTag.loadTagStyle();

                self.appId = aTag.appId;
                self.appRef = aTag.appRef;

                loadTagData(aTag, self.tags, function(data) {
                    self.tagDivs = createTagElements(self.tags, data);
                    self.tagCreator.createAnimations(tagData, self.tags, self.staticTags, true);
                    self.syncTags(tagData, self.staticTags);
                });
            }
        };
    };

    return TagController;
});

wwplayer.define("MetricsController", ["jquery", "underscore", "apiService", "pubsub", "globals", "uuid", "LogEvent"], function($, _, apiService, PubSub, globals, uuid, LogEvent) {
    // TODO enums
    /**
     @constructor MetricsController
     @classdesc Handles all the metrics logging
     @param {Function} getCurrentTimeCallback returns the current play time
     @param {Function} getCurrentFrameCallback returns the current frame number
     @param {Function} getPlayerPlayingCallback returns whether the player is currently playing
     @param {Function} getYawAndPitchCallback returns current yaw and pitch (360)
     **/
    var MetricsController = function(getCurrentTimeCallback, getCurrentFrameCallback, getPlayerPlayingCallback, getYawAndPitchCallback) {
        var self = this;

        self.timeCallback = getCurrentTimeCallback;
        self.frameCallback = getCurrentFrameCallback;
        self.playingCallback = getPlayerPlayingCallback;
        self.getYawAndPitchCallback = getYawAndPitchCallback;

        /**
         The Metrics object that we send every time we log
         @name MetricsController#metrics
         @type Object
         @property {Array} mouse Mouse positions
         @property {Array} interactions Tag interactions
         @property {Array} uiEvents UI events (play/pause/skip)
         @property {Array} loadTimes Resource load times
         @property {Array} throbberTimes throbber events
         @property {Array} widgets Widget events (clickouts, carousel events etc)
         @property {Array} threeSixty three sixty views
         @property {Array} custom Custom metrics (e.g. Disney slider position)
         **/
        self.metricsSent = 0;
        self.metrics = {
            mouse: [],
            interactions: [],
            uiEvents: [],
            loadTimes: [],
            throbberTimes: [],
            widgets: [],
            threeSixty: [],
            custom: []
        };
        self.transitMetrics = {};
        self.mouseMetrics = [];
        self.threeSixtyMetrics = [];
        self.customMetrics = [];
        /**
         The current running state of the controller
         @name MetricsController#running
         @type Boolean
         @default false
         **/
        self.running = false;
        /**
         Flag to see if PubSub / jQuery events have already been set up
         @name MetricsController#eventsSetup
         @type Boolean
         @default false
         **/
        self.eventsSetup = false;

        /**
         The dwelltime, time between widget open and close, for the current widget
         @name MetricsController#dwellTime
         @type Number
         @default 0
         **/
        self.dwellTime = 0;

        /**
         Interval to keep updating the dwelltime
         @name MetricsController#dwellTimeInterval
         @type Function
         @default null
         **/
        self.dwellTimeInterval = null;

        /**
         Flag to see if the MetricsController has been acknowledged by the server to send metrics
         @name MetricsController#acked
         @type Boolean
         @default false
         **/
        self.acked = false;

        /**
         The amount of times the MetricsController has tried to ack with the server
         @name MetricsController#ackTried
         @type Number
         @default 0
         **/
        self.ackTried = 0;

        self.mouseIn = true;
        self.widgetOpen = false;

        /**
         @name MetricsController#apiService
         @type ApiService
         **/
        self.apiService = apiService;

        self.getHash = function() {
            if (!self.hash) {
                if (window.wirewax.uuId) {
                    self.hash = window.wirewax.uuId;
                } else {
                    self.hash = uuid();
                }
                self.apiService.setUuId(self.hash);
            }
            return self.hash;
        };

        self.recordImpression = function(vidId, embedLoc, error) {
            var metric = {
                uuId: self.getHash(),
                vidId: parseInt(vidId),
                playerType: 3,
                userAgent: navigator.userAgent,
                embedLoc: embedLoc,
                startedPlaying: 0,
                when: { sec: new Date().getTime() / 1000, usec: 0 }
            };
            apiService.sendImpression(vidId, metric, error);
            globals.LOG("sent impression to api service");
        };

        /**
         Sets up and starts logging Metrics

         @name MetricsController#start
         @method
         **/
        self.start = function() {
            globals.LOG("start metrics controller");
            if (!self.running) {
                self.mousePosition = {};

                if (!self.eventsSetup) {
                    self.setupEvents();
                    self.eventsSetup = true;
                }

                if (globals.RECORD_MOUSE_METRICS) {
                    self.metricRecordingInterval = window.setInterval(self.recordMetric, 1000);
                }

                if (globals.ENABLE_360_METRICS && self.getYawAndPitchCallback && self.getYawAndPitchCallback()) {
                    self.threeSixtyRecordingInterval = window.setInterval(self.record360Metric, 1000);
                }

                if (globals.CUSTOM_METRICS) {
                    self.customMetricsRecordingInterval = window.setInterval(self.recordCustomMetric, 1000);
                }

                self.metricsInterval = window.setInterval(function() {
                    if (self.playingCallback()) {
                        globals.LOG("sending metrics");
                        self.recordMouseMetrics();
                        self.record360Metrics();
                        self.recordCustomMetrics();
                        self.sendMetric();
                    }
                }, globals.METRICS_INTERVAL);

                // Kill the metrics after 6 hours
                self.initialStartTimeout = window.setTimeout(function() {
                    window.clearInterval(self.metricsInterval);
                    self.running = false;
                }, 21600000);

                self.running = true;
            }
            globals.LOG("started metrics sending");
        };

        self.recordMouseMetrics = function() {
            var thisMetric = {};
            thisMetric.when = { sec: new Date().getTime() / 1000, usec: 0 };
            thisMetric.frames = getCurrentFrameCallback();
            thisMetric.time = parseInt(getCurrentTimeCallback());
            thisMetric.f = _.pluck(self.mouseMetrics, "f").join(",");
            thisMetric.x = _.pluck(self.mouseMetrics, "x").join(",");
            thisMetric.y = _.pluck(self.mouseMetrics, "y").join(",");
            self.mouseMetrics = [];
            // don't send empty metrics...
            if (thisMetric.f.length) {
                self.metrics.mouse.push(thisMetric);
            }
        };

        self.record360Metrics = function() {
            if (!self.threeSixtyMetrics.length) {
                return;
            }
            var thisMetric = {};
            thisMetric.when = { sec: new Date().getTime() / 1000, usec: 0 };
            thisMetric.frames = getCurrentFrameCallback();
            thisMetric.time = parseInt(getCurrentTimeCallback());
            thisMetric.f = _.pluck(self.threeSixtyMetrics, "f").join(",");
            thisMetric.yaw = _.pluck(self.threeSixtyMetrics, "yaw").join(",");
            thisMetric.pitch = _.pluck(self.threeSixtyMetrics, "pitch").join(",");
            self.threeSixtyMetrics = [];
            // don't send empty metrics...
            if (thisMetric.f.length) {
                self.metrics.threeSixty.push(thisMetric);
            }
        };

        self.recordCustomMetrics = function() {
            if (!self.customMetrics.length) {
                return;
            }
            var thisMetric = {};
            thisMetric.when = { sec: new Date().getTime() / 1000, usec: 0 };
            thisMetric.frames = getCurrentFrameCallback();
            thisMetric.time = parseInt(getCurrentTimeCallback());
            thisMetric.f = _.pluck(self.customMetrics, "f").join(",");
            thisMetric.data = _.pluck(self.customMetrics, "data").join(",");
            self.customMetrics = [];
            // don't send empty metrics...
            if (thisMetric.f.length) {
                self.metrics.custom.push(thisMetric);
            }
        };

        self.handshake = function(vidId, embedLoc, success, error) {
            var metric = {
                uuId: self.getHash(),
                vidId: parseInt(vidId),
                playerType: 3,
                ipAddress: globals.IP_ADDRESS,
                userAgent: navigator.userAgent,
                embedLoc: embedLoc,
                startedPlaying: 1,
                when: { sec: new Date().getTime() / 1000, usec: 0 }
            };

            apiService.sendRootMetric(vidId, metric, success, error);
        };

        /**
         Sets up event listeners

         @method
         @name MetricsController#setupEvents
         **/
        self.setupEvents = function() {
            PubSub.subscribe(globals.TAG_CLICK, self.addTagClickData);
            PubSub.subscribe(globals.WIDGET_ACTION, self.addWidgetActionData);
            PubSub.subscribe(globals.UI_EVENT, self.addUIEventData);
            PubSub.subscribe(globals.CURRENT_TIME_SET, self.preSeek);
            PubSub.subscribe(globals.HAS_SEEKED, self.postSeek);
            PubSub.subscribe(globals.WIDGET_SHOWN, function() {
                self.widgetOpen = true;
            });
            PubSub.subscribe(globals.WIDGET_CLOSED, function() {
                self.widgetOpen = false;
            });

            var tagOverlay = $("#tag-overlay");
            tagOverlay.mousemove(function(e) {
                self.mousePosition.x = ((e.pageX - tagOverlay.offset().left) / tagOverlay.width()).toFixed(3);
                self.mousePosition.y = ((e.pageY - tagOverlay.offset().top) / tagOverlay.height()).toFixed(3);
                //TODO: put this code in as a debug option on the control panel or something!!
                //                if (!self.mouseTrackDiv) {
                //                    self.mouseTrackDiv = document.createElement('div');
                //                    $(self.mouseTrackDiv).css({
                //                        position: 'absolute',
                //                        width: '20px',
                //                        height: '20px',
                //                        'background-color': 'pink',
                //                        opacity: 0.5
                //                    })
                //                    tagOverlay.append(self.mouseTrackDiv);
                //                }
                //                globals.LOG(self.mousePosition);
                //                $(self.mouseTrackDiv).css({
                //                    left: (parseFloat(self.mousePosition.x))*100+'%',
                //                    top: (parseFloat(self.mousePosition.y))*100+'%'
                //                })
            });

            tagOverlay.mouseover(function(e) {
                self.mouseIn = true;
            });

            tagOverlay.mouseout(function(e) {
                self.mouseIn = false;
            });

            $(window).on("beforeunload", function() {
                if (self.running) {
                    self.sendMetric();
                }
            });
        };

        /**
         Clears the Metrics object

         @method
         @name MetricsController#clearMetrics
         **/
        self.clearMetrics = function() {
            self.metrics = {
                mouse: [],
                interactions: [],
                uiEvents: [],
                loadTimes: [],
                throbberTimes: [],
                widgets: [],
                threeSixty: [],
                custom: []
            };
        };

        /**
         * @name MetricsController#successMetrics
         * @method
         * @description Metric sent successfully, so remove from the transitMetrics
         */
        self.successMetrics = function(metricIndex, data) {
            delete self.transitMetrics[metricIndex];
        };

        /**
         * @name MetricsController#failedMetrics
         * @method
         * @description Put the associated transit metric back into the metrics to be sent set so they're re-sent next time
         */
        self.failedMetrics = function(metricIndex) {
            for (key in self.transitMetrics[metricIndex]) {
                self.metrics[key] = _.intersection(self.transitMetrics[metricIndex][key], self.metrics[key]);
            }
            delete self.transitMetrics[metricIndex];
        };

        self.getMetricSize = function() {
            var count = 0;
            _.each(self.metrics, function(subObj) {
                count += _.size(subObj);
            });
            return count;
        };

        self.splitMetrics = function() {
            var piecesPerSplit = 10;
        };

        /**
         Send the current Metrics object to the server

         @method
         @name MetricsController#sendMetric
         **/
        self.sendMetric = function() {
            var chunkedMetrics = self.chunkMetrics(self.metrics);
            _.each(chunkedMetrics, function(eachMetric) {
                globals.LOG("sending metric ", eachMetric);
                PubSub.publish(globals.CONSOLE_EVENTS.SENT_METRIC, eachMetric);
                self.transitMetrics[self.metricsSent] = eachMetric;
                self.apiService.sendSubMetrics(eachMetric, self.hash, self.successMetrics, self.failedMetrics, self.metricsSent);
                self.metricsSent++;
            });
            self.clearMetrics();
        };

        /**
         Records a mouse metric to the current Metrics object

         @method
         @name MetricsController#recordMetric
         **/
        self.recordMetric = function() {
            if (self.playingCallback()) {
                if (self.shouldRecordMouseMetric() && self.mousePosition.x) {
                    thisMetric = { x: self.mousePosition.x, y: self.mousePosition.y, f: getCurrentFrameCallback(), when: getCurrentTimeCallback() };
                    self.mouseMetrics.push(thisMetric);
                }
            }
        };

        /**
         Records a three sixty metric to the current threeSixtyMetrics object

         @method
         @name MetricsController#record360Metric
         **/
        self.record360Metric = function() {
            if (self.playingCallback()) {
                if (self.shouldRecord360Metric()) {
                    var orientation = self.getYawAndPitchCallback();
                    thisMetric = { yaw: round2dp(orientation.yaw), pitch: round2dp(orientation.pitch), f: getCurrentFrameCallback(), when: getCurrentTimeCallback() };

                    self.threeSixtyMetrics.push(thisMetric);
                }
            }
        };

        /**
         Records a custom mouse-like metric

         @method
         @name MetricsController#recordCustomMetric
         **/
        self.recordCustomMetric = function() {
            if (self.playingCallback()) {
                if (globals.CUSTOM_METRICS) {
                    var data = globals.CUSTOM_METRICS_CALLBACK();
                    if (typeof data !== "undefined") {
                        thisMetric = { data: data, f: getCurrentFrameCallback(), when: getCurrentTimeCallback() };

                        self.customMetrics.push(thisMetric);
                    }
                }
            }
        };

        /**
         Checks to see if we should record a mouse metric this round

         @method
         @name MetricsController#shouldRecordMouseMetric
         @return Boolean whether we should record a mouse metric or not
         **/
        self.shouldRecordMouseMetric = function() {
            return self.mouseIn;
        };

        /**
         Checks to see if we should record a 360 metric this round

         @method
         @name MetricsController#shouldRecord360Metric
         @return Boolean whether we should record a mouse metric or not
         **/
        self.shouldRecord360Metric = function() {
            return !self.widgetOpen;
        };

        /**
         Stops recording metrics

         @method
         @name MetricsController#stop
         **/
        self.stop = function() {
            self.running = false;
            window.clearInterval(self.metricsInterval);
        };

        /**
         Adds Tag click data to the current Metrics object

         @method
         @name MetricsController#addTagClickData
         @param {String} eventType tagClick
         @param {Object} tagData the tags data
         **/
        self.addTagClickData = function(eventType, tagData) {
            self.metrics.interactions.push({
                //tagIndex: tagData.tag.tagIndex,
                //clipIndex: tagData.tag.clipIndex,
                //customNameRef: tagData.tag.customNameRef,
                nameLink: tagData.tag.nameLink,
                spriteId: tagData.tag.spriteId,
                btnLink: tagData.tag.buttonData ? tagData.tag.buttonData.btnLink : null,
                time: parseInt(getCurrentTimeCallback()),
                type: globals.IS_DESKTOP ? 2 : 4,
                when: { sec: new Date().getTime() / 1000, usec: 0 }
            });
            self.sendMetric();
        };

        /**
         Adds UIMetric data to the current Metrics object

         @method
         @name MetricsController#addUIEventData
         @param {String} eventType uiEvent
         @param {Object} eventData the events data
         **/
        self.addUIEventData = function(eventType, eventData) {
            if (!self.metrics.uiEvents) {
                self.metrics.uiEvents = [];
            }

            var data = {
                eventId: eventData.eventId,
                name: eventData.eventName,
                frame: getCurrentFrameCallback(),
                time: parseInt(getCurrentTimeCallback()),
                when: { sec: new Date().getTime() / 1000, usec: 0 }
            };

            if (eventData.result) {
                data.result = eventData.result;
            }

            self.metrics.uiEvents.push(data);
            self.sendMetric();
        };

        /**
         Adds Widget action data to the current Metrics object and calculates dwelltime

         @method
         @name MetricsController#addWidgetActionData
         @param {String} eventType widgetAction
         @param {Object} widgetData the widgets data
         **/
        self.addWidgetActionData = function(eventType, widgetData) {
            if (widgetData.action === "open") {
                self.dwellTime = 0;
                self.dwellTimeInterval = window.setInterval(function() {
                    self.dwellTime += 1;
                }, 1000);
            } else if (widgetData.action === "close") {
                window.clearInterval(self.dwellTimeInterval);
                // only send dwell metric on close
                //except this doesn't send, it just adds it to interactions to be sent whenever metrics are next sent.
                self.metrics.interactions.push({
                    nameLink: widgetData.widget.tag.nameLink,
                    spriteId: widgetData.widget.tag.spriteId,
                    type: 5, // type 5 === dwell
                    btnLink: widgetData.widget.tag.buttonData ? widgetData.widget.tag.buttonData.btnLink : null,
                    timestamp: getCurrentTimeCallback(),
                    dwellTime: self.dwellTime
                });
            }
        };

        self.logLoadMetric = function(eventName, loadData) {
            self.metrics.loadTimes.push(loadData);
        };

        self.logThrobberMetric = function(eventName, throbberData) {
            self.metrics.throbberTimes.push(throbberData);
        };

        // Not all of these will be seeks, we use preSeek to set the time before any time changes occur
        // and use postSeek to check if the time change is actually related to a seek
        self.preSeek = function(eventName, eventData) {
            self.preSeekTime = eventData;
        };

        self.postSeek = function(eventName, eventData) {
            if (self.preSeekTime) {
                var data = {
                    eventId: 13,
                    name: "seek",
                    result: self.preSeekTime.toFixed(2) + "," + eventData.toFixed(2)
                };

                self.addUIEventData(globals.UI_EVENT, data);
                self.preSeekTime = null;
            }
        };

        // custom widget interactions
        self.addWidgetInteractionData = function(widgetObj) {
            self.metrics.widgets.push(widgetObj);
            self.sendMetric();
        };

        self.addInteractionData = function(interactionsObj) {
            self.metrics.interactions.push(interactionsObj);
            self.sendMetric();
        };

        self.chunkMetrics = function(allMetrics) {
            var ITEMS_PER_CHUNK = 10;

            var metricChunks = [];
            var thisChunk = {};
            var objCount = 1;
            _.each(allMetrics, function(metricTypeList, metricType) {
                _.each(metricTypeList, function(metricObj) {
                    if (objCount > ITEMS_PER_CHUNK) {
                        metricChunks.push(thisChunk);
                        thisChunk = {};
                        objCount = 0;
                    }
                    objCount++;
                    if (!thisChunk[metricType]) {
                        thisChunk[metricType] = [];
                    }
                    thisChunk[metricType].push(metricObj);
                });
            });
            metricChunks.push(thisChunk);
            return metricChunks;
        };

        PubSub.subscribe(globals.LOAD_METRIC, self.logLoadMetric);
        PubSub.subscribe(globals.THROBBER_METRIC, self.logThrobberMetric);

        PubSub.subscribe(globals.VIDEO_END, function() {
            self.recordMouseMetrics();
            self.record360Metrics();
            self.sendMetric();
        });

        function round2dp(num) {
            return Math.round(num * 100) / 100;
        }
    };

    return MetricsController;
});

wwplayer.define("EventLogger", ["apiService", "pubsub", "globals", "jquery", "LogEvent"], function(apiService, PubSub, globals, $, LogEvent) {
    /**
		Handles logging of events

		@constructor EventLogger
	**/
    var EventLogger = function() {
        var self = this;

        /**
			The events that we send

			@name EventLogger#events
			@type Array
		**/
        self.events = [];

        /**
		 	@name EventLogger#apiService
			@type ApiService
		**/
        self.apiService = apiService;

        /**
			Adds an event to the event array

		 	@name EventLogger#addEvent
			@method
			@param {String} eventType the type of event
			@param {Object} eventObject the event object
		**/
        self.addEvent = function(eventType, eventObject) {
            globals.LOG("error ", eventObject);
            if (eventType === globals.ERROR) {
                if (eventObject.eventObject.behaviour !== 0) {
                    PubSub.publish(globals.SHOW_MESSAGE, eventObject.eventObject);
                }
            }

            try {
                if (eventObject.args) {
                    var details = eventObject.args.detail;
                    var message = eventObject.args.message;
                    var stack = eventObject.args.stack;
                }
                eventObject.args = {};
                eventObject.args.detail = details;
                eventObject.args.message = message;
                eventObject.args.stack = stack;
            } catch (err) {}

            self.events.push(eventObject);

            self.recordEvent(
                function() {
                    //success
                },
                function() {
                    //failed
                }
            );
        };

        /**
			Sends the event to the server

			@method
		    @name EventLogger#recordEvent
			@param {Function} success success callback
			@param {Function} error error callback
		**/
        self.recordEvent = function(success, error) {
            self.apiService.recordError(self.events, success, error);
            self.events = [];

            //PubSub.publish(globals.HIDE_LOADER);
        };

        PubSub.subscribe(globals.ERROR, self.addEvent);

        // THIS KILLS IE9 :/
        // $(window).error(function(err){
        // 	self.addEvent(globals.ERROR, new LogEvent(globals.ERROR, globals.ERRORS['5011'], err.originalEvent.error));
        // });
    };

    return EventLogger;
});

wwplayer.define("EventManager", ["jquery", "pubsub", "globals", "apiService", "underscore"], function($, PubSub, globals, apiService, _) {
    /**
		Handles triggering and responding to DOM events

		@constructor EventManager
		@param {HTMLElement} element the element to listen to events on
	**/
    var EventManager = function(element) {
        var self = this;

        /**
			Triggers and event on the DOM
		 	@name EventManager#triggerEvent
			@method
			@param {String} eventName the name of the event
			@param {Object} eventData the event data
		**/
        this.triggerEvent = function(eventName, eventData) {
            PubSub.publish(globals.CONSOLE_EVENTS.SENT_API_EVENT, { eventName: eventName, eventData: eventData });
            if (typeof eventData === "string") {
                eventData = {
                    data: eventData
                };
            }
            try {
                var event = $.Event(eventName, eventData);
                $(element).trigger(event);
            } catch (err) {
                console.error("Failed to trigger event on element");
            }

            if (window.parent !== window) {
                try {
                    var payload = { name: String(eventName), data: eventData, vidId: parseInt(window.wirewax.vidId), uniqueViewId: apiService.uuId };
                    if (globals.IS_IE_9 || globals.IS_IE_8) {
                        payload = JSON.stringify(payload);
                    }

                    window.parent.postMessage(payload, "*");
                } catch (err) {
                    // Weird JSON parsing error
                }
            }
        };

        PubSub.subscribe(globals.PLAYER_READY, this.triggerEvent);
        PubSub.subscribe(globals.DURATION_CHANGE, function(eventName, duration) {
            self.triggerEvent(eventName, { duration: duration });
        });
        PubSub.subscribe(globals.HAS_PLAYED, this.triggerEvent);
        PubSub.subscribe(globals.HAS_PAUSED, this.triggerEvent);
        PubSub.subscribe(globals.HAS_SEEKED, this.triggerEvent);
        PubSub.subscribe(globals.HAS_VIDEO_CLICKED, this.triggerEvent);
        PubSub.subscribe(globals.TAG_CLICK, function(eventName, tagData) {
            self.triggerEvent(eventName, { tagData: tagData.tag.publicData });
        });
        PubSub.subscribe(globals.WIDGET_SHOWN, this.triggerEvent);
        PubSub.subscribe(globals.WIDGET_CLOSED, this.triggerEvent);

        PubSub.subscribe(globals.PRODUCT_ADD_TO_CART, function(eventName, productData) {
            self.triggerEvent(eventName, { product: productData });
        });
        PubSub.subscribe(globals.CUSTOM_EVENT, function(eventName, data) {
            self.triggerEvent(eventName, data);
        });
        PubSub.subscribe(globals.RETURN_CURRENT_TIME, function(eventName, timeData) {
            self.triggerEvent(eventName, { currentTime: timeData });
        });
        PubSub.subscribe(globals.VOLUME_CHANGE, function(eventName, volume) {
            self.triggerEvent(eventName, { volume: volume });
        });
        PubSub.subscribe(globals.STARTED_BUFFERING, function(eventName, timeData) {
            self.triggerEvent(eventName);
        });
        PubSub.subscribe(globals.ENDED_BUFFERING, function(eventName, volume) {
            self.triggerEvent(eventName);
        });

        PubSub.subscribe(globals.VIDEO_FIRST_QUARTILE, this.triggerEvent);
        PubSub.subscribe(globals.VIDEO_MIDPOINT, this.triggerEvent);
        PubSub.subscribe(globals.VIDEO_THIRD_QUARTILE, this.triggerEvent);
        PubSub.subscribe(globals.VIDEO_END, this.triggerEvent);

        PubSub.subscribe(globals.ERROR, this.triggerEvent);
        PubSub.subscribe(globals.WIDGET_CLICKOUT, this.triggerEvent);
        PubSub.subscribe(globals.CLIENT_CUSTOM_EVENT, function(eventName, data) {
            self.triggerEvent(eventName, data);
        });
        PubSub.subscribe(globals.RENDITION_CHANGED, self.triggerEvent);
        PubSub.subscribe(globals.SCORM_EVENT, function(eventName, data) {
            self.triggerEvent(eventName, data);
        });

        // WRITER EVENTS
        PubSub.subscribe(globals.TAG_ADDED, function(eventName, tagData) {
            tagData = _.clone(tagData);

            if (tagData.element) {
                tagData.element = null;
            }
            self.triggerEvent(eventName, { tagData: tagData });
        });
        PubSub.subscribe(globals.EDIT_TAG, function(eventName, tagData) {
            tagData = _.clone(tagData);

            if (tagData.element) {
                tagData.element = null;
            }
            self.triggerEvent(eventName, { tagData: tagData });
        });
        PubSub.subscribe(globals.WRITER_ERROR, function(eventName, errorMessage) {
            self.triggerEvent(eventName, { message: errorMessage });
        });
        PubSub.subscribe(globals.WRITER_CLOSING, function(eventName) {
            self.triggerEvent(eventName);
        });
        PubSub.subscribe(globals.NAME_TAG, function(eventName, tagData) {
            tagData = _.clone(tagData);

            if (tagData.element) {
                tagData.element = null;
            }
            self.triggerEvent(eventName, { tagData: tagData });
        });
        PubSub.subscribe(globals.EDITOR_TAG_SETTINGS, function(eventName, tagData) {
            tagData = _.clone(tagData);

            if (tagData.element) {
                tagData.element = null;
            }
            self.triggerEvent(eventName, { tagData: tagData });
        });

        PubSub.subscribe(globals.EDITOR_DO_EDIT_TRACKING, function(eventName, tagData) {
            tagData = _.clone(tagData);

            if (tagData.element) {
                tagData.element = null;
            }
            self.triggerEvent(eventName, { tagData: tagData });
        });

        PubSub.subscribe(globals.EDITOR_DELETE_TAG, function(eventName, tagData) {
            tagData = _.clone(tagData);

            if (tagData.element) {
                tagData.element = null;
            }
            self.triggerEvent(eventName, { tagData: tagData });
        });

        PubSub.subscribe(globals.EDITOR_REFRESH_TIMELINE, function(eventName, videoData) {
            self.triggerEvent(eventName, videoData);
        });

        PubSub.subscribe(globals.SEND_SUBTITLES, function(eventName, subtitle) {
            self.triggerEvent(eventName, subtitle);
        });

        PubSub.subscribe(globals.RETURN_TAGS, function(eventName, tagData) {
            var returnTags = [];

            _.each(tagData, function(tag) {
                returnTags.push({
                    overlayId: tag.overlayId,
                    tagName: tag.tagName,
                    spriteId: tag.spriteId,
                    tagId: tag.tagId,
                    widgetId: tag.widgetId,
                    isStatic: tag.isStatic,
                    thumbImgIndex: tag.thumbImgIndex,
                    thumbIndex: tag.thumbIndex,
                    tagStartTime: tag.tagStartTime,
                    tagAnimationTime: tag.tagAnimationTime
                });
            });

            self.triggerEvent(eventName, returnTags);
        });

        $(element).bind(globals.DO_PLAY, function() {
            globals.PLAY_FUNCTION();
        });

        $(element).bind(globals.DO_PAUSE, function() {
            PubSub.publish(globals.DO_PAUSE);
        });

        $(element).bind(globals.DO_SEEK, function(event, args) {
            if (!args) {
                return;
            }

            PubSub.publish(globals.CLOSE_WIDGET);

            if (args.pause) {
                window.setTimeout(function() {
                    PubSub.publish(globals.DO_PAUSE);
                    PubSub.publish(globals.DO_SEEK, args.videoTime);
                }, 1000);
            } else {
                PubSub.publish(globals.DO_SEEK, args.videoTime);
            }
        });

        $(element).bind(globals.MUTE_VOLUME, function(event) {
            PubSub.publish(globals.MUTE_VOLUME);
        });

        $(element).bind(globals.UNMUTE_VOLUME, function(event) {
            PubSub.publish(globals.UNMUTE_VOLUME);
            // Need to publish sync because otherwise mobile browsers do not count the function call as being user initiated
            PubSub.publishSync(globals.ENABLE_AUDIO);
        });

        $(element).bind(globals.TOGGLE_SUBTITLES, function(event) {
            PubSub.publish(globals.TOGGLE_SUBTITLES);
        });

        $(element).bind(globals.GET_CURRENT_TIME, function(event) {
            PubSub.publish(globals.GET_CURRENT_TIME);
        });

        $(element).bind(globals.ADD_TAG, function(event, args) {
            PubSub.publish(globals.ADD_TAG, args);
        });

        $(element).bind(globals.UPDATE_TAG, function(event, tagData) {
            PubSub.publish(globals.UPDATE_TAG, tagData);
        });

        $(element).bind(globals.REDRAW_TAGS, function(event, args) {
            PubSub.publish(globals.REDRAW_TAGS, args);
        });

        $(element).bind(globals.SAVE_TAG, function(event, tagData) {
            PubSub.publish(globals.SAVE_TAG, tagData);
        });

        $(element).bind(globals.DELETE_TAG, function(event, tagData) {
            PubSub.publish(globals.DELETE_TAG, tagData);
        });

        $(element).bind(globals.TAG_NAMED, function(event, tagData) {
            PubSub.publish(globals.TAG_NAMED, tagData);
        });

        $(element).bind(globals.CLOSE_WRITER, function(event, tagData) {
            PubSub.publish(globals.CLOSE_WRITER, tagData);
        });

        $(element).bind(globals.START_EDIT_TRACKING, function(event, tagData) {
            PubSub.publish(globals.START_EDIT_TRACKING, tagData);
        });

        $(element).bind(globals.EDIT_TAG_INPOINT, function(event, tagData) {
            PubSub.publish(globals.EDIT_TAG_INPOINT, tagData);
        });

        $(element).bind(globals.EDIT_TAG_OUTPOINT, function(event, tagData) {
            PubSub.publish(globals.EDIT_TAG_OUTPOINT, tagData);
        });

        $(element).bind(globals.UNDO_EDIT_TRACKING, function(event) {
            PubSub.publish(globals.UNDO_EDIT_TRACKING);
        });

        $(element).bind(globals.END_EDIT_TRACKING, function(event) {
            PubSub.publish(globals.END_EDIT_TRACKING);
        });

        $(element).bind(globals.WINDOW_RESIZE, function(event) {
            PubSub.publish(globals.WINDOW_RESIZE);
        });

        $(element).bind(globals.GET_TAGS, function(event) {
            PubSub.publish(globals.GET_TAGS);
        });

        $(element).bind(globals.TAG_HOVER_IN, function(event, tagData) {
            PubSub.publish(globals.TAG_HOVER_IN, tagData);
        });

        $(element).bind(globals.TAG_HOVER_OUT, function(event, tagData) {
            PubSub.publish(globals.TAG_HOVER_OUT, tagData);
        });

        $(element).bind(globals.GO_TO_TAG, function(event, spriteId) {
            PubSub.publish(globals.GO_TO_TAG, spriteId);
        });

        $(element).bind(globals.OPEN_TAG, function(event, spriteId) {
            PubSub.publish(globals.OPEN_TAG, spriteId);
        });

        $(element).bind(globals.CHANGE_VOLUME, function(event, volume) {
            PubSub.publish(globals.CHANGE_VOLUME, volume);
        });

        $(element).bind(globals.CLOSE_WIDGET, function(event) {
            PubSub.publish(globals.CLOSE_WIDGET);
        });

        $(element).bind(globals.TOGGLE_PLAY, function(event) {
            globals.PLAY_PAUSE_FUNCTION();
        });

        $(element).bind(globals.GO_TO_PREV_CLIP, function(event) {
            PubSub.publish(globals.GO_TO_PREV_CLIP);
        });

        $(element).bind(globals.GO_TO_NEXT_CLIP, function(event) {
            PubSub.publish(globals.GO_TO_NEXT_CLIP);
        });

        $(element).bind(globals.TIMELINE_TAG_SETTINGS, function(event, tagData) {
            PubSub.publish(globals.TIMELINE_TAG_SETTINGS, tagData);
        });

        $(element).bind(globals.CHANGE_SUBTITLES, function(event, language) {
            PubSub.publish(globals.CHANGE_SUBTITLES, language);
        });

        $(element).bind(globals.MERGE_MODE, function(event, m) {
            PubSub.publish(globals.MERGE_MODE, m);
        });

        $(element).bind(globals.CHANGE_RENDITION, function(event, r) {
            PubSub.publish(globals.CHANGE_RENDITION, r);
        });

        // Move all the element bound events to playerApi events
        window.wirewax.playerApi = {};
        window.wirewax.playerApi.playVideo = function() {
            globals.PLAY_FUNCTION();
        };

        if (window.addEventListener) {
            window.addEventListener(
                "message",
                function(event) {
                    var data = event.data;
                    PubSub.publish(globals.CONSOLE_EVENTS.RECEIVED_API_EVENT, data);

                    if (typeof event.data == "string") {
                        try {
                            data = JSON.parse(event.data);
                        } catch (err) {
                            if (data.indexOf("{") != -1 && data.indexOf("inspifm") == -1) {
                                // console.error("Error parsing JSON string", event.data);
                            }
                        }
                    }

                    if (data === globals.DO_PLAY) {
                        globals.PLAY_FUNCTION();
                    } else if (data === globals.DO_PAUSE) {
                        PubSub.publish(globals.DO_PAUSE);
                    } else if (data === globals.WINDOW_RESIZE) {
                        PubSub.publish(globals.WINDOW_RESIZE);
                    } else if (data === globals.MUTE_VOLUME) {
                        PubSub.publish(globals.MUTE_VOLUME);
                    } else if (data === globals.UNMUTE_VOLUME) {
                        PubSub.publish(globals.UNMUTE_VOLUME);
                        // Need to publish sync because otherwise mobile browsers do not count the function call as being user initiated
                        PubSub.publishSync(globals.ENABLE_AUDIO);
                    } else if (data === globals.GET_CURRENT_TIME) {
                        PubSub.publish(globals.GET_CURRENT_TIME);
                    } else if (data === globals.TOGGLE_SUBTITLES) {
                        PubSub.publish(globals.TOGGLE_SUBTITLES);
                    } else if (data === globals.IS_PLAYER_READY) {
                        if (window.wirewax.playerReady) {
                            self.triggerEvent(globals.PLAYER_READY);
                        }
                    } else if (data === globals.GET_TAGS) {
                        PubSub.publish(globals.GET_TAGS);
                    } else if (data === globals.ADD_TAG && window.wirewax.writer) {
                        PubSub.publish(globals.ADD_TAG);
                    } else if (data === globals.REDRAW_TAGS && window.wirewax.writer) {
                        PubSub.publish(globals.REDRAW_TAGS, data.data);
                    } else if (data.name === globals.REDRAW_TAGS && window.wirewax.preview) {
                        PubSub.publish(globals.REDRAW_TAGS, data.data);
                    } else if (data === globals.CLOSE_WRITER && window.wirewax.writer) {
                        PubSub.publish(globals.CLOSE_WRITER);
                    } else if (data === globals.SAVE_TAG && window.wirewax.writer) {
                        PubSub.publish(globals.SAVE_TAG);
                    } else if (data === globals.UPDATE_TAG && window.wirewax.writer) {
                        PubSub.publish(globals.UPDATE_TAG);
                    } else if (data.name === "accessToken" && window.wirewax.writer) {
                        window.wirewax.accessToken = data.data;
                    } else if (data.name === globals.VOLUME_CHANGE) {
                        var volume = data.volume;
                        globals.VOLUME = volume;
                        PubSub.publish(globals.VOLUME_CHANGE, volume);
                    } else if (data.name === globals.TAG_NAMED) {
                        PubSub.publish(globals.TAG_NAMED, data.data);
                    } else if (data.name === globals.DO_SEEK) {
                        PubSub.publish(globals.DO_SEEK, data.data);
                    } else if (data.name === globals.GO_TO_TAG) {
                        PubSub.publish(globals.GO_TO_TAG, data.data);
                    } else if (data.name === globals.OPEN_TAG) {
                        PubSub.publish(globals.OPEN_TAG, data.data);
                    } else if (data.name === globals.CHANGE_VOLUME) {
                        if (!globals.IS_IPHONE) {
                            // Need to publish sync because otherwise mobile browsers do not count the function call as being user initiated
                            if (globals.AUDIO_DISABLED && data.data > 0) PubSub.publishSync(globals.ENABLE_AUDIO);
                            PubSub.publish(globals.CHANGE_VOLUME, data.data);
                        }
                    } else if (data.name === globals.TAG_HOVER_IN) {
                        PubSub.publish(globals.TAG_HOVER_IN, data.data);
                    } else if (data.name === globals.TAG_HOVER_OUT) {
                        PubSub.publish(globals.TAG_HOVER_OUT, data.data);
                    } else if (data.name === globals.DEVICE_ORIENTATION) {
                        PubSub.publish(globals.DEVICE_ORIENTATION, data.data);
                    } else if (data.name === globals.DEVICE_MOTION) {
                        PubSub.publish(globals.DEVICE_MOTION, data.data);
                    } else if (data.name === globals.DEVICE_SCREEN_ORIENTATION) {
                        PubSub.publish(globals.DEVICE_SCREEN_ORIENTATION, data.data);
                    } else if (data.name === globals.CLIENT_CUSTOM_TRIGGER) {
                        PubSub.publish(globals.CLIENT_CUSTOM_TRIGGER, data.data);
                    } else if (data === globals.CLOSE_WIDGET) {
                        PubSub.publish(globals.CLOSE_WIDGET);
                    } else if (data.name === globals.CHANGE_SUBTITLES) {
                        PubSub.publish(globals.CHANGE_SUBTITLES, data.data);
                    } else if (data.name === globals.MERGE_MODE) {
                        PubSub.publish(globals.MERGE_MODE, data.data);
                    } else if (data.name === globals.CHANGE_RENDITION) {
                        PubSub.publish(globals.CHANGE_RENDITION, data.data);
                    } else if (data.name === globals.CHANGE_CUSTOM_CONFIG) {
                        PubSub.publish(globals.CHANGE_CUSTOM_CONFIG, data.data);
                    }
                },
                false
            );
        }
    };

    return EventManager;
});

wwplayer.define("InnovidEventManager", ["jquery", "pubsub", "globals", "apiService"], function($, PubSub, globals, apiService) {
    /**
		Handles triggering and responding to DOM events
	 	Implements the Innovid VPAID spec

		@constructor InnovidEventManager
		@param {HTMLElement} element the element to listen to events on
	**/
    var EventManager = function(element) {
        var self = this;
        self.duration = 0;
        self.volume = 1;

        /**
			Triggers and event on the DOM
		 	@name InnovidEventManager#triggerEvent
			@method
			@param {String} eventName the name of the event
			@param {Object} eventData the event data
		**/
        this.innovidEvents = {};
        this.innovidEvents[globals.PLAYER_READY] = "ive-ready";
        this.innovidEvents[globals.HAS_PLAYED] = { name: "AdPlaying" };
        this.innovidEvents[globals.HAS_PAUSED] = { name: "AdPaused" };
        this.innovidEvents[globals.VIDEO_FIRST_QUARTILE] = { name: "AdVideoFirstQuartile" };
        this.innovidEvents[globals.VIDEO_MIDPOINT] = { name: "AdVideoMidpoint" };
        this.innovidEvents[globals.VIDEO_THIRD_QUARTILE] = { name: "AdVideoThirdQuartile" };
        this.innovidEvents[globals.VIDEO_END] = { name: "AdVideoComplete" };
        this.innovidEvents[globals.TAG_CLICK] = { name: "AdInteraction" };
        this.innovidEvents[globals.WIDGET_CLICKOUT] = { name: "AdClickThru" };
        this.innovidEvents[globals.ERROR] = { name: "AdError" };
        this.innovidEvents["AdLoaded"] = { name: "AdLoaded" };
        this.innovidEvents["AdStarted"] = { name: "AdStarted" };
        this.innovidEvents["AdPlaying"] = { name: "AdPlaying" };
        this.innovidEvents["AdPaused"] = { name: "AdPaused" };
        this.innovidEvents["AdVideoStart"] = { name: "AdVideoStart" };
        this.innovidEvents["AdStopped"] = { name: "AdStopped" };

        this.triggerEvent = function(eventName, eventData, eventParams) {
            if (window.parent !== window) {
                try {
                    var payload = null;
                    if (!self.innovidEvents[eventName]) {
                        payload = { eventType: "vpaid-method-response", methodName: eventName, value: eventData };
                    } else if (typeof self.innovidEvents[eventName] == "string") {
                        payload = self.innovidEvents[eventName];
                    } else {
                        payload = { eventType: "vpaid-event", eventName: self.innovidEvents[eventName].name };

                        if (eventParams) {
                            payload.params = eventParams;
                        }
                    }

                    window.parent.postMessage(payload, "*");
                } catch (err) {
                    // Weird JSON parsing error
                }
            }
        };

        PubSub.subscribe(globals.PLAYER_READY, this.triggerEvent);
        PubSub.subscribe(globals.DURATION_CHANGE, function(eventName, eventData) {
            self.duration = eventData;
        });
        PubSub.subscribe(globals.VIDEO_FIRST_QUARTILE, this.triggerEvent);
        PubSub.subscribe(globals.VIDEO_MIDPOINT, this.triggerEvent);
        PubSub.subscribe(globals.VIDEO_THIRD_QUARTILE, this.triggerEvent);
        PubSub.subscribe(globals.VIDEO_END, function() {
            self.triggerEvent(globals.VIDEO_END);
        });
        PubSub.subscribe(globals.WIDGET_CLICKOUT, function(eventName, eventData) {
            var id = null;
            if (eventData.tagData) {
                id = eventData.tagData.tagName;
            }
            self.triggerEvent(eventName, null, { id: id, url: eventData.url, tagData: eventData.tagData });
        });
        PubSub.subscribe(globals.TAG_CLICK, function(eventName, tagData) {
            //uniqueUserId should be uniqueViewId but they are already expecting the first name
            self.triggerEvent(eventName, null, { id: tagData.tag.publicData.tagName, tagData: tagData.tag.publicData, uniqueUserId: apiService.uuId });
        });
        PubSub.subscribe(globals.HAS_PAUSED, this.triggerEvent);
        PubSub.subscribe(globals.HAS_PLAYED, function(eventName) {
            if (self.started) {
                self.triggerEvent(eventName);
            } else if (!self.started && !globals.IS_DESKTOP) {
                self.triggerEvent("AdStarted");
                self.triggerEvent("AdVideoStart");

                self.started = true;
            }
        });
        PubSub.subscribe(globals.ERROR, function(eventName, data) {
            self.triggerEvent(eventName, null, { message: data.args && data.args.message ? data.args.message : "Video not available" });
        });

        if (window.addEventListener) {
            window.addEventListener(
                "message",
                function(event) {
                    var data = event.data;

                    if (data.eventType === "vpaid-method") {
                        if (data.eventName === "getAdRemainingTime") {
                            if (self.duration > 0) {
                                self.triggerEvent("getAdRemainingTime", Math.max(self.duration - globals.GET_CURRENT_PLAYING_TIME(), 0));
                            }
                        } else if (data.eventName === "getAdDuration") {
                            self.triggerEvent("getAdDuration", self.duration);
                        } else if (data.eventName === "getAdVolume") {
                            self.triggerEvent("getAdVolume", self.volume);
                        } else if (data.eventName === "getAdExpanded") {
                            self.triggerEvent("getAdExpanded", true);
                        } else if (data.eventName === "getAdSkippableState") {
                            self.triggerEvent("getAdSkippableState", false);
                        } else if (data.eventName === "getAdLinear") {
                            self.triggerEvent("getAdLinear", true);
                        } else if (data.eventName === "handshakeVersion") {
                            self.triggerEvent("handshakeVersion", "2.0");
                        } else if (data.eventName === "setAdVolume") {
                            if (data.params.volume !== undefined && data.params.volume !== null) {
                                self.volume = data.params.volume;
                                PubSub.publish(globals.CHANGE_VOLUME, data.params.volume);
                            }
                        } else if (data.eventName === "pauseAd") {
                            PubSub.publish(globals.DO_PAUSE);
                        } else if (data.eventName === "resumeAd") {
                            globals.PLAY_FUNCTION();
                        } else if (data.eventName === "initAd") {
                            self.triggerEvent("AdLoaded");
                        } else if (data.eventName === "stopAd") {
                            PubSub.publish(globals.DO_PAUSE);
                            self.triggerEvent("AdStopped");
                        } else if (data.eventName === "startAd") {
                            window.setTimeout(function() {
                                if (globals.IS_DESKTOP) {
                                    globals.PLAY_FUNCTION();
                                    self.triggerEvent("AdStarted");
                                    self.triggerEvent("AdVideoStart");
                                }

                                $("#video-container").show();

                                window.setTimeout(function() {
                                    self.started = true;
                                }, 1000);
                            }, 1000);
                        }
                    }
                },
                false
            );
        }
    };

    return EventManager;
});

wwplayer.define("ww", ["jquery", "AbstractPlayer", "pubsub", "globals", "modernizr", "LogEvent", "apiService", "require-shim", "iphone-inline-video"], function(
    $,
    AbstractPlayer,
    PubSub,
    globals,
    Modernizr,
    LogEvent,
    apiService,
    requireShim,
    makeVideoPlayableInline
) {
    "use strict";

    var self;
    var Player = AbstractPlayer.extend({
        init: function(videoElementContainer, updateScrubFn, playerOptions, readyCallback, errorCallback, videoData) {
            this._super(videoElementContainer, updateScrubFn, playerOptions, readyCallback, errorCallback, videoData);
            self = this;
            self.videoElementContainer = videoElementContainer;
            globals.ENABLE_TIME_CODE_COVER = true;
            self.refreshRate = globals.IS_IPHONE ? 20 : 60;

            self.vidId = $(videoElementContainer).attr("data-vidid");
            self.stallLoopCount = 0;
            self.lastCheckedStallFrame = 0;

            self.isWaiting = false;

            if (window.wirewax.vidOverride) {
                self.vidId = window.wirewax.vidOverride;
            }

            var posterUrl = window.wirewax.cdnUrl + "vidData/" + self.vidId + "/poster/poster.jpg";

            if (window.wirewax.posterUrl) {
                posterUrl = window.wirewax.posterUrl;
            }
            if (window.wirewax.blackPoster) {
                posterUrl = "//edge-assets.wirewax.com/creativeData/pureblack.jpg";
            }

            self.overrideGlobalRendition();

            var extraRenditionName = "";

            if (globals.IS_STACKED) {
                extraRenditionName = "Stacked";
                $("#video-container").css({ overflow: "hidden" });
            }

            var mp4VidUrl = self.cdnURL + "vidData/" + self.vidId + "/" + self.vidId + "_" + globals.RENDITION + extraRenditionName + ".mp4";
            var webmVidUrl = self.cdnURL + "vidData/" + self.vidId + "/" + self.vidId + "_" + globals.RENDITION + extraRenditionName + ".webm";

            if (window.wirewax.sourceFiles) {
                posterUrl = window.wirewax.sourceFiles.poster || posterUrl;
                mp4VidUrl = window.wirewax.sourceFiles.mp4 || mp4VidUrl;
                webmVidUrl = window.wirewax.sourceFiles.webm || webmVidUrl;
            }

            self.videoElement = self.createVideoElement(posterUrl, mp4VidUrl, webmVidUrl);
            window.wirewax.element = self.videoElement;

            self.setupLoadTimeEvent();

            $(videoElementContainer).append($(self.videoElement));

            PubSub.subscribe(globals.ENABLE_AUDIO, self.enableAudio);

            window.setTimeout(function() {
                readyCallback(self.videoElement);
            }, 50);
        },
        overrideGlobalRendition: function() {
            if (globals.FORCE_RENDITION) {
                globals.RENDITION = globals.FORCE_RENDITION;
            } else if (globals.IS_ANDROID || globals.IS_IPHONE) {
                if (parseInt(globals.RENDITION) >= 540) {
                    globals.RENDITION = "540";
                }
                if (globals.IS_STACKED) {
                    globals.RENDITION = "360";
                }
            }
        },
        checkForStall: function() {
            //Reset if we're in the middle of a seeking stall check
            if (self.stallCheckTimeout) {
                return;
            }

            if (!self.playing() && self.stalled) {
                self.stalled = false;
                PubSub.publish(globals.HIDE_LOADER);
            }

            if (self.isWaiting) {
                var currentTime = self.getCurrentTime();
                if (!self.stalled && currentTime === self.lastCheckedStallTime) {
                    // Stalled
                    self.stalled = true;
                    PubSub.publish(globals.SHOW_LOADER);
                } else if (self.stalled && currentTime !== self.lastCheckedStallTime) {
                    self.stalled = false;
                    self.isWaiting = false;
                    PubSub.publish(globals.HIDE_LOADER);
                }

                self.lastCheckedStallTime = currentTime;
            }
        },
        /**
         * Enable audio. This should only be called by user initiated callbacks. This will only do anything if
         * globals.AUDIO_DISABLED is true (or force is true).
         * @param eventName - PubSub stuff
         * @param force - should only be true when this is called from setVolume.
         */
        enableAudio: function(eventName, force) {
            if (globals.AUDIO_DISABLED || force) {
                self.videoElement.muted = false;
                PubSub.publish(globals.VOLUME_CHANGE, globals.VOLUME);
                if (globals.AUDIO_DISABLED && globals.SHOW_DISABLED_AUDIO_ICON) {
                    globals.AUDIO_DISABLED = false;
                }
            }
        },
        disableAudio: function() {
            self.videoElement.muted = true;
            PubSub.publish(globals.VOLUME_CHANGE, 0);
        },
        createVideoElement: function(posterUrl, mp4VidUrl, webmVidUrl) {
            var videoElement = null;

            window.wirewax.onVideoError = function() {
                self.onError(arguments);
            };

            if (globals.REQUIRES_BAGEL) {
                videoElement = $('<video preload="auto" src="' + mp4VidUrl + '" crossorigin="anonymous" webkit-playsinline playsinline id="wireWaxVideo"></video>')[0];
                self.iphonePlayer = makeVideoPlayableInline(videoElement, self.refreshRate);
            }
            // 2017-08-18: In the current iOS 11 Beta, <source> tags don't work.
            // Hopefully this will be fixed before final release. ¯\_(ツ)_/¯
            // 2017-09-22: Safari new version throws an error if webm is one of the possible sources.
            else if (globals.IOS_VERSION > 10 || (globals.IS_SAFARI && globals.IS_DESKTOP)) {
                videoElement = $('<video preload="auto" src="' + mp4VidUrl + '" crossorigin="anonymous" webkit-playsinline playsinline id="wireWaxVideo"></video>')[0];
            } else if (globals.IS_IE_9 || globals.IS_IE_8) {
                videoElement = $(
                    '<video preload="' + globals.VIDEO_PRELOAD + '" playsinline webkit-playsinline id="wireWaxVideo" src="' + mp4VidUrl + '" type="video/mp4"></video>'
                )[0];
            } else if (globals.ENABLE_PIXEL_TIMECODE) {
                videoElement = $(
                    '<video preload="' +
                        globals.VIDEO_PRELOAD +
                        '" crossorigin="anonymous" playsinline webkit-playsinline id="wireWaxVideo">' +
                        '<source src="' +
                        webmVidUrl +
                        '" type="video/webm" >' +
                        '<source src="' +
                        mp4VidUrl +
                        '" type="video/mp4" onerror="window.wirewax.onVideoError(parentNode)" >' +
                        "</video>"
                )[0];
            } else {
                videoElement = $(
                    '<video preload="' +
                        globals.VIDEO_PRELOAD +
                        '" webkit-playsinline playsinline id="wireWaxVideo">' +
                        '<source src="' +
                        webmVidUrl +
                        '" type="video/webm" >' +
                        '<source src="' +
                        mp4VidUrl +
                        '" type="video/mp4" onerror="window.wirewax.onVideoError(parentNode)" >' +
                        "</video>"
                )[0];
            }

            if (posterUrl && !(globals.AUTOPLAY && globals.CAN_AUTOPLAY)) {
                globals.ASSETS.push(posterUrl);
                var posterElement = $(
                    '<img style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 100; cursor: pointer; user-select:none; -webkit-user-drag: none;" class="fallback-poster-image" src="' +
                        posterUrl +
                        '"/>'
                );
                posterElement.bind(globals.CLICK_EVENT, function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    globals.PLAY_FUNCTION();
                });
                $("#tag-overlay").append(posterElement);
            }

            return videoElement;
        },
        setupLoadTimeEvent: function() {
            var loadTimeStart = new Date().getTime();
            $(self.videoElement).bind("canplaythrough", function() {
                PubSub.publish(globals.LOAD_METRIC, {
                    type: 8,
                    urls: [self.videoElement.currentSrc],
                    loadTime: new Date().getTime() - loadTimeStart
                });
                $(self.videoElement).unbind("canplaythrough");
            });
        },
        getAvailableRenditions: function() {
            return ["1080", "720", "540", "360", "180"];
        },
        switchRendition: function(eventName, rendition) {
            var vidId = self.vidId;
            PubSub.publish(globals.SHOW_LOADER);
            self.pause(true);
            var curTime = self.getCurrentTime();
            $(self.videoElement)
                .children("source")
                .remove();
            var extraRenditionName = "";
            if (globals.IS_STACKED) {
                extraRenditionName = "Stacked";
                $("#video-container").css({ overflow: "hidden" });
            }

            var sourceWebm = document.createElement("source");
            sourceWebm["src"] = self.cdnURL + "vidData/" + vidId + "/" + vidId + "_" + rendition + extraRenditionName + ".webm";
            $(self.videoElement).append(sourceWebm);

            var sourceMp4 = document.createElement("source");
            sourceMp4["src"] = self.cdnURL + "vidData/" + vidId + "/" + vidId + "_" + rendition + extraRenditionName + ".mp4";
            $(self.videoElement).append(sourceMp4);

            var loadedmetadataAfterRenditionChange = function() {
                var seekedAfterRenditionChange = function() {
                    window.setTimeout(function() {
                        self.play(true);
                        globals.RENDITION = rendition;
                        PubSub.publish(globals.RENDITION_CHANGED);
                        PubSub.publish(globals.HIDE_LOADER);
                        $(self.videoElement).unbind("seeked", seekedAfterRenditionChange);
                    }, 1000);
                };
                $(self.videoElement).unbind("loadedmetadata", loadedmetadataAfterRenditionChange);
                $(self.videoElement).bind("seeked", seekedAfterRenditionChange);
                self.videoElement.currentTime = curTime;
            };

            $(self.videoElement)
                .unbind("loadedmetadata")
                .bind("loadedmetadata", loadedmetadataAfterRenditionChange);
            self.videoElement.load();
        },
        getCurrentRendition: function() {
            var vidId = self.vidId;
            var currentSrc = self.videoElement.currentSrc;
            var rendStart = currentSrc.indexOf(vidId.toString() + "_") + vidId.toString().length;
            var rendEnd = currentSrc.substring(rendStart).indexOf(".");
            var rend = currentSrc.substring(rendStart + 1, rendStart + rendEnd);
            return rend;
        },
        getVolume: function() {
            return self.videoElement.volume;
        },
        setVolume: function(volume) {
            if (volume) {
                self.enableAudio("lol", true);
            } else {
                self.disableAudio();
            }
            self.videoElement.volume = volume;
            this._super(volume);
        },
        play: function(hideIcon) {
            self.videoElement.play();
            this._super(hideIcon);
        },
        pause: function(hide) {
            if (self.playing()) {
                self.videoElement.pause();
                this._super(hide);
            }
        },
        seeking: function() {
            return self.iphonePlayer ? false : self.videoElement.seeking;
        },
        VideoData: function(videoData) {
            this._super(videoData);
        },
        getAvailableSubtitles: function() {
            this._super();
            return self.videoData ? self.videoData.subtitles : [];
        },
        seekToFrame: function(frame) {
            self.setCurrentTime("junk", parseFloat(frame / self.videoData.fps) + 0.0001);
        },
        frameForward: function(verificationFn) {
            if (!self.playing()) {
                self.pauseOnSeek = true;
                var wantedFrame = self.getFrame() + 1;
                var wantedTime = (wantedFrame - 1) / self.videoData.fps + 0.0001;
                var retryFn = function(isRetry) {
                    if (verificationFn) {
                        var verification = function() {
                            if (!isRetry || self.getCurrentTime() === wantedTime) {
                                $(self.videoElement).unbind("seeked", verification);
                                verificationFn(retryFn);
                            }
                        };
                        $(self.videoElement).bind("seeked", verification);
                        //self.setCurrentTime('junk', wantedFrame / self.videoData.fps + 0.0001);
                    }
                    self.setCurrentTime("junk", wantedTime);
                };
                retryFn(false);
            }
        },
        frameBack: function(verificationFn) {
            if (!self.playing()) {
                self.pauseOnSeek = true;
                var wantedFrame = self.getFrame() - 1;
                var wantedTime = (wantedFrame - 1) / self.videoData.fps + 0.0001;
                var retryFn = function(isRetry) {
                    if (verificationFn) {
                        var verification = function() {
                            if (!isRetry || self.getCurrentTime() === wantedTime) {
                                $(self.videoElement).unbind("seeked", verification);
                                verificationFn(retryFn);
                            }
                        };
                        $(self.videoElement).bind("seeked", verification);
                        self.setCurrentTime("junk", wantedFrame / self.videoData.fps + 0.0001);
                    }
                    self.setCurrentTime("junk", wantedTime);
                };
                retryFn(false);
            }
        },
        getFrame: function() {
            return Math.floor((self.videoElement.currentTime + 0.0001) * self.videoData.fps) + 1;
        },
        setFrame: function(frame) {
            var goToFrame = frame - 25;
            var time = self.videoData.fps * (goToFrame - 1) + 0.0001;
            self.setCurrentTime("junk", time);
        },
        getCurrentTime: function(frame) {
            return self.videoElement.currentTime;
        },
        setCurrentTime: function(eventName, currentTime) {
            if (isNaN(currentTime)) {
                return;
            }

            try {
                this._super(eventName, currentTime);
                if (self.iphonePlayer) {
                    self.iphonePlayer.setTime.call(self.iphonePlayer, currentTime, true);
                    self.seeked();
                } else {
                    var HAVE_METADATA_STATE = 1;
                    // video can't seek before the metadata is loaded
                    if (self.videoElement.readyState >= HAVE_METADATA_STATE) {
                        self.videoElement.currentTime = currentTime;
                    } else {
                        $(self.videoElement).bind("loadedmetadata", function() {
                            self.videoElement.currentTime = currentTime;
                            $(self.videoElement).unbind("loadedmetadata");
                        });
                    }
                }
            } catch (err) {
                console.log("Invalid current time " + currentTime, err);
            }
        },
        getBuffered: function() {
            var buffered = 0;
            var bufferAmt = self.videoElement.buffered;
            if (bufferAmt.length > 0) {
                var maxBuffer = 0;
                for (var i = 0; i < bufferAmt.length; i++) {
                    if (bufferAmt.end(i) > maxBuffer) {
                        maxBuffer = parseFloat(bufferAmt.end(i));
                    }
                }
                buffered = maxBuffer;
            } else {
                if (self.videoElement.readyState === 4) {
                    buffered = self.videoElement.duration;
                    if (isNaN(buffered)) {
                        buffered = 0;
                    }
                } else {
                    buffered = 0;
                }
            }
            return buffered;
        },
        getNetworkState: function() {
            return self.videoElement.networkState;
        },
        playing: function() {
            if (self.videoElement.paused) {
                return false;
            } else {
                return self.startedPlaying;
            }
        },
        paused: function() {
            return self.videoElement.paused;
        },
        playPause: function() {
            if (self.videoElement.paused) {
                self.play();
            } else {
                self.pause();
            }
        },
        getReadyState: function() {
            var state = self.videoElement.readyState;
            if (state < 2) {
                return 0;
            }
            if (state >= 2 && state < 4) {
                return 2;
            }
            if (state >= 4) {
                return 4;
            }
        },
        load: function() {
            self.videoElement.load();
        },
        onError: function() {
            if (self.getNetworkState() === 3) {
                PubSub.publish(globals.ERROR, new LogEvent(globals.ERROR, globals.ERRORS["5018"]));
            } else {
                PubSub.publish(globals.ERROR, new LogEvent(globals.ERROR, globals.ERRORS["5024"]));
            }
        },
        preSeekStallCheck: function() {
            if (!self.startedPlaying) {
                return;
            }

            if (self.stallCheckTimeout) {
                window.clearTimeout(self.stallCheckTimeout);
            }

            self.stallCheckTimeout = window.setTimeout(function() {
                self.stallCheckTimeout = null;
                PubSub.publish(globals.SHOW_LOADER);
                PubSub.publish(globals.STARTED_BUFFERING);
            }, 1000);
        },
        postSeekStallCheck: function() {
            if (self.stallCheckTimeout) {
                window.clearTimeout(self.stallCheckTimeout);
            } else {
                PubSub.publish(globals.ENDED_BUFFERING);
                PubSub.publish(globals.HIDE_LOADER);
            }
        },
        initialise: function() {
            $(self.videoElement).bind("seeked", this.seeked);
            $(self.videoElement).bind("ended", self.onEnd);
            $(self.videoElement).bind("waiting", function() {
                self.isWaiting = true;
            });

            // Remove the posterFrame so that we don't see it on seek
            var posterRemoveSubscriber = PubSub.subscribe(globals.HAS_PLAYED, function() {
                if (!window.wirewax.writer) $(window).resize();
                setTimeout(function() {
                    PubSub.unsubscribe(posterRemoveSubscriber);
                }, 0);
                self.videoElement.removeAttribute("poster");
                $("#tag-overlay")
                    .find(".fallback-poster-image")
                    .remove();
            });

            if (globals.ENABLE_STALL_DETECTION) {
                PubSub.subscribe(globals.DO_SEEK, self.preSeekStallCheck);
                PubSub.subscribe(globals.HAS_SEEKED, self.postSeekStallCheck);
            }

            self.mainLoop();
            this._super();

            // check if video needs to start muted
            if (globals.AUTOPLAY_MUTED) {
                self.disableAudio();
            }
        },
        onLoopUpdate: function() {}
    });

    return Player;
});

wwplayer.define("StandardEndFrame", ["jquery", "BaseModule", "underscore", "apiService", "globals", "pubsub", "require-shim"], function(
    $,
    BaseModule,
    _,
    apiService,
    globals,
    PubSub,
    requireShim
) {
    var self;
    var END_FRAME_VIDEO = 8150648;
    var StandardEndFrame = BaseModule.extend({
        init: function(args) {
            self = this;
            this._super(args);
            if (globals.WHITELABEL || globals.DISABLE_STANDARD_END_FRAME) {
                return;
            }

            self.setupEvents();
        },
        setupEvents: function() {
            PubSub.subscribe(globals.HAS_PLAYED, function() {
                self.onPlayed();
            });

            PubSub.subscribe(globals.VIDEO_END, function() {
                $("#bottom-button-bar").hide();
                if (!self.added) {
                    self.createEndFrame();
                    self.showing = true;
                    self.added = true;
                    window.setTimeout(function() {
                        self.$endFrame.find(".animates-in").addClass("show");
                    }, 100);
                } else if (self.added && !self.showing) {
                    self.showing = true;
                    self.$endFrame.show();
                    window.setTimeout(function() {
                        self.$endFrame.find(".wwx-end-frame-components").show();
                        self.$endFrame.find(".animates-in").addClass("show");
                        self.$endFrame.find(".video-in-video")[0].play();
                    }, 100);
                }
            });
        },
        createEndFrame: function() {
            var isStudioUser = apiService.isStudioUser();
            self.$endFrame = $(
                '<div id="wwx-end-frame">' +
                    '<div class="wwx-end-frame-background animates-in"></div>' +
                    '<div class="wwx-end-frame-components">' +
                    '<div class="default-button replay-button"><div class="default-button-icon replay-icon"></div><div class="default-button-text"><p>replay</p></div></div>' +
                    '<div class="wwx-end-frame-logo"></div>' +
                    '<div class="button-wrap">' +
                    '<div class="wwx-s5-signup-button-outer">' +
                    '<div class="ww-s5-signup-inner">Request a demo</div>' +
                    "</div>" +
                    "</div></div>"
            );

            if (self.shouldShowVariant()) {
                self.$endFrame.addClass("wwx-end-frame-alternative");
            }
            self.drawButton(self.$endFrame.find(".wwx-s5-signup-button-outer"));
            self.drawLogo(self.$endFrame.find(".wwx-end-frame-logo"));
            self.drawReplay(self.$endFrame.find(".replay-icon"));

            self.$endFrame.find(".ww-s5-signup-inner").bind(globals.CLICK_EVENT, function(e) {
                e.stopPropagation();
                e.preventDefault();
                PubSub.publish(globals.UI_EVENT, { eventName: "endcardSignup", eventId: 32 });
                var url = isStudioUser ? "login" : "signup";
                apiService.widgetLinkClick("", "", "https://www.wirewax.com/studio#studio-form", "standard_end_frame_signup", "");
            });
            self.$endFrame.find(".replay-button").bind(globals.CLICK_EVENT, function() {
                self.$endFrame.find(".button-wrap").removeClass("enable-click");
                PubSub.publish(globals.UI_EVENT, { eventName: "endcardReplay", eventId: 31 });
                self.onPlayed(globals.PLAY_FUNCTION);
            });

            var videoInVideo = self.toolkit.createVideoInVideo(self.$endFrame.find(".wwx-end-frame-background")[0], END_FRAME_VIDEO, {
                autoPlay: true,
                playsInline: true,
                muted: true,
                togglePlayOnClick: false,
                forceRendition: "720"
            });

            videoInVideo.onEnd = function() {
                self.showButtonsAndLogo();
            };

            $("#control-overlay").append(self.$endFrame);
        },
        showButtonsAndLogo: function() {
            PubSub.publish(globals.UI_EVENT, { eventName: "endcardEnd", eventId: 33 });
            self.$endFrame.find(".button-wrap").addClass("show");
            self.$endFrame.find(".wwx-end-frame-logo").addClass("show");
            self.$endFrame.find(".wwx-end-frame-components").addClass("show");
            self.$endFrame.find(".wwx-end-frame-background").addClass("ended");
            window.setTimeout(function() {
                self.$endFrame.find(".button-wrap").addClass("enable-click");
            }, 1300); // Pointer events are disabled until animation of button and logo are finished
        },
        shouldShowVariant: function() {
            var uuid = apiService.getUserUUID();
            if (uuid) {
                var hex = uuid.slice(-1);
                var int = parseInt(hex, 16); // parse hexadecimal string
                return int % 2;
            } else {
                return false;
            }
        },
        onPlayed: function(callback) {
            $("#bottom-button-bar").show();
            if (self.added && self.showing) {
                self.showing = false;

                window.setTimeout(function() {
                    self.$endFrame.hide();
                    self.$endFrame.find(".show").removeClass("show");
                    self.$endFrame.find(".wwx-end-frame-background").removeClass("ended");
                    self.$endFrame.find(".wwx-end-frame-components").hide();
                    self.$endFrame.find(".video-in-video")[0].currentTime = 0;
                    if (callback) {
                        callback();
                    }
                }, 300);
            }
        },
        drawReplay: function(element) {
            var rsr = Raphael($(element)[0], "100%", "100%");
            rsr.setViewBox(0, 0, 100, 100, true);
            var path_a = rsr.path(
                "M87.2,94C87.2,94,87.2,94,87.2,94H73.3c19.3-10.4,29.5-32.7,24.3-54.4c-5.5-23.1-26.8-39-50.5-37.6v0 C23.5,3.5,4.2,21.7,1.4,45.3C-1.4,68.8,13.2,91,35.9,97.9c1,0.3,2.1-0.3,2.4-1.3c0.3-1-0.3-2.1-1.3-2.4C16.1,87.8,2.7,67.4,5.3,45.7 C7.8,24,25.6,7.3,47.4,6c21.8-1.3,41.4,13.3,46.4,34.6c4.9,20.7-5.3,41.8-24.2,50.9V76.4c0-1.1-0.9-2-1.9-2c0,0,0,0-0.1,0 c-1.1,0-1.9,0.9-1.9,2V96c0,1.1,0.9,2,2,2h19.5c1.1,0,2-0.9,2-1.9C89.2,94.9,88.3,94,87.2,94z"
            );
            path_a.attr({ "stroke-width": "0", "stroke-opacity": "1", fill: "#e5e5e5" }).data("id", "path_a");
        },
        drawLogo: function(element) {
            var rsr = Raphael($(element)[0], "100%", "100%");
            // rsr.setViewBox(270, 110, 230, 50, true);

            rsr.setViewBox(0, 0, 500, 500, true);
            // var rsr = Raphael(element.find('.innerSvg')[0], "100%", "100%");
            // rsr.setViewBox(0, 0, 800, 15, true);
            var group_a = rsr.set();
            group_a.attr({ name: "group_a" });
            var group_b = rsr.set();
            var path_d = rsr
                .path(
                    "M203.6,227.1c0-22.9,0-46.7-0.2-70l0-1l-1.1,0.2c-5.5,0.9-11,1.7-16.3,2.5l-0.8,0.1l0,0.8 c0.3,23.3,0.4,47.1,0.5,70.1c0.1,21.2,0.2,43.1,0.4,64.6l0,1l1.1-0.2c5.1-0.8,10.5-1.7,15.8-2.6l0.8-0.1l0-0.7 C203.5,270.1,203.6,248.2,203.6,227.1z"
                )
                .attr({
                    class: "st0",
                    parent: "group_a",
                    "stroke-width": "0",
                    "stroke-opacity": "1",
                    fill: "#EBA7C6"
                })
                .data("id", "path_d");
            var path_e = rsr
                .path(
                    "M253,152c-3.5-2.7-8.5-3.5-14-2.4c-9.5,1.8-18.8,3.5-27.7,5.1l-0.8,0.1l0,0.8c0.2,23.3,0.1,47,0.1,69.9 c-0.1,21.2-0.2,43,0,64.6l0,1.1l1.1-0.2c5.1-0.9,10.5-2,15.9-3.1l0.8-0.2l0-0.7c-0.1-21.2,0-42.4,0.2-62.2 c2.3-0.4,3.7-0.7,6.2-1.2c2.2-0.4,3.3-0.4,3.9,0c0.7,0.6,0.8,2.4,0.8,4.4c-0.2,16.9-0.3,36.8-0.2,56.5l0,1.1l1.1-0.2 c5.2-1.1,10.6-2.3,16.3-3.5l0.7-0.2l0-0.7c0-19.7,0.1-39.7,0.3-56.5c0.6-6-1.4-10-6.2-12c5.8-4,6.5-10.3,6.4-15.5 c0.1-12.2,0.2-22.9,0.2-32.8C258.2,158.9,256.4,154.6,253,152z M239.7,202.2c0,4.2-0.3,4.5-3.8,5.2c-2.9,0.6-4.5,0.9-7.1,1.4 c0.1-16.4,0.2-29.1,0.1-41.2c1-0.2,1.9-0.4,2.7-0.5c1.5-0.3,2.8-0.6,4.8-0.9c1-0.2,1.8,0,2.5,0.5c0.6,0.5,1,1.3,1,2.3 C239.8,179.8,239.8,190.4,239.7,202.2z"
                )
                .attr({
                    class: "st0",
                    parent: "group_a",
                    "stroke-width": "0",
                    "stroke-opacity": "1",
                    fill: "#EBA7C6"
                })
                .data("id", "path_e");
            var path_f = rsr
                .path(
                    "M266,144.2l-0.7,0.2l0,0.7c0,23.2-0.2,46.7-0.3,69.5c-0.2,21-0.3,42.8-0.3,64.2v1.1l1.2-0.3 c13.1-3,26.1-6.1,39.3-9.3l0.7-0.2l0-15.9l-1.2,0.3c-7.2,1.7-14.4,3.4-21.6,5.1c0-14.8,0.1-29.3,0.2-46.5 c6.2-1.4,12.4-2.8,18.6-4.2l0.7-0.2l0-15.8l-1.2,0.3c-6,1.4-12.1,2.7-18.1,4.1c0.1-16.2,0.1-28.9,0.2-40.8 c7.2-1.6,14.5-3.1,21.7-4.7l0.7-0.2l0-15.9l-1.2,0.2C291.8,138.7,279.1,141.4,266,144.2z"
                )
                .attr({
                    class: "st0",
                    parent: "group_a",
                    "stroke-width": "0",
                    "stroke-opacity": "1",
                    fill: "#EBA7C6"
                })
                .data("id", "path_f");
            var path_g = rsr
                .path(
                    "M372,255.1l0.1-0.6c2.4-19.4,4.7-39.1,7-58.2c2.9-25,6-50.8,9.2-76.1l0.2-1.2l-1.3,0.2 c-5.4,1-11.1,2-16.8,3.1l-0.7,0.1l-0.1,0.6c-2,17.5-3.9,34.9-5.7,51.5c-2.6-19.1-4.6-34.4-6.4-48.8l-0.1-1l-1,0.2 c-5.1,1-10.2,2.1-15.3,3.1l-0.7,0.1l-0.1,0.6c-1.9,17.2-3.8,34.2-5.6,50.9c-2.3-17.1-4.3-32.8-6.2-48l-0.1-1l-1,0.2 c-5.7,1.2-11.3,2.4-17,3.7l-0.8,0.2l0.1,0.8c3.3,26,6.7,52.4,10,77.9c2.2,16.9,4.4,33.8,6.5,50.7l0.1,1l1-0.2c5-1.2,10-2.3,15-3.5 l0.6-0.1l0.1-0.6c2.1-16.2,4.4-33.7,7.1-54.8c1.9,18,3.7,34.7,5.4,51.6l0.1,1l1.1-0.2c4.9-1.1,9.9-2.1,14.6-3.1L372,255.1z"
                )
                .attr({
                    class: "st0",
                    parent: "group_a",
                    "stroke-width": "0",
                    "stroke-opacity": "1",
                    fill: "#EBA7C6"
                })
                .data("id", "path_g");
            var path_h = rsr
                .path(
                    "M419.8,247.1l1-0.1c5.6-0.8,11.3-1.4,16.9-2.1l0.9-0.1l-0.1-0.9c-2.6-19.8-5.3-40-8-59.5 c-3.1-22.8-6.4-46.5-9.3-69.7l-0.1-0.9l-1,0.1c-6.6,0.9-13.6,2-21.4,3.3l-0.7,0.1l-0.1,0.7c-3.1,24.3-6.1,49.1-9,73.1 c-2.4,20-4.9,40.7-7.4,61l-0.2,1.2l1.3-0.2c5.2-1,10.4-1.9,15.6-2.8l0.7-0.1l0.1-0.7c1.3-10.1,2.7-20.9,4.2-33.1 c4.2-0.7,8.4-1.3,12.5-1.9c1.4,11.2,2.7,21.6,4,31.6L419.8,247.1z M405.2,200.5l1.3-10.1c0.9-7.6,1.9-15.3,2.8-22.9 c0.7,5.3,1.4,10.5,2.1,15.8l2.1,16C410.3,199.7,408.3,200,405.2,200.5z"
                )
                .attr({
                    class: "st0",
                    parent: "group_a",
                    "stroke-width": "0",
                    "stroke-opacity": "1",
                    fill: "#EBA7C6"
                })
                .data("id", "path_h");
            var path_i = rsr
                .path(
                    "M497.4,240.9l-0.3-1.1c-5.3-21.6-10.8-43.8-17-67.9c5.8-22.7,11.1-43.3,16.2-63.1l0.3-1.1l-1.2,0 c-5.7,0.1-11.5,0.2-17.3,0.5l-0.7,0l-0.2,0.7c-2.5,10.3-5,20.6-7.4,30.9c-3-9.9-5.9-19.9-8.8-29.8l-0.2-0.7l-0.8,0.1 c-5.5,0.4-11.2,1-16.8,1.6l-1.1,0.1l0.3,1c4.7,15.9,9.6,31.9,14.4,47.5l4.2,13.8l-5.2,18.5c-4.7,16.8-9.6,34.2-14.4,51.3l-0.4,1.3 l1.4-0.1c5.8-0.6,11.7-1.1,17.5-1.6l0.7-0.1l0.2-0.6c3-11.7,6-23.4,9.1-35c2.7,11.4,5.3,22.8,7.9,33.8l0.2,0.7l0.8,0 c5.9-0.3,11.7-0.5,17.5-0.6L497.4,240.9z"
                )
                .attr({
                    class: "st0",
                    parent: "group_a",
                    "stroke-width": "0",
                    "stroke-opacity": "1",
                    fill: "#EBA7C6"
                })
                .data("id", "path_i");
            var path_j = rsr
                .path(
                    "M163.3,161.5l-0.8,0.1l-0.1,0.7c-1.6,17.4-3.2,35-4.8,52.1c-2.5-18.4-4.9-35.1-7.2-50.8l-0.1-0.8l-0.9,0.1 c-5.1,0.4-10.2,0.8-15.2,1.1l-0.8,0.1l-0.1,0.8c-1.1,12.9-2.3,25.8-3.4,38.8l-1.1,12.1c-2.5-17.1-5-33.9-7.4-50.3l-0.1-0.8l-0.8,0 c-5.7,0.2-11.4,0.3-17,0.3l-1.1,0l0.2,1c6.8,46,13.5,92.1,19.7,135.1l0.1,0.8l0.9,0c4.8-0.2,9.6-0.5,14.4-0.9l0.8-0.1l0.1-0.7 c1.8-17.1,3.7-35.1,5.9-54.8l1,8.7c1.7,14.9,3.4,29.9,5.1,44.8l0.1,0.9l0.9-0.1c4.7-0.5,9.5-1,14.3-1.6l0.8-0.1l0.1-0.7 c2.7-27.5,5.8-55.5,8.7-82.6c1.9-17.8,4-36.2,5.8-54.3l0.1-1.1l-1.2,0.2C174.5,160.2,168.8,160.9,163.3,161.5z"
                )
                .attr({
                    class: "st0",
                    parent: "group_a",
                    "stroke-width": "0",
                    "stroke-opacity": "1",
                    fill: "#EBA7C6"
                })
                .data("id", "path_j");
            group_b.attr({ parent: "group_a", name: "group_b" });
            var group_c = rsr.set();
            var path_k = rsr
                .path(
                    "M520.4,109.4c-1.3-1.4-3.1-2.1-5.3-2.1c-2.2,0-3.9,0.7-5.3,2.1c-1.3,1.4-2,3.2-2,5.3c0,2.2,0.7,3.9,2,5.3 c1.3,1.4,3.1,2.1,5.3,2.1c2.1,0,3.9-0.7,5.3-2.1c1.3-1.4,2-3.2,2-5.3C522.4,112.6,521.7,110.8,520.4,109.4z M521.1,114.7 c0,1.9-0.5,3.4-1.6,4.5h0c-1.1,1.1-2.5,1.7-4.4,1.7c-1.8,0-3.3-0.6-4.4-1.7c-1.1-1.1-1.6-2.6-1.6-4.5c0-1.9,0.5-3.4,1.6-4.5 c1.1-1.1,2.5-1.7,4.4-1.7c1.8,0,3.3,0.6,4.4,1.7C520.6,111.4,521.1,112.9,521.1,114.7z"
                )
                .attr({
                    class: "st0",
                    parent: "group_a",
                    "stroke-width": "0",
                    "stroke-opacity": "1",
                    fill: "#EBA7C6"
                })
                .data("id", "path_k");
            var path_l = rsr
                .path(
                    "M517.6,114.6c0.3-0.4,0.5-1,0.5-1.6c0-0.6-0.2-1.2-0.7-1.6c-0.5-0.4-1.2-0.7-2.1-0.7h-2.6v7.8h1.4v-3.1h0.7 l1.9,3.1h1.7l-2.1-3.2C516.9,115.2,517.3,114.9,517.6,114.6z M514.1,111.8h1.2c1,0,1.4,0.4,1.4,1.2c0,0.8-0.4,1.2-1.4,1.2h-1.2 V111.8z"
                )
                .attr({
                    class: "st0",
                    parent: "group_a",
                    "stroke-width": "0",
                    "stroke-opacity": "1",
                    fill: "#EBA7C6"
                })
                .data("id", "path_l");
            group_c.attr({ parent: "group_a", name: "group_c" });
            var rsrGroups = [group_a, group_b, group_c];
            group_a.push();
            group_b.push(path_d, path_e, path_f, path_g, path_h, path_i, path_j);
            group_c.push(path_k, path_l);

            // var path = rsr.path("M301.601,221.413c-0.554,0-1.109-0.277-1.663-0.554c0,0,0,0-0.277,0&#10;&#9;&#9;&#9;c-0.554-0.554-0.831-1.109-0.831-1.663l0,0l0,0l0,0L282.479,54.301c0-0.831,0.277-1.94,1.109-2.494&#10;&#9;&#9;&#9;c0.831-0.554,1.663-0.831,2.771-0.277l113.071,45.173l38.522-46.281c0.554-0.831,1.386-1.109,2.494-1.109&#10;&#9;&#9;&#9;c0.831,0,1.663,0.554,2.217,1.386l45.727,82.309c0,0,0,0,0,0.277l0,0l0,0l0,0v0.277c0.277,0.554,0.277,1.386,0,1.94l0,0l0,0l0,0&#10;&#9;&#9;&#9;c-0.277,0.554-0.831,1.109-1.386,1.386l0,0l0,0l0,0l0,0l-184.294,84.249c-0.277,0-0.554,0.277-0.831,0.277l0,0l0,0&#10;&#9;&#9;&#9;C301.878,221.413,301.878,221.413,301.601,221.413L301.601,221.413L301.601,221.413L301.601,221.413z M288.298,57.904&#10;&#9;&#9;&#9;l15.242,153.809l92.008-110.576L288.298,57.904z M401.092,103.631l-89.514,107.528l167.112-76.212L401.092,103.631z&#10;&#9;&#9;&#9; M404.694,98.92l74.549,30.208l-39.63-71.778L404.694,98.92z")
            // .attr({
            //     parent: 'group_b',
            //     fill: '#EBA7C6',
            //     'stroke-width': '0',
            //     'stroke-opacity': '1'
            // }).data('id', 'path_al');
        },
        drawButton: function(parentElement) {
            var rsr = Raphael($(parentElement)[0], "100%", "100%");
            rsr.setViewBox(0, 0, 200, 54, true);
            var path_al = rsr
                .path("M175,50H25C11.2,50,0,38.8,0,25v0C0,11.2,11.2,0,25,0h150c13.7,0,25,11.2,25,25v0 C200,38.8,188.8,50,175,50z")
                .attr({
                    parent: "group_b",
                    stroke: "#EBA7C6",
                    "stroke-width": "2"
                })
                .data("id", "path_al");
        }
    });

    return StandardEndFrame;
});
wwplayer.define("Branching", ["globals", "pubsub", "Class", "underscore", "require-shim"], function(globals, PubSub, Class, _, requireShim) {
    var self;
    var Branching = Class.extend({
        init: function(args) {
            self = this;

            if (args.videoData.metaData && args.videoData.metaData.branching && args.videoData.metaData.branching.branches) {
                _.each(args.videoData.metaData.branching.branches, function(branch) {
                    function branchingFn() {
                        if (branch.type == globals.BRANCHING_TYPE.JUMP) {
                            PubSub.publish(globals.DO_SEEK, branch.outPoint / args.videoData.metaData.fps);
                            PubSub.publish(globals.BRANCHING_EVENTS.JUMP, branch);
                        } else if (branch.type == globals.BRANCHING_TYPE.PAUSE) {
                            PubSub.publish(globals.DO_PAUSE, { flashIn: false });
                            PubSub.publish(globals.BRANCHING_EVENTS.PAUSE, branch);
                        } else if (branch.type == globals.BRANCHING_TYPE.CUSTOM) {
                            PubSub.publish(globals.BRANCHING_EVENTS.CUSTOM, branch);
                        } else if (branch.type == globals.BRANCHING_TYPE.OVERLAY) {
                            if (branch.overlayId) {
                                var onWidgetLoad = function(Widget) {
                                    if (!branch.preventPauseOnClick) {
                                        PubSub.publish(globals.DO_PAUSE, { flashIn: false });
                                    }

                                    var widgetId = "panels"; // this is only for studio created overlays
                                    var overlayId = branch.overlayId; // 6 digits e.g. 140959
                                    var emptyTag = {
                                        appRef: null,
                                        appId: widgetId,
                                        overlayId: overlayId,
                                        widgetCdn: true,
                                        widgetId: widgetId, // same as appId
                                        branchingOverlay: true,
                                        preventPauseOnClick: !!branch.preventPauseOnClick,
                                        widgetClosed: function() {
                                            window.setTimeout(function() {
                                                PubSub.publish(globals.WIDGET_CLOSED);
                                            }, 100);
                                        }
                                    };
                                    var widgetInstance = new Widget(emptyTag);
                                    window.setTimeout(function() {
                                        PubSub.publish(globals.SHOW_WIDGET, widgetInstance);
                                    }, 50);

                                    if (branch.autoClose) {
                                        branch.autoCloseTime = branch.autoCloseTime || 0;
                                        window.setTimeout(function() {
                                            PubSub.publish(globals.CLOSE_WIDGET);
                                        }, branch.autoCloseTime);
                                    }
                                };
                                var widgetUrl = window.wirewax.widgetUrl + "panels.js";
                                requireShim.require([widgetUrl], onWidgetLoad.bind(this));
                            }
                        }
                    }
                    args.player.subscribeToFrame(branch.inPoint, branchingFn, true);
                });
            }
        }
    });
    return Branching;
});
wwplayer.define(
    "Core",
    [
        "jquery",
        "underscore",
        "modernizr",
        "InterfaceController",
        "TailTag",
        "BaseTagNew",
        "BaseWidget",
        "BaseModule",
        "SkinBaseSlick",
        "AbstractPlayer",
        "AnimationController",
        "TagController",
        "MetricsController",
        "apiService",
        "pubsub",
        "globals",
        "EventLogger",
        "LogEvent",
        "EventManager",
        "InnovidEventManager",
        "ww",
        "require-shim",
        "StandardEndFrame",
        "Branching"
    ],
    function(
        $,
        _,
        Modernizr,
        InterfaceController,
        BaseWidget,
        TailTag,
        BaseTagNew,
        BaseModule,
        SkinBaseSlick,
        AbstractPlayer,
        AnimationController,
        TagController,
        MetricsController,
        apiService,
        PubSub,
        globals,
        EventLogger,
        LogEvent,
        EventManager,
        InnovidEventManager,
        ww,
        requireShim,
        StandardEndFrame,
        Branching
    ) {
        /**
         Handles the loading and setup of the various modules that make up wireWAX

         @constructor Core
         @param {HTMLElement} videoContainer The main video-container element
         @param {Number} vidId The id of the video being watched
         **/
        var Core = function(videoContainer, vidId) {
            var self = this;
            /**
             The baseUrl path from where we load resources
             @name Core#resourceUrl
             @type String
             **/
            var resourceUrl = window.wirewax.baseUrl || "";

            /**
             The container for the video and wirewax elements
             @name Core#videoElementContainer
             @type HTMLElement
             **/
            self.videoElementContainer = videoContainer;

            /**
             The id of the video being watched
             @name Core#vidId
             @type Number
             **/
            self.vidId = vidId;

            /**
             @name Core#eventLogger
             @type EventLogger
             **/
            self.eventLogger = new EventLogger();

            /**
             The amount of retries for require module loading
             @name Core#errorRetries
             @type Number
             **/
            self.errorRetries = 0;

            // self.allowedWriterTags = [100023, 100080, 100081, 100139];
            self.allowedWriterTags = [100080];
            self.defaultWriterTag = 100080;

            /**
             Starts loading the core modules in sequence
             @name Core#start
             @method
             **/

            self.start = function() {
                if (window.wirewax.recordLoad) {
                    window.wirewax.recordLoad("core.js started");
                }

                if (window.wirewax.profile) {
                    PubSub.subscribe(globals.HAS_PLAYED, function() {
                        console.profile("video playback");
                    });
                    PubSub.subscribe(globals.VIDEO_END, function() {
                        console.profileEnd();
                    });
                }

                if (self.videoElementContainer === null) {
                    PubSub.publish(globals.ERROR, new LogEvent(globals.ERROR, globals.ERRORS["5001"]));
                    return;
                }

                // self.interfaceController = new InterfaceController(self.videoElementContainer, self.vidId, videoData);

                var eventManagerClass = globals.INNOVID_EVENTS ? InnovidEventManager : EventManager;
                self.eventManager = new eventManagerClass(self.videoElementContainer);

                // TODO - Find a better way to disable metrics in writer mode
                if (!globals.DISABLE_METRICS) {
                    self.metricsController = new MetricsController(
                        self.getCurrentTime,
                        self.getCurrentFrame,
                        function() {
                            return self.player.recordMetrics();
                        },
                        function() {
                            // getYawAndPitchCallback
                            return self.player.getYawAndPitch ? self.player.getYawAndPitch() : false;
                        }
                    );

                    // TODO Move methods that requires the metricscontroller in the apiService to a dedicated service
                    apiService.setMetricsController(self.metricsController);
                    self.metricsController.getHash();

                    self.metricsController.recordImpression(self.vidId, window.wirewax.embedLoc, self.impressionFail);
                    PubSub.subscribe(globals.HAS_PLAYED, self.metricsController.start);

                    PubSub.subscribe(globals.DO_HANDSHAKE, function() {
                        self.metricsController.handshake(self.vidId, window.wirewax.embedLoc, function() {}, self.handshakeFail);
                    });
                }

                self.loadSkin(window.wirewax.skin).then(function(loadedSkin) {
                    // self.interfaceController.loadSkin(loadedSkin);

                    if (!Modernizr.video && !globals.IS_WINDOWS_PHONE && !window.callPhantom && window.wirewax.player != "dummyPlayer") {
                        PubSub.publish(globals.ERROR, new LogEvent(globals.ERROR, globals.ERRORS["5009"]));
                        return;
                    }

                    self.loadVideoData(function(videoData) {
                        self.interfaceController = new InterfaceController(self.videoElementContainer, self.vidId, videoData);
                        self.interfaceController.loadSkin(loadedSkin);

                        globals.LOG("Loaded video data");
                        if (videoData["metaData"]["aspectRatio"]) {
                            globals.ASPECT_RATIO_HEIGHT = 1;
                            globals.ASPECT_RATIO_WIDTH = videoData["metaData"]["aspectRatio"];

                            if (videoData["metaData"]["isStacked"] === true) {
                                globals.ASPECT_RATIO_WIDTH = globals.ASPECT_RATIO_WIDTH * 2;
                            }
                        } else {
                            globals.ASPECT_RATIO_WIDTH = 16;
                            globals.ASPECT_RATIO_HEIGHT = 9;
                        }

                        if (window.wirewax.writer) {
                            if (self.allowedWriterTags.indexOf(videoData["metaData"]["tagId"]) === -1) {
                                videoData["metaData"]["customTagId"] = videoData["metaData"]["tagId"];
                                videoData["metaData"]["tagId"] = self.defaultWriterTag;
                            }
                        }

                        if (videoData["metaData"]["isStacked"]) {
                            globals.IS_STACKED = true;
                        }

                        if (videoData["metaData"]["iphoneInlineVideo"]) {
                            window.wirewax.forceVideoPlayer = true;
                        }

                        if (videoData["metaData"]["vidThumbcake"]) {
                            window.wirewax.vidThumbcake = {};
                            window.wirewax.vidThumbcake["thumbHeight"] = videoData["metaData"]["vidThumbcake"]["thumbHeight"];
                            window.wirewax.vidThumbcake["thumbWidth"] = videoData["metaData"]["vidThumbcake"]["thumbWidth"];
                            window.wirewax.vidThumbcake["numThumbs"] = videoData["metaData"]["vidThumbcake"]["numThumbs"];
                        }

                        if (videoData["metaData"]["is360"] && !window.wirewax.writer) {
                            window.wirewax.player = "newThreeSixtyPlayer";
                            globals.ENABLE_360_METRICS = true;
                        }

                        if (videoData["customConfigData"]) {
                            globals.CUSTOM_CONFIG_DATA = videoData["customConfigData"];
                        }
                        PubSub.subscribe(globals.CHANGE_CUSTOM_CONFIG, function(eventName, data) {
                            var customConfig = null;
                            if (data.themeId) {
                                customConfig = _.find(globals.CUSTOM_CONFIG_DATA, function(customConfigData) {
                                    return customConfigData.themeId;
                                });
                            } else {
                                customConfig = _.findWhere(globals.CUSTOM_CONFIG_DATA, {
                                    nameLink: data.nameLink,
                                    widgetId: data.widgetId
                                });
                            }

                            if (customConfig) {
                                customConfig.fields = data.fields;
                            } else {
                                if (!globals.CUSTOM_CONFIG_DATA) {
                                    globals.CUSTOM_CONFIG_DATA = [];
                                }
                                globals.CUSTOM_CONFIG_DATA.push(data);
                            }
                        });

                        videoData = self.processVideoData(videoData);
                        self.videoData = videoData;

                        if (self.videoData === null) {
                            return;
                        }
                        if (globals.DISABLE_CUSTOMISATIONS) {
                            globals.LOG("No Customisations version loaded");
                            // set the tagId to the default so any global settings in the real tag file don't interfere with this no customisations version
                            videoData.metaData.tagId = "100080";
                            self.loadTag(videoData).then(function(Tag) {
                                globals.LOG("Tag loaded");
                                $.when(self.loadPlayer(videoData), self.loadAnimationController(videoData)).then(function(player, animationController) {
                                    self.player = player;
                                    globals.NON_INTERACTIVE = true;
                                    self.createInterface(self.interfaceController, videoData, player, animationController);
                                    self.tagController = self.createTagController(self.interfaceController, videoData, player, animationController, Tag);

                                    self.loadAssets().then(function() {
                                        self.initialisePlayer(player, null);
                                    });
                                });
                            });
                        } else {
                            self.loadTag(videoData).then(function(Tag) {
                                globals.LOG("Tag loaded");
                                $.when(self.loadPlayer(videoData), self.loadAnimationController(videoData)).then(function(player, animationController) {
                                    globals.LOG("Player and animController loaded");
                                    self.player = player;
                                    self.animationController = animationController;

                                    self.animationController.player = self.player;

                                    self.Tag = Tag;
                                    self.createInterface(self.interfaceController, videoData, player, animationController);
                                    self.tagController = self.createTagController(self.interfaceController, videoData, player, animationController, Tag);
                                    self.loadModules(videoData).then(function(modules) {
                                        globals.LOG("modules loaded");

                                        _.each(modules, function(module, idx) {
                                            var moduleArgs = {
                                                player: player,
                                                interfaceController: self.interfaceController,
                                                animationController: animationController,
                                                videoData: videoData,
                                                tagController: self.tagController
                                            };

                                            if (idx >= videoData.moduleData.length && idx < videoData.moduleData.length + videoData.enhancedModuleData.length) {
                                                //this module is enhanced, so send along the data
                                                moduleArgs.moduleData = videoData.enhancedModuleData[idx - videoData.moduleData.length];
                                            }
                                            new module(moduleArgs);
                                        });

                                        self.interfaceController.addTagsToScrubberBar(tagController.getTags());

                                        if (!window.wirewax.writer) {
                                            new Branching({
                                                player: player,
                                                videoData: videoData
                                            });
                                        }

                                        self.loadAssets().then(function() {
                                            self.initialisePlayer(player, self.tagController);
                                        });
                                    });
                                });
                            });
                        }
                    });
                });
            };

            self.createInterface = function(interfaceController, videoData, player, animationController, tagController) {
                interfaceController.createInterface(player.videoElement, player, animationController, globals.MEDIA_TYPE === globals.MEDIA_TYPES.IMAGE);
                interfaceController.setDuration(videoData["metaData"]["duration"]);
                PubSub.publish(globals.DURATION_CHANGE, videoData["metaData"]["duration"]);
            };

            self.createTagController = function(interfaceController, videoData, player, animationController, Tag) {
                tagController = new TagController(videoData, interfaceController.tagOverlay, Tag, animationController, player.getCurrentTime, player.playing);

                if (!globals.NON_INTERACTIVE) {
                    tagController.start();
                } else {
                    PubSub.publish(globals.ANIMATIONS_READY);
                }
                return tagController;
            };

            self.initialisePlayer = function(player, tagController) {
                var readySubscriber = PubSub.subscribe(globals.PLAYER_READY, function() {
                    if (window.wirewax.spriteId) {
                        player.goToTag(tagController.getTagBySpriteId(parseInt(window.wirewax.spriteId)), !globals.OPEN_WIDGET_ON_SPRITE_SEEK_TO);
                    }
                    PubSub.unsubscribe(readySubscriber);
                });
                player.initialise();
            };

            self.impressionFail = function(error) {
                // PubSub.publish(globals.ERROR, new LogEvent(globals.ERROR, globals.ERRORS['5029'], {detail: error}));
            };

            self.loadSkin = function(skinName) {
                return $.Deferred(function(defer) {
                    var skinUrl = resourceUrl + "javascripts/player/interface/" + skinName + ".js";
                    requireShim.require(
                        [skinUrl],
                        function(Skin) {
                            defer.resolve(Skin);
                        },
                        function() {
                            defer.reject();
                        }
                    );
                }).promise();
            };

            self.loadAssets = function() {
                if (globals.IS_IPHONE) {
                    return $.when();
                } else {
                    //Assets are always images
                    var promises = [];

                    var createPromise = function(imageSrc) {
                        return $.Deferred(function(defer) {
                            var tmpImg = new Image();
                            tmpImg.onload = function() {
                                defer.resolve();
                            };
                            tmpImg.src = imageSrc;
                        }).promise();
                    };

                    _.each(globals.ASSETS, function(asset) {
                        promises.push(createPromise(asset));
                    });

                    return $.when.apply($, promises);
                }
            };

            self.loadErrorData = function(success) {
                apiService.getErrorDataCdn(success, function() {
                    globals.LOG("Failed to load error data");
                });
            };

            self.loadVideoData = function(success) {
                if (window.wirewax.vidData) {
                    var vidData = window.wirewax.vidData;
                    delete window.wirewax.vidData;
                    success(vidData);
                } else {
                    apiService.getVideoData(self.vidId, success, self.loadDataError);
                }
            };

            self.handshakeFail = function() {
                // PubSub.publish(globals.ERROR, new LogEvent(globals.ERROR, globals.ERRORS['5002']));
            };

            self.processVideoData = function(videoData) {
                globals.LOG("processing video data ", videoData);
                if (!videoData["metaData"] && !videoData["tagData"]) {
                    PubSub.publish(globals.ERROR, new LogEvent(globals.ERROR, globals.ERRORS["5014"]));
                    return;
                }

                self.handleIOSFallbacks(videoData);

                if (!self.processMetaData(videoData["metaData"])) {
                    return null;
                }

                return videoData;
            };

            self.handleIOSFallbacks = function(videoData) {
                if (window.wirewax.disableIOSApp === undefined) {
                    window.wirewax.disableIOSApp = videoData["metaData"]["disableIOSApp"];
                }
                if (window.wirewax.disableIOSAppVidOverride === undefined) {
                    window.wirewax.disableIOSAppVidOverride = videoData["metaData"]["disableIOSAppVidOverride"];
                } else if (globals.IS_IPHONE && !window.wirewax.inApp && window.wirewax.disableIOSApp && window.wirewax.disableIOSAppVidOverride) {
                    window.wirewax.vidOverride = videoData["metaData"]["disableIOSAppVidOverride"];
                }
            };

            ////// This is _never_ used
            self.processErrorCodes = function(errorCodes) {
                if (errorCodes) {
                    var wantedErrors = _.findWhere(errorCodes, { area: 0 });
                    globals.ERRORS = _.indexBy(wantedErrors["errors"], "code");
                }
            };

            self.processMetaData = function(metaData) {
                var canVideoPlay = true;

                if (metaData["autoStart"] && globals.IS_DESKTOP) {
                    globals.AUTOPLAY = true;
                }
                if (metaData["again"] && globals.IS_DESKTOP) {
                    globals.LOOP = true;
                }
                if (metaData["cdnUrl"]) {
                    window.wirewax.cdnUrl = metaData["cdnUrl"];
                }
                if (metaData["posterURL"]) {
                    window.wirewax.posterUrl = metaData["posterURL"];
                }
                if (metaData["whiteLabel"] == 0 || metaData["whiteLabel"] == 1 || window.wirewax.whitelabel) {
                    globals.WHITELABEL = true;
                }
                if (metaData["whiteLabel"] == 2 || window.wirewax.disableStandardEndFrame) {
                    globals.DISABLE_STANDARD_END_FRAME = true;
                }
                if (metaData["disableShares"] == 1) {
                    globals.DISABLE_SHARES = true;
                }
                if (metaData["impressionUrls"]) {
                    _.each(metaData["impressionUrls"], function(impressionUrl) {
                        var impressImg = new Image();
                        impressImg.src = impressionUrl + "?ts=" + new Date().getTime();
                    });
                }
                if (metaData["ipAddress"]) {
                    globals.IP_ADDRESS = metaData["ipAddress"];
                }

                if (metaData["vidOverride"]) {
                    window.wirewax.vidOverride = metaData["vidOverride"];
                } else {
                    window.wirewax.vidOverride = null;
                }

                if (metaData["shareText"]) {
                    globals.SHARE_TEXT = metaData["shareText"];
                }

                if (metaData["shareURL"]) {
                    globals.SHARE_URL = metaData["shareURL"];
                }

                if (metaData["countryLock"] && !window.wirewax.writer && !window.wirewax.preview) {
                    var unlocked = false;
                    _.each(metaData["countryLock"].split(","), function(country) {
                        if (window.wirewax.country && window.wirewax.country.toLowerCase() === country.toLowerCase()) {
                            unlocked = true;
                        }
                    });

                    if (!unlocked) {
                        PubSub.publish(globals.ERROR, new LogEvent(globals.ERROR, globals.ERRORS["5032"]));
                        canVideoPlay = false;
                    }
                }

                // Override Subtitles
                if (window.wirewax.subtitles) {
                    var subObj = {};
                    subObj["label"] = "custom";
                    subObj["file"] = window.wirewax.subtitles;
                    subObj["default"] = true;
                    subObj["external"] = true;
                    metaData["subtitles"] = [subObj];
                }

                if (window.wirewax.tagId) {
                    metaData["tagId"] = window.wirewax.tagId;
                }

                // Set media type
                globals.MEDIA_TYPE = metaData["mediaType"];

                if (globals.MEDIA_TYPE == globals.MEDIA_TYPES.IMAGE) {
                    // If is image, adjust the renditions!
                    switch (globals.BANDWIDTH_PREFERRED_RENDITION) {
                        case "4k":
                        // Fallthrough
                        case "1080":
                            globals.BANDWIDTH_PREFERRED_RENDITION = "2160image";
                            break;
                        case "720":
                        case "540":
                            globals.BANDWIDTH_PREFERRED_RENDITION = "1080image";
                            break;
                        default:
                            globals.BANDWIDTH_PREFERRED_RENDITION = "540image";
                    }

                    var wantedRendition = globals.BANDWIDTH_PREFERRED_RENDITION || globals.RESOLUTION_CODES[metaData["prefRendition"]];

                    var renditions = [];
                    if (metaData["renditionCodes"]) {
                        var availableRenditions = metaData["renditionCodes"].split(",");
                        _.each(globals.RENDITION_CODES, function(key, value) {
                            if (availableRenditions.indexOf("" + key) > -1) {
                                renditions.push(value);
                            }
                        });
                    }

                    globals.RENDITIONS = renditions;

                    if (renditions.indexOf(wantedRendition) > -1) {
                        globals.RENDITION = wantedRendition;
                    } else if (renditions.indexOf("2160image") > -1) {
                        globals.RENDITION = "2160image";
                    } else if (renditions.indexOf("1080image") > -1) {
                        globals.RENDITION = "1080image";
                    } else {
                        globals.RENDITION = "540image";
                    }

                    if (metaData["renditionCap"] && parseInt(globals.RENDITION) > parseInt(metaData["renditionCap"])) {
                        globals.RENDITION = metaData["renditionCap"];
                    }

                    if (parseInt(globals.RENDITION) > parseInt(globals.HD_RENDITION)) {
                        globals.HD_RENDITION = globals.RENDITION;
                    }
                } else {
                    if (globals.IS_STACKED && globals.BANDWIDTH_PREFERRED_RENDITION) {
                        //If is stacked, downgrade the resolution
                        switch (globals.BANDWIDTH_PREFERRED_RENDITION) {
                            case "4k":
                                globals.BANDWIDTH_PREFERRED_RENDITION = "1080";
                                break;
                            case "1080":
                                globals.BANDWIDTH_PREFERRED_RENDITION = "720";
                                break;
                            case "720":
                                //FIXME: we dont have stacked 540 resolution yet
                                globals.BANDWIDTH_PREFERRED_RENDITION = "360";
                                break;
                            case "540":
                                globals.BANDWIDTH_PREFERRED_RENDITION = "360";
                                break;
                        }
                    }

                    var wantedRendition = globals.BANDWIDTH_PREFERRED_RENDITION || globals.RESOLUTION_CODES[metaData["prefRendition"]];

                    var renditions = [];
                    if (metaData["renditionCodes"]) {
                        var availableRenditions = metaData["renditionCodes"].split(",");

                        _.each(globals.RENDITION_CODES, function(key, value) {
                            if (availableRenditions.indexOf("" + key) > -1) {
                                renditions.push(value);
                            }
                        });
                    }

                    globals.RENDITIONS = renditions;

                    if (renditions.indexOf(wantedRendition) > -1) {
                        globals.RENDITION = wantedRendition;
                    }
                    // DEFAULT TO 540, if not available then 360
                    else if (renditions.indexOf("1080") > -1) {
                        globals.RENDITION = "1080";
                    } else if (renditions.indexOf("720") > -1) {
                        globals.RENDITION = "720";
                    } else if (renditions.indexOf("540") > -1) {
                        globals.RENDITION = "540";
                    } else {
                        globals.RENDITION = "360";
                    }

                    if (metaData["renditionCap"] && parseInt(globals.RENDITION) > parseInt(metaData["renditionCap"])) {
                        globals.RENDITION = metaData["renditionCap"];
                    }

                    if (parseInt(globals.RENDITION) > parseInt(globals.HD_RENDITION)) {
                        globals.HD_RENDITION = globals.RENDITION;
                    }
                }

                globals.USER_AGENT = navigator.userAgent;
                globals.TAG_DISPLAY_MODE = 2;

                return canVideoPlay;
            };

            self.loadPlayer = function(videoData, callback) {
                var allowedPlayers = [
                    "yp",
                    "mtvPlayer",
                    "bcp",
                    "bc",
                    "ff",
                    "tnt",
                    "tp",
                    "tpp",
                    "newbcp",
                    "rtlPlayer",
                    "rtlPluginPlayer",
                    "ooyalaPlayer",
                    "bbcPlayer",
                    "ypLive",
                    "writerPlayer",
                    "dummyPlayer",
                    "vimeoPlayer",
                    "threeSixtyPlayer",
                    "threeSixtyCanvasPlayer",
                    "newThreeSixtyPlayer",
                    "amazonPlayer",
                    "imagePlayer",
                    "bitmovinPlayer",
                    "flowPlayer",
                    "pdk5",
                    "pdk6"
                ];
                var defaultPlayer = allowedPlayers.indexOf(videoData["metaData"]["defaultPlayer"]) !== -1 ? videoData["metaData"]["defaultPlayer"] : null;
                var playerType = window.wirewax.player || $(self.videoElementContainer).attr("data-player") || defaultPlayer || (Modernizr.video ? "ww" : "ff");

                // IPHONE INAPP DEPRECATED
                if (globals.IS_IPHONE && window.wirewax.inApp) {
                    playerType = "ww";
                }

                if (playerType === "yp" || playerType === "ypLive") {
                    var playerOptions = _.findWhere(videoData["players"], { player: playerType });
                    if (!playerOptions) {
                        playerType = "ww";
                    }
                    if (playerType === "ypLive") {
                        self.interfaceController.disableScrubber();
                    }
                }

                if (playerType === "tp") {
                    var playerOptions = _.findWhere(videoData["players"], { player: playerType });
                    if (!playerOptions) {
                        playerType = "ww";
                    }
                    $("head").append('<meta name="tp:PreferredRuntimes" content="Universal" />');
                    $("head").append('<meta name="tp:PreferredFormats" content="MPEG4, WEBM, OGG" /> ');
                    $("head").append('<meta name="tp:LogLevel" content="debug" /> ');
                }

                if (
                    window.MediaSource &&
                    window.MediaSource.isTypeSupported('video/webm; codecs="vp8,vorbis"') &&
                    (videoData.metaData.renditionCodes.indexOf("150") !== -1 ||
                        videoData.metaData.renditionCodes.indexOf("151") !== -1 ||
                        videoData.metaData.renditionCodes.indexOf("152") !== -1 ||
                        videoData.metaData.renditionCodes.indexOf("153") !== -1) &&
                    playerType !== "newThreeSixtyPlayer"
                ) {
                    playerType = "mediaSource";
                }

                if (playerType != "newbcp" && playerType != "flowPlayer" &&  playerType != "pdk5" && globals.IS_IPHONE) {
                    // all the brightcove, etc players must fallback to our bagel
                    if (playerType !== "newThreeSixtyPlayer") {
                        playerType = "ww";
                    }
                }

                // Force IE8 use our player
                if (globals.IS_IE_8) {
                    playerType = "ff";
                }

                // FORCE THE WRITER PLAYER IF WE'RE USING THE WRITER
                if (window.wirewax.writer) {
                    playerType = "writerPlayer";
                }

                // This should be _after_ the writer player override, as we don't use the writer player for images.
                if (globals.MEDIA_TYPE == globals.MEDIA_TYPES.IMAGE) {
                    playerType = "imagePlayer";
                }

                if (window.callPhantom) {
                    playerType = "dummyPlayer";
                }

                return $.Deferred(function(defer) {
                    var onPlayerLoad = function(defer, player) {
                        player.setVideoData(videoData["metaData"]);
                        player.setClipData(videoData["tagData"]);
                        player.setStaticData(videoData["staticSpriteData"]);
                        apiService.setCurrentTimeFn(player.getCurrentTime);
                        apiService.setCurrentFrameFn(player.getFrame);

                        defer.resolve(player);
                    };

                    if (playerType === "ww") {
                        var player = new ww(
                            self.videoElementContainer,
                            self.updateScrubBar,
                            playerOptions,
                            function(videoElement) {
                                onPlayerLoad(defer, player);
                            },
                            null,
                            videoData["metaData"]
                        );
                    } else {
                        var playerOptions = _.findWhere(videoData["players"], { player: playerType });

                        var playerUrl = resourceUrl + "javascripts/player/players/" + playerType + ".js";

                        if (playerType === "pdk5" || playerType === "pdk6") {
                            // playerUrl = "https://wirewax.s3-eu-west-1.amazonaws.com/wirewax-platform/" + playerType + ".wwxplayer.js"
                            playerUrl = "https://wenqili-ww.github.io/pdk5-test/" + playerType + ".wwxplayer.js";
                            // playerUrl = "https://wenqili-ww.github.io/pdk5-test/pdk5.wwxplayer.js";
                        }

                        requireShim.require([playerUrl], function(Player) {
                            var player = new Player(
                                self.videoElementContainer,
                                self.updateScrubBar,
                                playerOptions,
                                function(videoElement, playerRef) {
                                    if (playerRef) {
                                        onPlayerLoad(defer, playerRef);
                                    } else {
                                        onPlayerLoad(defer, player);
                                    }
                                },
                                function() {
                                    defer.reject();
                                },
                                videoData["metaData"]
                            );
                        });
                    }
                }).promise();
            };

            self.loadAnimationController = function(videoData) {
                return $.Deferred(function(defer) {
                    var animationControllerUrl;
                    if (videoData.metaData.tagId === 100183 || videoData.metaData.tagId === 100191 || videoData.metaData.tagId === 100210) {
                        //FIXME, THIS IS SPECIFIC TO DULUX ATM, WE NEED A WAY OF HAVING A GENERAL NON TAG TAG ANIMATION THING
                        animationControllerUrl = globals.ANIMATION_CONTROLLERS.NON_TAG;
                    } else if (window.wirewax.player === "threeSixtyCanvasPlayer" || window.wirewax.player === "newThreeSixtyPlayer") {
                        animationControllerUrl = globals.ANIMATION_CONTROLLERS.THREE_SIXTY;
                    } else if (window.wirewax.player === "amazonPlayer") {
                        animationControllerUrl = globals.ANIMATION_CONTROLLERS.TRANSFORM;
                    } else if (globals.IS_IE_8) {
                        //else use shitty js controller
                        animationControllerUrl = globals.ANIMATION_CONTROLLERS.JS;
                    } else {
                        animationControllerUrl = globals.ANIMATION_CONTROLLERS.DEFAULT;
                    }

                    requireShim.require(
                        [resourceUrl + animationControllerUrl],
                        function(AnimationControllerClass) {
                            var animationController = new AnimationControllerClass(
                                videoData["metaData"]["fps"],
                                videoData["metaData"]["duration"],
                                globals.TAG_DISPLAY_MODE,
                                self.interfaceController.tagOverlay
                            );
                            defer.resolve(animationController);
                        },
                        function() {
                            defer.reject();
                        }
                    );
                }).promise();
            };

            self.loadTag = function(videoData) {
                return $.Deferred(function(defer) {
                    var tag = videoData["metaData"]["tagId"];

                    if (!tag) {
                        PubSub.publish(globals.ERROR, new LogEvent(globals.ERROR, globals.ERRORS["5017"]));
                        defer.reject();
                    }

                    var tagUrl = window.wirewax.tagUrl + tag + ".js";
                    requireShim.require(
                        [tagUrl],
                        function(Tag) {
                            defer.resolve(Tag);
                        },
                        function() {
                            defer.reject();
                        }
                    );
                }).promise();
            };

            self.loadModules = function(videoData) {
                if (window.wirewax.writer) {
                    self.loadWriter();
                    videoData["moduleData"] = [];
                    videoData["enhancedModuleData"] = [];
                }

                return $.Deferred(function(defer) {
                    if ((videoData["moduleData"] && videoData["moduleData"].length) || (videoData["enhancedModuleData"] && videoData["enhancedModuleData"].length)) {
                        self.modules = videoData["moduleData"].concat(
                            _.map(videoData["enhancedModuleData"], function(enhancedModule) {
                                return enhancedModule.id;
                            })
                        );

                        var hasStandardEndFrame = false;
                        var indexOfModule = self.modules.indexOf(32985);
                        if (self.modules.indexOf(32985) !== -1) {
                            self.modules.splice(videoData["moduleData"].indexOf(32985), 1);
                            hasStandardEndFrame = true;
                        }

                        var moduleUrls = _.map(self.modules, function(moduleId) {
                            return window.wirewax.moduleUrl + moduleId + ".js";
                        });

                        requireShim.require(
                            moduleUrls,
                            function() {
                                var args = Array.prototype.slice.call(arguments);
                                if (hasStandardEndFrame) {
                                    args.splice(indexOfModule, 0, StandardEndFrame);
                                }

                                defer.resolve(args);
                            },
                            function() {
                                defer.reject();
                            }
                        );
                    } else {
                        defer.resolve();
                    }
                }).promise();
            };

            self.loadWriter = function() {
                return $.Deferred(function(defer) {
                    wwplayer.require(
                        ["Writer"],
                        function(Writer) {
                            self.writer = new Writer({
                                interfaceController: self.interfaceController,
                                player: self.player,
                                animationController: self.animationController,
                                tagController: self.tagController,
                                imageMode: globals.MEDIA_TYPE === globals.MEDIA_TYPES.IMAGE
                            });
                            self.writer.load();

                            PubSub.subscribe(globals.REDRAW_TAGS, self.redrawTags);

                            defer.resolve(self.writer);
                        },
                        function() {
                            defer.reject();
                        }
                    );
                }).promise();
            };

            self.clearOldStyles = function() {
                $("head style").each(function(index, styleTag) {
                    var elem = $(styleTag);
                    var id = elem.attr("id");
                    if (id && id.indexOf("wax") != -1) {
                        elem.remove();
                    }
                });
            };

            // TODO Make this smarter, only draw tags that have changed. or create method to update a tags tracking based on its spriteId
            self.redrawTags = function(eventName, args) {
                PubSub.publish(globals.SHOW_LOADER);
                PubSub.publish(globals.DO_PAUSE);

                if (!args) {
                    apiService.getVideoData(
                        self.vidId,
                        function(videoData) {
                            self.tagController.redrawTags(videoData["tagData"], videoData["swissData"], videoData["buttonData"], videoData["staticSpriteData"]);
                        },
                        self.loadDataError
                    );
                } else {
                    var tagId = args.tagId;
                    var spriteId = args.spriteId;

                    var success = function(videoData) {
                        if (window.wirewax.writer && tagId && self.allowedWriterTags.indexOf(tagId) === -1) {
                            tagId = self.defaultWriterTag;
                        }

                        // Redraws all the tags with a new tagId / Tag class
                        if (tagId) {
                            self.clearOldStyles();

                            videoData["metaData"]["tagId"] = tagId;
                            self.loadTag(videoData).then(function(Tag) {
                                self.tagController.redrawTags(videoData["tagData"], videoData["swissData"], videoData["buttonData"], videoData["staticSpriteData"], {
                                    TagClass: Tag,
                                    tagId: tagId
                                });
                            });
                        }
                        // Redraw / add a tag
                        else if (spriteId) {
                            self.tagController.redrawTag(videoData["tagData"], videoData["swissData"], videoData["buttonData"], videoData["staticSpriteData"], spriteId);
                        }
                        // Redraw all the tags
                        else {
                            self.tagController.redrawTags(videoData["tagData"], videoData["swissData"], videoData["buttonData"], videoData["staticSpriteData"]);
                        }
                    };

                    apiService.getVideoData(self.vidId, success, self.loadDataError);
                }
            };

            if (window.wirewax.preview) {
                PubSub.subscribe(globals.REDRAW_TAGS, self.redrawTags);
            }

            /**
             Throw an error when the video data fails to load

             @method
             @name Core#loadDataError
             **/
            self.loadDataError = function() {
                PubSub.publish(globals.ERROR, new LogEvent(globals.ERROR, globals.ERRORS["5004"], { detail: arguments }));
            };

            /**
             Returns the current time of the player

             @method
             @name Core#getCurrentTime
             @returns {Number} Current time
             **/
            self.getCurrentTime = function() {
                if (self.player) {
                    return self.player.getCurrentTime();
                } else {
                    return 0;
                }
            };

            /**
             Returns the current frame of the player

             @method
             @name Core#getCurrentFrame
             @returns {Number} Current frame
             **/

            self.getCurrentFrame = function() {
                if (self.player) {
                    return self.player.getFrame();
                } else {
                    return 0;
                }
            };

            /**
             Returns the play state of the player (player / not playing)

             @method
             @name Core#getIsPlayer
             @returns {Boolean} `true` if the video is playing
             **/
            self.getIsPlaying = function() {
                return self.player.playing();
            };

            /**
             Updates the Scrubber bar and Buffer Bar

             @method
             @name Core#updateScrubBar
             @param {Number} videoWatchedTime the current time of the video
             @param {Number} bufferedTime the current amount of the the video has buffered
             **/
            self.updateScrubBar = function(videoWatchedTime, bufferedTime) {
                self.interfaceController.updateScrubBar(videoWatchedTime, bufferedTime);
            };
        };
        return Core;
    }
);

/*
 * jQuery JSONP Core Plugin 2.4.0 (2012-08-21)
 *
 * https://github.com/jaubourg/jquery-jsonp
 *
 * Copyright (c) 2012 Julian Aubourg
 *
 * This document is licensed as free software under the terms of the
 * MIT License: http://www.opensource.org/licenses/mit-license.php
 */
wwplayer.define(
    "jquery-jsonp",
    ["jquery"], // Require jquery
    function($) {
        (function($) {
            // ###################### UTILITIES ##

            // Noop
            function noop() {}

            // Generic callback
            function genericCallback(data) {
                lastValue = [data];
            }

            // Call if defined
            function callIfDefined(method, object, parameters) {
                return method && method.apply(object.context || object, parameters);
            }

            // Give joining character given url
            function qMarkOrAmp(url) {
                return /\?/.test(url) ? "&" : "?";
            }

            var // String constants (for better minification)
                STR_ASYNC = "async",
                STR_CHARSET = "charset",
                STR_EMPTY = "",
                STR_ERROR = "error",
                STR_INSERT_BEFORE = "insertBefore",
                STR_JQUERY_JSONP = "_jqjsp",
                STR_ON = "on",
                STR_ON_CLICK = STR_ON + "click",
                STR_ON_ERROR = STR_ON + STR_ERROR,
                STR_ON_LOAD = STR_ON + "load",
                STR_ON_READY_STATE_CHANGE = STR_ON + "readystatechange",
                STR_READY_STATE = "readyState",
                STR_REMOVE_CHILD = "removeChild",
                STR_SCRIPT_TAG = "<script>",
                STR_SUCCESS = "success",
                STR_TIMEOUT = "timeout",
                // Window
                win = window,
                // Deferred
                Deferred = $.Deferred,
                // Head element
                head = $("head")[0] || document.documentElement,
                // Page cache
                pageCache = {},
                // Counter
                count = 0,
                // Last returned value
                lastValue,
                // ###################### DEFAULT OPTIONS ##
                xOptionsDefaults = {
                    //beforeSend: undefined,
                    //cache: false,
                    callback: STR_JQUERY_JSONP,
                    //callbackParameter: undefined,
                    //charset: undefined,
                    //complete: undefined,
                    //context: undefined,
                    //data: "",
                    //dataFilter: undefined,
                    //error: undefined,
                    //pageCache: false,
                    //success: undefined,
                    //timeout: 0,
                    //traditional: false,
                    url: location.href
                },
                // opera demands sniffing :/
                opera = win.opera,
                // IE < 10
                oldIE = !!$("<div>")
                    .html("<!--[if IE]><i><![endif]-->")
                    .find("i").length;

            // ###################### MAIN FUNCTION ##
            function jsonp(xOptions) {
                // Build data with default
                xOptions = $.extend({}, xOptionsDefaults, xOptions);

                // References to xOptions members (for better minification)
                var successCallback = xOptions.success,
                    errorCallback = xOptions.error,
                    completeCallback = xOptions.complete,
                    dataFilter = xOptions.dataFilter,
                    callbackParameter = xOptions.callbackParameter,
                    successCallbackName = xOptions.callback,
                    cacheFlag = xOptions.cache,
                    pageCacheFlag = xOptions.pageCache,
                    charset = xOptions.charset,
                    url = xOptions.url,
                    data = xOptions.data,
                    timeout = xOptions.timeout,
                    pageCached,
                    // Abort/done flag
                    done = 0,
                    // Life-cycle functions
                    cleanUp = noop,
                    // Support vars
                    supportOnload,
                    supportOnreadystatechange,
                    // Request execution vars
                    firstChild,
                    script,
                    scriptAfter,
                    timeoutTimer;

                // If we have Deferreds:
                // - substitute callbacks
                // - promote xOptions to a promise
                Deferred &&
                    Deferred(function(defer) {
                        defer.done(successCallback).fail(errorCallback);
                        successCallback = defer.resolve;
                        errorCallback = defer.reject;
                    }).promise(xOptions);

                // Create the abort method
                xOptions.abort = function() {
                    !done++ && cleanUp();
                };

                // Call beforeSend if provided (early abort if false returned)
                if (callIfDefined(xOptions.beforeSend, xOptions, [xOptions]) === !1 || done) {
                    return xOptions;
                }

                // Control entries
                url = url || STR_EMPTY;
                data = data ? (typeof data == "string" ? data : $.param(data, xOptions.traditional)) : STR_EMPTY;

                // Build final url
                url += data ? qMarkOrAmp(url) + data : STR_EMPTY;

                // Add callback parameter if provided as option
                callbackParameter && (url += qMarkOrAmp(url) + encodeURIComponent(callbackParameter) + "=?");

                // Add anticache parameter if needed
                !cacheFlag && !pageCacheFlag && (url += qMarkOrAmp(url) + "_" + new Date().getTime() + "=");

                // Replace last ? by callback parameter
                url = url.replace(/=\?(&|$)/, "=" + successCallbackName + "$1");

                // Success notifier
                function notifySuccess(json) {
                    if (!done++) {
                        cleanUp();
                        // Pagecache if needed
                        pageCacheFlag && (pageCache[url] = { s: [json] });
                        // Apply the data filter if provided
                        dataFilter && (json = dataFilter.apply(xOptions, [json]));
                        // Call success then complete
                        callIfDefined(successCallback, xOptions, [json, STR_SUCCESS, xOptions]);
                        callIfDefined(completeCallback, xOptions, [xOptions, STR_SUCCESS]);
                    }
                }

                // Error notifier
                function notifyError(type) {
                    if (!done++) {
                        // Clean up
                        cleanUp();
                        // If pure error (not timeout), cache if needed
                        pageCacheFlag && type != STR_TIMEOUT && (pageCache[url] = type);
                        // Call error then complete
                        callIfDefined(errorCallback, xOptions, [xOptions, type]);
                        callIfDefined(completeCallback, xOptions, [xOptions, type]);
                    }
                }

                // Check page cache
                if (pageCacheFlag && (pageCached = pageCache[url])) {
                    pageCached.s ? notifySuccess(pageCached.s[0]) : notifyError(pageCached);
                } else {
                    // Install the generic callback
                    // (BEWARE: global namespace pollution ahoy)
                    win[successCallbackName] = genericCallback;

                    // Create the script tag
                    script = $(STR_SCRIPT_TAG)[0];
                    script.id = STR_JQUERY_JSONP + count++;

                    // Set charset if provided
                    if (charset) {
                        script[STR_CHARSET] = charset;
                    }

                    opera && opera.version() < 11.6
                        ? // onerror is not supported: do not set as async and assume in-order execution.
                          // Add a trailing script to emulate the event
                          ((scriptAfter = $(STR_SCRIPT_TAG)[0]).text = "document.getElementById('" + script.id + "')." + STR_ON_ERROR + "()")
                        : // onerror is supported: set the script as async to avoid requests blocking each others
                          (script[STR_ASYNC] = STR_ASYNC);

                    // Internet Explorer: event/htmlFor trick
                    if (oldIE) {
                        script.htmlFor = script.id;
                        script.event = STR_ON_CLICK;
                    }

                    // Attached event handlers
                    script[STR_ON_LOAD] = script[STR_ON_ERROR] = script[STR_ON_READY_STATE_CHANGE] = function(result) {
                        // Test readyState if it exists
                        if (!script[STR_READY_STATE] || !/i/.test(script[STR_READY_STATE])) {
                            try {
                                script[STR_ON_CLICK] && script[STR_ON_CLICK]();
                            } catch (_) {}

                            result = lastValue;
                            lastValue = 0;
                            result ? notifySuccess(result[0]) : notifyError(STR_ERROR);
                        }
                    };

                    // Set source
                    script.src = url;

                    // Re-declare cleanUp function
                    cleanUp = function(i) {
                        timeoutTimer && clearTimeout(timeoutTimer);
                        script[STR_ON_READY_STATE_CHANGE] = script[STR_ON_LOAD] = script[STR_ON_ERROR] = null;
                        head[STR_REMOVE_CHILD](script);
                        scriptAfter && head[STR_REMOVE_CHILD](scriptAfter);
                    };

                    // Append main script
                    head[STR_INSERT_BEFORE](script, (firstChild = head.firstChild));

                    // Append trailing script if needed
                    scriptAfter && head[STR_INSERT_BEFORE](scriptAfter, firstChild);

                    // If a timeout is needed, install it
                    timeoutTimer =
                        timeout > 0 &&
                        setTimeout(function() {
                            notifyError(STR_TIMEOUT);
                        }, timeout);
                }

                return xOptions;
            }

            // ###################### SETUP FUNCTION ##
            jsonp.setup = function(xOptions) {
                $.extend(xOptionsDefaults, xOptions);
            };

            // ###################### INSTALL in jQuery ##
            $.jsonp = jsonp;
        })($);
    }
);

wwplayer.define("requestAnimationFrameShim", [], function() {
    (function() {
        var lastTime = 0;
        var vendors = ["ms", "moz", "webkit", "o"];
        for (var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {
            window.requestAnimationFrame = window[vendors[x] + "RequestAnimationFrame"];
            window.cancelAnimationFrame = window[vendors[x] + "CancelAnimationFrame"] || window[vendors[x] + "CancelRequestAnimationFrame"];
        }

        if (!window.requestAnimationFrame)
            window.requestAnimationFrame = function(callback, element) {
                var currTime = new Date().getTime();
                var timeToCall = Math.max(0, 16 - (currTime - lastTime));
                var id = window.setTimeout(function() {
                    callback(currTime + timeToCall);
                }, timeToCall);
                lastTime = currTime + timeToCall;
                return id;
            };

        if (!window.cancelAnimationFrame)
            window.cancelAnimationFrame = function(id) {
                clearTimeout(id);
            };
    })();

    /* h/t paul irish */
    return true;
});

/**
 The requirejs configuration

 @attribute
 @readOnly
 **/

wwplayer.require.config({
    baseUrl: "https://edge-player.wirewax.com/ww4release/v2779/javascripts/",
    waitSeconds: 30,
    map: {
        "*": {
            jquery: "jquery-private",
            raphael: "raphael-shadow",
            underscore: "underscore-private"
        },
        "jquery-private": { jquery: "jquery" },
        "underscore-private": { underscore: "underscore" },
        "raphael-shadow": { raphael: "raphael" }
    },
    paths: {
        jquery: "vendor/jquery",
        "jquery-private": "jquery-private",
        "jquery-jsonp": "vendor/jquery.jsonp",
        raphael: "vendor/raphael",
        underscore: "vendor/underscore",
        "underscore-private": "underscore-private",
        lodash: "vendor/lodash.min",
        slick: "vendor/slick.min",
        modernizr: "vendor/modernizr",
        pubsub: "vendor/pubsub",
        Class: "vendor/class",
        froogaloop: "vendor/froogaloop2",
        swfobject: "vendor/swfobject",
        iscroll: "vendor/iscroll",
        iscroll5: "vendor/iscroll5",
        eve: "vendor/eve",
        aws: "vendor/aws",
        b64: "vendor/base64",
        text: "vendor/text",
        uuid: "vendor/uuid-v4",
        WebFontLoader: "vendor/WebFontLoader",
        Cookie: "vendor/jquery.cookie",
        colorbox: "vendor/jquery.colorbox",
        proximity: "vendor/jquery.proximity",
        Sketch: "vendor/sketch.min",
        evaporate: "vendor/evaporate",
        utf8: "vendor/utf8",
        three: "vendor/three.min",
        snap: "vendor/snap.svg",
        libpannellum: "vendor/libpannellum",
        libpannellum2: "vendor/libpannellum2",
        pannellum2: "vendor/pannellum2",
        pixi: "vendor/pixi",
        pixi3: "vendor/pixi3",
        pixinormal: "vendor/pixinormal",
        "iphone-inline-video": "vendor/iphoneinlinevideo",
        facebook: "//connect.facebook.net/en_US/sdk",
        Clipboard: "vendor/clipboard",
        requestAnimationFrameShim: "requestAnimationFrameShim",
        apiService: "apiService",
        awsCond: "awsCond",
        TimelineLite: "vendor/TimelineLite.min",
        TimelineMax: "vendor/TimelineMax.min",
        TweenLite: "vendor/TweenLite.min",
        TweenMax: "vendor/TweenMax.min",

        // Players
        AbstractPlayer: "player/players/abstractPlayer",
        ww: "player/players/ww",
        yp: "player/players/yp",
        ff: "player/players/ff",
        bc: "player/players/brightcovePlayer",
        vm: "player/players/vimeoPlayer",
        // 'jw': 'player/players/jwPlayer',
        jw: "player/players/jwPlayer2",
        samsungTv: "player/players/samsungTv",
        mtv: "player/players/mtvPlayer",
        rtlPlayer: "player/players/rtlPlayer",
        rtlPluginPlayer: "player/players/rtlPluginPlayer",
        ooyalaPlayer: "player/players/ooyalaPlayer",
        bbcPlayer: "player/players/bbcPlayer",
        flowPlayer: "player/players/flowPlayer",
        tnt: "player/players/tnt",
        fbPlayer: "player/players/fbPlayer",
        crumpet: "player/players/crumpet",
        crumpet360: "player/players/crumpet360",
        mediaSource: "player/players/mediaSource",
        tp: "player/players/tp",
        tpp: "player/players/tpp",
        ypLive: "player/players/ypLive",
        dummyPlayer: "player/players/dummyPlayer",
        writerPlayer: "player/players/writerPlayer",
        threeSixtyPlayer: "player/players/threeSixtyPlayer",
        newThreeSixtyPlayer: "player/players/newThreeSixtyPlayer",
        threeSixtyCanvasPlayer: "player/players/threeSixtyCanvasPlayer",
        amazonPlayer: "player/players/amazonPlayer",
        videoInVideoPlayer: "player/players/videoInVideoPlayer",
        imagePlayer: "player/players/imagePlayer",
        bitmovinPlayer: "player/players/bitmovinPlayer",

        //crumpet
        crumpetAudioController: "player/players/crumpet/crumpetAudioController",
        crumpetFrameImageController: "player/players/crumpet/crumpetFrameImageController",
        crumpetVideoController: "player/players/crumpet/crumpetVideoController",
        crumpet360VideoController: "player/players/crumpet/crumpet360VideoController",

        // Player APIs
        jwPlayerApi: "//jwpsrv.com/library/IZPVXjWiEeOV7hIxOUCPzg",
        brightCoveApi: "vendor/BrightcoveExperiences",
        brightCoveApiSSL: "vendor/BrightcoveExperiencesSSL",
        mtvApi: "vendor/mtvapi",
        tntApi: "vendor/cvp.min",
        tpPdk: "vendor/tpPdk",
        youtubeApi: "vendor/youtubeApi",

        // Skins
        Skin: "player/interface/Skin",
        SkinBaseSlick: "player/interface/SkinBaseSlick",
        SkinDefaultSlick: "player/interface/SkinDefaultSlick",

        // Test runner
        SpecRunner: "tests/SpecRunner",

        //Loaders for other players
        // 'brightcoveLoader' : 'player/loaders/brightcoveLoader',

        Core: "player/core",
        EventLogger: "player/eventLogger",
        EventManager: "player/eventManager",
        InnovidEventManager: "player/innovidEventManager",
        LogEvent: "player/logEvent",
        TagController: "player/tagController",
        TagAnimator: "player/tagAnimator",
        TagCreator: "player/tagCreator",
        MetricsController: "player/metricsController",
        InterfaceController: "player/interface/interfaceController",
        VolumeController: "player/interface/volumeController",
        VolumeControllerSlick: "player/interface/volumeControllerSlick",
        ForwardsBackwardsControllerSlick: "player/interface/forwardsBackwardsControllerSlick",
        ShareController: "player/interface/shareController",
        ShareControllerSlick: "player/interface/shareControllerSlick",
        ShareScreen: "player/interface/shareScreen",
        Timecode: "player/timecode",
        globals: "player/globals",
        "require-shim": "player/require-shim",
        Security: "player/security",
        Vast: "player/vast",
        DeviceOrientationModule: "player/deviceOrientationModule",

        Scrubber: "player/interface/Scrubber",
        ScrubberSlick: "player/interface/ScrubberSlick",
        Button: "player/interface/button",
        Tooltip: "player/interface/tooltip",
        PlayButton: "player/interface/playButton",
        PauseButton: "player/interface/pauseButton",
        BottomBarPlayButton: "player/interface/bottomBarPlayButton",
        BottomBarPauseButton: "player/interface/bottomBarPauseButton",
        BottomBarFullscreenButton: "player/interface/bottomBarFullscreenButton",
        BottomBarFullscreenButtonSlick: "player/interface/bottomBarFullscreenButtonSlick",
        BottomBarRenditionController: "player/interface/bottomBarRenditionController",
        BottomBarRenditionControllerSlick: "player/interface/bottomBarRenditionControllerSlick",
        BottomBarSubtitleController: "player/interface/bottomBarSubtitleController",
        BottomBarSettingsController: "player/interface/bottomBarSettingsController",
        Loader: "player/interface/Loader",
        LoaderSlick: "player/interface/loaderSlick",
        Console: "player/interface/console",
        Logo: "player/interface/logo",
        LogoSlick: "player/interface/logoSlick",
        LogoWithBanner: "player/interface/logoWithBanner",
        TagDisplayController: "player/interface/tagDisplayController",
        UserMessage: "player/interface/userMessage",
        Suspender: "player/interface/Suspender",
        ViewerOverlay: "player/interface/viewerOverlay",
        StandardEndFrame: "player/interface/standardEndFrame",

        SponsorMarker: "player/interface/sponsorMarker",
        SponsorInfoBar: "player/interface/sponsorInfoBar",
        SponsorVideoController: "player/interface/sponsorVideoController",
        SponsorPlayButton: "player/interface/sponsorPlayButton",

        AnimationController: "player/animationcontrollers/animationController",
        CssAnimationController: "player/animationcontrollers/CssAnimationController",
        JSAnimationController: "player/animationcontrollers/jsAnimationController",
        ImprovedJSAnimationController: "player/animationcontrollers/improvedJSAnimationController",
        NonTagTagController: "player/animationcontrollers/nonTagTagController",
        ThreeSixtyAnimationController: "player/animationcontrollers/ThreeSixtyAnimationController",

        BaseModule: "player/baseModule",
        BaseTag: "player/baseTag",
        BaseTagNew: "player/baseTagNew",
        TailTag: "player/tailTag",
        TempTag: "player/tempTag",
        BaseWidget: "player/baseWidget",
        Branching: "player/branchingcontroller/branching",

        DefaultToolkit: "player/defaultToolkit",
        SamsungToolkit: "player/samsungToolkit",

        //services
        DiscreteBufferingService: "player/services/discreteBufferingService",
        FrameImageGeneratorService: "player/services/frameImageGeneratorService",
        ImageServiceShim: "player/services/imageServiceShim",

        // Writer
        Writer: "player/writer",
        ThriftDataGatherer: "vendor/thrift/ThriftDataGatherer",
        VisionSlave: "vendor/thrift/VisionSlave",
        VisionTypes: "vendor/thrift/visionT_types",
        WireWaxDataTypes: "vendor/thrift/wwDataT_types",
        Thrift: "vendor/thrift/thrift",

        // Education
        InfoBase: "player/education/infoBase"
    },
    shim: {
        jquery: {
            exports: "$"
        },
        modernizr: {
            exports: "Modernizr"
        },
        froogaloop: {
            exports: "Froogaloop"
        },
        jwPlayerApi: {
            exports: "jwplayer2"
        },
        brightCoveApi: {
            exports: "brightcove"
        },
        brightCoveApiSSL: {
            exports: "brightcove"
        },
        swfobject: {
            exports: "swfobject"
        },
        iscroll: {
            exports: "iScroll"
        },
        TweenLite: {
            exports: "TweenLite"
        },
        TweenMax: {
            deps: ["TimelineMax"],
            exports: "TweenMax"
        },
        TimelineLite: {
            deps: ["TweenLite"],
            exports: "TimelineLite"
        },
        TimelineMax: {
            deps: ["TimelineLite"],
            exports: "TimelineMax"
        },
        mtvApi: {
            exports: "MTVNPlayer",
            dependencies: ["underscore", "swfobject"]
        },
        proximity: {
            exports: "proximity",
            dependencies: ["jquery"]
        },
        raphael: {
            exports: "Raphael",
            dependencies: ["eve"]
        },
        Sketch: {
            exports: "Sketch"
        },
        utf8: {
            exports: "utf8"
        },
        eve: {
            exports: "eve"
        },
        aws: {
            exports: "AWS"
        },
        b64: {
            exports: "Base64"
        },
        Thrift: {
            exports: "Thrift",
            dependencies: ["jquery"]
        },
        WebFontLoader: {
            exports: "WebFont"
        },
        Cookie: {
            dependencies: ["jquery"]
        },
        colorbox: {
            dependencies: ["jquery"]
        },
        tntApi: {
            dependencies: ["jquery"],
            exports: "CVP"
        },
        tpPdk: {
            exports: "tpPdk"
        },
        evaporate: {
            exports: "Evaporate"
        },
        snap: {
            exports: "Snap"
        },
        three: {
            exports: "THREE"
        },
        libpannellum: {
            exports: "libpannellum"
        },
        libpannellum2: {
            exports: "libpannellum2"
        },
        pannellum2: {
            exports: "pannellum2"
        },
        facebook: {
            exports: "FB"
        }
    }
});

var myRequirejs = window.wwplayer ? window.wwplayer.requirejs : requirejs;
myRequirejs.onResourceLoad = function(context, map, depArray) {
    if (window.wirewax) {
        if (!window.wirewax.loadedDependencies) window.wirewax.loadedDependencies = [];
        window.wirewax.loadedDependencies.push(map.name);
    }
};

window.reloadWirewax = function(overrides) {
    function merge_objects(obj1, obj2) {
        var obj3 = {};
        for (var attrname in obj1) {
            obj3[attrname] = obj1[attrname];
        }
        for (var attrname in obj2) {
            obj3[attrname] = obj2[attrname];
        }
        return obj3;
    }

    wwplayer.require(["pubsub"], function(PubSub) {
        PubSub.unsubscribeAll();
    });

    if (!window.wirewax.loadedDependencies) {
        window.wirewax.loadedDependencies = [];
    }
    window.wirewax.loadedDependencies.map(function(item) {
        var myRequirejs = window.wwplayer ? window.wwplayer.require : require;
        myRequirejs.undef(item);
    });
    var newWirewax = {
        continent: window.wirewax.continent,
        country: window.wirewax.country,
        embedLoc: window.wirewax.embedLoc,

        // plugin variables
        flowplayerPlugin: window.wirewax.flowplayerPlugin,
        brightcovePlayerPlugin: window.wirewax.brightcovePlayerPlugin,
        amazonPlayerPlugin: window.wirewax.amazonPlayerPlugin,
        bbcPlayerPlugin: window.wirewax.bbcPlayerPlugin,
        bitmovinPlugin: window.wirewax.bitmovinPlugin,
        jwPlugin: window.wirewax.jwPlugin,

        // dev variables
        dev: window.wirewax.dev,
        debug: window.wirewax.debug,
        baseUrl: window.wirewax.baseUrl,
        moduleUrl: window.wirewax.moduleUrl,
        tagUrl: window.wirewax.tagUrl,
        widgetUrl: window.wirewax.widgetUrl,
        vidCdnUrl: window.wirewax.vidCdnUrl,
        cdnUrl: window.wirewax.cdnUrl,
        color: window.wirewax.color,
        fontUrl: window.wirewax.fontUrl,
        requireBaseUrl: window.wirewax.requireBaseUrl
    };

    if (document.getElementById("waxxer")) document.getElementById("waxxer").outerHTML = "";
    delete window.wirewax;
    window.wirewax = merge_objects(newWirewax, overrides);
    init_requirejs();
};

/**
 The main entry point to the APP
 Sets up the globals / dependencies and launched the Core player

 @module dependencies
 @main dependencies
 @requires jquery, globals, apiService, modernizr
 **/

function init_requirejs() {
    wwplayer.require(["jquery", "globals", "apiService", "Core", "modernizr", "pubsub", "underscore", "require-shim", "jquery-jsonp", "requestAnimationFrameShim"], function($, globals, apiService, Core, Modernizr, PubSub, _, requireShim, jqueryJsonp, requestAnimationFrameShim) {
            $.noConflict(true);
            var self = this;
            // Don't allow Google Web Preview to load the player and cause idiotic errors
            if (globals.IS_GOOGLE_BOT || globals.IS_DEJACLICK_BOT) {
                return;
            }

            if (window.wirewax.mainLoadTimeStart) {
                var loadTimeDiff = new Date().getTime() - window.wirewax.mainLoadTimeStart;

                if (globals.IS_DESKTOP) {
                    if (loadTimeDiff < 200) {
                        globals.BANDWIDTH_PREFERRED_RENDITION = "4k";
                    } else if (loadTimeDiff < 1000) {
                        globals.BANDWIDTH_PREFERRED_RENDITION = "1080";
                    } else if (loadTimeDiff < 3000) {
                        globals.BANDWIDTH_PREFERRED_RENDITION = "720";
                    } else if (loadTimeDiff < 5000) {
                        globals.BANDWIDTH_PREFERRED_RENDITION = "540";
                    } else {
                        globals.BANDWIDTH_PREFERRED_RENDITION = "360";
                    }
                }

                if (window.wirewax.recordLoad) {
                    window.wirewax.recordLoad("dependencies.js loaded", loadTimeDiff);
                }
            }

            if (window.wirewax.dev) {
                globals.BANDWIDTH_PREFERRED_RENDITION = "360";
            }

            if (window.wirewax.forceRendition) {
                globals.BANDWIDTH_PREFERRED_RENDITION = window.wirewax.forceRendition;
            }

            if (window.wirewax.devKit) {
                window.define = window.define || window.wwplayer.define;
                window.require = window.require || window.wwplayer.require;
            }

            if (window.wirewax.innovid) {
                globals.INNOVID_EVENTS = true;
                window.wirewax.skin = "SkinBarebones";
            }

            function isTrue(value) {
                if (typeof value == "string") {
                    value = value.toLowerCase().trim();
                }
                switch (value) {
                    case true:
                    case "true":
                    case 1:
                    case "1":
                    case "on":
                    case "yes":
                        return true;
                    default:
                        return false;
                }
            }

            $(document).ready(function() {
                if (window.wirewax.recordLoad) {
                    window.wirewax.recordLoad("dependencies document ready");
                }

                function getUrlParameter(url, name) {
                    return decodeURIComponent((new RegExp("[?|&]" + name + "=" + "([^&;]+?)(&|#|;|$)").exec(url) || [, ""])[1].replace(/\+/g, "%20")) || null;
                }

                if (window && window.open && globals.IS_WINDOWS_PHONE) {
                    var openNewWindow = window.open;

                    window.open = function(args) {
                        window.location.href = args;
                    };
                }
                /**
                 Loads and starts the Core

                 @method loadCore
                 @param {HTMLElement} videoElement The main video-container element
                 @param {Number} vId The id of the video being watched
                 **/
                var loadCore = function(videoElement, vId) {
                    if (window.wirewax.recordLoad) {
                        window.wirewax.recordLoad("dependencies loading core " + vId);
                    }

                    var core = new Core(videoElement, vId);
                    // window.wirewax.core = core;
                    core.start();
                };

                // ========================== WIREWAX GLOBALS =========================================
                window.wirewax.$ = window.wirewax.jQuery = $;

                if (!window.wirewax.embedLoc) {
                    window.wirewax.embedLoc = window.location.href;
                }
                if (window.wirewax.again || window.wirewax.loop) {
                    globals.LOOP = true;
                }
                if (window.wirewax.html5Override) {
                    globals.FORCE_HTML5 = true;
                }
                if (window.wirewax.writer) {
                    globals.ENABLE_STALL_MESSAGES = true;
                    globals.WHITELABEL = true;
                    globals.DISABLE_ADS = true;
                    globals.OPEN_WIDGET_ON_SPRITE_SEEK_TO = false;
                    globals.DISABLE_METRICS = true;
                    globals.DISABLE_SPACE_BAR_PLAY = false;
                    window.wirewax.skin = "SkinWriter";
                }
                if (window.wirewax.preview) {
                    globals.WHITELABEL = true;
                    globals.DISABLE_ADS = true;
                    globals.DISABLE_METRICS = true;
                    globals.DISABLE_SHARES = true;
                    globals.DISABLE_LOGO = true;
                    globals.OPEN_WIDGET_ON_SPRITE_SEEK_TO = false;
                }
                if (window.wirewax.offline) {
                    globals.DISABLE_ADS = true;
                    globals.DISABLE_SHARES = true;
                    globals.DISABLE_LOGO = true;
                    window.wirewax.forceVideoPlayer = true;
                }
                if (window.wirewax.disableMetrics) {
                    globals.DISABLE_METRICS = true;
                }
                var fullscreenEnabled = document.fullscreenEnabled || document.webkitFullscreenEnabled || document.mozFullScreenEnabled || document.msFullscreenEnabled;
                if (!fullscreenEnabled) {
                    globals.DISABLE_FULLSCREEN = true;
                }

                if (window.wirewax.noShare) {
                    globals.DISABLE_SHARES = true;
                }
                if (globals.IS_PHANTOM) {
                    globals.DISABLE_METRICS = true;
                }
                if (window.wirewax.disableScrubberTags) {
                    globals.DISABLE_SCRUBBER_TAGS = true;
                }
                if (window.wirewax.muted) {
                    globals.VOLUME = 0;
                }
                if (window.wirewax.vr) {
                    globals.VR_ENABLED = true;
                }
                if (window.wirewax.singlePixel) {
                    globals.SINGLE_PIXEL = true;
                }
                if (window.wirewax.shareVersion) {
                    globals.SHARE_VERSION = window.wirewax.shareVersion;
                }
                if (window.wirewax.shareButtons) {
                    //make sure the final value is an array
                    if (typeof window.wirewax.shareButtons === "string" || window.wirewax.shareButtons instanceof String) {
                        globals.SHARE_BUTTONS = window.wirewax.shareButtons.split(",");
                    } else if (Array.isArray(window.wirewax.shareButtons)) {
                        globals.SHARE_BUTTONS = window.wirewax.shareButtons;
                    }
                }
                if (window.wirewax.shareBgColor) {
                    globals.SHARE_BG_COLOR = window.wirewax.shareBgColor;
                }
                if (window.wirewax.shareIconColor) {
                    globals.SHARE_ICON_COLOR = window.wirewax.shareIconColor;
                }

                if (isTrue(window.wirewax.showSubtitles)) {
                    globals.HAS_SUBTITLES = true;
                }

                if (parseInt(window.wirewax.hfov)) {
                    globals.HFOV = parseInt(window.wirewax.hfov);
                }

                if (parseInt(window.wirewax.startingYaw)) {
                    globals.STARTING_YAW = parseInt(window.wirewax.startingYaw);
                }

                if (isTrue(window.wirewax.preload)) {
                    globals.VIDEO_PRELOAD = "auto";
                }
                if (isTrue(window.wirewax.autoStart) || isTrue(window.wirewax.autoplay)) {
                    globals.AUTOPLAY = true;
                    globals.SHOW_DISABLED_AUDIO_ICON = true;
                }
                if (isTrue(window.wirewax.noCustomisations)) {
                    globals.DISABLE_CUSTOMISATIONS = true;
                }

                if (window.wirewax.forceRendition) {
                    var _SMC_DEFAULT_RENDITIONS = ["360", "540", "720", "1080"];
                    if (_SMC_DEFAULT_RENDITIONS.indexOf(window.wirewax.forceRendition) !== -1) {
                        globals.FORCE_RENDITION = window.wirewax.forceRendition;
                    }
                }

                // Color override from embedder params
                if (window.wirewax.colour) {
                    var style = document.createElement("style");
                    style.setAttribute("type", "text/css");
                    style.setAttribute("id", "wwx-color-style");

                    var isLight = function(hexcolor) {
                        var r = parseInt(hexcolor.substr(1, 2), 16);
                        var g = parseInt(hexcolor.substr(3, 2), 16);
                        var b = parseInt(hexcolor.substr(5, 2), 16);
                        var yiq = (r * 299 + g * 587 + b * 114) / 1000;
                        return yiq >= 128;
                    };

                    globals.BUTTON_BACKGROUND_COLOR = "#303030";
                    globals.INVERSE_BACKGROUND_COLOR = "#ffffff";

                    if (!isLight(window.wirewax.colour)) {
                        globals.BUTTON_BACKGROUND_COLOR = "#ffffff";
                        globals.INVERSE_BACKGROUND_COLOR = "#303030";
                    }

                    var colorStyle = ".colorable{ background-color:" + window.wirewax.colour + " !important; }\n";
                    colorStyle += ".hover-colorable{ background-color: " + globals.BUTTON_BACKGROUND_COLOR + " !important;}\n";
                    colorStyle += ".hover-colorable.hover-effect{ background-color: " + window.wirewax.colour + " !important;}\n";
                    colorStyle += ".background-colorable{ background-color: " + globals.BUTTON_BACKGROUND_COLOR + " !important;}\n";

                    if (style.styleSheet) {
                        style.styleSheet.cssText = colorStyle;
                    } else {
                        var textNode = document.createTextNode(colorStyle);
                        style.appendChild(textNode);
                    }
                    $("head").append(style);
                }

                // Set the users language
                if (!window.wirewax.lang) {
                    if (navigator.userLanguage) {
                        globals.LANG = navigator.userLanguage.substring(0, 2);
                    } else if (navigator.language) {
                        globals.LANG = navigator.language.substring(0, 2);
                    } else {
                        globals.LANG = "en";
                    }
                }

                // Set the users locale
                if (!window.wirewax.locale) {
                    if (navigator.userLanguage) {
                        globals.LOCALE = navigator.userLanguage;
                    } else if (navigator.language) {
                        globals.LOCALE = navigator.language;
                    } else {
                        globals.LOCALE = "en-GB";
                    }
                }

                window.wirewax.toolkit = "DefaultToolkit";

                if (window.wirewax.skin === "SkinDefault" && !window.wirewax.forceSkin && !globals.IS_IE_8 && !globals.IS_IE_9) {
                    if (globals.IS_ANDROID && !globals.IS_CHROME) {
                        window.wirewax.skin = "SkinDefault";
                    } else {
                        window.wirewax.skin = "SkinDefaultSlick";
                    }
                }

                if (Modernizr.touchevents && !globals.IS_DESKTOP) {
                    //globals.CLICK_EVENT = "click";

                    if (window.wirewax.skin !== "SkinDefaultSlick") {
                        window.wirewax.skin = window.wirewax.skin + "Mobile";
                        if (
                            globals.IS_IPHONE &&
                            window.wirewax.skin !== "SkinBarebonesMobile" &&
                            window.wirewax.skin !== "SkinBarebonesSlickMobile" &&
                            window.wirewax.skin !== "SkinInvisibleSlickMobile" &&
                            window.wirewax.skin !== "SkinAlwaysOnMobile" &&
                            window.wirewax.skin !== "SkinAlwaysOnSlickMobile"
                        ) {
                            window.wirewax.skin = "SkinIPhone";
                        }
                    }
                }

                if (globals.IS_WINDOWS_PHONE && !Modernizr.touchevents) {
                    //windows phone does not use touch events, but it needs mobile skin
                    window.wirewax.skin = "SkinDefaultMobile";
                }

                if (globals.IS_DESKTOP) {
                    $("html")
                        .removeClass("touch")
                        .addClass("no-touch");
                }

                if (!Modernizr.video) {
                    globals.HTML5_VIDEO_SUPPORTED = false;
                }

                if (window.wirewax.wakeOnReturn || getUrlParameter(window.location.href, "wakeOnReturn")) {
                    globals.PLAY_ON_WAKE = true;
                }

                if (window.wirewax.transparent === "true") {
                    $("body").css({ background: "transparent" });
                    $("#video-container").css({ background: "transparent" });
                }

                // ==================================================================================

                // ========================== USER AGENT SWITCHING ==================================
                if (globals.IS_IE) {
                    $("body").addClass("ie");
                }
                if (globals.IS_IE_10) {
                    $("body").addClass("ie10");
                }
                if (globals.IS_IE_9) {
                    $("body").addClass("ie9");
                }
                if (globals.IS_IE_8) {
                    $("body").addClass("ie8");
                }
                if (globals.IS_FIREFOX) {
                    $("body").addClass("firefox");
                }
                if (globals.IS_CHROME) {
                    $("body").addClass("chrome");
                }
                if (globals.IS_EDGE) {
                    $("body")
                        .addClass("edge")
                        .addClass("ie")
                        .removeClass("chrome");
                }
                if (globals.IS_SAFARI && !(globals.IS_IPHONE || globals.IS_IPAD)) {
                    $("body").addClass("safari");
                }
                if (globals.IS_IPHONE) {
                    $("body").addClass("iphone");

                    if (globals.IOS_VERSION === 4) {
                        $("body").addClass("iphone-4");
                    }
                }
                if (globals.IS_IPAD) {
                    $("body").addClass("ipad");
                }
                if (globals.IS_KINDLE) {
                    $("body").addClass("kindle");
                }
                if (globals.IS_ANDROID) {
                    $("body").addClass("android");
                }
                if (globals.IS_WINDOWS_PHONE) {
                    $("body").addClass("windows-phone");
                }

                if (globals.IS_MAC) {
                    $("body").addClass("mac");
                }

                // Samsung TV needs a special toolkit
                if (window.Common) {
                    window.wirewax.baseUrl = "http:" + window.wirewax.baseUrl;
                    window.wirewax.toolkit = "SamsungToolkit";
                    apiService.setHttp();
                    window.wirewax.cdnUrl = "http:" + window.wirewax.cdnUrl;
                    window.wirewax.fontUrl = "http:" + window.wirewax.fontUrl;
                    globals.IS_SAMSUNG_TV = true;
                }
                // ==================================================================================
                // THIRD PARTY PLUGINS
                // TODO REFACTOR INTO SEPARATE MODULES
                // ==================================================================================

                //================== BRIGHTCOVE ==================================
                //================================================================
                if (window.wirewax.brightcovePlayerPlugin || window.videojs) {
                    window.wirewax.player = "newbcp";
                    window.wirewax.skin = "SkinBarebonesSlick";

                    var iphoneFix = function() {
                        if (globals.IOS_VERSION < 10) {
                            $(wireWaxElement).html(
                                '<iframe width="100%" height="100%" ' +
                                    'src="//embed.wirewax.com/' +
                                    window.wirewax.vidId +
                                    '/" frameborder="0" scrolling="yes" allowfullscreen>' +
                                    "</iframe>"
                            );
                            return;
                        } else {
                            $(wireWaxElement)
                                .find("video")
                                .attr("playsinline", "true");
                            loadCore(wireWaxElement[0], window.wirewax.vidId);
                        }
                    };

                    // Check if is being loaded in their iframe or on a page via script
                    if (window.self !== window.top || window.location.href.indexOf("players.brightcove.net") !== -1) {
                        // In brightcove iframe, full steam ahead

                        var wireWaxElement = $("#vjs_video_3");

                        if ($("video").length) {
                            wireWaxElement = $("video").parent();
                            window.wirewax.skin = "SkinBarebonesSlick";
                        } else if ($("object").length) {
                            wireWaxElement = $("object").parent();
                            window.wirewax.skin = "SkinBarebones";
                        }
                        var thumb;
                        var thumbnailElement = $(".ee-template-info-inner.ee-components-thumbnail");
                        if (thumbnailElement && thumbnailElement.length) {
                            var firstEl = thumbnailElement[0];
                            if (firstEl) {
                                var firstElStyle = firstEl.style;
                                if (firstElStyle) {
                                    var firstElBG = firstElStyle.backgroundImage;
                                    if (firstElBG) {
                                        thumb = firstElBG.slice(4, -1).replace(/"/g, "");
                                    }
                                }
                            }
                        }

                        var posterUrl = $("video").attr("poster") || thumb;
                        var vidId = wireWaxElement.attr("data-video-id") || getUrlParameter(window.location, "videoId");

                        if (!vidId && posterUrl) {
                            vidId = getUrlParameter(posterUrl, "videoId");
                        }

                        if (!vidId) {
                            return;
                        } else {
                            vidId = vidId.replace(/\s+/g, "");
                        }

                        apiService.getVidIdFromBrightcove(
                            vidId,
                            function(wwVidId) {
                                wireWaxElement
                                    .parent()
                                    .attr("id", "video-container")
                                    .css({
                                        height: "100%",
                                        width: "100%"
                                    });

                                window.wirewax.vidId = wwVidId;
                                $(wireWaxElement).attr("data-vidid", window.wirewax.vidId);
                                $("body").addClass("wwx-brightcove");
                                self.vidId = window.wirewax.vidId;

                                if (globals.IS_IPHONE) {
                                    iphoneFix();
                                } else {
                                    loadCore(wireWaxElement[0], self.vidId);
                                }
                            },
                            function() {
                                // Probably a 404, don't load
                            }
                        );
                    } else {
                        // Loaded by brightcove script, check every video element on the page until it finds one that has wirewax functionality
                        // this means that only 1 video on the page can be used when we're not embedded as an iframe
                        var interactiveVideoFound = false;
                        var videosTried = [];

                        var checkVideos = function() {
                            var videos = null;
                            if (globals.IS_IE) {
                                // They can still be using flash in IE11
                                videos = $(".video-js");
                            } else {
                                videos = $("video");
                            }

                            videos.each(function(index, elem) {
                                if (videosTried.indexOf(elem) !== -1) {
                                    return;
                                }

                                var videojs = window.videojs(elem);
                                var vidId =
                                    $(elem).attr("data-video-id") ||
                                    $(elem)
                                        .parent()
                                        .attr("data-video-id");
                                vidId = vidId.replace(/\s+/g, "");

                                if (videojs && videojs.mediainfo && videojs.mediainfo.id) {
                                    vidId = videojs.mediainfo.id;
                                }

                                if (vidId) {
                                    videosTried.push(elem);
                                    var elem = $(this);
                                    apiService.getVidIdFromBrightcove(
                                        vidId,
                                        function(wwVidId) {
                                            if (!interactiveVideoFound) {
                                                interactiveVideoFound = true;
                                                if (globals.IS_IE) {
                                                    // They can still be using flash and all the bc attributes are in this element
                                                    wireWaxElement = elem;
                                                    wireWaxElement.attr("id", "video-container");
                                                } else if (window.bcJumpstart && globals.IS_MOBILE_USERAGENT) {
                                                    // bcJumpstart is used by Time Inc, on mobile the parent of the div holding the video has no height/width
                                                    // so set the container on the parent above that which does.
                                                    wireWaxElement = elem.parent();
                                                    wireWaxElement.parents(":eq(1)").attr("id", "video-container");
                                                } else {
                                                    // this is the normal route, set Wirewax Element as parent of video, set container on parent of that
                                                    wireWaxElement = elem.parent();
                                                    wireWaxElement.parent().attr("id", "video-container");
                                                }
                                                $("body").addClass("wwx-brightcove");
                                                window.wirewax.vidId = wwVidId;
                                                $(wireWaxElement).attr("data-vidid", window.wirewax.vidId);
                                                self.vidId = window.wirewax.vidId;

                                                globals.VIDEOELEMENT_SIZE_CHECK = true;

                                                if (globals.IS_IPHONE) {
                                                    iphoneFix();
                                                } else {
                                                    loadCore(wireWaxElement[0], self.vidId);
                                                }
                                            }
                                        },
                                        function() {}
                                    );
                                }
                            });
                        };
                        checkVideos();

                        var videoCheckInterval = window.setInterval(function() {
                            if (interactiveVideoFound) {
                                window.clearInterval(videoCheckInterval);
                                return;
                            }
                            checkVideos();
                        }, 1000);
                    }

                    return;
                }
                // ========================== DEPRECATED BRIGHTCOVE ==================================
                // If we're embedded on brightcove then load the Brightcove Plugin Player
                // This is the OLD Brightcove SMART Player and is depreacated
                else if (!$("#video-container").length && $("#BrightcovePlayer").length) {
                    globals.USE_FLASH_FALLBACK = false;

                    $("html").css({ height: "100%", width: "100%" });
                    $("body").css({ height: "100%", width: "100%" });

                    var brightcoveLoadInterval = window.setInterval(function() {
                        var brightcoveVideo = brightcove.api.getExperience().getModule(brightcove.api.modules.APIModules.VIDEO_PLAYER).video;
                        if (brightcoveVideo) {
                            if ($("#bcVideo")[0] && $("#bcVideo")[0].controls) {
                                $("#bcVideo")[0].controls = false;
                            }
                            $(".vjs-controls").remove();

                            var vidId = brightcoveVideo.customFields && brightcoveVideo.customFields.wwvidid ? brightcoveVideo.customFields.wwvidid : brightcoveVideo.referenceID;

                            window.clearInterval(brightcoveLoadInterval);
                            $("#bcVideo")[0].controls = false;
                            $(".vjs-controls").remove();
                            $("#BrightcovePlayer").wrap('<div id="video-container" style="height:100%; width:100%;" data-vidid="' + vidId + '" data-player="bcp"></div>');
                            var wireWaxElement = $("#video-container");
                            self.vidId = wireWaxElement.attr("data-vidid");
                            window.wirewax.vidId = self.vidId;

                            loadCore(wireWaxElement[0], self.vidId);
                        }
                    }, 100);

                    return;
                }
                // ========================== ANOTHER DEPRECATED BRIGHTCOVE ==================================
                // this is also deprecated, we don't use the window.brightcove
                else if (window.brightcove) {
                    var onBCTemplateReady = function() {
                        if (!window.BCL.experienceId) {
                            // This is bad, find a better way :(
                            window.BCL.experienceId = $(".BrightcoveExperience").attr("id");
                        }

                        window.BCL.APIModules = brightcove.api.modules.APIModules;
                        window.BCL.brightcovePlayer = brightcove.api.getExperience(window.BCL.experienceId);
                        window.BCL.videoPlayerModule = window.BCL.brightcovePlayer.getModule(window.BCL.APIModules.VIDEO_PLAYER);

                        window.BCL.videoPlayerModule.getCurrentVideo(function(brightcoveVideo) {
                            var vidId = brightcoveVideo.customFields && brightcoveVideo.customFields.wwvidid ? brightcoveVideo.customFields.wwvidid : brightcoveVideo.referenceID;

                            if (!globals.IS_IPHONE) {
                                window.wirewax.posterUrl = brightcoveVideo.videoStillURL;
                            }

                            var brightCoveElement = $("#" + window.BCL.experienceId);
                            var height = brightCoveElement.height();
                            var width = brightCoveElement.width();

                            var videoContainer = $("#" + window.BCL.experienceId).parent();
                            videoContainer
                                .attr("id", "video-container")
                                .attr("data-player", "bcp")
                                .attr("data-vidid", vidId);
                            videoContainer.css({
                                height: height,
                                width: width
                            });

                            var wireWaxElement = $("#video-container");
                            self.vidId = vidId;
                            window.wirewax.vidId = vidId;

                            loadCore(wireWaxElement[0], vidId);

                            if (globals.IS_IPHONE) {
                                $(wireWaxElement)
                                    .find('object[type="applications/x-shockwave-flash"]')
                                    .remove();
                                $(wireWaxElement).css({
                                    width: "100%",
                                    height: "100%"
                                });
                            }
                        });
                    };

                    if (window.BCL.templateReady) {
                        onBCTemplateReady();
                    } else {
                        var readyFunc = window.onBrightcoveTemplateReady;
                        window.onBrightcoveTemplateReady = function() {
                            if (readyFunc) {
                                readyFunc();
                            }
                            onBCTemplateReady();
                        };
                    }

                    return;
                }
                //=====================THE PLATFORM ==================================
                //====================================================================
                else if (window.$pdk && !$("#video-container").length) {
                    switch (window.$pdk.version.major) {
                        case "5":
                            if (window.$pdk.version.minor === "9") {
                                window.wirewax.player = "pdk5";
                            } else {
                                window.wirewax.player = "tpp";
                            }
                            break;

                        case "6":
                            window.wirewax.player = "pdk6";
                            break;

                        default:
                            window.wirewax.player = "tpp";
                            break;
                    }

                    console.log("%c ::WIREWAX:: WIREWAX Player configured as " + window.wirewax.player, "background: #444; color: #ffff00");

                    window.wirewax.skin = "SkinBarebones";

                    window.wirewax.pdkPlugin.controller.addEventListener("OnMediaStart", function(event){
                        var contentID = window.wirewax.player === "pdk6" ? event.data.contentID : event.data.baseClip.contentID;
                        console.log(" ::WIREWAX:: PDK content ID: " + contentID);
                        if(window.wirewax.vidId) {
                            // to improve the performance when replay
                            return
                        }
                        apiService.getVidIdFromThePlatform(
                            contentID,
                            function(wwVidId) {
                                console.log(" ::WIREWAX:: Connected to WIREWAX video ID: " + wwVidId);
                                if (wwVidId) {
                                    window.wirewax.vidId = wwVidId;
                                    var targetContainerClass = window.wirewax.player === "pdk6" ? ".tpStandby" : "#waxxer-target";
                                    var targetContainer = $(targetContainerClass)
                                    var wireWaxElement = $("<div></div>");
                                    targetContainer.append(wireWaxElement)
                                    wireWaxElement.attr("id", "video-container");
                                    wireWaxElement.css({
                                        height: "100%",
                                        width: "100%",
                                        "background-color": "transparent"
                                    });
                                    $(wireWaxElement).attr("data-vidid", window.wirewax.vidId);
                                    self.vidId = window.wirewax.vidId;
                                    loadCore(wireWaxElement[0], self.vidId);
                                }
                            },
                            function() {
                                // Probably a 404, don't don't load
                                console.error(" ::WIREWAX:: WIREWAX video ID is NOT provided at s3/ww4player/thePlatformData");
                            }
                        );
                    });

                    return;
                }
                //================== OOYALA ==========================================
                //====================================================================
                else if (window.OO) {
                    window.wirewax.player = "ooyalaPlayer";
                    window.wirewax.skin = "SkinBarebones";

                    window.wirewax.reload = function(vidId, element) {
                        window.wirewax.playerReady = false;
                        window.wirewax.posterUrl = "";

                        $("#wirewax-keyframes").remove();

                        $("head style").each(function(index, styleTag) {
                            var elem = $(styleTag);
                            var id = elem.attr("id");
                            if (id && id.indexOf("wax") != -1) {
                                elem.remove();
                            }
                        });

                        if (element) {
                            wireWaxElement = element;
                        }

                        if ($("#video-container .innerWrapper .oo_tap_panel").length) {
                            wireWaxElement = $("#video-container .innerWrapper .oo_tap_panel");
                        } else {
                            wireWaxElement = $("#video-container .innerWrapper");
                        }

                        if (vidId) {
                            self.vidId = vidId;
                            window.wirewax.vidId = self.vidId;
                            wireWaxElement.attr("data-vidid", self.vidId);
                            PubSub.unsubscribeAll();
                            loadCore(wireWaxElement[0], self.vidId);
                        }
                    };

                    var loadPlayerOoyala = function(player) {
                        apiService.getVidIdFromOoyala(
                            player.embedCode,
                            function(json) {
                                var json = JSON.parse(json);
                                if (json.wirewaxVidId) {
                                    window.wirewax.reload(parseInt(json.wirewaxVidId));
                                }
                            },
                            function() {
                                // DO NOTHING
                            }
                        );
                    };

                    if (window.wirewax.ooyalaPlayer) {
                        var player = window.wirewax.ooyalaPlayer;
                        loadPlayerOoyala(player);
                    } else {
                        window.onOoyalaCreate = function(player) {
                            window.wirewax.ooyalaPlayer = player;
                            loadPlayerOoyala(player);
                        };
                    }

                    return;
                }
                //================== RTL PLAYER PLUGIN ===============================
                //====================================================================
                else if (window.wirewax.rtlPlugin) {
                    window.wirewax.player = "rtlPluginPlayer";
                    window.wirewax.skin = "SkinBarebones";

                    var interactiveVideoFound = false;
                    globals.NO_LOGO = true;
                    globals.NO_CENTER_BUTTONS = true;
                    globals.RECORD_MOUSE_METRICS = false;
                    globals.METRICS_INTERVAL = 30000;

                    var cachedFn = null;
                    if (window.playerEvent) {
                        cachedFn = window.playerEvent;
                    }
                    window.playerEvent = function(event, data) {
                        if (cachedFn) {
                            try {
                                cachedFn(event, data);
                            } catch (err) {}
                        }

                        console.info(event);

                        switch (event) {
                            case "RTL_VIDEODATA_INIT":
                                try {
                                    $("#waxxer").hide();

                                    var vidData = JSON.parse(window.decodeURIComponent(data));
                                    window.wirewax.currentTimeOffset = 0;

                                    if (vidData.id) {
                                        console.info(vidData.id);

                                        if (window.wirewax.rtlVidId && vidData.id == window.wirewax.rtlVidId) {
                                            if (vidData.segmentStart && vidData.segmentStart.time) {
                                                window.wirewax.currentTimeOffset = vidData.segmentStart.time;
                                            }
                                        } else {
                                            apiService.getVidIdFromRTL(
                                                vidData.id,
                                                function(wwxVidId) {
                                                    if (wwxVidId && wwxVidId.indexOf("<") === -1 && !interactiveVideoFound) {
                                                        window.wirewax.vidId = wwxVidId;
                                                        window.wirewax.rtlVidId = vidData.id;
                                                        interactiveVideoFound = true;
                                                        var wireWaxElement = $("#videoplayer").parent();
                                                        wireWaxElement.parent().attr("id", "video-container");
                                                        wireWaxElement.find("#videoplayer").css("float", "none");
                                                        wireWaxElement.css("position", "relative");
                                                        $(wireWaxElement).attr("data-vidid", window.wirewax.vidId);
                                                        self.vidId = window.wirewax.vidId;
                                                        globals.VIDEOELEMENT_SIZE_CHECK = true;

                                                        loadCore(wireWaxElement[0], self.vidId);
                                                    }
                                                },
                                                function() {
                                                    // DO NOTHING
                                                }
                                            );
                                        }
                                    }
                                } catch (err) {}
                                break;
                            case "RTL_ADBLOCK_START":
                                $("#waxxer").hide();
                                break;
                            case "RTL_ADBLOCK_END":
                                $("#waxxer").show();
                                break;
                            case "RTL_PLAYING_STATE_ENTERED":
                                window.wirewax.rtlHasStarted = true;
                                break;
                            case "RTL_CONTENT_STREAM_STARTED":
                                $("#waxxer").show();
                                if (window.wirewax.rtl && window.wirewax.rtl.contentResume) {
                                    window.wirewax.rtl.contentResume();
                                }
                                break;
                            case "RTL_PAUSED_STATE_ENTERED":
                                if (window.wirewax.rtl && window.wirewax.rtl.contentPause) {
                                    window.wirewax.rtl.contentPause();
                                }
                                break;
                            case "RTL_STOPPED_STATE_ENTERED":
                                if (window.wirewax.rtl && window.wirewax.rtl.contentPause) {
                                    window.wirewax.rtl.contentPause();
                                    $("#waxxer").hide();
                                }
                                break;
                            case "NOWTV_BREAKAD":
                                if (window.wirewax.rtl && window.wirewax.rtl.breakAd) {
                                    window.wirewax.rtl.breakAd(data);
                                }
                                break;
                            case "RTL_CONTENT_PAUSE":
                                if (window.wirewax.rtl && window.wirewax.rtl.contentPause) {
                                    window.wirewax.rtl.contentPause();
                                }
                                break;
                            case "RTL_CONTENT_RESUME":
                                if (window.wirewax.rtl && window.wirewax.rtl.contentResume) {
                                    window.wirewax.rtl.contentResume();
                                }
                                break;
                            case "RTL_CONTENT_BEFORE_SEEK":
                                if (window.wirewax.rtl && window.wirewax.rtl.beforeSeek) {
                                    window.wirewax.rtl.beforeSeek(data);
                                }
                                break;
                            case "RTL_CONTENT_SEEK_UPDATE":
                                if (window.wirewax.rtl && window.wirewax.rtl.seekUpdate) {
                                    window.wirewax.rtl.seekUpdate(data);
                                }
                                break;
                            case "RTL_PLAYER_INTERACTION":
                                if (data == "PLAYER_CONTROLS_SEEK") {
                                    if (window.wirewax.rtl && window.wirewax.rtl.seekUpdate) {
                                        window.wirewax.rtl.seekUpdate(data);
                                    }
                                }
                                break;
                            case "RTL_CONTENT_END":
                                if (window.wirewax.rtl && window.wirewax.rtl.contentEnd) {
                                    window.wirewax.rtl.contentEnd(data);
                                }
                                break;
                        }

                        return true;
                    };

                    return;
                }
                //================== AMAZON PLAYER PLUGIN ============================
                //====================================================================
                else if (window.wirewax.amazonPlayerPlugin) {
                    window.wirewax.player = "amazonPlayer";
                    window.wirewax.skin = "SkinBarebonesSlick";
                    self.vidId = window.options.videoLocation.match(/[0-9]{7}/);
                    window.wirewax.vidId = self.vidId;
                    $("body")
                        .attr("id", "video-container")
                        .css({
                            height: "100%",
                            width: "100%"
                        });
                    var wireWaxElement = $("#airy-container .airy");
                    loadCore(wireWaxElement[0], self.vidId);
                    return;
                }
                //================== BBC PLAYER PLUGIN ===============================
                //====================================================================
                else if (window.bbcPlayerPlugin) {
                    window.wirewax.player = "bbcPlayer";
                    window.wirewax.skin = "SkinBarebonesSlick";

                    var loadPlayerBbc = function(player) {
                        //PubSub.unsubscribeAll();
                        if (window.wirewax.bbcPlayerInterface.datastore.wirewaxPlugin) {
                            self.vidId = window.wirewax.bbcPlayerInterface.datastore.wirewaxPlugin.vidId;
                        } else {
                            //getting data from deprecated way of loading plugins in the bbc player
                            self.vidId = window.wirewax.bbcPlayerInterface.settings.plugins.toLoad[0].data.vidId;
                        }

                        $("body")
                            .attr("id", "video-container")
                            .css({
                                height: "100%",
                                width: "100%"
                            });
                        $("#mediaContainer").addClass("wwx-bbc");
                        var wireWaxElement = $("#mediaContainer");
                        loadCore(wireWaxElement[0], self.vidId);
                    };

                    if (window.wirewax.bbcPlayerInterface) {
                        loadPlayerBbc();
                    } else {
                        function MyPlugin(utils, data) {
                            this.utils = utils;
                            this.data = data;
                        }

                        MyPlugin.prototype = {
                            pluginInitialisation: function(utils) {
                                window.wirewax.bbcPlayerInterface = utils.playerInterface;
                                loadPlayerBbc();
                            }
                        };
                        window.runPlugin = function(utils, data) {
                            return new MyPlugin(utils, data);
                        };
                    }

                    return;
                } else if (window.wirewax.flowplayerPlugin) {
                    window.wirewax.player = "flowPlayer";
                    window.wirewax.skin = "SkinBarebonesSlick";

                    // Prevent to load several videos at the same time. We can only have 1 video at a time.
                    // TODO: realoading is not working yet
                    var reloadFlowPlayerVideo = _.debounce(
                        function(element, vidId, flowPlayerApi) {
                            window.wirewax.playerReady = false;
                            // remove all event subscriptions
                            PubSub.unsubscribeAll();
                            // destroy core object
                            // core = null;
                            // destroy uuid
                            window.wirewax.uuid = null;
                            // remove all wirewax layers
                            $("#waxxer").remove();
                            // remove all font styles
                            $("head style").each(function(index, styleTag) {
                                var elem = $(styleTag);
                                var id = elem.attr("id");
                                if (id && (id.indexOf("wax") != -1 || id.indexOf("font"))) {
                                    elem.remove();
                                }
                            });

                            //load new video
                            self.vidId = vidId;
                            window.wirewax.flowPlayerApi = flowPlayerApi;
                            $(element).addClass("wwx-flowplayer");
                            $(element).attr("id", "video-container");
                            loadCore(element, self.vidId);
                        },
                        1000,
                        true
                    );

                    // Get all flowplayer videos
                    $(".flowplayer").each(function() {
                        var $element = $(this);
                        var flowPlayerApi = window.flowPlayerApi || flowplayer($element);
                        var wirewaxId = $element.data("wirewax-id");
                        if (wirewaxId) {
                            var wireWaxElement = $element.find(".fp-player");
                            reloadFlowPlayerVideo(wireWaxElement, wirewaxId, flowPlayerApi);
                        }

                        // For when they load/replace dynamically
                        // TODO: realoading is not working yet
                        // flowPlayerApi.on("load", function(e, api, asd) {
                        //     var wirewaxId = $element.data("wirewax-id");
                        //     console.log("wirewaxId",wirewaxId, $element)
                        //     if(wirewaxId){
                        //         var wireWaxElement = $element.find('.fp-player');
                        //         reloadFlowPlayerVideo(wireWaxElement, wirewaxId, flowPlayerApi);
                        //     }
                        // });
                    });

                    return;
                }
                //================== BITMOVIN PLAYER PLUGIN ===========================
                //=====================================================================
                else if (window.wirewax.bitmovinPlugin) {
                    // define html element
                    var wireWaxElement = $("#video-container");
                    wireWaxElement.addClass("bitmovin-wirewax");
                    window.wirewax.player = "bitmovinPlayer";
                    window.wirewax.skin = "SkinBarebonesSlick";

                    if (window.wirewax.vidId) {
                        loadCore(wireWaxElement[0], window.wirewax.vidId);
                        return;
                    } else {
                        // get the videoId from within the bitmovin object
                        // there is a text file with the wirewax vidId saved under that name
                        // get the text file with getVidIdFromBitmovin, it returns the vidId
                        // set the vidId to window.wirewax

                        // TO DO: add function in studio to link videos, create text file with wirewax vidId named by bitmovin videoId.

                        var bitmovinVideo = bitmovin.player().getConfig().videoId;

                        apiService.getVidIdFromBitmovin(bitmovinVideo, function(vidId) {
                            window.wirewax.vidId = vidId;

                            loadCore(wireWaxElement[0], window.wirewax.vidId);
                        });
                        return;
                    }
                }
                //================== JWPLAYER PLAYER PLUGIN ===========================
                //=====================================================================
                else if (window.wirewax.jwPlugin) {
                    // define html element
                    var wireWaxElement = $("#video-container");
                    wireWaxElement.addClass("jwplayer-wirewax");
                    window.wirewax.player = "jwPlayer2";
                    window.wirewax.skin = "SkinBarebonesSlick";

                    if (window.wirewax.vidId) {
                        loadCore(wireWaxElement[0], window.wirewax.vidId);
                        return;
                    } else {
                        var mediaId = $(".container-wrapper").attr("data-mediaId");
                        apiService.getVidIdFromJWPlayer(
                            mediaId,
                            function(wwVidId) {
                                window.wirewax.vidId = wwVidId;
                                loadCore(wireWaxElement[0], wwVidId);
                            },
                            function() {
                                // Probably a 404, don't load
                                console.log("error : no vidId");
                            }
                        );
                    }
                }
                // ==================================================================================
                else {
                    var wireWaxElement = $("#video-container");
                    if (window.wirewax.vidId) {
                        $(wireWaxElement).attr("data-vidid", window.wirewax.vidId);
                        self.vidId = window.wirewax.vidId;
                    } else {
                        self.vidId = wireWaxElement.attr("data-vidid");
                    }

                    var legacyVidId = wireWaxElement.attr("data-ambervidid");
                }
                // ==================================================================================

                // Turn on LITE version for the Devices / Browsers that are slow
                if (
                    globals.IS_IE_8 ||
                    globals.IS_IE_9 ||
                    (globals.IS_ANDROID && !globals.IS_CHROME) ||
                    ((globals.IS_IPAD || globals.IS_IPHONE) && globals.IDEVICE_GENERATION === 1) ||
                    globals.IS_WINDOWS_PHONE
                ) {
                    globals.LITE_VERSION = true;
                    wireWaxElement.addClass("lite-version");
                }

                if (!window.wirewax.vidId) {
                    window.wirewax.vidId = self.vidId;
                }
                // else {
                //     loadCore(wireWaxElement[0], self.vidId);
                // }

                if (!window.wirewax.jwPlugin) {
                    loadCore(wireWaxElement[0], self.vidId);
                }

                window.wirewax.reload = function(vidId, element) {
                    window.wirewax.playerReady = false;
                    window.wirewax.posterUrl = "";

                    $("#wirewax-keyframes").remove();

                    $("head style").each(function(index, styleTag) {
                        var elem = $(styleTag);
                        var id = elem.attr("id");
                        if (id && (id.indexOf("wax") != -1 || id.indexOf("font"))) {
                            elem.remove();
                        }
                    });

                    if (element) {
                        wireWaxElement = element;
                    }

                    var videoElement = $(wireWaxElement).find("video");

                    if (videoElement.length) {
                        videoElement[0].pause();
                        videoElement.empty();
                        videoElement.attr("src", "");
                        videoElement[0].load();
                        window.setTimeout(function() {
                            videoElement.remove();
                            videoElement = null;
                        }, 0);
                    }

                    if (vidId) {
                        self.vidId = vidId;
                        window.wirewax.vidId = self.vidId;
                        wireWaxElement.attr("data-vidid", self.vidId);
                    }

                    wireWaxElement.empty();
                    PubSub.unsubscribeAll();
                    loadCore(wireWaxElement[0], self.vidId);
                };

                // Used by the writer to destroy the player on page change
                window.wirewax.destroyPlayer = function() {
                    window.wirewax.playerReady = false;
                    window.wirewax.posterUrl = "";
                    window.wirewax.autoStart = false;
                    window.wirewax.vidOverride = null;

                    $("#wirewax-keyframes").remove();

                    $("head style").each(function(index, styleTag) {
                        var elem = $(styleTag);
                        var id = elem.attr("id");
                        if (id && (id.indexOf("wax") != -1 || id.indexOf("font"))) {
                            elem.remove();
                        }
                    });

                    var videoElement = $(wireWaxElement).find("video");

                    if (videoElement.length) {
                        videoElement[0].pause();
                        videoElement.empty();
                        videoElement.attr("src", "");
                        videoElement[0].load();
                        window.setTimeout(function() {
                            videoElement.remove();
                            videoElement = null;
                        }, 0);
                    }

                    wireWaxElement.empty();
                    PubSub.unsubscribeAll();
                };
            });
        },
        function(err) {
            console.error("Error loading WireWax", err);
        }
    );
}

window.wirewax.pdkPlugin.controller.addEventListener("OnMediaLoadStart", function(event){
    if(!window.wirewax.loadedDependencies) {
        init_requirejs();
    }
})

wwplayer.define("dependencies", function() {});

wwplayer.define("wwplayer", function() {});


function checkJQuery() {
    const scriptsHTMLNodeList = document.querySelectorAll("script");
    const scriptsArray = Array.from(scriptsHTMLNodeList);
    const jQueryNode = scriptsArray.filter( node => /jquery/.test(node.src));
    return jQueryNode[0];
}
